WH.deepFreeze=e=>{"use strict";if(Object.isFrozen(e)){return e}const t=Object.getOwnPropertyNames(e);for(const a of t){const t=e[a];if(t&&typeof t==="object"){WH.deepFreeze(t)}}return Object.freeze(e)};(function(){function e(e){var t=true;var a=false;var i=null;var n={text:true,search:true,url:true,tel:true,email:true,password:true,number:true,date:true,month:true,week:true,time:true,datetime:true,"datetime-local":true};function s(e){if(e&&e!==document&&e.nodeName!=="HTML"&&e.nodeName!=="BODY"&&"classList"in e&&"contains"in e.classList){return true}return false}function r(e){var t=e.type;var a=e.tagName;if(a==="INPUT"&&n[t]&&!e.readOnly){return true}if(a==="TEXTAREA"&&!e.readOnly){return true}if(e.isContentEditable){return true}return false}function o(e){if(e.classList.contains("focus-visible")){return}e.classList.add("focus-visible");e.setAttribute("data-focus-visible-added","")}function l(e){if(!e.hasAttribute("data-focus-visible-added")){return}e.classList.remove("focus-visible");e.removeAttribute("data-focus-visible-added")}function c(a){if(a.metaKey||a.altKey||a.ctrlKey){return}if(s(e.activeElement)){o(e.activeElement)}t=true}function u(e){t=false}function d(e){if(!s(e.target)){return}if(t||r(e.target)){o(e.target)}}function f(e){if(!s(e.target)){return}if(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added")){a=true;window.clearTimeout(i);i=window.setTimeout((function(){a=false}),100);l(e.target)}}function h(e){if(document.visibilityState==="hidden"){if(a){t=true}p()}}function p(){document.addEventListener("mousemove",H);document.addEventListener("mousedown",H);document.addEventListener("mouseup",H);document.addEventListener("pointermove",H);document.addEventListener("pointerdown",H);document.addEventListener("pointerup",H);document.addEventListener("touchmove",H);document.addEventListener("touchstart",H);document.addEventListener("touchend",H)}function m(){document.removeEventListener("mousemove",H);document.removeEventListener("mousedown",H);document.removeEventListener("mouseup",H);document.removeEventListener("pointermove",H);document.removeEventListener("pointerdown",H);document.removeEventListener("pointerup",H);document.removeEventListener("touchmove",H);document.removeEventListener("touchstart",H);document.removeEventListener("touchend",H)}function H(e){if(e.target.nodeName&&e.target.nodeName.toLowerCase()==="html"){return}t=false;m()}document.addEventListener("keydown",c,true);document.addEventListener("mousedown",u,true);document.addEventListener("pointerdown",u,true);document.addEventListener("touchstart",u,true);document.addEventListener("visibilitychange",h,true);p();e.addEventListener("focus",d,true);e.addEventListener("blur",f,true);if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host){e.host.setAttribute("data-js-focus-visible","")}else if(e.nodeType===Node.DOCUMENT_NODE){document.documentElement.classList.add("js-focus-visible");document.documentElement.setAttribute("data-js-focus-visible","")}}if(typeof window!=="undefined"&&typeof document!=="undefined"){window.applyFocusVisiblePolyfill=e;var t;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){t=document.createEvent("CustomEvent");t.initCustomEvent("focus-visible-polyfill-ready",false,false,{})}window.dispatchEvent(t)}if(typeof document!=="undefined"){e(document)}})();
/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */(function(e,t,a){var i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)};var n=function(){var i={};var n=t.createElement("div").style;var s=function(){var e=["t","webkitT","MozT","msT","OT"],t,a=0,i=e.length;for(;a<i;a++){t=e[a]+"ransform";if(t in n)return e[a].substr(0,e[a].length-1)}return false}();function r(e){if(s===false)return false;if(s==="")return e;return s+e.charAt(0).toUpperCase()+e.substr(1)}i.getTime=Date.now||function e(){return(new Date).getTime()};i.extend=function(e,t){for(var a in t){e[a]=t[a]}};i.addEvent=function(e,t,a,i){e.addEventListener(t,a,!!i)};i.removeEvent=function(e,t,a,i){e.removeEventListener(t,a,!!i)};i.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t};i.momentum=function(e,t,i,n,s,r){var o=e-t,l=a.abs(o)/i,c,u;r=r===undefined?6e-4:r;c=e+l*l/(2*r)*(o<0?-1:1);u=l/r;if(c<n){c=s?n-s/2.5*(l/8):n;o=a.abs(c-e);u=o/l}else if(c>0){c=s?s/2.5*(l/8):0;o=a.abs(e)+c;u=o/l}return{destination:a.round(c),duration:u}};var o=r("transform");i.extend(i,{hasTransform:o!==false,hasPerspective:r("perspective")in n,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:r("transition")in n});i.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion);i.extend(i.style={},{transform:o,transitionTimingFunction:r("transitionTimingFunction"),transitionDuration:r("transitionDuration"),transitionDelay:r("transitionDelay"),transformOrigin:r("transformOrigin")});i.hasClass=function(e,t){var a=new RegExp("(^|\\s)"+t+"(\\s|$)");return a.test(e.className)};i.addClass=function(e,t){if(i.hasClass(e,t)){return}var a=e.className.split(" ");a.push(t);e.className=a.join(" ")};i.removeClass=function(e,t){if(!i.hasClass(e,t)){return}var a=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(a," ")};i.offset=function(e){var t=-e.offsetLeft,a=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;a-=e.offsetTop}return{left:t,top:a}};i.preventDefaultException=function(e,t){for(var a in t){if(t[a].test(e[a])){return true}}return false};i.extend(i.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});i.extend(i.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return a.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e=e-1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){if((e/=1)<1/2.75){return 7.5625*e*e}else if(e<2/2.75){return 7.5625*(e-=1.5/2.75)*e+.75}else if(e<2.5/2.75){return 7.5625*(e-=2.25/2.75)*e+.9375}else{return 7.5625*(e-=2.625/2.75)*e+.984375}}},elastic:{style:"",fn:function(e){var t=.22,i=.4;if(e===0){return 0}if(e==1){return 1}return i*a.pow(2,-10*e)*a.sin((e-t/4)*(2*a.PI)/t)+1}}});i.tap=function(e,a){var i=t.createEvent("Event");i.initEvent(a,true,true);i.pageX=e.pageX;i.pageY=e.pageY;e.target.dispatchEvent(i)};i.click=function(e){var a=e.target,i;if(!/(SELECT|INPUT|TEXTAREA)/i.test(a.tagName)){i=t.createEvent("MouseEvents");i.initMouseEvent("click",true,true,e.view,1,a.screenX,a.screenY,a.clientX,a.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null);i._constructed=true;a.dispatchEvent(i)}};return i}();function s(e,a){this.wrapper=typeof e=="string"?t.querySelector(e):e;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var i in a){this.options[i]=a[i]}this.translateZ=this.options.HWCompositing&&n.hasPerspective?" translateZ(0)":"";this.options.useTransition=n.hasTransition&&this.options.useTransition;this.options.useTransform=n.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?n.ease[this.options.bounceEasing]||n.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}s.prototype={version:"5.1.3",_init:function(){this._initEvents()},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(e){if(e.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(e){if(n.eventType[e.type]!=1){if(e.button!==0){return}}if(!this.enabled||this.initiated&&n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.isBadAndroid&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.touches?e.touches[0]:e,i;this.initiated=n.eventType[e.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=n.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;i=this.getComputedPosition();this._translate(a.round(i.x),a.round(i.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=t.pageX;this.pointY=t.pageY;this._execEvent("beforeScrollStart")},_move:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault){e.preventDefault()}var t=e.touches?e.touches[0]:e,i=t.pageX-this.pointX,s=t.pageY-this.pointY,r=n.getTime(),o,l,c,u;this.pointX=t.pageX;this.pointY=t.pageY;this.distX+=i;this.distY+=s;c=a.abs(this.distX);u=a.abs(this.distY);if(r-this.endTime>300&&(c<10&&u<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(c>u+this.options.directionLockThreshold){this.directionLocked="h"}else if(u>=c+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){e.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}s=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){e.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}i=0}i=this.hasHorizontalScroll?i:0;s=this.hasVerticalScroll?s:0;o=this.x+i;l=this.y+s;if(o>0||o<this.maxScrollX){o=this.options.bounce?this.x+i/3:o>0?0:this.maxScrollX}if(l>0||l<this.maxScrollY){l=this.options.bounce?this.y+s/3:l>0?0:this.maxScrollY}this.directionX=i>0?-1:i<0?1:0;this.directionY=s>0?-1:s<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(o,l);if(r-this.startTime>300){this.startTime=r;this.startX=this.x;this.startY=this.y}},_end:function(e){if(!this.enabled||n.eventType[e.type]!==this.initiated){return}if(this.options.preventDefault&&!n.preventDefaultException(e.target,this.options.preventDefaultException)){e.preventDefault()}var t=e.changedTouches?e.changedTouches[0]:e,i,s,r=n.getTime()-this.startTime,o=a.round(this.x),l=a.round(this.y),c=a.abs(o-this.startX),u=a.abs(l-this.startY),d=0,f="";this.isInTransition=0;this.initiated=0;this.endTime=n.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(o,l);if(!this.moved){if(this.options.tap){n.tap(e,this.options.tap)}if(this.options.click){n.click(e)}this._execEvent("scrollCancel");return}if(this._events.flick&&r<200&&c<100&&u<100){this._execEvent("flick");return}if(this.options.momentum&&r<300){i=this.hasHorizontalScroll?n.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0};s=this.hasVerticalScroll?n.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:l,duration:0};o=i.destination;l=s.destination;d=a.max(i.duration,s.duration);this.isInTransition=1}if(o!=this.x||l!=this.y){if(o>0||o<this.maxScrollX||l>0||l<this.maxScrollY){f=n.ease.quadratic}this.scrollTo(o,l,d,f);return}this._execEvent("scrollEnd")},_resize:function(){var e=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout((function(){e.refresh()}),this.options.resizePolling)},resetPosition:function(e){var t=this.x,a=this.y;e=e||0;if(!this.hasHorizontalScroll||this.x>0){t=0}else if(this.x<this.maxScrollX){t=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){a=0}else if(this.y<this.maxScrollY){a=this.maxScrollY}if(t==this.x&&a==this.y){return false}this.scrollTo(t,a,e,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var e=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=n.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(e,t){if(!this._events[e]){this._events[e]=[]}this._events[e].push(t)},off:function(e,t){if(!this._events[e]){return}var a=this._events[e].indexOf(t);if(a>-1){this._events[e].splice(a,1)}},_execEvent:function(e){if(!this._events[e]){return}var t=0,a=this._events[e].length;if(!a){return}for(;t<a;t++){this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,a,i){e=this.x+e;t=this.y+t;a=a||0;this.scrollTo(e,t,a,i)},scrollTo:function(e,t,a,i){i=i||n.ease.circular;this.isInTransition=this.options.useTransition&&a>0;if(!a||this.options.useTransition&&i.style){this._transitionTimingFunction(i.style);this._transitionTime(a);this._translate(e,t)}else{this._animate(e,t,a,i.fn)}},scrollToElement:function(e,t,i,s,r){e=e.nodeType?e:this.scroller.querySelector(e);if(!e){return}var o=n.offset(e);o.left-=this.wrapperOffset.left;o.top-=this.wrapperOffset.top;if(i===true){i=a.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)}if(s===true){s=a.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)}o.left-=i||0;o.top-=s||0;o.left=o.left>0?0:o.left<this.maxScrollX?this.maxScrollX:o.left;o.top=o.top>0?0:o.top<this.maxScrollY?this.maxScrollY:o.top;t=t===undefined||t===null||t==="auto"?a.max(a.abs(this.x-o.left),a.abs(this.y-o.top)):t;this.scrollTo(o.left,o.top,t,r)},_transitionTime:function(e){e=e||0;this.scrollerStyle[n.style.transitionDuration]=e+"ms";if(!e&&n.isBadAndroid){this.scrollerStyle[n.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(e){this.scrollerStyle[n.style.transitionTimingFunction]=e},_translate:function(e,t){if(this.options.useTransform){this.scrollerStyle[n.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ}else{e=a.round(e);t=a.round(t);this.scrollerStyle.left=e+"px";this.scrollerStyle.top=t+"px"}this.x=e;this.y=t},_initEvents:function(t){var a=t?n.removeEvent:n.addEvent,i=this.options.bindToWrapper?this.wrapper:e;a(e,"orientationchange",this);a(e,"resize",this);if(this.options.click){a(this.wrapper,"click",this,true)}if(!this.options.disableMouse){a(this.wrapper,"mousedown",this);a(i,"mousemove",this);a(i,"mousecancel",this);a(i,"mouseup",this)}if(n.hasPointer&&!this.options.disablePointer){a(this.wrapper,n.prefixPointerEvent("pointerdown"),this);a(i,n.prefixPointerEvent("pointermove"),this);a(i,n.prefixPointerEvent("pointercancel"),this);a(i,n.prefixPointerEvent("pointerup"),this)}if(n.hasTouch&&!this.options.disableTouch){a(this.wrapper,"touchstart",this);a(i,"touchmove",this);a(i,"touchcancel",this);a(i,"touchend",this)}a(this.scroller,"transitionend",this);a(this.scroller,"webkitTransitionEnd",this);a(this.scroller,"oTransitionEnd",this);a(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t=e.getComputedStyle(this.scroller,null),a,i;if(this.options.useTransform){t=t[n.style.transform].split(")")[0].split(", ");a=+(t[12]||t[4]);i=+(t[13]||t[5])}else{a=+t.left.replace(/[^-\d.]/g,"");i=+t.top.replace(/[^-\d.]/g,"")}return{x:a,y:i}},_animate:function(e,t,a,s){var r=this,o=this.x,l=this.y,c=n.getTime(),u=c+a;function d(){var f=n.getTime(),h,p,m;if(f>=u){r.isAnimating=false;r._translate(e,t);if(!r.resetPosition(r.options.bounceTime)){r._execEvent("scrollEnd")}return}f=(f-c)/a;m=s(f);h=(e-o)*m+o;p=(t-l)*m+l;r._translate(h,p);if(r.isAnimating){i(d)}}this.isAnimating=true;d()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":if(!e._constructed){e.preventDefault();e.stopPropagation()}break}}};s.utils=n;if(typeof module!="undefined"&&module.exports){module.exports=s}else{e.IScroll=s}})(window,document,Math);var g_localTime=new Date;var g_blogimages={};function MessageBox(e,t){e.find(".wh-message-box").remove();var a=$("<div></div>");a.hide();a.addClass("wh-message-box");a.html('<div class="message">'+t+'</div><div class="close" title="Click on this box to close it"></div>');a.click((function(){$(this).fadeOut()}));e.append(a[0]);a.fadeIn()}function Rectangle(e,t,a,i){this.l=e;this.t=t;this.r=e+a;this.b=t+i}Rectangle.prototype={intersectWith:function(e){return!(this.l>=e.r||e.l>=this.r||this.t>=e.b||e.t>=this.b)},contains:function(e){return this.l<=e.l&&this.t<=e.t&&this.r>=e.r&&this.b>=e.b},containedIn:function(e){return e.contains(this)}};WH.onLoad((()=>{const e=WH.SessionStorage;if(!(window.JSON&&e.isSupported())){return}let t=e.get(e.KEY_LISTVIEW_BROWSE);if(!t)return;let a=/^\/[a-z-]+(=|\/([\w-]*-)?)\d+[^?&#]*/i;let i=a.exec(location.pathname);if(!i)return;i=i[0];var n=function(e,t){if(!t){return WH.ce("i",{className:"fa fa-"+e})}return WH.ce("a",{className:"fa fa-"+e,href:t})};for(var s=0;s<t.length;s++){var r=t[s].urls;for(var o=0;o<r.length;o++){if(r[o]==i){var l=o>0?r[o-1]:false;var c=o+1<r.length?r[o+1]:false;var u=t[s].path+t[s].hash;var d=WH.qs(".breadcrumb");if(!d){return}var f=WH.ce("div",{className:"breadcrumb-browse"});WH.ae(d,f);var h=n("arrow-circle-up",u);WH.Tooltip.simple(h,WH.TERMS.backtolist,"q2",{noWrap:true});WH.ae(f,n("arrow-circle-left",l));WH.ae(f,h);WH.ae(f,n("arrow-circle-right",c));return}}}}));WH.smoothScroll=function(e,t){switch(typeof e){case"string":case"object":case"jQuery":var a=$(e).offset();if(!a){return}e=a.top;break;case"number":break;default:return}if(ZUL.getEnabled()){e-=50}else{e-=10}$("html, body").animate({scrollTop:e},t||500)};WH.getReputationPlusAchievementText=function(e,t,a,i){var n=WH.getAchievementText(e,t,a,true);var s=$("<span>").addClass("wsach-pts");s.mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.reputationtip,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));s.addClass("q1");s.text(WH.numberFormat(i));var r=$("<span>");r.append(" (");r.append(s);r.append(" &ndash; ");r.append(n);r.append(") ");return r};WH.getAchievementText=function(e,t,a,i){var n=$("<span>").addClass("wsach-pts");n.mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.userachcount_tip,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));var s=" ";if(!i){s+=" ("}if(e){s+="<i>"+e+"</i>"+"&middot;"}if(t){s+="<b>"+t+"</b>"+"&middot;"}if(!a){a=0}s+="<u>"+a+"</u>";if(!i){s+=")"}n.html(s);return n};WH.formatTimeElapsed=function(e){const t={abbreviated:[WH.TERMS.year_abbrev,WH.TERMS.month_abbrev,WH.TERMS.week_abbrev,WH.TERMS.day_abbrev,WH.TERMS.hour_abbrev,WH.TERMS.minute_abbrev,WH.TERMS.second_abbrev],singular:[WH.TERMS.year_lc,WH.TERMS.month_lc,WH.TERMS.week_lc,WH.TERMS.day_lc,WH.TERMS.hour_lc,WH.TERMS.minute_lc,WH.TERMS.second_lc],plural:[WH.TERMS.years_lc,WH.TERMS.months_lc,WH.TERMS.weeks_lc,WH.TERMS.days_lc,WH.TERMS.hours_lc,WH.TERMS.minutes_lc,WH.TERMS.seconds_lc]};function a(e,a,i){if(i){return e+" "+t.abbreviated[a]}else{return e+" "+(e==1?t.singular[a]:t.plural[a])}}var i=[31557600,2629800,604800,86400,3600,60,1];var n=[1,3,3,-1,5,-1,-1];e=Math.max(e,1);for(var s=3,r=i.length;s<r;++s){if(e>=i[s]){var o=s;var l=Math.floor(e/i[o]);if(n[o]!=-1){var c=n[o];e%=i[o];var u=Math.floor(e/i[c]);if(u>0){return a(l,o,1)+" "+a(u,c,1)}}return a(l,o,0)}}return"(n/a)"};WH.formatDate=function(e,t,a,i,n){var s=new Date;var r=new Date;r.setTime(s.getTime()-1e3*t);var o;var l=new Date(r.getYear(),r.getMonth(),r.getDate());var c=new Date(s.getYear(),s.getMonth(),s.getDate());var u=c.getTime()-l.getTime();u/=1e3;u/=86400;u=Math.round(u);if(t>=2592e3){o=WH.TERMS.on_lc+WH.formatDateSimple(a,i)}else if(u>1){o=WH.sprintf(WH.TERMS.daysago_format,u);if(e){var d=new Date;d.setTime(a.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else if(t>=43200){if(s.getDay()==r.getDay()){o=WH.TERMS.today_lc}else{o=WH.TERMS.yesterday_lc}o=WH.formatTimeSimple(r,o);if(e){var d=new Date;d.setTime(a.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}else{o=WH.sprintf(WH.TERMS.ago2_format,WH.formatTimeElapsed(t));if(e){var d=new Date;d.setTime(a.getTime()+(g_localTime-WH.getServerTime()));e.className+=" tip";e.title=d.toLocaleString()}}if(n==1){o=o.substr(0,1).toUpperCase()+o.substr(1)}if(e){WH.ae(e,WH.ct(o))}else{return o}};WH.formatDateSimple=function(e,t){function a(e){return e<10?"0"+e:e}var i="",n=e.getDate(),s=e.getMonth()+1,r=e.getFullYear();if(r<=1970){i+=WH.TERMS.unknowndate_stc}else{i+=WH.sprintf(WH.TERMS.date3_format,a(n),a(s),r)}if(t!=null){i=WH.formatTimeSimple(e,i)}return i};WH.formatTimeSimple=function(e,t,a){function i(e){return e<10?"0"+e:e}var n=e.getHours(),s=e.getMinutes();if(t==null){t=""}t+=a?" ":WH.TERMS.at_lc;if(n==12){t+=WH.TERMS.noon_lc}else if(n==0){t+=WH.TERMS.midnight_lc}else if(n>12){t+=n-12+":"+i(s)+" "+WH.TERMS.pm}else{t+=n+":"+i(s)+" "+WH.TERMS.am}return t};WH.formatStartEndDates=function(e,t){if(!e&&!t){return""}var a=false;var i=false;if(e)a=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());if(t)i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());var n="";if(!i){n=WH.TERMS.starts+" "+a.toLocaleDateString()}else if(!a){n=WH.TERMS.ends+" "+i.toLocaleDateString()}else{var s=function(){try{(new Date).toLocaleDateString("i")}catch(e){return e.name==="RangeError"}return false}();var r={month:"long",year:"numeric"};var o="",l="",c=0;if(s&&a.getDate()==1){o=a.toLocaleDateString(undefined,r);c++}else{o=a.toLocaleDateString()}if(s&&new Date(i.valueOf()+36*60*60*1e3).getMonth()!=i.getMonth()){l=i.toLocaleDateString(undefined,r);c++}else{l=i.toLocaleDateString()}if(o==l){n=o}else if(c==1){n=a.toLocaleDateString()+" - "+i.toLocaleDateString()}else{n=o+" - "+l}}return n};WH.createProgressBar=function(e){if(e==null)e={};if(typeof e.text=="undefined"){e.text=" "}if(e.color==null){e.color="rep0"}if(e.width==null||e.width>100){e.width=100}var t,a;if(e.hoverText){t=WH.ce("a");t.href="javascript:"}else{t=WH.ce("span")}t.className="progressbar";if(e.text||e.hoverText){a=WH.ce("div");a.className="progressbar-text";if(e.text){var i=WH.ce("del");WH.ae(i,WH.ct(e.text));WH.ae(a,i)}if(e.hoverText){var n=WH.ce("ins");WH.ae(n,WH.ct(e.hoverText));WH.ae(a,n)}WH.ae(t,a)}a=WH.ce("div");a.className="progressbar-"+e.color;a.style.width=e.width+"%";if(e.height){a.style.height=e.height}WH.ae(a,WH.ct(WH.Strings.nbsp));WH.ae(t,a);if(e.text){var a=WH.ce("div");a.className="progressbar-text progressbar-hidden";WH.ae(a,WH.ct(e.text));WH.ae(t,a)}return t};WH.createReputationBar=function(e,t){if(!t){t=0}var a=WH.getReputationProgress(t);var i=a.length>0?a[a.length-1][1]+999:0;if(!e)e=0;if(e<0){e=0}else if(e>i){e=i}var n=e,s=0,r,o=i;if(i!=0){while(s<a.length){if(e<a[s][1]){break}++s}--s;n-=a[s][1];o=s+1<a.length?a[s+1][1]-a[s][1]:999}if(t){r=g_friendship_reactions[WH.sprintf("$1-$2",t,s)]}else{r=WH.Wow.Faction.getRankName(s)}var l={text:r,hoverText:n+" / "+o,color:"rep"+s,width:parseInt(n/o*100)};return WH.createProgressBar(l)};WH.getReputationProgress=function(e){if(window.g_friendships_thresholds&&Array.isArray(g_friendships_thresholds[e])){return g_friendships_thresholds[e]}return[[0,0],[0,36e3],[0,39e3],[0,42e3],[0,45e3],[0,51e3],[0,63e3],[0,84e3]]};WH.createAchievementBar=function(e,t,a,i){if(!e){e=0}var n={text:e+(i>0?"(+"+i+")":"")+(t>0?" / "+t:""),color:a?"rep7":"ach"+(t>0?0:1),width:t>0?parseInt(e/t*100):100};return WH.createProgressBar(n)};WH.addCompletionIcons=function(e,t,a,i){var n=0;let s;if(t===WH.Types.TRANSMOG_SET){s=typeof a==="object"?a:WH.getPageData("transmog-set-detail-completion")}for(var r in g_user.lists){if(!g_user.lists.hasOwnProperty(r)){continue}let o=g_user.lists[r];if(!o.character){continue}let l=0;if(t===WH.Types.TRANSMOG_SET){l=WH.Wow.TransmogSet.getCompletionAmount(s,o.id);if(l==null){continue}}else{let e=WH.User.Completion.getByType(t);if(!e.hasOwnProperty(o.id)){continue}l=e[o.id].includes(a)?1:0}if(i&&!l){continue}WH.ae(e,WH.createCompletionIcon(o,l));n++}if(t===WH.Types.QUEST&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var o,r=0;o=g_user.characterProfiles[r];r++){var l=WH.inArray(o.quests,a)!=-1;if(i&&!l){continue}WH.ae(e,WH.createCompletionIcon({classs:o["class"],character:o.name,realm:o.realm},l?1:0));n++}}return n};WH.createCompletionIcon=function(e,t,a){var i=WH.ce("a");if(e.url){i.href=WH.Profiler.getPath(e)}i.className="progress-icon progress-"+(t?Math.max(1,Math.floor(t*8)):0);WH.Tooltip.simple(i,WH.getCompletionTooltip(e,t));if(a){i.rel=a}return i};WH.getCompletionTooltip=function(e,t){let a=WH.ce("div");WH.ae(a,WH.ce("span",{className:"q"},WH.ct((t>=1?WH.TERMS.complete:WH.TERMS.incomplete)+WH.TERMS.colon_punct)));WH.ae(a,WH.ce("br"));let i=WH.ce("span",{style:{whiteSpace:"nowrap"}});WH.ae(a,i);WH.ae(i,WH.ce("b",{className:"c"+e.classs},WH.ct(e.character)));let n=[WH.Strings.nbsp,e.realm];if(e.hasOwnProperty("region")){n.push(e.region)}WH.ae(i,WH.ce("span",{className:"q0"},WH.ct(n.join(" "))));if(t>0&&t<1){WH.ae(i,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",Math.round(t*100)+"%")))}return a.innerHTML};WH.getCompletionFlags=function(e,t){var a=0;var i=g_user.lists||[];let n=WH.User.Completion.getByType(e);for(var s=i.length-1;s>=0;s--){var r=i[s];if(!(r.id in n)||!r.character){continue}a=a<<1|(n[r.id].includes(t)?1:0)}if(e==="quest"&&g_user.characterProfiles&&g_user.characterProfiles.length){for(var s=g_user.characterProfiles.length-1;s>=0;s--){var o=g_user.characterProfiles[s];var l=WH.inArray(o.quests,t)!=-1;a=a<<1|(l?1:0)}}return a};WH.preventPageScroll=function(e){var t=e.originalEvent&&e.originalEvent.wheelDelta||e.originalEvent&&-e.originalEvent.detail||e.wheelDelta||-e.detail;this.scrollTop+=(t<0?1:-1)*100;e.preventDefault()};WH.pickerWheel=function(e){e.preventDefault();if(e.deltaY>0){this.scrollTop+=100}else{this.scrollTop-=100}};WH.setSelectedLink=function(e,t){if(!WH.setSelectedLink.groups){WH.setSelectedLink.groups={}}var a=WH.setSelectedLink.groups;if(a[t]){a[t].className=a[t].className.replace("selected","")}e.className+=" selected";a[t]=e};WH.addPagination=function(e,t){function a(e,a){var i;if(e==t.page){i=WH.ce("span");i.className="selected"}else{i=WH.ce("a");i.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}WH.ae(i,WH.ct(a!=null?a:e));return i}if(!t.pound){t.pound=""}if(!t.sep){t.sep="."}if(t.allOrNothing&&t.nPages<=1){return}var i=t.align&&t.align=="left";var n=WH.ce("div"),s,r=WH.ce("var");n.className="pages";if(i){n.className+=" pages-left"}if(t.nPages>1){s=WH.ce("div");s.className="pages-numbers";var o=Math.max(2,t.page-2);var l=Math.min(t.nPages-1,t.page+2);var c=[];if(t.page!=t.nPages){c.push(a(t.page+1,String.fromCharCode(187)))}c.push(a(t.nPages));if(l<t.nPages-1){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}for(var d=l;d>=o;--d){c.push(a(d))}if(o>2){var u=WH.ce("span");WH.ae(u,WH.ct("..."));c.push(u)}c.push(a(1));if(t.page!=1){c.push(a(t.page-1,String.fromCharCode(171)))}if(i){c.reverse()}for(var d=0,f=c.length;d<f;++d){WH.ae(s,c[d])}s.firstChild.style.marginRight="0";s.lastChild.style.marginLeft="0"}var r=WH.ce("var");WH.ae(r,WH.ct(WH.Strings.sprintf(WH.TERMS[t.wording[t.nItems==1?0:1]],t.nItems)));if(t.nPages>1){var u=WH.ce("span");WH.ae(u,WH.ct(String.fromCharCode(8211)));WH.ae(r,u);var h=WH.ce("a");h.className="go-to-page fa fa-files-o";h.href="javascript:";h.onclick=function(){var e=prompt(WH.sprintf(WH.TERMS.gotopage_format,1,t.nPages),t.page);if(e!=null){e|=0;if(e!=t.page&&e>=1&&e<=t.nPages){document.location.href=e>1?t.url+t.sep+e+t.pound:t.url+t.pound}}};h.onmouseover=function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.gotopage_tip,"q2")};h.onmousemove=WH.Tooltip.cursorUpdate;h.onmouseout=WH.Tooltip.hide;WH.ae(r,h)}if(i){WH.ae(n,r);if(s){WH.ae(n,s)}}else{if(s){WH.ae(n,s)}WH.ae(n,r)}WH.ae(e,n)};WH.disclose=function(e,t){let a=WH.toggleDisplay(e,true);t.classList.remove("disclosure-"+(a?"off":"on"));t.classList.add("disclosure-"+(a?"on":"off"));return false};WH.toggle=function(e){let t=WH.toggleDisplay(e,true);this.classList.remove("toggler-"+(t?"off":"on"));this.classList.add("toggler-"+(t?"on":"off"));return false};WH.setupChangeWarning=function(e,t,a){if(!e){return}function i(){return a}e.submit((function(){window.onbeforeunload=null}));var n=[];for(var s in t){var r=t[s];if(!r){continue}n[s]=r.val();r.keydown((function(){for(var e in t){var a=t[e];if(!a){continue}if(a.val()!=n[e]){window.onbeforeunload=i;return}window.onbeforeunload=null}}))}};$(document).ready((function(){WH.qsa("dfn[title]").forEach((function(e){let t=e.title;e.removeAttribute("title");e.classList.add("tip");WH.Tooltip.simple(e,t,"q",{byCursor:true,maxWidth:250})}));$(".text").bind("copy",(function(){$("*[unselectable]",this).each((function(e,t){var a=$(t).text();$(t).text("");setTimeout((function(){$(t).text(a)}),1)}))}))}));$(document).ready((function(){$("input").each((function(){var e=$(this).attr("maxlength");var t=$(this).attr("data-charwarning");var a=t?$("#"+t):null;if(!e||!a){return}var i=function(){a.hide()};var n=function(t){var i=e-t;var n=t/e;var s=parseInt(n>=.5?255:n*2*255).toString(16);var r=parseInt(n<.5?255:255-(n-.5)*2*255).toString(16);if(s.length==1){s="0"+s}if(r.length==1){r="0"+r}a.text(WH.sprintf(WH.TERMS.charactersremaining_format,i));a.show();a.css("color","#"+s+r+"00")};$(this).focus((function(){n($(this).val().length)})).blur((function(){i()})).keyup((function(){n($(this).val().length)}))}))}));WH.getN5=function(e){var t=Math.abs(e);if(t<1e4){return WH.numberFormat(e)}if(t<1e5){return Math.round(e/100)/10+"k"}if(t<1e6){return Math.round(e/1e3)+"k"}if(t<1e7){return Math.round(e/1e3/10)/100+"m"}if(t<1e8){return Math.round(e/1e3/100)/10+"m"}if(t<1e9){return Math.round(e/1e3/1e3)+"m"}if(t<1e10){return Math.round(e/1e3/1e3/10)/100+"b"}if(t<1e10){return Math.round(e/1e3/1e3/100)/10+"b"}return Math.round(e/1e3/1e3/1e3)+"b"};WH.debug=function(e){if(!WH.isDev()&&!WH.User?.hasRole(WH.User.ROLE_ADMIN)){WH.debug=()=>{};return}WH.debug=function(){console.debug.apply(console.debug,Array.prototype.slice.call(arguments))};WH.debug.apply(WH,Array.prototype.slice.call(arguments))};WH.decodeNumber=function(e,t){var a=0;e=e+"";var i=1;while(e.length>0){var n=e.charAt(e.length-1);var s=t.indexOf(n);if(s===-1){return null}a+=s*i;i*=t.length;e=e.substr(0,e.length-1)}return a};WH.encodeNumber=function(e,t){var a=t.length;var i=[e];while(i[0]>a){var n=Math.floor(i[0]/a);i[0]=i[0]-n*a;i.unshift(n)}var s="";for(var r=0,o=i.length;r<o;r++){s+=t.charAt(i[r])}return s};WH.getThrownErrorMessage=function(e){if(typeof e==="string"){return e}return e&&[e.name,e.message].filter(Boolean).join(": ")||"Unknown error"};WH.userIsLoggedIn=function(){return typeof g_user=="object"&&g_user.id};WH.getElementViewportOffset=function(e){if(!(e instanceof jQuery)){e=$(e)}var t=e.offset().top;var a=t+e.outerHeight();var i=$(window);var n=i.scrollTop();var s=n+i.height();if(a>s){return a-s}if(t<n){return t-n}return 0};WH.onMutate=function(e,t,a){a=a||{};var i={observer:null};var n=a.triggerOnce?function(){i.observer.disconnect();t.apply(e)}:t.bind(e);var s={characterData:true,childList:true,subtree:true};["attributes","attributeFilter","characterData","childList","subtree"].forEach((e=>{if(a.hasOwnProperty(e)){s[e]=a[e]}}));var r=new MutationObserver(n);i.observer=r;r.observe(e,s)};WH.getMajorHeading=function(e,t,a,i){if(isNaN(t)||t<1||t>6){t=2}if(isNaN(a)||a<1||a>6){a=t}var n=["heading-size-"+a];return WH.constructHeading("h"+t,e,n,i)};WH.getImitationHeading=function(e,t,a){if(isNaN(t)||t<1||t>6){t=2}var i=["imitation-heading","heading-size-"+t];return WH.constructHeading("div",e,i,a)};WH.constructHeading=function(e,t,a,i){if(typeof i!="object"){i={}}if(typeof i.classes=="string"){a.push(i.classes)}var n=WH.ce(e);n.className=a.join(" ");if(typeof i.styles=="string"){n.style=i.styles}if(typeof i.id=="string"){n.id=i.id}if(typeof t=="string"){n.innerHTML=t}else if(t.nodeType===Node.ELEMENT_NODE||t.nodeType===Node.TEXT_NODE){n.appendChild(t)}else{$(n).append(t)}return n};WH.clickToCopy=function(e,t,a){a=a||{};WH.aE(e,"click",WH.clickToCopy.copy.bind(null,e,t,a));WH.preventSelectStart(e);e.classList.add("click-to-copy");if(a.modifyTooltip){e._fixTooltip=function(e){return e+"<br>"+WH.ce("span",{className:"q2",innerHTML:WH.clickToCopy.getTooltip(false,a)}).outerHTML};a.overrideOtherTooltips=false}WH.Tooltip.simple(e,WH.clickToCopy.getTooltip.bind(null,false,a),undefined,{byCursor:!a.attachToElement,stopPropagation:a.overrideOtherTooltips})};WH.clickToCopy.copy=function(e,t,a,i){i.preventDefault();i.stopPropagation();if(t===undefined){if(!e.childNodes[0]||!e.childNodes[0].textContent){let t="Could not find text to copy.";WH.error(t,e);if(a.attachToElement){WH.Tooltip.show(e,t,"q10")}else{WH.Tooltip.showAtCursor(i,t,"q10")}return}t=e.childNodes[0].textContent}else if(typeof t==="function"){t=t()}WH.copyToClipboard(t);if(a.attachToElement){WH.Tooltip.show(e,WH.clickToCopy.getTooltip(true,a))}else{WH.Tooltip.showAtCursor(i,WH.clickToCopy.getTooltip(true,a))}};WH.clickToCopy.getTooltip=function(e,t){let a="";let i=undefined;if(e){a=" "+WH.TERMS.copied;i={className:"q1 fa fa-check"}}else{a=WH.TERMS.clickToCopy}let n=WH.ce("div",i,WH.ct(a));if(t.prefix){n.style.marginTop="10px";let e=typeof t.prefix==="function"?t.prefix():t.prefix;return e+n.outerHTML}return n.outerHTML};WH.copyToClipboard=function(e,t){if(!WH.copyToClipboard.hiddenInput){WH.copyToClipboard.hiddenInput=WH.ce("textarea",{className:"hidden-element"});WH.ae(document.body,WH.copyToClipboard.hiddenInput)}WH.copyToClipboard.hiddenInput.value=e;let a=WH.copyToClipboard.hiddenInput.value==="";if(a){WH.copyToClipboard.hiddenInput.value=WH.TERMS.nothingToCopy_tip}WH.copyToClipboard.hiddenInput.focus();WH.copyToClipboard.hiddenInput.select();if(!document.execCommand("copy")){prompt(null,e)}WH.copyToClipboard.hiddenInput.blur();if(t){if(a){WH.Tooltip.showFadingTooltipAtCursor(WH.TERMS.nothingToCopy_tip,t,"q10")}else{let e=WH.ce("span",{className:"q1 fa fa-check"},WH.ct(" "+WH.TERMS.copied));WH.Tooltip.showFadingTooltipAtCursor(e.outerHTML,t)}}};WH.createRange=function(e,t){var a={};for(var i=e;i<=t;++i){a[i]=i}return a};WH.objectToArray=function(e,t){var a=[];for(var i in e){if(e.hasOwnProperty(i)){a.push({property:i,value:e[i]})}}if(t){a.sort((function(e,a){return WH.stringCompare(e[t],a[t])}))}return a};WH.sortIdArray=function(e,t,a){e.sort(a?function(e,i){return WH.stringCompare(t[e][a],t[i][a])}:function(e,a){return WH.stringCompare(t[e],t[a])})};WH.sortJsonArray=function(e,t,a,i){var n=[];for(var s in e){if(e.hasOwnProperty(s)&&t[s]&&(i==null||i(t[s]))){n.push(s)}}if(a!=null){n.sort(a)}else{WH.sortIdArray(n,t)}return n};WH.sortObjectArray=function(e,t){for(var a=0,i;i=t[a];a++){var n=1;if(i.substr(0,1)==="-"){n=-1;i=i.substr(1)}e.sort(function(e,t,a,i){if(a[e]===i[e]){return 1*t}if(typeof a[e]==="string"||typeof i[e]==="string"){return WH.stringCompare(""+a[e],""+i[e])*t}return(a[e]>i[e]?1:-1)*t}.bind(null,i,n))}};WH.isEqualSimpleObject=function(e,t){for(var a in e){if(typeof e[a]=="object"){if(typeof t[a]!="object")return false;if(!WH.isEqualSimpleObject(e[a],t[a]))return false}else{if(e[a]!==t[a])return false}}for(var i in t){if(typeof t[i]=="object"){if(typeof e[i]!="object")return false;if(!WH.isEqualSimpleObject(e[i],t[i]))return false}else{if(e[i]!==t[i])return false}}return true};WH.deUrlize=function(e){var t=e.split("-");var a="";for(var i=0;i<t.length;i++){if(a){a+=" "}a+=WH.ucfirst(t[i])}return a};WH.ensureUrlProtocol=function(e,t){if(typeof e!=="string"){WH.error("Supplied URL was not a string.",e);e=""}if(t){if(!t.match(/:$/)){t+=":"}return e.replace(/^https?:/,t).replace(/^(\/[^\/])/,t+"//"+location.host+"$1").replace(/^(\/\/)/,t+"$1")}else{return e.replace(/^(\/[^\/])/,location.protocol+"//"+location.host+"$1").replace(/^(\/\/)/,location.protocol+"$1")}};WH.getTinyIconUrl=function(e){return e.indexOf("/")===-1?WH.Icon.getIconUrl(e,WH.Icon.TINY):e};WH.removeAccents=function(e){var t=e;var a=[["ß","á","ä","à","â","è","ê","é","ë","í","î","ì","ï","ñ","ò","ó","ö","ô","ú","ü","û","ù","œ","Á","Ä","À","Â","È","Ê","É","Ë","Í","Î","Ì","Ï","Ñ","Ò","Ó","Ö","Ô","Ú","Ü","Û","Ù","œ"],["ss","a","a","a","a","e","e","e","e","i","i","i","i","n","o","o","o","o","u","u","u","u","oe","A","A","A","A","E","E","E","E","I","I","I","I","N","O","O","O","O","U","U","U","U","Oe"]];for(var i=0;i<a[0].length;i++){t=t.replace(new RegExp(a[0][i],"g"),a[1][i])}return t};WH.isDateValid=function(e){return/^(20[0-2]\d)-([01]\d)-([0-3]\d) ([0-2]\d):([0-5]\d):([0-5]\d)$/.exec(e)};WH.isIpAddress=function(e){return/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/.test(e)};WH.isEmailValid=function(e){if(e.length>64){return false}return e.match(/^([a-z0-9._-]+)(\+[a-z0-9._-]+)?(@[a-z0-9.-]+\.[a-z]{2,})$/i)!=null};WH.getCurrentDomain=function(){if(WH.getCurrentDomain.CACHE){return WH.getCurrentDomain.CACHE}var e=location.hostname;if(!WH.isIpAddress(e)){var t=e.split(".");if(t.length>2){t.splice(0,t.length-2)}e=t.join(".")}WH.getCurrentDomain.CACHE=e;return e};WH.isExternalUrl=function(e){return!(!e||e.indexOf("http")!=0&&e.indexOf("//")!=0||e.indexOf("wowhead.com")!=-1||e.indexOf("wowheadnews.")!=-1||e.indexOf(WH.getCurrentDomain())!=-1)};WH.getRelativeHostPrefix=function(){var e=true;if(WH.isDev()){e=location.protocol==="https:"}var t=e?"_https":"_http";if(!WH.getRelativeHostPrefix.CACHE){WH.getRelativeHostPrefix.CACHE={}}if(t in WH.getRelativeHostPrefix.CACHE){return WH.getRelativeHostPrefix.CACHE[t]}var a="";if(e!==(location.protocol==="https:")&&!/^[0-9\.]+$/.test(location.hostname)){var i=/^([\w\W]*)\.[^\.]+\.com$/.exec(location.hostname);i=i?i[1]:"www";var n="";if(location.port){n=location.port}if(n.substr(0,1)!==":"){n=":"+n}if(n===":80"||n===":"){n=""}a="https://"+i+".wowhead.com"+n}if(!e){a=a.replace(/^https:/,"http:")}WH.getRelativeHostPrefix.CACHE[t]=a;return a};WH.fixWowheadHttps=function(e){return e.replace(/\bhttp:(\/\/(?:[^\/:]+\.)?(?:wowhead\.com|zamimg\.com)[:\/])/g,"https:$1")};WH.goToLoginPage=function(e){window.location=WH.Url.getLoginPath(e)};WH.createOrRegex=function(e,t){e=e.replace(/(\(|\)|\|\+|\*|\?|\$|\^)/g,"\\$1");var a=e.split(" "),i="";for(var n=0,s=a.length;n<s;++n){if(n>0){i+="|"}i+=a[n]}return new RegExp((t!=null?"("+t+")?":"")+"("+i+")","gi")};WH.getHash=function(){return"#"+decodeURIComponent(location.href.split("#")[1]||"")};WH.modifyUrl=function(e,t,a,i){if(!a){a=$.noop}var n="";if(e.match(/(#.+)$/)){n=RegExp.$1;e=e.replace(n,"")}if(typeof a.custom=="function"){e=a.custom(e,i)}if(a.returnAfterCustom){return e+n}$.each(t,(function(t,i){var n;var s;var r;var o=e.match(new RegExp("(&|\\?)?"+t+"=?([^&]+)?"));if(o!=null){n=o[0];s=o[1];r=decodeURIComponent(o[2])}if(i==null){if(!n)return;r=null}else if(i.substr(0,2)=="+="){if(r&&a.onAppendCollision){r=a.onAppendCollision(r,i.substr(2),a.menuUrl)}else if(!r&&a.onAppendEmpty){r=a.onAppendEmpty(i.substr(2),a.menuUrl)}else{if(!r)r="";r+=$.trim(i.substr(2))}}else{r=i}if(n){var l="";if(s){l+=s}if(r!=null){l+=t;if(r){l+="="+WH.urlEncodeHref(r)}}e=e.replace(n,l)}else if(r||i==null||i.substr(0,2)!="+="){e+=(/[&?]/.test(e)?"&":"?")+t;if(r){e+="="+WH.urlEncodeHref(r)}}}));e=e.replace("?&","?");e=e.replace(/&&/g,"&");e=e.replace(/\/\?/g,"/");e=e.replace(/(&|\?)+$/,"");return e+n};WH.pageWasReloaded=function(){if(window.performance){if(performance.getEntriesByType){var e=performance.getEntriesByType("navigation");for(var t=0;t<e.length;t++){if(e[t].type==="reload"){return true}}}else if(performance.navigation){return performance.navigation.type===1}}return false};WH.getPreferredTransmogRace=function(){let e=WH.LocalStorage.get(WH.LocalStorage.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL);if(!e&&g_user&&g_user.settings&&g_user.settings.defaultModel){e=[g_user.settings.defaultModel.race,g_user.settings.defaultModel.gender].join(",")}if(!e||(""+e).indexOf(",")<0){e="1,2"}e=e.split(",");if(e[0]==25||e[0]==26){e[0]=24}if(!parseInt(e[0],10)){e[0]=1}if(!parseInt(e[1],10)){e[1]=2}if(!WH.Wow.Race.isPlayableRace(e[0])){e[0]=WH.Wow.Race.ID_HUMAN}return{race:parseInt(e[0]),gender:parseInt(e[1])}};WH.isBlizzardReferral=function(){var e=false;if(typeof WH.getGets().brl!=="undefined"){e="brl"}else{e=!!(document.referrer&&document.referrer.match(/^https?:\/\/[^\/]*\bbattle\.net\//))}WH.isBlizzardReferral=function(e){return e}.bind(null,e);return e};WH.prepInfobox=function(){$(".infobox").each((function(){var e=$(this);if(e.data("infobox-completion-info-added")!==true&&g_user.lists&&typeof g_pageInfo=="object"&&WH.Types.existsInDataEnv(g_pageInfo.type)&&typeof g_pageInfo.typeId=="number"){var t=$(".compact-completion-display",e);if(t.length){var a=$("span",t);if(a.length){var i=0;a.each((function(){var e=$(this);var t=e.html();try{t=JSON.parse(t)}catch(e){return}var a;for(var n=0,s;s=g_user.lists[n];n++){if(s.id==t.id){a=s;break}}if(a){e.parent().append(WH.createCompletionIcon(a,t.completed?1:0,t.rel));e.remove();i++}}));if(i){t.parent().parent().show()}}else{if(t.is(":empty")&&WH.addCompletionIcons(t.get(0),g_pageInfo.type,g_pageInfo.typeId)){t.parent().parent().show()}}}e.data("infobox-completion-info-added",true)}}))};WH.enhanceTextarea=function(e,t){const a=WH.LocalStorage;if(!(e instanceof jQuery)){e=$(e)}if(e.data("wh-enhanced")||e.prop("tagName")!="TEXTAREA"){return}if(typeof t!="object"){t={}}var i=function(e){if(!e.dynamicResizeOption){return true}let t=a.get(a.KEY_TEXTAREA_DYNAMIC_SIZING);if(typeof t==="boolean"){return t}return!e.hasOwnProperty("dynamicSizing")||e.dynamicSizing}.bind(null,t);var n=e.height()||500;var s=$("<div/>",{class:"enhanced-textarea-wrapper"}).insertBefore(e).append(e);if(!t.hasOwnProperty("dynamicSizing")||t.dynamicSizing||t.dynamicResizeOption){var r=$("<div/>",{class:"enhanced-textarea-expander"}).prependTo(s);r.css("width",r.parent().width()+"px");var o=function(e,t,a,i){if(!i()){return}var n=e.val()||e.attr("placeholder")||"";if(n){n=WH.htmlEntities(n)}t.html(n.replace(/\n/g,"<br>")+"<br>");var s=t.height()+(a?14:34);e.css("height",s+"px")};e.bind("keydown keyup change",o.bind(this,e,r,t.exactLineHeights,i));o(e,r,t.exactLineHeights,i);setTimeout(o.bind(this,e,r,t.exactLineHeights,i),100);if(!t.dynamicResizeOption||t.dynamicResizeOption&&i()){s.addClass("enhanced-textarea-dynamic-sizing")}}if(t.markup){var l=$("<div/>",{class:"enhanced-textarea-markup-wrapper"}).prependTo(s);var c=$("<div/>",{class:"enhanced-textarea-markup"}).appendTo(l);var u=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(c);var d=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(c);if(t.markup==="inline"){WH.markup.Toolbar.addInline(e.get(0),u.get(0),d.get(0))}else{WH.markup.Toolbar.addStandard(e.get(0),u.get(0),d.get(0))}if(t.dynamicResizeOption){var f=$("<div/>",{class:"enhanced-textarea-markup-segment"}).appendTo(c);var h=$("<label/>").appendTo(f);var p=$("<input/>",{type:"checkbox",checked:i()}).appendTo(h);p.change(function(e,t,i,n,s,r){var o=this.is(":checked");a.set(a.KEY_TEXTAREA_DYNAMIC_SIZING,o);if(o){t.addClass("enhanced-textarea-dynamic-sizing");r(i,e.exactLineHeights,n)}else{t.removeClass("enhanced-textarea-dynamic-sizing");i.css("height",s+"px")}}.bind(p,t,s,e,i,n,o));$("<span/>",{text:WH.TERMS.autoresizetextbox}).appendTo(h)}if(t.scrollingMarkup){if(WH.enhanceTextarea.scrollerCount){WH.enhanceTextarea.scrollerCount++}else{WH.enhanceTextarea.scrollerCount=1}var m="fixable-markup-controls-"+WH.enhanceTextarea.scrollerCount;var H="fixed-markup-controls-"+WH.enhanceTextarea.scrollerCount;var g=function(e){var t=e.css("backgroundColor");if(t=="rgba(0, 0, 0, 0)"||t=="transparent"){return g(e.parent())}else{return t}};var W=g(c);for(var E,_=0;(E=window.document.styleSheets[_])&&E.href;_++){}if(!E){window.document.head.appendChild(document.createElement("style"));E=window.document.styleSheets[_]}var v="."+H+" ."+m+" .enhanced-textarea-markup";E.insertRule(v+" {background:"+W+";padding-bottom:5px;padding-top:10px;position:fixed;top:0;z-index:3}",E.cssRules.length);E.insertRule('body[data-zul-bar="true"]'+v+" {padding-top: 50px}",E.cssRules.length);l.addClass(m);var T=function(e,t,a){let i=ZUL.getEnabled()?ZUL.HEIGHT:0;var n=this.scrollY||this.pageYOffset||0;if(n>e.offset().top-10-i&&n<t.offset().top+t.height()-100-i){$("body").addClass(a)}else{$("body").removeClass(a)}};var b=$(window);b.scroll(T.bind(window,l,s,H));T.call(window,l,s,H);var S=function(e,t){t.css("width",e.width()+"px");e.css("height",t.height()+"px")}.bind(null,l,c);S();b.on("resize",S);$((function(){setTimeout(S,2e3)}))}}e.data("wh-enhanced",true)};WH.createOptionsMenuWidget=function(e,t,a){var i=0;var n=1;var s=2;var r=3;var o=WH.createOptionsMenuWidget.chevron;if(a.noChevron){o=""}var l=WH.ce("span");l.id="options-menu-widget-"+e;l.className="options-menu-widget "+l.id;l.innerHTML=t+o;if(a.id){l.id=a.id}if(a.className){l.className+=" "+a.className}if(a.options instanceof Array){var c=[];for(var u=0,d;d=a.options[u];u++){var f=[u,d[n]];if((typeof a.selected=="number"||typeof a.selected=="string")&&a.selected==d[i]){l.innerHTML=d[n]+o;if(d[r]){switch(typeof d[r].className){case"string":$.data(l,"options-menu-widget-class",d[r].className);l.className+=" "+d[r].className;break;case"function":$.data(l,"options-menu-widget-class",d[r].className(d,true));l.className+=" "+d[r].className(d,true);break}}}if(d[s]){f.push(function(e,t,a,i){switch(typeof a[s]){case"string":window.location=a[s];break;case"function":if(typeof i.updateWidgetText=="undefined"||i.updateWidgetText){t.innerHTML=a[n]+e;var o=$.data(t,"options-menu-widget-class");if(o){t.className=t.className.replace(new RegExp(" *\\b"+o+"\\b"),"")}if(a[r]){switch(typeof a[r].className){case"string":$.data(t,"options-menu-widget-class",a[r].className);t.className+=" "+a[r].className;break;case"function":$.data(t,"options-menu-widget-class",a[r].className(a,true));t.className+=" "+a[r].className(a,true);break}}}a[s](t,a);break}}.bind(null,o,l,d,a))}else if(!d[r]||!d[r].menu){f[0]=null}f[Menu.ITEM_OPTIONS]={};if(d[r]){switch(typeof d[r].className){case"string":f[Menu.ITEM_OPTIONS].className=d[r].className;break;case"function":f[Menu.ITEM_OPTIONS].className=d[r].className.bind(null,d,false);break}switch(typeof d[r].column){case"number":case"string":f[Menu.ITEM_OPTIONS].column=d[r].column;break;case"function":f[Menu.ITEM_OPTIONS].column=d[r].column.bind(null,d);break}switch(typeof d[r].tinyIcon){case"string":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon;break;case"function":f[Menu.ITEM_OPTIONS].tinyIcon=d[r].tinyIcon.bind(null,d);break}switch(typeof d[r].fontIcon){case"string":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon;break;case"function":f[Menu.ITEM_OPTIONS].fontIcon=d[r].fontIcon.bind(null,d);break}if(typeof d[r].isChecked=="function"){f[Menu.ITEM_OPTIONS].checkedFunc=d[r].isChecked.bind(null,d)}if(typeof d[r].menu=="object"&&d[r].menu instanceof Array){Menu.setSubmenu(f,d[r].menu)}}c.push(f)}l.menu=c;if(a.menuOnClick){l.onmousedown=WH.rf;Menu.add(l,c,{showAtElement:true})}else{Menu.add(l,c)}}if(a.target){$(a.target).append(l)}else{return l}};WH.createOptionsMenuWidget.chevron=' <i class="fa fa-chevron-down fa-color-gray"></i>';WH.setupSmoothNavClicks=function(e){var t=$(".smooth-nav-inner > a",e);if(!t.length){setTimeout(WH.setupSmoothNavClicks.bind(null,e),9);return}let a=WH.Device.isTouch();t.each((function(){var e=this.href.replace(new RegExp("^"+location.href.replace(/#.*/,"")),"");if(e&&e.substr(0,1)==="#"){$(this).click(function(e,t){if(t.which===2){return}var i=e==="#top"?0:$(e).offset().top-20;if(isNaN(i)){return}if(a){i-=37}$("html, body").stop().animate({scrollTop:i},"500","swing");return false}.bind(null,e))}}))};WH.countdownClock=function(e){var t=$(e.element||"#countdown-clock-"+e.id);if(!t.length){return}var a;if(e.url){a=$("<a/>",{href:e.url,target:"_blank"})}else{a=$("<div/>")}a.addClass("countdown-clock-content").css({"background-image":"url("+e.bg+")"});var i=$("<div/>",{class:"countdown-clock-content-inner"}).appendTo(a);if(e.impressionImage){$("<img>",{src:e.impressionImage,css:{bottom:0,height:"1px",position:"absolute",right:0,width:"1px"}}).appendTo(a)}if(e.text){i.append($("<span/>",{class:"countdown-clock-text",html:e.text}))}var n=$("<span/>",{class:"countdown-clock-time"}).appendTo(i);var s=$("<table/>").appendTo(n);var r=$("<tr/>").appendTo(s);var o=$("<tr/>").appendTo(s);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:":"}).appendTo(r);$("<td/>").appendTo(r);$("<td/>",{html:WH.TERMS.days_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.hours_lc}).appendTo(o);$("<td/>").appendTo(o);$("<td/>",{html:WH.TERMS.minutes_lc}).appendTo(o);t.addClass("countdown-clock").append(a);var l={days:0,hours:0,minutes:0};var c=(new Date).getTime();var u=c;if(typeof e.time==="string"){u=new Date(e.time).getTime()}else if(typeof e.time==="object"){var d=new Date;if(!e.time.hasOwnProperty("year")){e.time.year=d.getFullYear()}if(!e.time.hasOwnProperty("month")){e.time.month=d.getMonth+1}if(!e.time.hasOwnProperty("day")){e.time.day=d.getDay()}if(!e.time.hasOwnProperty("hour")){e.time.hour=0}if(!e.time.hasOwnProperty("minute")){e.time.minute=0}if(!e.time.hasOwnProperty("second")){e.time.second=0}u=new Date(e.time.year,e.time.month-1,e.time.day,e.time.hour,e.time.minute,e.time.second).getTime()}var f=parseInt((u-c)/1e3);var h=60;var p=h*60;var m=p*24;l.days=parseInt(f/m);f=f-l.days*24*60*60;l.hours=parseInt(f/p);f=f-l.hours*60*60;l.minutes=parseInt(f/h);var H=function(e,t,a){if(t.days<=0&&t.hours<=0&&t.minutes<=0){e.html(a.completionText).parent().parent().addClass("countdown-clock-complete");return}$("tr:first-child > td:nth-child(1)",e).html(t.days);$("tr:last-child > td:nth-child(1)",e).html(t.days===1?WH.TERMS.day_lc:WH.TERMS.days_lc);$("tr:first-child > td:nth-child(3)",e).html(t.hours);$("tr:last-child > td:nth-child(3)",e).html(t.hours===1?WH.TERMS.hour_lc:WH.TERMS.hours_lc);$("tr:first-child > td:nth-child(5)",e).html(t.minutes);$("tr:last-child > td:nth-child(5)",e).html(WH.TERMS.minute_abbrev);t.minutes--;if(t.minutes<0){if(t.hours>0||t.days>0){t.minutes=59}else{t.minutes=0}t.hours--}if(t.hours<0){if(t.days>0){t.hours=23}else{t.hours=0}t.days--}if(t.days<0){t.days=0}setTimeout(H.bind(null,e,t,a),6e4)};H(n,l,e)};WH.slashHashEvent=null;try{WH.slashHashEvent=new Event("slashhash")}catch(e){try{WH.slashHashEvent=document.createEvent("Event");WH.slashHashEvent.initEvent("slashhash",true,true)}catch(e){}}WH.getSlashHash=function(e){var t=""+location.href;var a=t.indexOf(e);if(a==-1){return location.hash?(""+location.hash).replace(/^#/,""):""}var i=t.substr(0,a+e.length);return t.substr(i.length+1)};WH.setSlashHash=function(e,t,a){var i=""+location.href;var n=i.indexOf(e);if(n==-1){alert("Bad hash update: No root found!");return}var s=i.substr(0,n+e.length);var r=i.substr(s.length+1);if(t.substr(0,1)=="#"){t=t.substr(1)}var o=t?"/"+t:"";if(a){WH.Url.pushHistory(s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}else{WH.Url.replaceHistory(s+o);if(WH.slashHashEvent){dispatchEvent(WH.slashHashEvent)}}return r};WH.setHash=function(e,t){let a=""+location.hash;if(!e.startsWith("#")){e="#"+e}if(e==="#."){WH.clearHash(t||false)}else{if(t){WH.Url.pushHistory(location.pathname+e)}else{WH.Url.replaceHistory(location.pathname+e)}}return a};WH.clearHash=function(e){var t=""+location.hash;var a=(""+location.href).replace(/#.*/,"");if(e){if(window.history){window.history.pushState({},"",a)}else{location.hash="#."}}else{if(window.history){window.history.replaceState({},"",a)}else{location.replace("#.")}}return t};WH.selectText=function(e){var t=document,a=t.getElementById(e),i,n;if(t.body.createTextRange){i=document.body.createTextRange();i.moveToElementText(a);i.select()}else if(window.getSelection){n=window.getSelection();i=document.createRange();i.selectNodeContents(a);n.removeAllRanges();n.addRange(i)}};WH.ucfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};WH.loadAssets=function(e,t,a){const i=WH.Game;let n=function(e,t){var a=WH.ce("link");a.rel="stylesheet";if(WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}a.href=e;if(t){WH.aE(a,"load",t)}WH.ae(document.getElementsByTagName("head")[0],a)};var s=function(e,t,a){var i=WH.ce("script");i.type="text/javascript";if(a&&WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}i.src=e;if(t){WH.aE(i,"load",t)}WH.ae(document.getElementsByTagName("head")[0],i)};switch(e){case"artifact-weapon-calc":if(WH.isSet("ArtifactCalc")){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/artifact-calc.css");var r=WH.STATIC_URL+"/js/ArtifactCalc.js";if(WH.isSet("g_artifact_textures")){s(r,t,true)}else{var o=WH.Url.getDataPageUrl("artifact-calc");s(o,s.bind(null,r,t,true))}break;case"azerite-finder":if(WH.Wow.AzeriteFinder){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/azerite-finder.css");s(WH.STATIC_URL+"/js/WH/Wow/AzeriteFinder.js",t,true);break;case"build-summary":if(WH.Wow.BuildSummary){if(t){t()}return}let d=2;let f=()=>--d<=0&&t&&t();n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}tools/build-summary.css`,f);s(WH.Url.getDataPageUrl("item-bonuses",a),(()=>{s(WH.STATIC_URL+"/js/WH/Wow/BuildSummary.js",f,true)}));break;case"di-paragon-skill-calc":if(WH.DI.ParagonCalc&&WH.DI.ParagonCalc.Shell){if(t){t()}break}WH.Fonts.load(i.DI);n(WH.STATIC_URL+"/css/tools/partials/paragon-calc.css");n(WH.STATIC_URL+"/css/tools/paragon-calc-shell.css");s(WH.Url.getDataPageUrl("paragon-calc",WH.dataEnv.DI),(()=>{s(WH.STATIC_URL+"/js/WH/DI/ParagonCalc.js",(()=>{s(WH.STATIC_URL+"/js/WH/DI/ParagonCalc/Shell.js",t,true)}),true)}));break;case"diablo-2-skill-calc":if(WH.D2.hasOwnProperty("SkillCalc")){if(t){t()}break}WH.Fonts.load(i.D2);n(WH.STATIC_URL+"/css/d2/skill-calc.css");s(WH.Url.getDataPageUrl("diablo2-skills",WH.dataEnv.D2),(function(){s(WH.STATIC_URL+"/js/WH/D2/SkillCalc.js",t,true)}));break;case"d4-skill-tree":{if(WH.D4.SkillPlanner?.isReady()){t&&t();return}a=i.getByEnv(a)===i.D4?a:i.getDefaultEnv(i.D4);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/skill-planner.css`);s(WH.Url.getDataPageUrl("skill-tree-planner",a),(()=>s(WH.STATIC_URL+"/js/WH/D4/SkillPlanner.js",t,true)));break}case"d4-paragon-calc":{if(WH.D4.ParagonCalc?.isReady()){t&&t();return}a=i.getByEnv(a)===i.D4?a:i.getDefaultEnv(i.D4);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/frame-box.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/modal.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/points.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/paragon-calc.css`);let e=3;let r=()=>--e>0||s(`${WH.STATIC_URL}/js/WH/D4/ParagonCalc.js`,t,true);s(WH.Url.getDataPageUrl("paragon-calc",a),r,false);s(`${WH.STATIC_URL}/js/WH/D4/Components/Modal.js`,r,true);s(`${WH.STATIC_URL}/js/WH/D4/Components/Points.js`,r,true);break}case"d4-build":{if(WH.D4.BuildPlanner?.isReady()){t&&t();return}a=i.getByEnv(a)===i.D4?a:i.getDefaultEnv(i.D4);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/paragon-calc.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/modal.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/points.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/skill-planner.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/vampiric-powers.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/build-planner.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/frame-box.css`);n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/d4/components/item-slot-box.css`);const e=`${WH.STATIC_URL}/js/WH/D4/`;const r=[{url:WH.Url.getDataPageUrl("paragon-calc",a),includeVersion:false},{url:WH.Url.getDataPageUrl("skill-tree-planner",a),includeVersion:false},{url:WH.Url.getDataPageUrl("build-planner",a),includeVersion:false},{url:`${e}Components/FrameBox.js`,includeVersion:true},{url:`${e}Components/ItemSlotBox.js`,includeVersion:true},{url:`${e}Components/Modal.js`,includeVersion:true},{url:`${e}Components/Points.js`,includeVersion:true},{url:`${e}ParagonCalc.js`,includeVersion:true},{url:`${e}SkillPlanner.js`,includeVersion:true},{url:`${e}VampiricPowers.js`,includeVersion:true},{url:`${e}BuildPlanner.js`,includeVersion:true}];let o=r.length;let l=()=>--o>0||s(`${e}BuildPlanner.js`,t,true);r.forEach((e=>s(e.url,l,e.includeVersion)));break}case"dragonflight-talent-calc":if(WH.Wow.TalentCalcDragonflight&&WH.Wow.TalentCalcDragonflight.isReady(a)){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/talent-calc-dragonflight.css");s(WH.Url.getDataPageUrl("talents-dragonflight",a),(()=>s(WH.STATIC_URL+"/js/WH/Wow/TalentCalcDragonflight.js",t,true)));break;case"dragonflight-talent-calc-manual":if(WH.Wow.TalentCalcDragonflightManual){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/talent-calc-dragonflight.css");s(WH.STATIC_URL+"/js/WH/Wow/TalentCalcDragonflightManual.js",t,true);break;case"gear-planner":let h="GearPlanner";if(WH.isTbcTree())h="GearPlannerTbc";if(WH.isWrathTree())h="GearPlannerWrath";if(WH.Wow[h]){if(t){t()}break}WH.loadAssets("talent-calc-classic",(function(){n(`${WH.STATIC_URL}/css/${WH.Theme.getThemePath()}/tools/gear-planner.css`);t=s.bind(null,`${WH.STATIC_URL}/js/WH/Wow/${h}.js`,t,true);t=s.bind(null,`${WH.STATIC_URL}/js/WH/Listview/Templates/item.js`,t,true);t=s.bind(null,WH.Url.getDataPageUrl("gear-planner"),t,false);t=s.bind(null,WH.Url.getDataPageUrl("weight-presets"),t,false);t=s.bind(null,`${WH.STATIC_URL}/js/WH/Wow/CharacterCustomization.js`,t,true);if(h!=="GearPlanner"&&!WH.applyStatModifications.ScalingData){t=s.bind(null,WH.Url.getDataPageUrl("item-scaling"),t,false)}t()}));break;case"heart-of-azeroth-calc":if(WH.Wow.HeartOfAzerothCalc){if(t){t()}break}n(WH.staticUrl+"/css/tools/heart-of-azeroth-calc.css");var l=s.bind(null,WH.staticUrl+"/js/WH/Wow/HeartOfAzerothCalc.js",t,true);if(!WH.Wow.AzeriteEssence){s(WH.staticUrl+"/js/WH/Wow/AzeriteEssence.js",s.bind(null,WH.Url.getDataPageUrl("azerite-essence"),l,false),true)}else{l()}break;case"mythic-damage-calc":if(WH.Wow.MythicDamageCalc){if(t){t()}break}n(WH.staticUrl+"/css/tools/mythic-damage-calc.css");s(WH.staticUrl+"/js/WH/Wow/MythicDamageCalc.js",(function(){s(WH.Url.getDataPageUrl("mythic-damage-calc"),t)}),true);break;case"profession-tree-calc":if(WH.Wow.ProfessionTreeCalc&&WH.Wow.ProfessionTreeCalc.isReady(a)){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/profession-tree-calc.css");s(WH.Url.getDataPageUrl("profession-tree-calc",a),(()=>s(WH.STATIC_URL+"/js/WH/Wow/ProfessionTreeCalc.js",t,true)));break;case"pvp-talent-calc":if(WH.isSet("PvpTalentCalc")){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/pvp-calc.css");var c=WH.STATIC_URL+"/js/talent-pvp.js";if(WH.isSet("g_talents_pvp")){s(c,t,true)}else{s(WH.Url.getDataPageUrl("talents-pvp"),s.bind(null,c,t,true))}break;case"soulbind-calc":if(WH.Wow.SoulbindCalc){if(t){t()}break}n(WH.staticUrl+"/css/tools/soulbind-calc.css");s(WH.staticUrl+"/js/WH/Wow/SoulbindCalc.js",t,true);break;case"talent-calc":if(WH.isSet("TalentCalc")){if(t){t()}return}n(WH.STATIC_URL+"/css/tools/talent-calc.css");var u=WH.STATIC_URL+"/js/WH/Wow/TalentCalc.js";if(WH.isSet("g_glyphs")){s(u,t,true)}else{s(WH.Url.getDataPageUrl("glyphs"),s.bind(null,u,t,true))}break;case"talent-calc-classic":case"pet-talent-calc":let p=e==="pet-talent-calc";if(WH.Wow.hasOwnProperty("TalentCalcClassic")&&WH.Wow.TalentCalcClassic.isReady(p,a)){if(t){t()}return}n(WH.STATIC_URL+"/css/"+WH.Theme.getThemePath()+"tools/talent-calc-classic.css");s(WH.STATIC_URL+"/js/WH/Wow/TalentCalcClassic.js",s.bind(null,WH.Url.getDataPageUrl("talents-classic"+(p?"-pet":""),a),t),true);break;default:alert('Tried to load unknown asset set "'+String(e)+'".')}};WH.isInt=function(e){return typeof e==="number"&&parseFloat(e)==parseInt(e)&&!isNaN(e)};WH.ensureObjectPath=function(e,t){var a=Array.prototype.slice.call(arguments,1);if(typeof a[0]!="string"){return e}if(typeof e[a[0]]!="object"){e[a[0]]={}}if(a[1]){e[a[0]]=WH.ensureObjectPath.apply(this,[e[a[0]]].concat(a.slice(1)))}return e};WH.preventDefault=function(e){if(e&&e.preventDefault){e.preventDefault()}};WH.preventTyping=function(e){if(e&&e.preventDefault){var t="which"in e?e.which:e.keyCode;var a=t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=105||t>=106&&t<=111||t>=186&&t<=192||t>=219&&t<=222;var i=e.altKey||e.ctrlKey||e.shiftKey||e.metaKey;if(a&&!i){e.preventDefault()}}};WH.leadingZeroes=function(e,t){var a=e+"";while(a.length<t)a="0"+a;return a};$(document).ready((function(){$("a.wsach").each((function(){var e=$(this).text();var t=$(this).attr("title");var a=parseInt($(this).attr("data-earned"));var i=$(this).attr("data-user");var n=$(this).parent().parent().attr("id")=="user-achievement-list";var s=$(this).attr("data-progress");var r=$(this).attr("data-quality");var o=$(this).attr("data-count");$(this).attr("title","");var l=$("<div>");l.append('<table><tr><td style="padding-bottom: 0.35em"><b class="q" data-quality="'+r+'"></b></td></tr><tr><td><span></span></td></tr></table>');l.find("b").text(e);l.find("span").text(t);if(a){var c=null;var u=(new Date).getTime()/1e3;if(i){if(a>31*24*60*60){l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime4_format:WH.TERMS.earnedwsatime4_format,i,WH.formatDateSimple(new Date((u-a)*1e3)))+"</span>")}else{l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime2_format:WH.TERMS.earnedwsatime2_format,i,WH.formatTimeElapsed(a))+"</span>")}}else if(!n){if(a>31*24*60*60){l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime3_format:WH.TERMS.earnedwsatime3_format,WH.formatDateSimple(new Date((u-a)*1e3)))+"</span>")}else{l.append('<span class="q0"><br />'+WH.sprintf(o>1?WH.TERMS.earnedwsafirsttime_format:WH.TERMS.earnedwsatime_format,WH.formatTimeElapsed(a))+"</span>")}}if(c){l.append('<span class="q0"><br />'+c+"</span>")}}else if(!n&&s){l.append('<span class="q0"><br /><small></small>'+WH.TERMS.progress_format.replace("%s",s)+"</td></tr>")}WH.Tooltip.simple(this,l.html(),undefined,{byCursor:true})}))}));WH.User=new function(){const e=this;this.ROLE_TESTER=1;this.ROLE_ADMIN=2;this.ROLE_EDITOR=4;this.ROLE_MOD=8;this.ROLE_BUREAU=16;this.ROLE_DEV=32;this.ROLE_VIP=64;this.ROLE_BLOGGER=128;this.ROLE_PREMIUM=256;this.ROLE_LOCALIZER=512;this.ROLE_SALES_AGENT=1024;this.ROLE_SCREENSHOT=2048;this.ROLE_VIDEO=4096;this.ROLE_API_ONLY=8192;this.ROLE_PENDING=16384;this.ROLE_BLIZZARD=32768;this.ROLE_GROUP_EMPLOYEE=this.ROLE_ADMIN|this.ROLE_BUREAU|this.ROLE_DEV;this.ROLE_GROUP_STAFF=this.ROLE_TESTER|this.ROLE_GROUP_EMPLOYEE|this.ROLE_EDITOR|this.ROLE_MOD|this.ROLE_BLOGGER|this.ROLE_LOCALIZER|this.ROLE_SALES_AGENT|this.ROLE_SCREENSHOT|this.ROLE_VIDEO;this.ROLE_GROUP_GREEN_TEXT=this.ROLE_MOD|this.ROLE_BUREAU|this.ROLE_DEV;this.ROLE_GROUP_MODERATOR=this.ROLE_ADMIN|this.ROLE_MOD|this.ROLE_BUREAU;this.ROLE_GROUP_COMMENTS_MODERATOR=this.ROLE_GROUP_MODERATOR|this.ROLE_LOCALIZER|this.ROLE_EDITOR;this.ROLE_GROUP_PREMIUM_PERMISSIONS=this.ROLE_PREMIUM|this.ROLE_GROUP_STAFF|this.ROLE_VIP|this.ROLE_EDITOR|this.ROLE_BLIZZARD;this.NEWS_AUTHOR_ROLES=this.ROLE_GROUP_EMPLOYEE|this.ROLE_BLOGGER;this.GUIDE_MANAGER_ROLES=this.ROLE_GROUP_EMPLOYEE;this.GUIDE_EDITOR_ROLES=this.GUIDE_MANAGER_ROLES|this.ROLE_EDITOR;const t="TOMRUS";this.disableDebug=function(){g_user.debug=false};this.getCommentRoleClass=function(e,a){if(e&(U_GROUP_ADMIN|U_GROUP_BLIZZARD)){return"comment-role-admin"}else if(e&U_GROUP_GREEN_TEXT&&a!==t){return"comment-role-moderator"}else if(e&U_GROUP_VIP){return"comment-role-vip"}else if(e&U_GROUP_PREMIUMISH){return"comment-role-premium"}return null};this.getCommentRoleLabel=function(t,a,i){if(a){return a}if(t&U_GROUP_ADMIN){return WH.TERMS.administrator_abbrev}else if(t&U_GROUP_BLIZZARD){return WH.TERMS.blizzardRep}else if(t&e.ROLE_MOD){return WH.TERMS.moderator}else if(t&U_GROUP_PREMIUMISH){return WH.TERMS.premiumuser}return null};this.getDebug=function(){return e.hasRole(U_GROUP_STAFF)&&(g_user.debug||WH.getGets().debug!=null)};this.getId=function(){return g_user.id};this.getPath=function(){if(!WH.User.isLoggedIn()){return null}return WH.Url.generatePath("/user="+encodeURIComponent(WH.User.getUsername()))};this.getReputation=function(){return g_user.reputation||0};this.getUsername=function(){return g_user.name||""};this.hasRole=function(e){if(!e){return true}return!!(g_user.roles&e)};this.isLoggedIn=function(){return g_user.id>0};this.isPremium=function(){return!!g_user.premium};this.isUsernameValid=function(e){return e.match(/[^a-z0-9]/i)==null&&e.length>=4&&e.length<=16};this.saveOption=function(e,t,a){let i={method:"POST",json:{key:e,value:t}};if(typeof a==="function"){i.success=a}WH.fetch(WH.Url.generatePath("/account/save-option"),i)}};var U_GROUP_ADMIN=WH.User.ROLE_ADMIN;var U_GROUP_EDITOR=WH.User.ROLE_EDITOR;var U_GROUP_MOD=WH.User.ROLE_MOD;var U_GROUP_BUREAU=WH.User.ROLE_BUREAU;var U_GROUP_DEV=WH.User.ROLE_DEV;var U_GROUP_VIP=WH.User.ROLE_VIP;var U_GROUP_BLOGGER=WH.User.ROLE_BLOGGER;var U_GROUP_PREMIUM=WH.User.ROLE_PREMIUM;var U_GROUP_LOCALIZER=WH.User.ROLE_LOCALIZER;var U_GROUP_SALESAGENT=WH.User.ROLE_SALES_AGENT;var U_GROUP_SCREENSHOT=WH.User.ROLE_SCREENSHOT;var U_GROUP_VIDEO=WH.User.ROLE_VIDEO;var U_GROUP_PENDING=WH.User.ROLE_PENDING;var U_GROUP_BLIZZARD=WH.User.ROLE_BLIZZARD;var U_GROUP_EMPLOYEE=WH.User.ROLE_GROUP_EMPLOYEE;var U_GROUP_STAFF=WH.User.ROLE_GROUP_STAFF;var U_GROUP_GREEN_TEXT=WH.User.ROLE_GROUP_GREEN_TEXT;var U_GROUP_PREMIUMISH=WH.User.ROLE_PREMIUM|WH.User.ROLE_EDITOR;var U_GROUP_MODERATOR=WH.User.ROLE_GROUP_MODERATOR;var U_GROUP_COMMENTS_MODERATOR=WH.User.ROLE_GROUP_COMMENTS_MODERATOR;var g_users={};WH.LocalStorage=new function(){const e=this;const t=WH.Game;this.KEY_ANNOUNCEMENTS_CLOSED="announcements.closed";this.KEY_AUDIO_PLAYLIST="audioPlaylist";this.KEY_EDIT_ADJACENT_PREVIEW="edit.adjacentPreview";this.KEY_GUIDE_SIDEBAR_STATE="guide.sidebarState";this.KEY_HIGHLIGHTS_CLOSED="highlights.closed";this.KEY_LAYOUT_FULLSCREEN="layout.fullscreen";this.KEY_LAYOUT_FULLSCREEN_DB2_READER="layout.fullscreen.db2Reader";this.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC="layout.userReturnedFromClassic";this.KEY_MENU_RECENT_PATHS="menu.recentPaths";this.KEY_NEWS_LIST_FILTER="news.listFilter";this.KEY_NOTIFICATIONS_ERROR_SHOWN="notifications.errorShown";this.KEY_NOTIFICATIONS_ONBOARDING="notifications.onboarding";this.KEY_TEXTAREA_DYNAMIC_SIZING="textarea.dynamicSizing";this.KEY_TOOLTIP_SCREENSHOTS="tooltip.screenshots";this.KEY_WAS_BLIZZARD_REFERRAL_TIME="was.blizzardReferralTime";this.KEY_WAS_COIL_START_TIME="was.coilStartTime";this.KEY_WAS_DFP_LOG="was.dfpLog";this.KEY_WOW_API_CHARACTER_CACHE="wow.api.characterCache";this.KEY_WOW_ATTUNEMENT_TRACKER="wow.attunementTracker";this.KEY_WOW_DATABASE_CLASS_FILTER="wow.database.classFilter";this.KEY_WOW_DATABASE_SPEC_FILTER="wow.database.specFilter";this.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY="wow.dressingRoom.appearanceHistory";this.KEY_WOW_DRESSING_ROOM_LAST_CATEGORY="wow.dressingRoom.lastCategory";this.KEY_WOW_DRESSING_ROOM_LAST_MODEL="wow.dressingRoom.lastModel";this.KEY_WOW_GEAR_PLANNER_HASHES="wow.gearPlanner.hashes";this.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL="wow.modelViewer.defaultModel";this.KEY_WOW_MODEL_VIEWER_LAST_MODEL="wow.modelViewer.lastModel";this.KEY_WOW_MODEL_VIEWER_SHEATHED="wow.modelViewer.sheathed";this.KEY_WOW_SHADOWLANDS_BUILD_PLANNER_HASH="wow.shadowlandsBuildPlanner.hash";this.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS="wow.talentCalc.showTopBuilds";this.KEY_WOW_TODAY_IN_WOW_FILTER="wow.todayInWow.filter";this.KEY_WOW_TODAY_IN_WOW_VISIBILITY="wow.todayInWow.visibility";const a=["lvBrowse","showRandomWidget","transmog_racegender"];const i={[this.KEY_AUDIO_PLAYLIST]:"AudioPlaylist",[this.KEY_EDIT_ADJACENT_PREVIEW]:"edit.adjacentPreview",[this.KEY_GUIDE_SIDEBAR_STATE]:"guide.sidebarState",[this.KEY_LAYOUT_FULLSCREEN]:"fullscreenMode",[this.KEY_LAYOUT_FULLSCREEN_DB2_READER]:"fullscreenMode.db2Reader",[this.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC]:"fromClassic",[this.KEY_MENU_RECENT_PATHS]:"menu.recentPaths",[this.KEY_NEWS_LIST_FILTER]:"newsListFilter",[this.KEY_NOTIFICATIONS_ERROR_SHOWN]:"notifications-error-seen",[this.KEY_NOTIFICATIONS_ONBOARDING]:"notifications.onboarding",[this.KEY_TEXTAREA_DYNAMIC_SIZING]:"dynamic-textarea-resizing",[this.KEY_TOOLTIP_SCREENSHOTS]:"tooltipScreenshots",[this.KEY_WAS_BLIZZARD_REFERRAL_TIME]:"blizz-skin-suppression",[this.KEY_WAS_COIL_START_TIME]:"cmStarted",[this.KEY_WAS_DFP_LOG]:"dfpLog",[this.KEY_WOW_API_CHARACTER_CACHE]:"BattleNetCharCache",[this.KEY_WOW_ATTUNEMENT_TRACKER]:"wow.attunementTracker",[this.KEY_WOW_DATABASE_CLASS_FILTER]:"dynamic_quest_class",[this.KEY_WOW_DATABASE_SPEC_FILTER]:"tooltips_class:spec",[this.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY]:"dressingRoom.appearanceHistory",[this.KEY_WOW_DRESSING_ROOM_LAST_CATEGORY]:"WH.Wow.DressingRoom.lastCategory",[this.KEY_WOW_DRESSING_ROOM_LAST_MODEL]:"dressingRoom.lastViewedModel",[this.KEY_WOW_GEAR_PLANNER_HASHES]:(()=>{switch(WH.getDataTree()){case WH.dataTree.CLASSIC:return"wow.gearPlanner.hashes";case WH.dataTree.TBC:return"wow.gearPlannerTbc.hashes";default:return"wow.gearPlannerWrath.hashes"}})(),[this.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL]:"defaultModel",[this.KEY_WOW_MODEL_VIEWER_LAST_MODEL]:"lastViewedModel",[this.KEY_WOW_MODEL_VIEWER_SHEATHED]:"WH.ModelViewer.sheathed",[this.KEY_WOW_SHADOWLANDS_BUILD_PLANNER_HASH]:"WH.Wow.ShadowlandsBuildPlanner.hash",[this.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS]:"talent-calc-show-top-builds",[this.KEY_WOW_TODAY_IN_WOW_FILTER]:"today-in-wow-filter",[this.KEY_WOW_TODAY_IN_WOW_VISIBILITY]:"today-in-wow-visibility"};const n=1;const s=2;const r={[this.KEY_AUDIO_PLAYLIST]:n,[this.KEY_NEWS_LIST_FILTER]:n,[this.KEY_WOW_ATTUNEMENT_TRACKER]:s,[this.KEY_WOW_DATABASE_CLASS_FILTER]:n,[this.KEY_WOW_DATABASE_SPEC_FILTER]:n,[this.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY]:n,[this.KEY_WOW_DRESSING_ROOM_LAST_MODEL]:n,[this.KEY_WOW_GEAR_PLANNER_HASHES]:s,[this.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL]:s,[this.KEY_WOW_MODEL_VIEWER_LAST_MODEL]:s,[this.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS]:n,[this.KEY_WOW_TODAY_IN_WOW_VISIBILITY]:s};const o="accessed";const l="created";const c="modified";this.get=function(t){if(!e.isSupported()){return undefined}let a=h(t);let i=m(a);if(i){try{i.accessed=u(new Date);localStorage.setItem(a,JSON.stringify(i))}catch(e){WH.error("Error when updating local storage data access time.",a,e)}return i.value}else{return i}};this.isSupported=function(){let t;try{t="localStorage"in window&&window["localStorage"]!==null;if(t){localStorage.setItem("test","123");t=localStorage.getItem("test")==="123";localStorage.removeItem("test")}}catch(e){t=false}e.isSupported=(e=>e).bind(null,t);return t};this.remove=function(t){if(!e.isSupported()){return}localStorage.removeItem(h(t));if(i[t]){localStorage.removeItem(i[t])}};this.set=function(t,a){if(!e.isSupported()){return}W(h(t),a)};function u(e){return Math.floor(e.getTime()/1e3).toString(36)}function d(e){return new Date(parseInt(e,36)*1e3)}function f(e){return{value:undefined,created:u(e||new Date)}}function h(e,t,a){let i="wh:";if(e.startsWith(i)){WH.error("Tried to re-finalize a local storage key.");return e}switch(r[e]){case n:a=WH.getDataTree(t);i+=`${WH.getDataTreeKey(a)}.${WH.getDataEnvKey(t)}`;break;case s:i+=`${WH.getDataTreeKey(a)}`;break}return`${i}/${e}`}function p(e,t){let a=m(h(e));if(a){return d(a[t])}}function m(e){try{let t=JSON.parse(localStorage.getItem(e));if(t===null||H(t)){return t}}catch(t){let a;try{a=localStorage.getItem(e)}catch(e){a="Error with getItem(): "+WH.getThrownErrorMessage(e)}WH.error("Failed to parse local storage data that should have been JSON.",e,a)}}function H(e){return!!(e&&typeof e==="object"&&typeof e.created==="string"&&e.hasOwnProperty("value"))}function g(){const n=WH.Wow.PlayerClass;const s=WH.Wow.Race;if(!e.isSupported()){return}let r=new Date;let o=WH.getDataTree();let l=t.getDataEnvs(t.WOW);let c=[WH.dataTree.CLASSIC,WH.dataTree.TBC,WH.dataTree.WRATH];try{let t=/^announcements-closed(-(\d+))?$/;let a=[];let i={};Object.keys(localStorage).filter((e=>e.startsWith("announcements-closed"))).forEach((e=>{let n=e.match(t);if(!n){return}let s;try{s=localStorage.getItem(e)}catch(t){WH.error(`Could not fetch closed announcement value from legacy key "${e}".`);return}let r;try{r=s.match(/^"?([\d,]+)"?$/)[1].split(",").map((e=>parseInt(e))).filter(Boolean)}catch(e){}if(!Array.isArray(r)){a.push(e);return}if(n[2]){i[n[2]]=r}else{i[0]=r}a.push(e)}));if(a.length){W(h(e.KEY_ANNOUNCEMENTS_CLOSED),i,r);a.forEach((e=>localStorage.removeItem(e)))}}catch(e){WH.error("Error when migrating announcements local storage values.",e)}try{let t=/^highlight-([a-z0-9-]+)$/;let a=[];let i=[];Object.keys(localStorage).filter((e=>e.startsWith("highlight-"))).forEach((e=>{let n=e.match(t);if(!n){return}let s;try{s=JSON.parse(localStorage.getItem(e))}catch(t){WH.error(`Could not fetch closed highlight value from legacy key "${e}".`);return}if(s!==true){return}i.push(n[1]);a.push(e)}));if(a.length){W(h(e.KEY_HIGHLIGHTS_CLOSED),i,r);a.forEach((e=>localStorage.removeItem(e)))}}catch(e){WH.error("Error when migrating highlights local storage values.",e)}const u=[e.KEY_WOW_DATABASE_SPEC_FILTER,e.KEY_WOW_SHADOWLANDS_BUILD_PLANNER_HASH];Object.entries(i).forEach((([t,a])=>{try{let i;try{i=localStorage.getItem(a)}catch(e){WH.error(`Could not migrate legacy local storage value from legacy key "${a}".`);return}if(i===null){return}let d;try{d=JSON.parse(i)}catch(e){if(u.includes(t)){WH.debug("Found legacy non-JSON local storage value. Migrating it to JSON.",a,i);d=i}else{WH.error(`Could not migrate invalid JSON value from legacy key "${a}".`);return}}let f;let p;switch(t){case e.KEY_AUDIO_PLAYLIST:f=l;break;case e.KEY_NEWS_LIST_FILTER:f=[WH.dataEnv.MAIN];break;case e.KEY_WOW_ATTUNEMENT_TRACKER:p=[WH.dataTree.TBC];break;case e.KEY_WOW_DATABASE_CLASS_FILTER:let u=parseInt(d);f=l.filter((e=>n.exists(u,e)));break;case e.KEY_WOW_DATABASE_SPEC_FILTER:try{d=d.split(":");d={classId:parseInt(d[0]),specId:parseInt(d[1])};f=l.filter((e=>n.exists(d.classId,e)))}catch(e){f=[]}break;case e.KEY_WOW_DRESSING_ROOM_APPEARANCE_HISTORY:f=[WH.dataEnv.MAIN,WH.dataEnv.PTR,WH.dataEnv.PTR2,WH.dataEnv.BETA];let m=false;if(c.includes(o)){m=true;c.forEach((e=>{Object.entries(WH.dataEnvToTree).forEach((([t,a])=>{if(a===e){f.push(parseInt(t))}}))}))}f.forEach((e=>{if(!m&&c.includes(WH.getDataTree(e))){return}let a=s.ID_HUMAN;let n=JSON.parse(i);Object.keys(n.entries).forEach((t=>{t=parseInt(t);if(s.exists(t,e)){a=Math.max(a,t)}else{if(![s.ID_BLOOD_ELF,s.ID_DRAENEI].includes(t)){m=false;if(c.includes(WH.getDataTree(e))){return}}delete n.entries[t]}}));if(!s.exists(n.race,e)){n.race=a}if(Object.keys(n.entries)){W(h(t,e),n,r)}}));localStorage.removeItem(a);return;case e.KEY_WOW_DRESSING_ROOM_LAST_MODEL:case e.KEY_WOW_MODEL_VIEWER_LAST_MODEL:l.forEach((e=>{let a=Array.isArray(d);if(a){d.forEach((t=>{if(t.race&&!s.exists(parseInt(t.race),e)){a=false}}))}if(a){W(h(t,e),d,r)}}));localStorage.removeItem(a);return;case e.KEY_WOW_GEAR_PLANNER_HASHES:p=[WH.dataTree.CLASSIC,WH.dataTree.TBC].includes(o)?[o]:[WH.dataTree.WRATH];break;case e.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL:if(d.race){p=l.filter((e=>s.exists(d.race,e)))}break;case e.KEY_WOW_TALENT_CALC_SHOW_TOP_BUILDS:f=[WH.dataEnv.MAIN];break;case e.KEY_WOW_TODAY_IN_WOW_VISIBILITY:p=[WH.dataTree.RETAIL];break}try{JSON.stringify(d)}catch(e){WH.error("Failed to stringify local storage value during migration.",WH.getThrownErrorMessage(e),t,d);return}localStorage.removeItem(a);if(f){f.forEach((e=>{W(h(t,e),d,r)}))}else if(p){p.forEach((e=>{W(h(t,undefined,e),d,r)}))}else{W(h(t),d,r)}}catch(e){WH.error(`Error when migrating legacy local storage key "${a}".`,e)}}));Object.values(a).forEach((e=>localStorage.removeItem(e)))}function W(e,t,a){a=a||new Date;let i=m(e);if(i){i.modified=u(a)}else{i=f(a)}i.value=t;let n;try{n=JSON.stringify(i)}catch(a){WH.error("Failed to stringify local storage data.",WH.getThrownErrorMessage(a),e,t);return}localStorage.setItem(e,n)}WH.aE(document,"bodyAvailable",g)};WH.SessionStorage=new function(){const e=this;this.KEY_RANDOM_SHOW_ICON="random.showIcon";this.KEY_LISTVIEW_BROWSE="listview.browse";const t=1;const a={[this.KEY_LISTVIEW_BROWSE]:t};this.isSupported=function(){let t;try{t="sessionStorage"in window&&window["sessionStorage"]!==null;if(t){let e=i("test");let a="123";sessionStorage.setItem(e,a);t=sessionStorage.getItem(e)===a;sessionStorage.removeItem(e)}}catch(e){t=false}e.isSupported=(e=>e).bind(null,t);return t};this.set=function(t,a){if(!e.isSupported()){return}let n;try{n=JSON.stringify(a)}catch(e){WH.error("Failed to stringify session storage data.",WH.getThrownErrorMessage(e),t,a);return}sessionStorage.setItem(i(t),n)};this.get=function(t){if(!e.isSupported()){return undefined}let a=i(t);try{return JSON.parse(sessionStorage.getItem(a))}catch(e){let i;try{i=sessionStorage.getItem(a)}catch(e){i="Error with getItem(): "+WH.getThrownErrorMessage(e)}WH.error("Failed to parse session storage data that should have been JSON.",t,i);return undefined}};this.remove=function(t){if(!e.isSupported()){return}sessionStorage.removeItem(i(t))};function i(e){let i="wh.";if(e.startsWith(i)){WH.error("Tried to re-finalize a session storage key.");return e}switch(a[e]){case t:i+=`dataEnv:${WH.getDataEnv()}.`;break}return i+e}};WH.Time=new function(){const e=this;this.DAYS_PER_WEEK=7;this.FORMAT_ABBR="ABBR";this.FORMAT_PLURAL="PLURAL";this.FORMAT_SINGULAR="SINGULAR";this.FORMAT_SYMBOL="SYMBOL";this.MS_SEC=1e3;this.MS_MIN=this.MS_SEC*60;this.MS_HOUR=this.MS_MIN*60;this.MS_DAY=this.MS_HOUR*24;this.SEC_MIN=60;this.SEC_HOUR=this.SEC_MIN*60;this.SEC_DAY=this.SEC_HOUR*24;this.MIN_HOUR=60;const t=[WH.TERMS.january,WH.TERMS.february,WH.TERMS.march,WH.TERMS.april,WH.TERMS.may,WH.TERMS.june,WH.TERMS.july,WH.TERMS.august,WH.TERMS.september,WH.TERMS.october,WH.TERMS.november,WH.TERMS.december];const a={[this.FORMAT_ABBR]:{SECOND:WH.TERMS.second_abbrev,MINUTE:WH.TERMS.minute_abbrev,HOUR:WH.TERMS.hour_abbrev,DAY:WH.TERMS.day_abbrev,WEEK:WH.TERMS.week_abbrev,MONTH:WH.TERMS.month_abbrev,YEAR:WH.TERMS.year_abbrev},[this.FORMAT_PLURAL]:{SECOND:WH.TERMS.seconds_lc,MINUTE:WH.TERMS.minutes_lc,HOUR:WH.TERMS.hours_lc,DAY:WH.TERMS.days_lc,WEEK:WH.TERMS.weeks_lc,MONTH:WH.TERMS.months_lc,YEAR:WH.TERMS.years_lc},[this.FORMAT_SINGULAR]:{SECOND:WH.TERMS.second_lc,MINUTE:WH.TERMS.minute_lc,HOUR:WH.TERMS.hour_lc,DAY:WH.TERMS.day_lc,WEEK:WH.TERMS.week_lc,MONTH:WH.TERMS.month_lc,YEAR:WH.TERMS.year_lc},[this.FORMAT_SYMBOL]:{SECOND:WH.TERMS.second_short_abbrev,MINUTE:WH.TERMS.minute_short_abbrev,HOUR:WH.TERMS.hour_short_abbrev,DAY:WH.TERMS.day_short_abbrev,WEEK:WH.TERMS.week_short_abbrev,MONTH:WH.TERMS.month_short_abbrev,YEAR:WH.TERMS.year_short_abbrev}};const i=[WH.TERMS.sunday,WH.TERMS.monday,WH.TERMS.tuesday,WH.TERMS.wednesday,WH.TERMS.thursday,WH.TERMS.friday,WH.TERMS.saturday];this.formatDeltaWithSymbols=function(t){let i;if(t<e.SEC_MIN){let e=Math.floor(t);i=e+a.SYMBOL.SECOND}else if(t<e.SEC_HOUR){let e=Math.floor(t/60);i=e+a.SYMBOL.MINUTE}else if(t<e.SEC_DAY){let n=Math.floor(t/e.SEC_HOUR);let s=Math.floor((t-n*e.SEC_HOUR)/e.SEC_MIN);i=n+a.SYMBOL.HOUR;if(s>0){i+=WH.TERMS.wordspace_punct+s+a.SYMBOL.MINUTE}}else{let n=Math.floor(t/e.SEC_DAY);let s=Math.floor((t-n*e.SEC_DAY)/e.SEC_HOUR);i=n+a.SYMBOL.DAY;if(s>0){i+=WH.TERMS.wordspace_punct+s+a.SYMBOL.HOUR}}return i};this.formatFutureTimeAndDay=(n,s,r)=>{let o;let l=new Date;let c=l.getTime()/e.MS_SEC;let u=n.getTime()/e.MS_SEC;if(u-e.SEC_HOUR<c){let t=Math.floor((u-c)/e.SEC_MIN);let i=r===e.FORMAT_SYMBOL?"":WH.TERMS.wordspace_punct;let n=r??(t===1?e.FORMAT_SINGULAR:e.FORMAT_PLURAL);o=t+i+a[n].MINUTE}else if(u-e.SEC_HOUR*8<c){let t=Math.floor((u-c)/e.SEC_MIN);let i=Math.floor(t/60);t-=i*60;let l=r===e.FORMAT_SYMBOL?"":WH.TERMS.wordspace_punct;let d=r??(i===1?e.FORMAT_SINGULAR:e.FORMAT_PLURAL);let f=i+l+a[d].HOUR;if(t>0){let i=r??(t===1?e.FORMAT_SINGULAR:e.FORMAT_PLURAL);f+=WH.TERMS.wordspace_punct+t+l+a[i].MINUTE}o=f+WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+e.formatTimeOfDay(n,s)+WH.TERMS.closedparenthesis_punct}else{if(n.toDateString()===l.toDateString()){o=e.formatTimeOfDay(n,s)}else{let a;if(n<=new Date(l.getFullYear(),l.getMonth(),l.getDate()+6,23,59)){a=n.getDate()-1===l.getDate()?WH.TERMS.tomorrow:i[n.getDay()]}else{a=i[n.getDay()]+WH.TERMS.wordspace_punct+t[n.getMonth()]+WH.TERMS.wordspace_punct+n.getDate()}o=e.formatTimeOfDay(n,s)+WH.TERMS.wordspace_punct+a}}return o};this.formatTimeOfDay=function(e,t){let a=e.getHours();let i=WH.leadingZeroes(e.getMinutes(),2);let n;if(t===true){n=a+":"+i}else{let e=a>=12?WH.TERMS.pm:WH.TERMS.am;if(a>12){n=a-12}else if(a===0){n=12}else{n=a}n+=":"+i+WH.TERMS.wordspace_punct+e}return n};this.getMonthName=function(e){return t[e]};this.getWeekdayName=function(e){return i[e]};this.unix=function(){return Math.floor((new Date).getTime()/1e3)}};WH.Admin=new function(){this.foo="test"};function Ajax(e,t){if(!e){return}var a;try{a=new XMLHttpRequest}catch(e){return}this.request=a;WH.cO(this,t);this.method=this.method||this.params&&"POST"||"GET";a.open(this.method,e,this.async==null?true:this.async);a.onreadystatechange=Ajax.onReadyStateChange.bind(this);if(this.method.toUpperCase()=="POST"){a.setRequestHeader("Content-Type",(this.contentType||"application/x-www-form-urlencoded")+"; charset="+(this.encoding||"UTF-8"))}a.send(this.params)}Ajax.onReadyStateChange=function(){if(this.request.readyState==4){if(this.request.status==0||this.request.status>=200&&this.request.status<300){this.onSuccess!=null&&this.onSuccess(this.request,this)}else{this.onFailure!=null&&this.onFailure(this.request,this)}if(this.onComplete!=null){this.onComplete(this.request,this)}}};WH.Announcement=function(e){const t=this;const a=WH.LocalStorage;const i=WH.User;const n={allowMarkup:undefined,class:undefined,elements:{innerDiv:undefined},id:undefined,mobileText:undefined,parent:undefined,text:undefined};this.hide=function(){n.parentDiv.dataset.animation="hide";setTimeout((function(){n.parentDiv.classList.remove("show");delete n.parentDiv.dataset.animation}),200)};this.markRead=function(){WH.Track.interactiveEvent("Announcements","Close",""+n.name);if(!l()){let e=a.get(a.KEY_ANNOUNCEMENTS_CLOSED)||{};let t=i.getId();if(!Array.isArray(e[t])){e[t]=[]}if(!e[t].includes(n.id)){e[t].push(n.id)}a.set(a.KEY_ANNOUNCEMENTS_CLOSED,e)}t.hide()};this.setClass=function(e){n.class=e;n.parentDiv.className=r()};this.setStyle=function(e){n.elements.innerDiv.setAttribute("style",e?WH.fixWowheadHttps(e):"")};this.setText=function(e,t){n.text=e;n.mobiletext=t;s(n.parent+"-markup",n.text);s(n.parent+"-markup-responsive",t||e)};this.show=function(){n.parentDiv.classList.add("show");WH.Track.nonInteractiveEvent("Announcements","Show",""+n.name)};function s(e,t){let a=WH.ge(e);if(n.allowMarkup){WH.markup.printHtml(t,a.id,{allow:WH.markup.CLASS.STAFF})}else{WH.st(a,t)}WH.Track.addClickEvents(a,{category:"Announcements",actions:{"Follow link":function(){return true}}},n.id)}function r(){let e="announcement announcement-";switch(n.mode){case 2:e+="fixed";break;case 0:e+="pagetop";break;case 1:default:e+="contenttop"}if(n.class){n.class.split(" ").forEach((function(t){e+=" announcement-styling-"+t}))}return e}function o(e){if(WH.UserAgent.isWebCrawler()){return}if(!e||!e.hasOwnProperty("id")||!["number","string","undefined"].includes(typeof e.id)||typeof e.parent!=="string"||typeof e.text!=="string"){WH.error("Announcement initialized with invalid options.",e);return}n.id=e.id;n.parent=e.parent;n.text=e.text;if(!e.admin&&l()){return}n.allowMarkup=typeof e.allowMarkup==="boolean"?e.allowMarkup:true;n.parentDiv=e.parentDiv||WH.ge(n.parent);n.parentDiv.dataset.announcementId=n.id;WH.displayNone(n.parentDiv);n.class=e.class;n.parentDiv.className=r();let a=n.elements.innerDiv=WH.ce("div",{className:"announcement-inner text"});if(e.style){t.setStyle(e.style)}let i=typeof e.id==="string";if(WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BUREAU)>0&&!i){if(!e.admin){let e=WH.ce("a",{className:"fa fa-pencil",href:WH.Url.generatePath("/admin/announcements/edit/"+n.id)});WH.Tooltip.simpleNonTouch(e,WH.TERMS.edit,"q2");WH.ae(a,e)}}WH.ae(a,WH.ce("div",{className:"announcement-markup",id:n.parent+"-markup"}));WH.ae(a,WH.ce("div",{className:"announcement-markup-responsive",id:n.parent+"-markup-responsive"}));if(!i&&!e.admin){let i=WH.ce("a",{className:"fa fa-times announcement-close",id:"closeannouncement"});WH.aE(i,"click",e.nocookie?t.hide:t.markRead);WH.ae(a,i);WH.Tooltip.simpleNonTouch(i,WH.TERMS.close,"q2")}WH.ae(a,WH.ce("div",{style:{clear:"both"}}));WH.ae(n.parentDiv,a);t.setText(e.text,e.mobiletext);t.show()}function l(){if(!n.id){return false}let e=(a.get(a.KEY_ANNOUNCEMENTS_CLOSED)||{})[i.getId()];return Array.isArray(e)&&e.includes(n.id)}o(e)};WH.Announcement.forgetRead=function(){const e=WH.LocalStorage;let t=e.get(e.KEY_ANNOUNCEMENTS_CLOSED);delete t[WH.User.getId()];e.set(e.KEY_ANNOUNCEMENTS_CLOSED,t);let a=WH.ge("announcetext");if(a){WH.ee(a);WH.ae(a,WH.ct(WH.TERMS.purgesuccess_tip));a.className="q2"}else{alert(WH.TERMS.purgesuccess_tip)}};var g_audiocontrols={__windowloaded:false,__rewardedAchievement:false};var g_audioplaylist={};if(!window.JSON){window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(e){if(e instanceof Object){var t="";if(e.constructor===Array){for(var a=0;a<e.length;t+=this.stringify(e[a])+",",a++);return"["+t.substr(0,t.length-1)+"]"}if(e.toString!==Object.prototype.toString){return'"'+e.toString().replace(/"/g,"\\$&")+'"'}for(var i in e){t+='"'+i.replace(/"/g,"\\$&")+'":'+this.stringify(e[i])+","}return"{"+t.substr(0,t.length-1)+"}"}return typeof e==="string"?'"'+e.replace(/"/g,"\\$&")+'"':String(e)}}}AudioControls=function(){const e=WH.Strings;const t={addAllTracks:false,list:undefined};var a=-1;var i=false;var n=false;var s=false;var r={};var o=[];function l(){if(g_audiocontrols.__rewardedAchievement)return;if(!(WH.isSet("g_user")&&g_user.id))return;$.ajax({url:WH.Url.generatePath("/website-achievement-explored"),data:{trigger:"playsound"},success:function(){AchievementCheck()},type:"POST"});g_audiocontrols.__rewardedAchievement=true}function c(e,n,c){var f=WH.ce("audio");f.preload="none";f.controls="true";$(f).click((function(e){e.stopPropagation()}));WH.aE(f,"ended",l);f.style.marginTop="5px";r.audio.parentNode.replaceChild(f,r.audio);r.audio=f;WH.aE(r.audio,"ended",d.bind(e));if(c){f.preload="auto";s=true;WH.aE(r.audio,"canplaythrough",u.bind(this))}if(!i)r.table.style.visibility="visible";var h;do{a+=n;if(a>o.length-1){a=0;if(!i){WH.de(r.table);WH.de('a[href*="/sound&playlist"].btn');return}}if(a<0)a=o.length-1;h=o[a]}while(r.audio.canPlayType(h.type)=="");var p=WH.ce("source");p.src=h.url;p.type=h.type;WH.ae(r.audio,p);if(t.list){t.list.childNodes.forEach((function(e){e.dataset.current=JSON.stringify(e.dataset.track===h.title)}))}if(r.hasOwnProperty("trackDisplay")){WH.st(r.trackDisplay,a+1+" / "+o.length)}if(!i){i=true;for(let e=a+1;e<=o.length-1;e++){if(r.audio.canPlayType(o[e].type)){WH.qsa("a",r.controls).forEach((function(e){delete e.dataset.disabled}));break}}}if(r.hasOwnProperty("addbutton")){delete r.addbutton.dataset.disabled;WH.st(r.addbutton,WH.TERMS.playlist)}}function u(){if(!s)return;s=false;r.audio.play()}this.init=function(a,i,s){if(!Array.isArray(a)){return}if(a.length===0){return}if(i.id===""||g_audiocontrols.hasOwnProperty(i.id)){i.id=e.guid()}g_audiocontrols[i.id]=this;if(typeof s=="undefined"){s={}}t.list=s.list;n=!!s.loop;o=a;r.div=i;r.controls=WH.ce("div",{className:"audio-controls-controls"});if(!s.listview){var l=WH.ce("table",{className:"audio-controls"});r.table=l;r.table.style.visibility="hidden";WH.ae(r.div,l);var c=WH.ce("tr");WH.ae(l,c);var u=WH.ce("td");WH.ae(c,u);r.audio=WH.ce("div");WH.ae(u,r.audio);WH.ae(u,r.controls);let e=f(WH.TERMS.previous,"step-backward",true);WH.ae(r.controls,e);WH.aE(e,"click",this.btnPrevTrack.bind(this));r.trackDisplay=WH.ce("div",{className:"audio-controls-track"});WH.ae(r.controls,r.trackDisplay);let t=f(WH.TERMS.next,"step-forward",true);WH.ae(r.controls,t);WH.aE(t,"click",this.btnNextTrack.bind(this))}else{t.addAllTracks=true;let e=WH.ce("div",{className:"audio-controls"});r.table=e;WH.ae(r.div,e);r.audio=WH.ce("div");WH.ae(e,r.audio);r.trackDisplay=s.trackDisplay;WH.ae(e,r.controls)}r.table.dataset.tracks=""+o.length;r.trackDisplay.dataset.tracks=""+o.length;if(g_audioplaylist.isEnabled()&&!s.fromPlaylist){let e=f(WH.TERMS.playlist,"plus");WH.ae(r.controls,e);WH.aE(e,"click",this.btnAddToPlaylist.bind(this,e));r.addbutton=e}if(g_audiocontrols.__windowloaded)this.btnNextTrack()};function d(){c(this,1,n||a<o.length-1)}this.btnNextTrack=function(){c(this,1,i&&r.audio.readyState>1&&!r.audio.paused)};this.btnPrevTrack=function(){c(this,-1,i&&r.audio.readyState>1&&!r.audio.paused)};this.btnAddToPlaylist=function(e){if(t.addAllTracks){for(let e=0;e<o.length;e++){g_audioplaylist.addSound(o[e])}}else{g_audioplaylist.addSound(o[a])}e.dataset.disabled="true";e.classList.remove("fa-plus");e.classList.add("fa-check");WH.st(e,WH.TERMS.added)};this.isPlaying=function(){return!r.audio.paused};this.removeSelf=function(){r.table.parentNode.removeChild(r.table);delete g_audiocontrols[r.div]};function f(e,t,a){let i=WH.ce("a",{className:"audio-controls-control page-action fa fa-"+t,href:"javascript:"},WH.ct(e));if(a){i.dataset.disabled="true"}return i}};WH.aE(window,"load",(function(){g_audiocontrols.__windowloaded=true;for(var e in g_audiocontrols)if(e.substr(0,2)!="__")g_audiocontrols[e].btnNextTrack()}));AudioPlaylist=function(){const e=WH.LocalStorage;var t=false;var a=[];var i,n;var s=false;this.init=function(){if(!e.isSupported()){return}t=true;let i=e.get(e.KEY_AUDIO_PLAYLIST);if(Array.isArray(i)){a=i}};this.savePlaylist=function(){if(!t)return false;e.set(e.KEY_AUDIO_PLAYLIST,a)};this.isEnabled=function(){return t};this.addSound=function(e){if(!t)return false;this.init();a.push(e);this.savePlaylist();r()};this.deleteSound=function(e){if(e<0){a=[]}else{a.splice(e,1)}this.savePlaylist();if(!i.isPlaying()){i.removeSelf();this.setAudioControls(n)}if(a.length==0)WH.Tooltip.hide()};this.getList=function(){var e=[];for(var t=0;t<a.length;t++)e.push(a[t].title);return e};this.setAudioControls=function(e){if(!t)return false;n=e;i=new AudioControls;i.init(a,n,{loop:true,fromPlaylist:true})};function r(){if(s)return;if(!(WH.isSet("g_user")&&g_user.id))return;if(a.length<2)return;$.ajax({url:WH.Url.generatePath("/sound?playlist"),data:{achievement:1},success:function(){AchievementCheck()},type:"POST"});s=true}};g_audioplaylist=new AudioPlaylist;g_audioplaylist.init();WH.BlizzardApi=new function(){const e=WH.LocalStorage;const t={us:"northamerican_abbrev",eu:"european_abbrev",cn:"chinese_abbrev",tw:"taiwanese_abbrev",kr:"korean_abbrev"};var a={us:"us.api.blizzard.com",eu:"eu.api.blizzard.com",kr:"kr.api.blizzard.com",tw:"tw.api.blizzard.com"};var i=false;var n={};var s=[];this.apiCall=function(e,t,i){e=e.toLowerCase();if(!a.hasOwnProperty(e)){WH.error("Invalid region passed to Blizzard API:",e);return}if(!n.token||n.hasOwnProperty("expires")&&n.expires<new Date){if(n.failed){var s=["error","complete"];for(var r,o=0;r=s[o];o++){if(typeof i[r]==="function"){i[r]=[i[r]]}if(Array.isArray(i[r])){while(i[r].length){i[r].shift()({status:400},"abort")}}}}else{this.getNewToken(this.apiCall.bind(this,e,t,i))}return}i.url="https://"+a[e]+t;if(0){if(!i.hasOwnProperty("headers")){i.headers={}}i.headers.Authorization="Bearer "+n.token}else{i.data={...i.data,access_token:n.token}}$.ajax(i)};this.characterExists=function(t,a,n,s){if(!e.isSupported()||!(JSON&&"stringify"in JSON)){s(true);return}var r=a.toLowerCase().replace(/[^\w -]/,"").replace(" ","-");var o=(t+"|"+r+"|"+n).toLowerCase();if(!i){i={};try{i=e.get(e.KEY_WOW_API_CHARACTER_CACHE);if(i==null){i={}}}catch(e){i={}}}if(i.hasOwnProperty(o)){if(parseInt(i[o].substr(1),10)>Math.floor((Date.now()-1e3*60*60*24*4)/1e3)){s(i[o].substr(0,1)=="t");return}}var l=function(t){i[o]=(t&&t.is_valid?"t":"f")+Math.floor(Date.now()/1e3);e.set(e.KEY_WOW_API_CHARACTER_CACHE,i);s(t&&t.name)};WH.Wow.Realm.fetchData(function(){var e=WH.Wow.Realm.getSlugByName(t,a);if(!e){l(false)}else{this.apiCall(t,WH.Strings.sprintf("/profile/wow/character/%s/%s/status?namespace=profile-%s",encodeURIComponent(e),encodeURIComponent(n.toLocaleLowerCase()),t.toLowerCase()),{dataType:"json",method:"GET",success:l,error:l.bind(null,false)})}}.bind(this))};this.getCharacterThumbnailUrl=function(e,t){return"https://render-"+e.toLowerCase()+".worldofwarcraft.com/character/"+t};this.getNewToken=function(e){s.push(e);if(s.length>1){return}var t=$.ajax.bind($,{url:WH.Url.generatePath("/blizzard-api/token"),dataType:"json",method:"GET",success:this.setToken,error:function(e){WH.error("Could not get Blizzard API token from Wowhead",e);this.setToken(null)}.bind(this)});if(!n.hasOwnProperty("token")&&document.readyState=="loading"&&document.addEventListener){var a=function(){document.removeEventListener("readystatechange",a,false);if(!n.hasOwnProperty("token")){t()}};document.addEventListener("readystatechange",a,false)}else{t()}};this.getNotFoundMessage=function(){let e=document.createDocumentFragment();WH.ae(e,WH.ct(WH.TERMS.characterDoesNotExist_tip));let t=WH.ce("ul");WH.ae(e,t);WH.ae(t,WH.ce("li",{},WH.ct(WH.TERMS.characterHasBeenAccessedRecently_tip)));WH.ae(t,WH.ce("li",{innerHTML:WH.Strings.sprintf(WH.TERMS.yourBlizzardSettingsSetToEnabled_format,WH.ce("a",{href:"https://account.blizzard.com/privacy"},WH.ct(WH.TERMS.gameDataAndProfilePrivacy)).outerHTML)}));let a=WH.ce("div",{innerHTML:WH.Strings.sprintf(WH.TERMS.furtherIssues_format,WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.feedback)).outerHTML)});WH.aE(a.querySelector("a"),"click",ContactTool.show.bind(ContactTool,undefined));while(a.hasChildNodes()){WH.ae(e,a.removeChild(a.firstChild))}return e};this.getRegionAbbreviation=function(e){return WH.TERMS[t[e.toLowerCase()]]};this.setToken=function(e){if(!e||!e.hasOwnProperty("token")){n={failed:true};while(s.length){s.shift()()}n={};return}n=e;n.expires=new Date(Date.now()+n.expires*1e3);while(s.length){s.shift()()}}};WH.CommentReplies=new function(){this.setupReplies=function(i,n,s){e(i,n,s,false);t(i,n,s);i.find(".comment-reply-row").each((function(){a($(this),n,s)}));i.find(".comment-reply-row").hover((function(){$(this).find("span").attr("data-hover","true")}),(function(){$(this).find("span").attr("data-hover","false")}))};function e(e,t,a,i){let n=null;let s=null;let r=null;let o=null;let l=null;let c=null;let u=WH.getPageData("guide.author")===WH.User.getUsername()?WH.Comments.MAX_LENGTH_COMMENT:WH.Comments.MAX_LENGTH_REPLY;let d=WH.Comments.MIN_LENGTH;let f=null;let h=false;let p=false;let m=false;let H=false;let g=e.find(".comment-replies > table");let W=e.find(".add-reply");let E=t.replies.length;if(i){v()}else{W.click((function(){v()}))}function _(){if(h){return}h=true;let a=$("<tr/>");if(i){a.addClass("comment-reply-row").addClass("reply-edit-row")}a.html('<td style="width: 0"></td>'+'<td class="comment-form"><form><table>'+"<form>"+"<table><tr>"+'<td style="width: 600px">'+'<textarea required="required" name="body" cols="68" rows="3"></textarea>'+"</td>"+"<td>"+'<input type="submit" value="'+(i?WH.TERMS.save:WH.TERMS.addreply)+'" />'+'<img src="'+WH.staticUrl+'/images/icons/ajax.gif" class="ajax-loader" />'+"</td>"+"</tr>"+'<tr><td colspan="2">'+'<span class="text-counter">Text counter placeholder</span>'+"</td></tr></table>"+"</form>"+"</td>");r=a.find(".comment-form textarea");n=a.find(".comment-form input[type=submit]");f=a.find(".comment-form span.text-counter");l=a.find(".comment-form form");s=a.find(".comment-form .ajax-loader");c=a.find(".comment-form");l.submit((function(){b();return false}));N();r.keyup((function(e){N()}));r.keydown((function(e){if(e.keyCode==27){T();return false}}));r.keypress((function(e){if(e.keyCode==13){b();return false}}));if(i){e.after(a);e.hide();l.find("textarea").text(t.replies[e.attr("data-idx")].body)}else{g.append(a)}o=a;WH.safeFocus(l.find("textarea"))}function v(){if(!h){_()}p=true;if(!i){W.hide();e.find(".comment-replies").show();c.show()}}function T(){p=false;if(i){if(o){o.remove()}e.show();return}W.show();c.hide();if(E==0){e.find(".comment-replies").hide()}}function b(){if(!p||H){return}if(r.val().length<d||r.val().length>u){if(!m){m=true;f.animate({opacity:"0.0"},150);f.animate({opacity:"1.0"},150,null,(function(){m=false}))}return false}S();$.ajax({type:"POST",url:WH.Url.generatePath(i?"/comment/edit-reply":"/comment/add-reply"),data:{commentId:t.id,replyId:i?e.attr("data-replyid"):0,body:r.val()},success:function(e){I(e)},dataType:"json",error:function(e){R(e.responseText)}});return true}function S(){H=true;s.show();n.prop("disabled",true);c.find(".wh-message-box").remove()}function y(){H=false;s.hide();n.prop("disabled",false)}function I(e){t.replies=e;Listview.templates.comment.updateReplies.call(a,t)}function R(e){y();MessageBox(c,e)}function N(){let e="(error)";let t="q0";let a=r.val().replace(/(\s+)/g," ").replace(/^\s*/,"").replace(/\s*$/,"").length;let i=u-a;if(a==0){e=WH.sprintf(WH.TERMS.replylength1_format,d)}else if(a<d){e=WH.sprintf(WH.TERMS.replylength2_format,d-a)}else{e=WH.sprintf(WH.term(i===1?"replylength4_format":"replylength3_format"),i);if(i<120){t="chars-left-none"}else if(i<240){t="chars-left-some"}else if(i<360){t="chars-left-many"}}f.html(e).attr("class",t)}}function t(e,t,a){var i=e.find(".show-more-replies");var n=e.find(".comment-replies");i.click((function(){s()}));function s(){i.hide();n.append($("<img>",{class:"ajax-loader",alt:"",src:WH.staticUrl+"/images/icons/ajax.gif"}));$.ajax({type:"GET",url:WH.Url.generatePath("/comment/show-replies"),data:{id:t.id},success:function(e){t.replies=e;Listview.templates.comment.updateReplies.call(a,t)},dataType:"json",error:function(){r()}})}function r(){i.show();n.find(".ajax-loader").remove();MessageBox(n,"There was an error fetching the comments. Try refreshing the page.")}}function a(t,a,i){var n=t.attr("data-replyid");var s=t.find(".reply-upvote");var r=t.find(".reply-downvote");var o=t.find(".reply-report");var l=t.find(".reply-rating");var c=t.find(".reply-controls");var u=t.find(".reply-delete");var d=t.find(".reply-edit");var f=false;var h=false;d.click((function(){e(t,a,i,true)}));o.click((function(){if(f||!confirm(WH.TERMS.replyreportwarning_tip))return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"report"},success:function(){m()},error:function(e){g(e.responseText)}})}));s.click((function(){if(s.attr("data-hasvoted")=="true"||s.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"up"},success:function(){p(1)},error:function(e){g(e.responseText)}})}));r.click((function(){if(r.attr("data-hasvoted")=="true"||r.attr("data-canvote")!="true"||f)return;f=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/vote-reply"),data:{id:n,action:"down"},success:function(){p(-1)},error:function(e){g(e.responseText)}})}));u.click((function(){if(h)return;if(!confirm(WH.TERMS.deletereplyconfirmation_tip))return;h=true;$.ajax({type:"POST",url:WH.Url.generatePath("/comment/delete-reply"),data:{id:n},success:function(){H()},error:function(e){g(e.responseText)}})}));function p(e){var t=parseInt(l.text());t+=e;l.text(t);if(e>0)s.attr("data-hasvoted","true");else r.attr("data-hasvoted","true");s.attr("data-canvote","false");r.attr("data-canvote","false");if(e>0){o.remove()}f=false}function m(){f=false;o.remove()}function H(){t.remove();h=false}function g(e){f=false;h=false;if(!e)e="An error has occurred. Try refreshing the page.";MessageBox(c,e)}}};WH.Comments=new function(){const e=this;this.MIN_LENGTH=15;this.MAX_LENGTH_COMMENT=1e5;this.MAX_LENGTH_REPLY=600;this.EDIT_MODE_EDIT_FORUM_POST=-1;this.EDIT_MODE_EDIT_COMMENT=0;this.EDIT_MODE_ADD_COMMENT=1;this.EDIT_MODE_USER_DESCRIPTION=2;this.EDIT_MODE_ADD_FORUM_REPLY=3;this.EDIT_MODE_USER_SIGNATURE=4;this.LOW_RATING_THRESHOLD=-4;var t=1;var a=2;this.appendImportedSubject=function(e,t){if(!t){return}var a=t.replace(/^\s*Re\b|\bRe\s*$/,"").replace(/\s/,"");if(!a||!a.match(/[^:]/)){return}var i=WH.ce("span");WH.st(i,'"'+t+'"');var n=WH.ce("span",{className:"comment-imported-subject"});WH.st(n,WH.TERMS.subject_colon);WH.ae(n,i);e.append(n)};this.getColorClass=function(t,a,i,n){switch(a){case e.EDIT_MODE_EDIT_FORUM_POST:var s=null;if(!i){s=t.divPost.childNodes[1].className.match(/comment-([a-z-]+)/)}else{s=t.divBody[0].className.match(/comment-([a-z-]+)/)}if(s!=null){return" comment-"+s[1]}break;case e.EDIT_MODE_ADD_FORUM_REPLY:if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}case e.EDIT_MODE_USER_SIGNATURE:let a=WH.User.getCommentRoleClass(t.roles,t.user);if(a){return" "+a}break}if(t.roles&(U_GROUP_ADMIN|U_GROUP_BLIZZARD)){return" comment-role-admin"}if(n){return" comment-guide-author"}if(t.commentv2&&t.sticky||t.roles&U_GROUP_GREEN_TEXT||t.rating>=10){return" comment-high-rating"}if(t.rating&&t.rating<-2){return" comment-low-rating"}if(t.roles&U_GROUP_PREMIUMISH){return" comment-role-premium"}return""};this.edit=function(t,a,n){if(WH.qs(`#p${t.id} .comment-edit`)||t.container&&WH.qs(`.comment-edit`,t.container[0])){return}if(n){t.divBody.hide();t.divResponse.hide()}var s=$("<div/>");s.addClass("comment-edit");t.divEdit=s[0];if(a===e.EDIT_MODE_EDIT_FORUM_POST){if(g_users[t.user]!=null){t.roles=g_users[t.user].roles}}let r=a===e.EDIT_MODE_EDIT_FORUM_POST||a===e.EDIT_MODE_EDIT_COMMENT?undefined:"submit";let o=e.editAppend(s,t,a,n,undefined,undefined,r);var l=$("<div/>");l.addClass("comment-edit-buttons");var c=$("<button/>",{text:WH.TERMS.save});c.click(i.bind(this,true,t,a,n));l.append(c);l.append(WH.ct(" "));c=$("<button/>",{text:WH.TERMS.cancel});c.click(i.bind(this,false,t,a,n));l.append(c);s.append(l);s.insertAfter(t.divBody);WH.safeFocus(o)};this.editAppend=function(i,o,l,c,u,d,f){var h=e.getCharLimit(l);if(o.body===null){o.body=""}if(l===e.EDIT_MODE_ADD_COMMENT||l===e.EDIT_MODE_ADD_FORUM_REPLY||l===e.EDIT_MODE_USER_SIGNATURE){o.user=g_user.name;o.roles=g_user.roles;o.rating=1}else if(l===e.EDIT_MODE_USER_DESCRIPTION){o.roles=g_user.roles;o.rating=1}if(u){o.roles&=~U_GROUP_PENDING}if(l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT){var p=$("<div/>",{text:WH.TERMS.mode_colon});p.addClass("comment-edit-modes");var m=$("<a/>",{href:"javascript:",text:WH.TERMS.edit});m.click(s.bind(m[0],t,l,o));m.addClass("selected");p.append(m);p.append(WH.ct("|"));var H=$("<a/>",{href:"javascript:",text:WH.TERMS.preview});H.click(s.bind(H[0],a,l,o));p.append(H);i.append(p)}var g=$("<div/>",{css:{display:"none"}});g.addClass("text comment-body"+e.getColorClass(o,l,c));var W=$("<div/>");W.addClass("comment-edit-body");var E=$('<div style="float: left" />');E.addClass("toolbar");var _=$("<div/>");_.addClass("menu-buttons");var v=$("<textarea/>",{val:o.body,rows:10,css:{clear:"left"}});v.addClass("comment-editbox");switch(l){case e.EDIT_MODE_ADD_COMMENT:v.attr("name","commentbody");break;case e.EDIT_MODE_USER_DESCRIPTION:v.attr({name:"desc",originalValue:o.body});break;case e.EDIT_MODE_ADD_FORUM_REPLY:v.attr("name","body");break;case e.EDIT_MODE_USER_SIGNATURE:v.attr({name:"sig",originalValue:o.body,rows:3});v.css("height","auto");break}if(l!==e.EDIT_MODE_EDIT_FORUM_POST&&l!==e.EDIT_MODE_EDIT_COMMENT){var T=$("<a/>"),b=$("<div/>"),S=$("<div/>"),y=screen.availWidth<=480;var I=n.bind(e,o,l,v[0],b[0]);T.addClass("disclosure-"+(y?"off":"on"));T.text(WH.TERMS.livepreview);T.attr("href","javascript:");T.click((function(){I(1);var e=WH.toggleDisplay(b);T.toggleClass("disclosure-on",e);T.toggleClass("disclosure-off",!e)}));S.addClass("pad");g.append(WH.getMajorHeading(T,3,null,{classes:"first"}));g.append(b);g.append(S);WH.onAfterTyping(v[0],I,50);v.focus((function(){I();g.css("display",y?"none":"");if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){v.css("height","22em")}}))}else if(l!==e.EDIT_MODE_USER_SIGNATURE&&!d){v.focus((function(){v.css("height","22em")}))}var R=[{id:"b",icon:"bold",title:WH.TERMS.bold,pre:"[b]",post:"[/b]"},{id:"i",icon:"italic",title:WH.TERMS.italic,pre:"[i]",post:"[/i]"},{id:"u",icon:"underline",title:WH.TERMS.underline,pre:"[u]",post:"[/u]"},{id:"s",icon:"strikethrough",title:WH.TERMS.strikethrough,pre:"[s]",post:"[/s]"},{id:"small",icon:"text-height",title:WH.TERMS.smalltext_stc,pre:"[small]",post:"[/small]"},{id:"url",icon:"link",title:WH.TERMS.link,nopending:true,onclick:function(){var e=prompt(WH.TERMS.linkurl_tip,"https://");if(e){WH.insertTag(v[0],"[url="+e+"]","[/url]")}}},{id:"quote",icon:"quote-left",title:WH.TERMS.quotebox_stc,pre:"[quote]",post:"[/quote]"},{id:"code",icon:"code",title:WH.TERMS.codebox_stc,pre:"[code]",post:"[/code]"},{id:"ul",icon:"list-ul",title:WH.TERMS.unorderedlistbullets_stc,pre:"[ul]\n[li]",post:"[/li]\n[/ul]",rep:function(e){return e.replace(/\n/g,"[/li]\n[li]")}},{id:"ol",icon:"list-ol",title:WH.TERMS.orderedlistnumbers_stc,pre:"[ol]\n[li]",post:"[/li]\n[/ol]",rep:function(e){return e.replace(/\n/g,"[/li]\n[li]")}},{id:"li",icon:"circle",title:WH.TERMS.listitem_stc,pre:"[li]",post:"[/li]"}];if(!c){for(var N=0,w=R.length;N<w;++N){var A=R[N];if(l===e.EDIT_MODE_USER_SIGNATURE&&A.id=="quote"){break}if(g_user.roles&U_GROUP_PENDING&&A.nopending){continue}var M=$("<button/>",{click:function(e,t){t.preventDefault();(e.onclick!=null?e.onclick:WH.insertTag.bind(0,v[0],e.pre,e.post,e.rep))()}.bind(null,A)});M[0].setAttribute("type","button");M.attr("title",A.title);var C=$("<i/>",{class:"fa fa-"+A.icon});M.append(C);E.append(M)}}else{for(var N=0,w=R.length;N<w;++N){var A=R[N];if(g_user.rolls&U_GROUP_PENDING&&A.nopending){continue}var O="tb-"+A.id;var M=$("<button/>",{click:function(e,t){t.preventDefault();(e.onclick!=null?e.onclick:WH.insertTag.bind(0,v[0],e.pre,e.post,e.rep))()}.bind(null,A),class:O,title:A.title});M[0].setAttribute("type","button");M.append("<ins/>");E.append(M)}E.addClass("formatting")}let L=[];let k;for(let e in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(e)){continue}if(k=WH.markup.tags[e].entityType){let t=[k,WH.Types.getUpperSingular(k)+WH.TERMS.ellipsis_punct,WH.markup.insertEntityTag.bind(null,v[0],WH.Types.getLowerSingular(k),e)];let a=WH.Types.getRequiredTrees(k);if(a){t.push(null,{requiredTrees:a})}L.push(t)}}L.sort((function(e,t){return e[1].localeCompare(t[1])}));let D=[Menu.createItem({label:WH.TERMS.links,submenu:L})];W.append(E);W.append(_);W.append($('<div style="clear: left" />'));W.append(v);W.append($("<br/>"));Menu.addButtons(_[0],D);let P=WH.ce("section",{classList:"comment-edit-body-footer",dataset:{hasSubmitButton:JSON.stringify(!!f)}});if(f){let e={type:"submit",classList:"comment-edit-body-footer-submit-button",value:WH.TERMS.save};if(f){e.name=f}let t=WH.ce("section",{classList:"comment-edit-body-footer-submit"},WH.ce("input",e));WH.ae(P,t)}let x=WH.ce("section",{classList:"comment-edit-body-footer-limit"});WH.ae(P,x);W.append(P);if(l===e.EDIT_MODE_USER_SIGNATURE){WH.ae(x,WH.ct(WH.sprintf(WH.TERMS.uptoxcharactersorlines_format,WH.Strings.formatNumber(h),WH.Strings.formatNumber(3))))}else{WH.ae(x,WH.ct(WH.sprintf(WH.TERMS.uptoxcharacters_format,WH.Strings.formatNumber(h))))}let U=WH.Strings.formatNumber(h-o.body.length);let F=WH.sprintf(WH.TERMS.xcharactersremaining_format,U);let q=WH.ce("span",undefined,WH.ct(F));WH.ae(x,q);v.keyup(r.bind(e,v,q,h));v.keydown(r.bind(e,v,q,h));if((l===e.EDIT_MODE_EDIT_FORUM_POST||l===e.EDIT_MODE_EDIT_COMMENT)&&g_user.roles&U_GROUP_MODERATOR){var Y=$("<div/>",{class:"pad"});var B=$("<div/>",{text:(g_user.roles&U_GROUP_ADMIN?"Admin":"Moderator")+" response"});var G=$("<textarea/>",{val:o.response,rows:3,css:{height:"6em"}});W.append(Y);W.append(B);W.append(G)}i.append(W);i.append(g);return v};this.getCharLimit=function(t){if(t===e.EDIT_MODE_USER_DESCRIPTION){return 7500}if(t===e.EDIT_MODE_USER_SIGNATURE){return 250}if(g_user.roles&U_GROUP_STAFF){return 1e5}var a=WH.User.isPremium()?3:1;switch(t){case e.EDIT_MODE_EDIT_COMMENT:case e.EDIT_MODE_ADD_COMMENT:return 7500*a;case e.EDIT_MODE_EDIT_FORUM_POST:case e.EDIT_MODE_ADD_FORUM_REPLY:return 15e3*a}return 0};this.updateLastEdit=function(e){var t=e.divLastEdit;if(!t){return}if(e.lastEdit!=null){var a=e.lastEdit;t.childNodes[1].firstChild.nodeValue=a[2];t.childNodes[1].href=WH.Url.generatePath("/user="+a[2]);var i=new Date(a[0]);var n=(WH.getServerTime()-i)/1e3;if(t.childNodes[3].firstChild){WH.de(t.childNodes[3].firstChild)}WH.formatDate(t.childNodes[3],n,i);var s="";if(e.rating!=null){s+=WH.sprintf(WH.TERMS.patchparens_format,WH.Wow.getVersionStringFromTimestamp(i))}if(a[1]>1){s+=WH.TERMS.dash_punct+WH.sprintf(WH.TERMS.editcount_format,a[1])}t.childNodes[4].nodeValue=s;t.style.display=""}else{t.style.display="none"}};this.validate=function(t,a){a|=0;var i=a===e.EDIT_MODE_EDIT_FORUM_POST||a===e.EDIT_MODE_ADD_FORUM_REPLY;if(i){if(WH.trim(t.value).length<1){alert(WH.TERMS.postempty_tip);return false}}else{if(WH.trim(t.value).length<1){alert(WH.TERMS.messagetooshort_tip);return false}}var n=e.getCharLimit(a);if(t.value.length>n){return confirm(WH.sprintf(i?WH.TERMS.postlength_format:WH.TERMS.commentlength_format,n,t.value.substring(n-30,n)))}return true};function i(t,a,i,n){if(t){var s=WH.gE(a.divEdit,"textarea");var r=s[0];if(!e.validate(r,i)){return}if(r.value!=a.body||s[1]&&s[1].value!=a.response){var o=0;if(a.lastEdit!=null){o=a.lastEdit[1]}++o;a.lastEdit=[WH.getServerTime(),o,g_user.name];if(!a.commentv2){e.updateLastEdit(a)}var l=e.getCharLimit(i);var c=WH.markup.rolesToClass(a.roles);var u=WH.markup.getDomFragment(r.value.length>l?r.value.substring(0,l):r.value,{allow:c,mode:WH.markup.MODE.COMMENT,roles:a.roles});var d=s[1]&&s[1].value.length>0?WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+s[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:WH.markup.MODE.COMMENT,roles:g_user.roles}):document.createDocumentFragment();if(a.commentv2){a.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){a.response=s[1].value}Listview.templates.comment.updateCommentCell.call(this,a)}else{if(!n){$(a.divBody).empty().append(u);$(a.divResponse).empty().append(d)}else{a.divBody.empty().append(u);a.divResponse.empty().append(d)}a.body=r.value;if(g_user.roles&U_GROUP_MODERATOR&&s[1]){a.response=s[1].value}}var f={postId:a.id,body:a.body};var h="body="+WH.urlEncode(a.body);if(a.response!==undefined){h+="&response="+WH.urlEncode(a.response);f.response=a.response}if(i===e.EDIT_MODE_EDIT_FORUM_POST){$.ajax({url:WH.Url.generatePath("/forums/edit-post"),method:"post",data:f})}else{new Ajax(WH.Url.generatePath("/comment=edit&id="+a.id),{method:"POST",params:h})}}}if(a.commentv2){Listview.templates.comment.updateCommentCell.call(this,a)}else if(!n){a.divBody.style.display="";a.divResponse.style.display="";a.divLinks.firstChild.style.display=""}else{a.divBody.show();a.divResponse.show()}if(!a.commentv2){WH.de(a.divEdit);a.divEdit=null}}function n(t,a,i,n){if(n.style.display=="none"){return}var s=e.getCharLimit(a);var r=i.value.length>s?i.value.substring(0,s):i.value;if(a===e.EDIT_MODE_USER_SIGNATURE){var o;if((o=r.indexOf("\n"))!=-1&&(o=r.indexOf("\n",o+1))!=-1&&(o=r.indexOf("\n",o+1))!=-1){r=r.substring(0,o)}}var l=WH.markup.rolesToClass(t.roles);var c=WH.markup.getDomFragment(r,{allow:l,mode:WH.markup.MODE.COMMENT,roles:t.roles});if(c.hasChildNodes()){$(n).empty().append(c)}else{n.innerHTML='<span class="q6">...</span>'}}function s(i,n,s){var r=e.getCharLimit(n);var o=WH.markup.MODE.COMMENT;WH.arrayWalk(WH.gE(this.parentNode,"a"),(function(e){e.className=""}));this.className="selected";var l=WH.gE(this.parentNode.parentNode,"textarea");var c=l[0];var u=c.parentNode;var d=$(".comment-body",u.parentNode)[0];if(n===e.EDIT_MODE_USER_SIGNATURE){o=WH.markup.MODE.SIGNATURE}switch(i){case t:u.style.display="";d.style.display="none";WH.safeFocus(u.firstChild);break;case a:u.style.display="none";var f=c.value.length>r?c.value.substring(0,r):c.value;if(n===e.EDIT_MODE_USER_SIGNATURE){var h;if((h=f.indexOf("\n"))!=-1&&(h=f.indexOf("\n",h+1))!=-1&&(h=f.indexOf("\n",h+1))!=-1){f=f.substring(0,h)}}var p=WH.markup.rolesToClass(s.roles);var m=WH.markup.getDomFragment(f,{allow:p,mode:o,roles:s.roles});if(l[1]&&l[1].value.length>0){m.appendChild(WH.markup.getDomFragment("[div][/div][wowheadresponse="+g_user.name+" roles="+g_user.roles+"]"+l[1].value+"[/wowheadresponse]",{allow:WH.markup.CLASS.STAFF,mode:o,roles:g_user.roles}))}$(d).empty().append(m);d.style.display="";break}}function r(e,t,a){var i=$(e).val();if(i.length>a){$(e).val(i.substring(0,a))}else{$(t).html(" "+WH.sprintf(WH.TERMS.xcharactersremaining_format,(a-i.length).toLocaleString())).removeClass("q10");if(i.length===a){$(t).addClass("q10")}}}};function co_addYourComment(){tabsContribute.focus(0);var e=WH.gE(document.forms["addcomment"],"textarea")[0];WH.safeFocus(e)}function co_validateForm(e){var t=WH.gE(e,"textarea")[0];var a=false;if(WH.isSet("tabsContribute")){for(var i=0;i<tabsContribute.tabs.length;i++){if(tabsContribute.tabs[i].id=="suggest-a-video"){a=i;break}}}if(a!==false&&t.value.length<350){var n;for(var i in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(i)){continue}if(n=vi_sitevalidation[i].exec(t.value)){break}}if(n&&!confirm(WH.TERMS.commentasvideo_tip)){tabsContribute.show(a);$('#tab-suggest-a-video input[name="videourl"]').attr("value",n[0]);return false}}return WH.Comments.validate(t)}$(document).ready((function(){WH.setupChangeWarning($("form[name=addcomment]"),[$("textarea[name=commentbody]")],WH.TERMS.messagestarted_tip)}));WH.Cookies=new function(){const e=this;this.available=function(){if(!t()){return false}return a()};this.getDomain=function(){return location.hostname.replace(/^www\./,"")};function t(){if(typeof window.OptanonActiveGroups!=="string"){return true}return window.OptanonActiveGroups.split(",").indexOf("C0001")!==-1}function a(){WH.setCookie("enabledTest",1,"1",undefined,undefined,location.protocol==="https:");let e=WH.getCookies("enabledTest")==="1";if(e){WH.deleteCookie("enabledTest",undefined,undefined,location.protocol==="https:")}a=function(){return e};return e}};WH.D2={};WH.DI.getPlayerLevelMax=function(){return 60};var Dialog=function(){var e=this,t,a=null,i,n={},s,r=false,o=WH.ce("form"),l={};o.onsubmit=function(){p();return false};this.show=function(l,u){if(l){i=l;t=WH.cOr({},Dialog.templates[i]);e.template=t}else return;if(t.onInit&&!r)t.onInit.bind(e,o,u)();if(u.onBeforeShow)n.onBeforeShow=u.onBeforeShow.bind(e,o);if(t.onBeforeShow)t.onBeforeShow=t.onBeforeShow.bind(e,o);if(u.onShow)n.onShow=u.onShow.bind(e,o);if(t.onShow)t.onShow=t.onShow.bind(e,o);if(u.onHide)n.onHide=u.onHide.bind(e,o);if(t.onHide)t.onHide=t.onHide.bind(e,o);if(u.onSubmit)n.onSubmit=u.onSubmit;if(t.onSubmit)a=t.onSubmit.bind(e,o);if(u.data){r=false;s={};WH.cO(s,u.data)}e.data=s;Lightbox.show("dialog-"+i,{onShow:c,onHide:h})};this.getValue=function(e){return H(e)};this.setValue=function(e,t){g(e,t)};this.getSelectedValue=function(e){return W(e)};this.getCheckedValue=function(e){return E(e)};function c(e,a){if(a||!r)d(e);if(t.onBeforeShow)t.onBeforeShow();if(n.onBeforeShow)n.onBeforeShow();Lightbox.setSize(t.width);e.className+=" dialog";f();if(t.onShow)t.onShow();if(n.onShow)n.onShow();window.setTimeout(u,5)}function u(){for(var e=0,a,i;a=t.fields[e];e++){if(WH.inArray(["text","number"],a.type)>=0){l[a.id].focus();break}}}function d(a){WH.ee(a);WH.ee(o);var i=WH.ce("div");i.className="lightbox-content text";WH.ae(a,i);WH.ae(i,o);if(t.title){WH.ae(o,WH.getImitationHeading(WH.ct(t.title),1))}var n=WH.ce("table"),c=WH.ce("tbody"),u=false;var d;var f;var h;WH.ae(n,c);WH.ae(o,n);for(var m=0,H=t.fields.length;m<H;++m){var g=t.fields[m],W;if(!u){d=WH.ce("tr");f=WH.ce("th");h=WH.ce("td")}g.__tr=d;if(s[g.id]==null)s[g.id]=g.value?g.value:"";var E;if(g.options){E=[];if(g.optorder)WH.cO(E,g.optorder);else{for(var _ in g.options)E.push(_)}if(g.sort)E.sort((function(e,t){return g.sort*WH.stringCompare(g.options[e],g.options[t])}))}switch(g.type){case"caption":f.colSpan=2;f.style.textAlign="left";f.style.padding=0;if(g.compute)g.compute.bind(e,null,s[g.id],o,f,d)();else if(g.label)WH.ae(f,WH.ct(g.label));WH.ae(d,f);WH.ae(c,d);continue;break;case"textarea":var v=W=WH.ce("textarea");v.name=g.id;if(g.disabled)v.disabled=true;v.rows=g.size[0];v.cols=g.size[1];h.colSpan=2;if(g.label){f.colSpan=2;f.style.textAlign="left";f.style.padding=0;h.style.padding=0;WH.ae(f,WH.ct(g.label));WH.ae(d,f);WH.ae(c,d);d=WH.ce("tr")}if(g.maxLength){v.maxLength=g.maxLength}WH.ae(h,v);break;case"select":var v=W=WH.ce("select");v.name=g.id;if(g.size)v.size=g.size;if(g.disabled)v.disabled=true;if(g.multiple)v.multiple=true;if(g.onchange){v.onchange=g.onchange.bind(e,v)}for(var _=0,T=E.length;_<T;++_){var b=WH.ce("option");b.value=E[_];WH.ae(b,WH.ct(g.options[E[_]]));WH.ae(v,b)}WH.ae(h,v);break;case"dynamic":h.colSpan=2;h.style.textAlign="left";h.style.padding=0;if(g.compute)g.compute.bind(e,null,s[g.id],o,h,d)();WH.ae(d,h);WH.ae(c,d);W=h;break;case"checkbox":case"radio":var S=0;W=[];for(var _=0,T=E.length;_<T;++_){var y=WH.ce("span"),v,I,R="sdfler46"+g.id+"-"+E[_];if(_>0&&!g.noInputBr)WH.ae(h,WH.ce("br"));I=WH.ce("label");I.setAttribute("for",R);I.onmousedown=WH.rf;v=WH.ce("input");v.setAttribute("type",g.type);v.name=g.id;v.value=E[_];v.id=R;if(g.disabled)v.disabled=true;if(g.onchange){v.onchange=g.onchange.bind(e,v)}if(g.submitOnDblClick)I.ondblclick=v.ondblclick=function(e){p()};if(g.compute)g.compute.bind(e,v,s[g.id],o,h,d,I)();WH.ae(I,v);WH.ae(I,WH.ct(g.options[E[_]]));WH.ae(h,I);W.push(v)}break;default:var v=W=WH.ce("input");v.name=g.id;if(g.size)v.size=g.size;if(g.disabled)v.disabled=true;if(g.submitOnEnter){v.onkeypress=function(e){if(e.keyCode===13){p()}}}v.setAttribute("type",g.type);WH.ae(h,v);break}if(g.label){if(g.type=="textarea"){if(g.labelAlign)h.style.textAlign=g.labelAlign;h.colSpan=2}else{if(g.labelAlign)f.style.textAlign=g.labelAlign;WH.ae(f,WH.ct(g.label));WH.ae(d,f)}}if(g.placeholder){v.placeholder=g.placeholder}if(g.type!="checkbox"&&g.type!="radio"){if(g.width)v.style.width=g.width;if(g.compute&&g.type!="caption"&&g.type!="dynamic")g.compute.bind(e,v,s[g.id],o,h,d)()}if(g.caption){var y=WH.ce("small");if(g.type!="textarea")y.style.paddingLeft="2px";WH.ae(y,WH.ct(g.caption));WH.ae(h,y)}if(g.style&&typeof v!=="undefined"){for(var N in g.style){v.style[N]=g.style[N]}}WH.ae(d,h);WH.ae(c,d);u=g.mergeCell;l[g.id]=W}var w={arrow:"external-link",check:"check",question:"question",x:"times"};for(var m=t.buttons.length;m>0;--m){var A=t.buttons[m-1],M=WH.ce("a");M.onclick=p.bind(M,A[0]);M.className="dialog-option fa fa-"+(w[A[0]]||"circle fa-size-xs");M.href="javascript:";WH.ae(M,WH.ct(A[1]));WH.ae(a,M)}r=true}function f(){for(var a=0,i=t.fields.length;a<i;++a){var n=t.fields[a],r=l[n.id];switch(n.type){case"caption":break;case"select":for(let e=0,t=r.options.length;e<t;e++){r.options[e].selected=r.options[e].value==s[n.id]||s[n.id]instanceof Array&&WH.inArray(s[n.id],r.options[e].value)!==-1}break;case"checkbox":case"radio":for(let e=0,t=r.length;e<t;e++){r[e].checked=r[e].value==s[n.id]||Array.isArray(s[n.id])&&WH.inArray(s[n.id],r[e].value)!=-1}break;default:r.value=s[n.id];break}if(n.update)n.update.bind(e,null,s[n.id],o,r)()}}function h(){if(t.onHide)t.onHide();if(n.onHide)n.onHide()}function p(e){if(e=="x")return Lightbox.hide();for(var a=0,i=t.fields.length;a<i;++a){var n=t.fields[a],r;switch(n.type){case"caption":continue;case"select":r=W(n.id);break;case"checkbox":case"radio":r=E(n.id);break;case"dynamic":if(n.getValue){r=n.getValue(n,s,o);break}default:r=H(n.id);break}if(n.validate){if(!n.validate(r,s,o))return}if(r&&typeof r=="string")r=WH.trim(r);s[n.id]=r}m(e)}function m(e){var t;if(a)t=a(s,e,o);if(n.onSubmit)t=n.onSubmit(s,e,o);if(t===undefined||t)Lightbox.hide();return false}function H(e){return l[e].value}function g(e,t){l[e].value=t}function W(e){var t=[],a=l[e];for(var i=0,n=a.options.length;i<n;i++){if(a.options[i].selected)t.push(parseInt(a.options[i].value)==a.options[i].value?parseInt(a.options[i].value):a.options[i].value)}if(t.length==1)t=t[0];return t}function E(e){var t=[],a=l[e];for(var i=0,n=a.length;i<n;i++){if(a[i].checked)t.push(parseInt(a[i].value)==a[i].value?parseInt(a[i].value):a[i].value)}return t}};Dialog.prompt=function(e,t){let a=new Dialog;t=t||{};a.show("prompt",{promptOptions:{callback:e,caption:t.caption,initial:t.initial,label:t.label,placeholder:t.placeholder,size:t.size,text:t.text,title:t.title}})};Dialog.templates={prompt:{buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"topText",type:"caption"},{id:"inputField",type:"text",size:40,submitOnEnter:true}],onInit:function(e,t){this.template.title=t.promptOptions.title;this.template.fields[0].label=t.promptOptions.text||"";this.template.fields[1].label=t.promptOptions.label||"";this.template.fields[1].caption=t.promptOptions.caption||"";this.template.fields[1].placeholder=t.promptOptions.placeholder||"";let a=parseInt(t.promptOptions.size);if(a){this.template.fields[1].size=a}let i=t.promptOptions.callback;this.template.onSubmit=e=>i(e.inputField.value);t.data={};if(t.promptOptions.initial!=null){t.data.inputField=t.promptOptions.initial}delete t.promptOptions},onShow:function(e){setTimeout((()=>e.inputField.focus()),50);setTimeout(Lightbox.reveal,100)}}};Dialog.extraFields={};WH.DOM=new function(){const e=this;const t={bodyAddCallbacks:new WeakMap,lazyCssObserver:undefined,nodeData:new WeakMap};this.addScriptOnce=function(e,t){if(WH.qs('script[src="'+e+'"]')){return}t=t||{};t.src=e;let a=WH.ce("script",t);WH.ae(document.head,a);return a};this.bindBreakpoints=function(e,t){let a=Object.entries(t).sort(((e,t)=>e[1]-t[1]));WH.aE(e,"resize",(t=>{let i=t.detail.contentRect.width;let n=a.find((([e,t])=>i<=t));if(n){e.dataset.display=n[0]}else{delete e.dataset.display}}))};this.getColorFilter=function(e,t,a){let i=["svg-color-filter",Math.floor(e*1e3),Math.floor(t*1e3),Math.floor(a*1e3)].join("-");if(!WH.qs("svg filter#"+i)){let n=e=>document.createElementNS("http://www.w3.org/2000/svg",e);let s=n("svg");let r=n("defs");let o=n("filter");let l=n("feColorMatrix");WH.ae(s,r);WH.ae(r,o);WH.ae(o,l);o.setAttribute("id",i);o.setAttribute("color-interpolation-filters","sRGB");l.setAttribute("type","matrix");l.setAttribute("values","0 0 0 0 "+e+" 0 0 0 0 "+t+" 0 0 0 0 "+a+" 0 0 0 1 0");WH.ae(document.body,s)}return"url(#"+i+")"};this.createImitationSelect=function(t){t=t||{};let n=WH.ce("a",{className:"imitation-select",dataset:{fieldFilled:`${!!(t.isFilled??true)}`},href:"javascript:",tabIndex:0},WH.ct(t.text||""));if(t.native){n.dataset.native=1;Menu.add(n,a.bind(e,n),{showAtElement:true});WH.ae(n,WH.ce("span",{className:"imitation-select-width"}));let t=new MutationObserver(i.bind(e,n));t.observe(n,{childList:true,subtree:true,characterData:true});let s=0;Object.defineProperty(n,"selectedIndex",{get:function(){return s},set:function(e){let t=WH.qsa("option",n);s=parseInt(e);if(isNaN(s)){s=0}s=Math.max(s,0);if(t.length===0){s=0;WH.ee(n);n.style.backgroundImage="";delete n.dataset.icon;return}s=Math.min(t.length-1,s);WH.st(n,t[s].label);let a=t[s].dataset.tinyIcon;if(a){n.dataset.icon=a;n.style.backgroundImage='url("'+WH.Icon.getIconUrl(a,WH.Icon.MEDIUM)+'")'}else{n.style.backgroundImage="";delete n.dataset.icon}}});Object.defineProperty(n,"options",{get:function(){return WH.qsa("option",n)}})}else if(t.menu){Menu.add(n,t.menu,{showAtElement:true})}return n};this.dispatchEvent=function(e,t){e.dispatchEvent(new Event(t))};this.dragToMove=function(e,t,a=1){if(e.classList.contains("drag-to-move")){return}if(WH.Device.isTouch()){e.style.overflow="scroll";return}let i=0;let n=0;let s=0;let r=0;t.style.position="absolute";t.style.top="0";t.style.left="0";const o=t=>{if(t.button!==0){return}t.preventDefault();WH.aE(document,"mousemove",l);WH.aE(document,"mouseup",(()=>{delete e.dataset.dragging;document.removeEventListener("mousemove",l)}),{once:true});e.dataset.dragging="true";i=t.clientX;s=t.clientY};const l=e=>{n=(i-e.clientX)*a;i=e.clientX;t.style.left=`${t.offsetLeft-n}px`;r=(s-e.clientY)*a;s=e.clientY;t.style.top=`${t.offsetTop-r}px`};WH.aE(e,"mousedown",o);e.classList.add("drag-to-move")};this.dragToScroll=function(e){if(e.classList.contains("drag-to-scroll")){return}let t={};const a=a=>{a.preventDefault();t.left=e.scrollLeft;t.top=e.scrollTop;t.x=a.clientX;t.y=a.clientY;e.dataset.dragging="true";WH.aE(document,"mousemove",i,{passive:true});WH.aE(document,"mouseup",n,{once:true})};const i=a=>{let i=a.clientX-t.x;let n=a.clientY-t.y;e.scrollTop=t.top-n;e.scrollLeft=t.left-i};const n=t=>{delete e.dataset.dragging;document.removeEventListener("mousemove",i)};WH.aE(e,"mousedown",a);e.classList.add("drag-to-scroll")};this.enableEvents=function(e,t){if(e.addEventListener){throw new Error("Object already has events enabled.")}if(t&&!t.dispatchEvent){throw new Error("Parent does not support dispatchEvent.")}let a=new EventTarget;let i=["addEventListener","removeEventListener"];if(t){e.dispatchEvent=e=>{a.dispatchEvent(e);if(e.bubbles){t.dispatchEvent(e)}}}else{i.push("dispatchEvent")}i.forEach((t=>e[t]=a[t].bind(a)))};this.getData=function(e,a){return(t.nodeData.get(e)||{})[a]};this.getInnerHeight=function(e){return parseFloat(getComputedStyle(e,null).height.replace("px",""))};this.getInnerWidth=function(e){return parseFloat(getComputedStyle(e,null).width.replace("px",""))};this.lazyLoadBackground=function(e){if(!t.lazyCssObserver){return}if(!e.style.backgroundImage){WH.warn("Element does not have a background image to lazy-load.",e);return}e.classList.add("lazy-load-background");t.lazyCssObserver.observe(e)};this.isEmpty=function(e){for(let t=0,a;a=e.childNodes[t];t++){if(a.nodeType===Node.ELEMENT_NODE||a.nodeType===Node.TEXT_NODE&&a.textContent.trim()){return false}}return true};this.isVisible=function(e){return!(e.offsetWidth===0&&e.offsetHeight===0)};this.mouseWheelZoom=function(e,t,a,i){a=a||.2;i=i||2;let n=(e,t)=>t.style.transform=e===1?"":`scale(${e})`;let s=1;WH.aE(e,"wheel",(e=>{e.preventDefault();let r=e.deltaY;switch(e.deltaMode){case 0:break;case 1:r*=15;break;case 2:r*=window.innerHeight;break}s+=-.1*(r/120);s=Math.min(Math.max(a,s),i);let o=t.getBoundingClientRect();let l=(e.clientX-o.left)/o.width;let c=(e.clientY-o.top)/o.height;n(s,t);o=t.getBoundingClientRect();let u=o.left+l*o.width;let d=o.top+c*o.height;let f=parseInt(getComputedStyle(t).left,10);let h=parseInt(getComputedStyle(t).top,10);t.style.left=`${f+e.clientX-u}px`;t.style.top=`${h+e.clientY-d}px`;let p=Math.max(1,1/s);t.dataset.unzoomScale=p;WH.qsa("[data-unzoom]",t).forEach(n.bind(null,p))}),{passive:false});WH.onMutate(t,(e=>{let a=parseFloat(t.dataset.unzoomScale);WH.qsa("[data-unzoom]",t).forEach(n.bind(null,a))}),{attributes:true,attributeFilter:["data-unzoom"]})};this.onBodyAdd=function(e,a){if(document.body.contains(e)){window.requestAnimationFrame(a)}else{let i=t.bodyAddCallbacks.get(e)||[];i.push(a);t.bodyAddCallbacks.set(e,i)}};this.onBodyAvailable=e=>{if(document.body){requestAnimationFrame(e)}else{WH.aE(document,"bodyAvailable",e)}};this.scaleElementInParent=(e,t)=>{let a=()=>{e.style.transform="none";let a=e.getBoundingClientRect();e.style.transformOrigin="center";e.style.transform=`scale(${t})`;let i=e.getBoundingClientRect();let n=(i.width-a.width)/2;let s=(i.height-a.height)/2;e.style.margin=`${s}px ${n}px`};setTimeout((()=>{WH.onMutate(e,a);a()}))};this.setData=function(e,a,i){let n=t.nodeData.get(e);if(!n){n={};t.nodeData.set(e,n)}n[a]=i};this.setLoading=function(e,t){e.dataset.loading=t?"true":"false"};this.setRelativeHeight=function(e,t,a){e.style.paddingTop=a/t*100+"%"};this.setTemporaryIcon=function(e,t,a){if(a){e.classList.remove("fa-"+a)}else{e.classList.add("fa")}e.classList.add("fa-"+t);clearTimeout(e.temporaryIconTimer);e.temporaryIconTimer=setTimeout((function(){e.classList.remove("fa-"+t);if(a){e.classList.add("fa-"+a)}else{e.classList.remove("fa")}}),2500)};this.styleRangeElement=function(e){if(!e.style.setProperty){return}let t=function(){e.style.setProperty("--min",e.min);e.style.setProperty("--max",e.max);e.style.setProperty("--val",e.value)};WH.aE(e,"input",t);let a=Object.getPrototypeOf(e);["value","min","max"].forEach((function(i){let n=Object.getOwnPropertyDescriptor(a,i);Object.defineProperty(e,i,{get:function(){return n.get.apply(this,arguments)},set:function(){n.set.apply(this,arguments);t();return this[i]}})}));t()};this.touchGestures=function(e,t,a=.2,i=2){const n=0;const s=1;const r=2;let o,l;let c=n;e.style.position="relative";e.style.overflow="hidden";t.style.position="absolute";const u=e=>{const a=10;const i=e.touches[0].clientX-o;const n=e.touches[0].clientY-l;if(Math.abs(i)>a||Math.abs(n)>a){e.preventDefault();e.stopPropagation();t.style.left=`${i}px`;t.style.top=`${n}px`}};const d=e=>{};const f=e=>{if(c===s&&e.touches.length===1){u(e)}else if(c===r&&e.shiftKey===true||e.touches.length===2){}};const h=e=>{if(e.touches.length===1&&e.shiftKey!==true){c=s;o=e.touches[0].clientX-parseInt(getComputedStyle(t).left,10);l=e.touches[0].clientY-parseInt(getComputedStyle(t).top,10)}else if(e.touches.length===2||e.shiftKey===true){c=r}WH.aE(document,"touchmove",f,{passive:false});WH.aE(document,"touchend",(()=>{c=n;document.removeEventListener("touchmove",f)}),{once:true})};WH.aE(e,"touchstart",h,{passive:false})};function a(e){let t=[];let a;let i;let n=0;WH.qsa("option, optgroup",e).forEach((function(s){if(s.nodeName==="OPTGROUP"){a=s;i=[];t.push(Menu.createItem({label:s.label,submenu:i,options:{checkedFunc:function(t){return t[Menu.ITEM_SUBMENU].some((function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}))}}}));return}if(n===0&&!s.label){n++;return}if(a&&s.parentNode!==a){i=undefined;a=undefined}let r={checkedFunc:function(t){return t[Menu.ITEM_CRUMB]===e.selectedIndex}};if(s.dataset.tinyIcon){r.tinyIcon=s.dataset.tinyIcon}if(s.className){r.className=s.className}(i||t).push(Menu.createItem({crumb:n,label:s.dataset.menuLabel||s.label,url:function(t){e.selectedIndex=t;e.dispatchEvent(new Event("change"))}.bind(null,n),options:r}));n++}));return t}function i(e,t){let a=false;let i=WH.qs(".imitation-select-width",e);if(!i){WH.ae(e,i=WH.ce("span",{className:"imitation-select-width"}));a=true}for(let i,n=0;i=t[n];n++){let t=i.type==="characterData"?i.target.parentNode:i.target;if(t.nodeName!=="OPTION"&&t.nodeName!=="OPTGROUP"){continue}WH.qsa("option",e).forEach((function(t,i){if(t.label){a=true}if(t.selected){e.selectedIndex=i}}));break}if(a){WH.ee(i);WH.qsa("option",e).forEach((function(e,t){if(e.label){WH.ae(i,WH.ct(e.label));WH.ae(i,WH.ce("br"))}}))}}function n(){s();WH.aE(document,"selectstart",(function(e){let t=e.target;while(t){if(t.nodeName==="LABEL"||t.dataset&&t.dataset.preventSelectStart==="true"){e.preventDefault();break}t=t.parentNode}}));WH.onLoad(r)}function s(){if(!document.body){WH.aE(document,"bodyAvailable",s);return}let e=e=>{switch(e.nodeName){case"DATALIST":case"INPUT":case"TEXTAREA":WH.aE(e,["change","click","keydown","keyup"],o);o.call(e);break;case"SELECT":WH.aE(e,["change","click","keydown","keyup"],l);l.call(e)}};let a=e=>{let a=t.bodyAddCallbacks.get(e);if(a){t.bodyAddCallbacks.delete(e);while(a.length){a.shift()()}}};WH.onMutate(document.body,(function(t){t.forEach((t=>{t.addedNodes.forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE){e(t);a(t);if(t.childNodes){t.querySelectorAll("datalist, input, textarea, select").forEach(e);t.querySelectorAll("*").forEach(a)}}}))}))}));WH.qsa("datalist, input, textarea, select").forEach(e)}function r(){if(document.body.dataset.lazyLoading){return}if(typeof IntersectionObserver==="undefined"){WH.qsa(".lazy-load-background").forEach((function(e){e.classList.remove("lazy-load-background")}));document.body.dataset.lazyLoading="disabled";return}t.lazyCssObserver=new IntersectionObserver((function(e){let a=[];e.forEach((function(e){if(!e.isIntersecting||a.includes(e.target)){return}a.push(e.target);e.target.classList.remove("lazy-load-background");t.lazyCssObserver.unobserve(e.target)}))}));WH.qsa('[style*="url("]').forEach((function(e){if(e.style.backgroundImage){e.classList.add("lazy-load-background")}}));WH.qsa(".lazy-load-background").forEach((function(e){t.lazyCssObserver.observe(e)}));document.body.dataset.lazyLoading="ready"}function o(){this.dataset.fieldFilled=(this.value||"").trim()?"true":"false"}function l(){this.dataset.fieldFilled=(this.value||"").trim()&&(this.options[this.selectedIndex].text||"").trim()?"true":"false"}n()};WH.addCss=function(e){WH.ae(document.head,WH.ce("style",{type:"text/css"},WH.ct(e)))};WH.setTextNodes=function(e,t){if(e.nodeType==3){e.nodeValue=t}else{for(var a=0;a<e.childNodes.length;++a){WH.setTextNodes(e.childNodes[a],t)}}};WH.getFirstTextContent=function(e){for(var t=0;t<e.childNodes.length;++t){if(e.childNodes[t].nodeName=="#text"){return e.childNodes[t].nodeValue}var a=WH.getFirstTextContent(e.childNodes[t]);if(a){return a}}return false};WH.getTextContent=function(e){var t="";for(var a=0;a<e.childNodes.length;++a){if(e.childNodes[a].nodeValue){t+=e.childNodes[a].nodeValue}else if(e.childNodes[a].nodeName=="BR"){t+="\n"}t+=WH.getTextContent(e.childNodes[a])}return t};WH.toggleDisplay=function(e,t){var a=$(e);var i=a.is(":visible");if(t){a.slideToggle(150)}else{a.toggle()}if(!i){WH.Tools.Bloodmallet.updateChartsSizes(e)}return!i};WH.preventScroll=function(e,t){if(e){if(typeof t==="string"){t=WH.qs(t)}WH.preventScroll.allowedScrollArea=t;WH.aE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.aE(document.body,"touchmove",WH.preventScroll.cancelScroll)}else{WH.dE(document,"wheel",WH.preventScroll.cancelScroll,{passive:false,capture:false});WH.dE(document.body,"touchmove",WH.preventScroll.cancelScroll)}};WH.preventScroll.cancelScroll=function(e){if(WH.preventScroll.allowedScrollArea&&WH.preventScroll.allowedScrollArea.contains(e.target)){return}e.preventDefault();e.stopPropagation()};WH.safeFocus=function(e){if(!WH.Device.isTouch()){$(e).focus()}};WH.safeSelect=function(e){if(!WH.Device.isTouch()){$(e).select()}};WH.setCaretPosition=function(e,t){if(!e){return}if(e.createTextRange){var a=e.createTextRange();a.move("character",t);a.select()}else if(e.selectionStart!=undefined){e.focus();e.setSelectionRange(t,t)}else{e.focus()}};WH.insertTag=function(e,t,a,i){if(a==null){a=""}var n=WH.ge(e);n.focus();if(n.selectionStart!=null){var s=n.selectionStart,r=n.selectionEnd,o=n.scrollLeft,l=n.scrollTop;var c=n.value.substring(s,r);if(typeof i==="function"){c=i(c)}n.value=n.value.substr(0,s)+t+c+a+n.value.substr(r);n.selectionStart=n.selectionEnd=r+t.length;n.scrollLeft=o;n.scrollTop=l}else if(document.selection&&document.selection.createRange){var u=document.selection.createRange();if(u.parentElement()!=n){return}var c=u.text;if(typeof i==="function"){c=i(c)}u.text=t+c+a}if(n.onkeyup)n.onkeyup()};WH.onAfterTyping=function(e,t,a){let i;WH.aE(e,"keyup",(function(){if(i){clearTimeout(i)}i=setTimeout(t,a)}))};WH.isLeftClick=function(e){return!!(e&&e.button===0)};WH.preventEmptyFormSubmission=function(){if(!$.trim(this.elements[0].value)){return false}};var Draggable=new function(){var e={},t={},a,i;function n(t){if(this._handle){let e=t.target;let a=false;let i=0;while(e&&i<=3){if(e==this._handle){a=true;break}e=e.parentNode;i++}if(!a){return false}}a=this;e=WH.getCursorPos(t);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);if(a.onClick){a.onClick(t,a)}return false}function s(n){var s=WH.getCursorPos(n);if(a){if(Math.abs(s.x-e.x)>5||Math.abs(s.y-e.y)>5){o(n,a);a=null}}if(!i||!i._bounds)return false;var r=d(i),l=s.x-e.x,u=s.y-e.y;l=Math.max(i._bounds.x1-t.x,Math.min(i._bounds.x2-t.x-(r.x2-r.x1),l));u=Math.max(i._bounds.y1-t.y,Math.min(i._bounds.y2-t.y-(r.y2-r.y1),u));c(l,u);return false}function r(e){a=null;if(i)l(e)}function o(e,a){if(i)l(e);var n=WH.ac(a);t.x=n[0];t.y=n[1];if(a._targets.length){i=a.cloneNode(true);i._orig=a;WH.ae(document.body,i);c(-2323,-2323)}else i=a;WH.Tooltips.setEnabled(false);WH.Tooltip.hide();if(a.onDrag)a.onDrag(e,i,a);i._bounds=d(a._container);i.className+=" dragged"}function l(e){var t=false,a=WH.getCursorPos(e);if(i._orig&&i._orig._targets.length){u();var n={x1:i._x,x2:i._x+parseInt(i.offsetWidth),y1:i._y,y2:i._y+parseInt(i.offsetHeight)};WH.de(i);i=i._orig;for(var o=0,l=i._targets.length;o<l;++o){var c=i._targets[o],f=d(c);if(n.x2>=f.x1&&n.x1<f.x2&&n.y2>=f.y1&&n.y1<f.y2){t=true;if(i.onDrop)i.onDrop(e,i,c,a.x>=f.x1&&a.x<=f.x2&&a.y>=f.y1&&a.y<=f.y2);else WH.ae(c,i)}}}if(!t&&i.onDrop)i.onDrop(e,i,null);WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);WH.Tooltips.setEnabled(true);i.className=i.className.replace(/dragged/,"");i=null}function c(e,a){i.style.position="absolute";i.style.left=t.x+e+"px";i.style.top=t.y+a+"px";i._x=t.x+e;i._y=t.y+a}function u(){i.style.left="-2323px";i.style.top="-2323px"}function d(e){var t=WH.ac(e);return{x1:t[0],x2:t[0]+parseInt(e.offsetWidth),y1:t[1],y2:t[1]+parseInt(e.offsetHeight)}}this.init=function(e,t){e.onmousedown=n;if(!e._targets)e._targets=[];if(!e._container)e._container=document.body;if(t!=null){if(t.targets){for(var a=0,i=t.targets.length;a<i;++a)e._targets.push(WH.ge(t.targets[a]))}if(t.container)e._container=WH.ge(t.container);if(t.onClick)e.onClick=t.onClick;if(t.onDrop)e.onDrop=t.onDrop;if(t.onDrag)e.onDrag=t.onDrag}}};WH.Entity=new function(){const e=this;const t=WH.Icon;var a=[WH.Types.ADVENTURE_COMBATANT_ABILITY,WH.Types.AZERITE_ESSENCE,WH.Types.AZERITE_ESSENCE_POWER,WH.Types.GEAR_SET,WH.Types.GUIDE,WH.Types.PROFESSION_TRAIT,WH.Types.RESOURCE,WH.Types.STORYLINE,WH.Types.TRADING_POST_ACTIVITY,WH.Types.D4_AFFIX,WH.Types.D4_ASPECT,WH.Types.D4_BUILD,WH.Types.D4_ITEM,WH.Types.D4_PARAGON_GLYPH,WH.Types.D4_PARAGON_NODE,WH.Types.D4_SKILL,WH.Types.D4_VAMPIRIC_POWER,WH.Types.DI_EQUIP_ITEM,WH.Types.DI_MISC_ITEM,WH.Types.DI_NPC,WH.Types.DI_OBJECT,WH.Types.DI_PARAGON_SKILL,WH.Types.DI_QUEST,WH.Types.DI_SET,WH.Types.DI_SKILL,WH.Types.DI_ZONE];this.createIcon=function(a,i,n){n=n||{};let s=n.url===undefined?e.getUrl(i,n.id||a.id,a.name):n.url;delete n.id;delete n.url;return t.createByEntity(a,i,s,n)};this.getLink=function(t,a){let i=WH.Gatherer.getName(t,a);let n=WH.ce("a",{href:WH.Entity.getUrl(t,a,i||false)},WH.ct(i||e.getUnknownName(t,a)));let s=WH.Gatherer.get(t,a);if(s){if(s.icon){n.classList.add("icontinyl");n.style.backgroundImage="url("+WH.Icon.getIconUrl(s.icon,WH.Icon.TINY)+")"}if(s.quality!=null&&s.quality!==-1){n.classList.add("q"+s.quality)}}return n};this.getPlaceholderName=function(e,t){return WH.TERMS.openparenthesis_punct+WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+t+WH.TERMS.closedparenthesis_punct};this.getUnknownName=function(e,t){return WH.term("unknownEntityName_format",WH.Types.getUpperSingular(e),t)};this.getUrl=function(e,t,a,i,n,r){let o=s(e,t,a,i);if(WH.Types.existsInDataEnv(e,n)){return WH.Url.generate(o,{dataEnv:n,locale:r})}let l=WH.Types.getRequiredTrees(e);if(l&&l.length){return WH.Url.generate(o,{dataEnv:WH.getRootByTree(l[0]),locale:r})}return WH.Url.generate(o,{dataEnv:n,locale:r})};this.isReference=function(e){return/^[a-z-]+=-?\d+$/.test(e)};function i(e,t,a){var i="/"+WH.Types.getDetailPageName(e)+"="+t;if(!a&&a!==false){a=WH.Gatherer.getName(e,t)}if(a){i+="/"+WH.Strings.slug(a,true)}return i}function n(e,t,a){var i="/"+WH.Types.getDetailPageName(e)+"/";if(!a&&a!==false){a=WH.Gatherer.getName(e,t)}if(a){i+=WH.Strings.slug(a,true)+"-"+t}else{i+=t}return i}function s(e,t,s,r){let o;let l;switch(e){case WH.Types.PLAYER_CLASS:l=WH.Wow.PlayerClass.getSlug(t);break;case WH.Types.RACE:l=WH.Wow.Race.getSlug(t);break}if(l){o="/"+l}else if(a.indexOf(e)!==-1){o=n(e,t,s)}else{o=i(e,t,s)}if(typeof r==="string"){if(r!==""){o+="?"+r}}else if(r&&typeof r==="object"){r=WH.Url.buildQuery(r);if(r){o+="?"+r}}return o}};WH.Favorites=new function(){const e=this;const t={favorites:null,pageType:null,pageId:null,pageStar:null};this.pageInit=function(e,a,i){if(typeof e==="string"){e=WH.qs(e)}if(!e||typeof a!=="number"||typeof i!=="number"){return}t.pageType=a;t.pageId=i;u(e)};this.hasFavorites=function(){return t.favorites.length>0};this.getMenu=function(){o();let e=[];let a=0;let i=0;for(let n=0;n<t.favorites.length;n++){let s=t.favorites[n];if(!s.entities.length){continue}a++;let r=[];for(let e=0;e<s.entities.length;e++){let t=s.entities[e];let a=t[2]||WH.Entity.getUrl(s.id,t[0]);r.push([t[0],t[1],a]);i++}Menu.sort(r);e.push(Menu.createItem({crumb:s.id,label:WH.Types.getUpperPlural(s.id),submenu:r}))}Menu.sort(e);if(a===1&&i<=45||a===2&&a+i<=30||a>2&&a+i<=15){let t=[];for(let a=0;a<e.length;a++){let i=e[a];t.push([undefined,i[Menu.ITEM_LABEL]]);let n=Menu.getSubmenu(i);for(let e=0;e<n.length;e++){let a=n[e];let i=[a[Menu.ITEM_CRUMB],a[Menu.ITEM_LABEL],a[Menu.ITEM_URL]];if(a[Menu.ITEM_OPTIONS]){i[Menu.ITEM_OPTIONS]=a[Menu.ITEM_OPTIONS]}t.push(i)}}e=t}if(e.length&&WH.Theme.isStandardType()){e.unshift([0,WH.TERMS.favorites,null,null,{heading:true}])}return e};this.refreshMenu=function(){let t=WH.qs(".header-user-favorites");if(!t){return}let a=e.getMenu();if(!a.length){t.style.display="none";return}if(Menu.hasMenu(t)){Menu.replace(t,a,{padded:true})}else{Menu.add(t,a,{padded:true})}t.style.display=""};function a(a,n,s,o){let l=r(a,true);if(l===-1){return}let u=t.favorites[l].entities;for(let e=0;e<u.length;e++){if(!o&&u[e][0]===n){alert(WH.TERMS.entityalreadyfavorited_format.replace("%s",WH.Types.getLowerSingular(a)));return}}t.favorites[l].entities.push([n,s]);e.refreshMenu();if(!o){i("add",a,n,c.bind(null,a,n,s,true))}}function i(e,t,a,i){WH.fetch(WH.Url.generatePath("/account/favorites"),{method:"POST",json:{action:e,type:t,id:a,_csrf:g_user.sessionKey},error:function(n,s,r){i();WH.error("Error executing favorites action:",e,t,a,s,r);f(t,a)}})}function n(){let e=typeof g_pageInfo==="object"&&typeof g_pageInfo.type==="number"&&typeof g_pageInfo.typeId==="number"?WH.qs("#main-contents .heading-size-1"):null;if(!e){if(document.readyState!=="complete"){setTimeout(n,9)}return}o();t.pageType=g_pageInfo.type;t.pageId=g_pageInfo.typeId;u(e)}function s(e){for(let a=0;a<t.favorites.length;a++){if(t.favorites[a].id===e){return a}}return null}function r(e,a){let i=s(e);if(i!==null){return i}if(!a){return-1}t.favorites.push({id:e,entities:[]});t.favorites.sort((function(e,t){return WH.stringCompare(WH.Types.getUpperPlural(e.id),WH.Types.getUpperPlural(t.id))}));return s(e)}function o(){if(t.favorites===null){t.favorites=WH.getPageData("user.favorites")||[]}}function l(e,a){let i=r(e);if(i===-1){return false}let n=t.favorites[i].entities;for(let e=0;e<n.length;e++){if(n[e][0]===a){return true}}return false}function c(n,s,o,l){let c=r(n);if(c===-1){return}let u=t.favorites[c].entities;for(let r=0;r<u.length;r++){let d=u[r];if(d[0]===s){u.splice(r,1);if(!u.length){t.favorites.splice(c,1)}e.refreshMenu();if(!l){i("remove",n,s,a.bind(null,n,s,o,true))}break}}}function u(e){t.pageStar=WH.ce("span",{className:"fa fav-star"});WH.ae(e,t.pageStar);if(WH.userIsLoggedIn()&&g_user.sessionKey){t.pageStar.classList.add("fa-star"+(l(t.pageType,t.pageId)?"":"-o"));WH.aE(t.pageStar,"click",function(e,t,a){d(e,t,a);f(e,t);WH.Tooltip.hide()}.bind(null,t.pageType,t.pageId,e.textContent.trim().replace(/(.+)<.*/,"$1")));WH.Tooltip.simpleNonTouch(t.pageStar,(function(){let e=this.classList.contains("fa-star-o")?WH.TERMS.addtofavorites:WH.TERMS.removefromfavorites;return'<div class="no-wrap">'+e+"</div>"}),"q2")}else{t.pageStar.classList.add("fa-star-o");WH.aE(t.pageStar,"click",(function(){WH.goToLoginPage()}));WH.Tooltip.simpleNonTouch(t.pageStar,WH.TERMS.logintosavefavorites_tip+'<div class="q2" style="margin-top:10px">'+WH.TERMS.clicktologin_stc+"</div>")}}function d(e,t,i){if(l(e,t)){c(e,t,i)}else{a(e,t,i)}}function f(e,a){if(!t.pageStar){return}let i="fa-star-o";let n="fa-star";if(!l(e,a)){i="fa-star";n="fa-star-o"}t.pageStar.classList.remove(i);t.pageStar.classList.add(n)}n()};WH.Feedback=new function(){this.EMAIL_ADDR="feedback@wowhead.com"};var ContactTool=new function(){const e=this;this.MODE_COMMENT=1;this.MODE_POST=2;const t=10;const a=1e5;const i=1e3;const n=500;this.general=0;this.comment=1;this.post=2;this.screenshot=3;this.video=5;this.guide=6;var s;var r={0:[[1,true],[9,true],[2,true],[8,true],[3,true],[4,true],[5,true],[6,true],[7,true]],1:[[15,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[16,true],[18,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[19,function(e){return(e.roles&U_GROUP_MODERATOR)==0}],[20,function(e){return(e.roles&U_GROUP_MODERATOR)==0}]],2:[[30,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[37,function(e){return(e.roles&U_GROUP_MODERATOR)==0&&g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&g_users[e.user].avatar==2}],[31,true],[32,true],[33,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[34,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0&&e.op&&!e.sticky}],[35,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[36,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],3:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],5:[[45,true],[46,true],[47,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}],[48,function(e){return g_users&&g_users[e.user]&&(g_users[e.user].roles&U_GROUP_MODERATOR)==0}]],6:[[45,true],[46,true],[48,true]]};var o={1:WH.TERMS.captchaerror_tip,2:WH.TERMS.shortdescription_tip,3:WH.TERMS.contactreason_tip,7:WH.TERMS.alreadyreported_tip};var l=null;this.displayError=function(e,t){alert(t)};this.onShow=function(){if(location.hash&&location.hash!="#contact"){l=location.hash}if(this.data.mode==0){location.replace("#contact")}};this.onHide=function(){if(l&&(l.indexOf("screenshots:")==-1||l.indexOf("videos:")==-1)){WH.setHash(l)}else{WH.clearHash()}};this.onSubmit=function(e,t,a){if(e.submitting){return false}for(var i=0;i<a.elements.length;++i){a.elements[i].disabled=true}var n=["contact=1","mode="+WH.urlEncode(e.mode),"reason="+WH.urlEncode(e.reason),"desc="+WH.urlEncode(e.description),"ua="+WH.urlEncode(navigator.userAgent),"appname="+WH.urlEncode(navigator.appName),"page="+WH.urlEncode(e.currenturl)];if(e.mode==0){if(e.relatedurl){n.push("relatedurl="+WH.urlEncode(e.relatedurl))}if(e.email){n.push("email="+WH.urlEncode(e.email))}}else if(e.mode==1){n.push("id="+WH.urlEncode(e.comment.id))}else if(e.mode==2){n.push("id="+WH.urlEncode(e.post.id))}else if(e.mode==3){n.push("id="+WH.urlEncode(e.screenshot.id))}else if(e.mode==5){n.push("id="+WH.urlEncode(e.video.id))}else if(e.mode==6){n.push("id="+WH.urlEncode(e.guide))}if(e.reason===1||e.reason===9){var s="";if(!WH.WAS){s="Ads class not found. User may have ad blocking enabled. No ad log available."}else{var r=WH.WAS.getDfpLog();if(r&&r.length){s+="<br><b><i>DFP LOG</i></b><br>";for(var l=0,c;c=r[l];l++){s+="<br><b>"+c._time+"</b><br>";s+="<b>Unit:</b> "+c._env+" "+c._slot+"<br>";s+="<b>Channel:</b> "+c._channelName+" ("+c._channelGroup+")<br>";if(c._error){s+='<span style="color:'+WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_FAIL)+'"><b>Error:</b> '+c._error+"</span><br>"}delete c._time;delete c._env;delete c._slot;delete c._channelName;delete c._channelGroup;delete c._error;var u=WH.objectToArray(c,"property");for(var d=0,f;f=u[d];d++){s+="<b>"+f.property+":</b> "+JSON.stringify(f.value)+"<br>"}}}}if(!s){s="No ad data. Probably blocked by user."}n.push("adinfo="+encodeURIComponent(s));if(WH.LocalStorage.isSupported()){let e=localStorage.getItem("zafusr");if(e){n.push("zafusr="+encodeURIComponent(e))}}}e.submitting=true;var h=WH.Url.generatePath("/contactus");new Ajax(h,{method:"POST",params:n.join("&"),onSuccess:function(e,t){var a=e.responseText;if(a==0){if(g_user.name){alert(WH.sprintf(WH.TERMS.contactreceived_format,g_user.name))}else{alert(WH.TERMS.contactthanks_tip)}Lightbox.hide()}else{if(o[a]){alert(o[a])}else{alert("Error: "+a)}}},onFailure:function(e,t){alert("Failure submitting contact request: "+e.statusText)},onComplete:function(t,i){for(var n=0;n<a.elements.length;++n){a.elements[n].disabled=false}e.submitting=false}});return false};this.show=function(t){if(!t){t={}}let a={mode:0};WH.cO(a,t);a.reasons=r[a.mode];if(location.href.indexOf("#contact")!==-1){a.currenturl=location.href.substr(0,location.href.indexOf("#contact"))}else{a.currenturl=location.href}let i="contactus";if(a.mode!==0){i="reportform"}if(!s){e.init()}s.show(i,{data:a,onShow:e.onShow,onHide:e.onHide,onSubmit:e.onSubmit})};this.checkPound=function(){if(location.hash&&location.hash=="#contact"){ContactTool.show()}};this.init=function(){s=new Dialog;Dialog.templates.contactusEmailOnly={title:WH.TERMS.contactwowhead,width:550,buttons:[["x",WH.TERMS.cancel]],fields:[{id:"noemailwarning",type:"caption",compute:function(e,t,a,i){$(i).html('<b id="contact-emailwarn">'+WH.TERMS.contactDialogEmailOnly_tip.replace("%1$s",'<a href="mailto:'+WH.Feedback.EMAIL_ADDR+'">').replace("%2$s","</a>")+"</b>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){setTimeout(Lightbox.reveal,250)}};Dialog.templates.contactus={title:WH.TERMS.contactwowhead,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,required:1,options:[],compute:function(e,t,a,i){WH.ee(e);for(var n=0;n<this.data.reasons.length;++n){var s=this.data.reasons[n][0];var r=this.data.reasons[n][1];var o=false;if(typeof r=="function"){o=r(this.extra)}else{o=r}if(!o){continue}var l=WH.ce("option");l.value=s;if(t&&t==s){l.selected=true}WH.ae(l,WH.ct(c(s)));WH.ae(e,l)}e.onchange=function(){if(this.value==1||this.value==2||this.value==3){a.currenturl.parentNode.parentNode.style.display="";a.relatedurl.parentNode.parentNode.style.display=""}else if(this.value==9){a.currenturl.parentNode.parentNode.style.display="";a.relatedurl.parentNode.parentNode.style.display="none"}else{a.currenturl.parentNode.parentNode.style.display="none";a.relatedurl.parentNode.parentNode.style.display="none"}}.bind(e);i.style.width="98%"},validate:function(e,t,a){var i="";if(!e||e.length==0){i=WH.TERMS.contactreason_tip}if(i==""){return true}ContactTool.displayError(a.reason,i);WH.safeFocus(a.reason);return false}},{id:"currenturl",type:"text",disabled:true,label:WH.TERMS.currenturl_colon,size:40},{id:"relatedurl",type:"text",label:WH.TERMS.relatedurl_colon,caption:WH.TERMS.optional,size:40,validate:function(e,t,a){var i="";var s=/^(http(s?)\:\/\/|\/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((\/?\w+\/)+|\/?)(\w+\.[\w]{3,4})?((\?\w+=\w+)?(&\w+=\w+)*)?/;e=e.trim();if(e.length>=n){i=WH.TERMS.relatedurl_tip}else if(e.length>0&&!s.test(e)){i=WH.TERMS.entervalidurl_tip}if(i==""){return true}ContactTool.displayError(a.relatedurl,i);WH.safeFocus(a.relatedurl);return false}},{id:"email",type:"text",label:WH.TERMS.emailaddress_colon,caption:WH.TERMS.emailcontact_tip,compute:function(e,t,a,i,n){var s=function(){$("#contact-emailwarn").css("display",WH.isEmailValid($(a.email).val())?"none":"");Lightbox.reveal()};$(e).keyup(s).blur(s)},validate:function(e,t,a){var i="";e=e.trim();if(e.length>=100){i=WH.TERMS.emailaddresslength_tip}else if(e.length>0&&!WH.isEmailValid(e)){i=WH.TERMS.entervalidemail_tip}if(i==""){return true}ContactTool.displayError(a.email,i);WH.safeFocus(a.email);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",maxLength:a,required:1,size:[10,30],validate:function(e,i,n){var s="";e=e.trim();if(e.length<t||e.length>a){s=WH.TERMS.shortdescription_tip}if(s==""){return true}ContactTool.displayError(n.description,s);WH.safeFocus(n.description);return false}},{id:"noemailwarning",type:"caption",compute:function(e,t,a,i){$(i).html('<span id="contact-emailwarn" class="q10">'+WH.TERMS.noemailwarning_tip+"</span>").css("white-space","normal").css("padding","0 4px")}}],onInit:function(e){},onShow:function(e){if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(e["reason"]&&!e.reason.value){setTimeout(e.reason.focus.bind(e.reason),10)}else if(e["relatedurl"]&&!e.relatedurl.value){setTimeout(e.relatedurl.focus.bind(e.relatedurl),10)}else if(e["email"]&&!e.email.value){setTimeout(e.email.focus.bind(e.email),10)}else if(e["description"]&&!e.description.value){setTimeout(e.description.focus.bind(e.description),10)}setTimeout(Lightbox.reveal,250)}};Dialog.templates.reportform={title:WH.TERMS.report,width:550,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"reason",type:"select",label:WH.TERMS.reason_colon,options:[],compute:function(e,t,a,i){let n;switch(this.data.mode){case 1:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.comment.user));a.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportcomment_format,'<a href="'+n+'">'+this.data.comment.user+"</a>");break;case 2:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.post.user));var s='<a href="'+n+'">'+this.data.post.user+"</a>";if(this.data.post.op){a.firstChild.innerHTML=WH.sprintf(WH.TERMS.reporttopic_format,s)}else{a.firstChild.innerHTML=WH.sprintf(WH.TERMS.reportpost_format,s)}break;case 3:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.screenshot.user));a.firstChild.innerHTML=WH.sprintf(WH.TERMS.screenshotreport_format,'<a href="'+n+'">'+this.data.screenshot.user+"</a>");break;case 5:n=WH.Strings.escapeHtml(WH.Url.generatePath("/user="+this.data.video.user));a.firstChild.innerHTML=WH.sprintf(WH.TERMS.videoreport_format,'<a href="'+n+'">'+this.data.video.user+"</a>");break;case 6:a.firstChild.innerHTML="Report guide";break}a.firstChild.setAttribute("style","");WH.ee(e);var r;if(this.data.mode==1){r=this.data.comment}else if(this.data.mode==2){r=this.data.post}else if(this.data.mode==3){r=this.data.screenshot}else if(this.data.mode==5){r=this.data.video}else if(this.data.mode==6){r=this.data.guide}WH.ae(e,WH.ce("option",{selected:!t,value:-1}));for(var o=0;o<this.data.reasons.length;++o){var l=this.data.reasons[o][0];var u=this.data.reasons[o][1];var d=false;if(typeof u=="function"){d=u(r)}else{d=u}if(!d){continue}var f=WH.ce("option");f.value=l;if(t&&t==l){f.selected=true}WH.ae(f,WH.ct(c(l)));WH.ae(e,f)}i.style.width="98%"},validate:function(e,t,a){var i="";if(!e||e==-1||e.length==0){i=WH.TERMS.contactreason_tip}if(i==""){return true}ContactTool.displayError(a.reason,i);WH.safeFocus(a.reason);return false}},{id:"description",type:"textarea",caption:WH.TERMS.bespecific_tip,width:"98%",maxLength:i,required:1,size:[10,30],validate:function(e,a,n){var s="";e=e.trim();if(e.length<t||e.length>i){s=WH.TERMS.shortdescription_tip}if(s==""){return true}ContactTool.displayError(n.description,s);WH.safeFocus(n.description);return false}}],onInit:function(e){},onShow:function(e){let t=WH.qs('*[name="reason"]',e);let a=WH.qs('*[name="description"]',e);if(this.data.focus&&e[this.data.focus]){setTimeout(WH.setCaretPosition.bind(null,e[this.data.focus],e[this.data.focus].value.length),100)}else if(!t.value){setTimeout(t.focus.bind(t),10)}else if(!a.value){setTimeout(a.focus.bind(a),10)}}}};function c(e){return(WH.getPageData("contactReasons")||{})[e]||WH.TERMS.unknown}WH.onLoad(this.checkPound)};WH.Gatherer=new function(){var requested={};this.addData=function(e,t,a){g_gathered_types[e]=g_gathered_types[e]||{};let i=g_gathered_types[e];for(let e in a){if(!a.hasOwnProperty(e)){continue}if(t===WH.getDataEnv()){if(!i.hasOwnProperty(e)){i[e]=a[e]}else{WH.cO(i[e],a[e])}}else{let n=getEnvKey(t);if(!i.hasOwnProperty(e)){i[e]=a[e];i[e][n]=WH.cO({},a[e])}else{if(!i[e].hasOwnProperty(n)){i[e][n]={}}WH.cO(i[e][n],a[e]);for(let t in a[e]){if(!a[e].hasOwnProperty(t)){continue}if(!i[e].hasOwnProperty(t)){i[e][t]=a[e][t]}}}}}};this.fetchItems=function(e,t){fetchData("items",e,t)};this.fetchSpells=function(e,t){fetchData("spells",e,t)};this.get=function(e,t,a,i){if(!g_gathered_types.hasOwnProperty(e)){return undefined}var n=g_gathered_types[e][t];if(n===undefined||!a||a===WH.getDataEnv()){return n}var s=getEnvKey(a);var r=i?undefined:n;return n.hasOwnProperty(s)?n[s]:r};this.getIconName=function(e,t){return g_gathered_types?.[e]?.[t]?.icon||WH.Icon.UNKNOWN};this.getIconNameNoFallback=function(e,t){return g_gathered_types?.[e]?.[t]?.icon||undefined};this.getName=function(e,t){if(!g_gathered_types[e]||!g_gathered_types[e][t]){switch(e){case WH.Types.RACE:return WH.Wow.Race.getName(t)||null;case WH.Types.PLAYER_CLASS:return WH.Wow.PlayerClass.getName(t);case WH.Types.CURRENCY:return WH.Wow.Currency.getName(t);case WH.Types.ZONE:return WH.Wow.Area.getName(t);case WH.Types.HUNTER_PET:return WH.Wow.Pet.getName(t);case WH.Types.SKILL:return WH.Wow.Skill.getName(t)}return null}if(g_gathered_types[e][t].name){return g_gathered_types[e][t].name}return g_gathered_types[e][t]["name_"+Locale.getName()]||null};function fetchData(type,entityIDs,options){if(!options){options={}}var entityArray=prepareEntityArray(type,entityIDs,options);if(!entityArray.length){switch(typeof options.onSuccess){case"string":eval(options.onSuccess+"()");break;case"function":options.onSuccess();break}return}entityArray.sort();var url=WH.Url.generatePath("/gatherer?"+type+"="+entityArray.join(","));if(typeof options.onSuccess=="string"){url+="&callback="+options.onSuccess}var callback=typeof options.onSuccess=="function"?options.onSuccess:null;$.getScript(WH.Url.generatePath(url),callback)}function getEnvKey(e){return"_dataEnv_"+WH.dataEnvKey[e]}function prepareEntityArray(e,t,a){if(!requested[e]){requested[e]={}}if(t instanceof Array){var i=[];for(var n=0,s;s=t[n];n++){if(validateID(s)){if(requested[e][s]&&!a.forceRequest){}else{requested[e][s]=true;i.push(s)}}}return i}else if(validateID(t)){if(requested[e][t]&&!a.forceRequest){return[]}else{requested[e][t]=true;return[t]}}else{WH.error("Gatherer requires an array of IDs or single ID.");return[]}}function validateID(e){return typeof e=="number"||typeof e=="string"&&!e.match(/[^0-9]/)}};WH.GlobalStrings=WH.GlobalStrings||{};(function(){if(typeof Proxy!=="function"){return}var e=WH.GlobalStrings;WH.GlobalStrings=new Proxy(e,{get:function(e,t){return e[t]||t}})})();WH.Guide=new function(){this.ROLES_MANAGER=U_GROUP_EMPLOYEE;this.ROLES_EDITOR=this.ROLES_MANAGER|U_GROUP_EDITOR;const e=WH.getPageData("guides.statusNames");this.getStatusName=function(t){return(e||[])[t]}};function GetStars(e,t,a,i){var n=5;var s=e;if(a){e=a}e=Math.round(e*2)/2;var r=Math.round(e);var o=$("<span>").addClass("stars").addClass("max-"+n).addClass("stars-"+r);if(!g_user.id){t=false}if(t){o.addClass("ratable")}if(a){o.addClass("rated")}var l="<span>";var c=e;for(var u=1;u<=n;++u){if(c<1&&c>0){l+='<b class="stars-half">'}else if(c<=0){l+='<b class="stars-empty">'}else{l+='<b class="stars-full">'}c--;l+='<i class="fa fa-star"></i><i class="fa fa-star-o"></i><i class="fa fa-star-half"></i>'}for(var u=1;u<=n;++u){l+="</b>"}l+="</span>";o.append(l);if(t){var d=0;$("b",o).each((function(){var e=++d;$("> i",this).click((function(){VoteGuide(i,s,e);return false}))}))}if(a){var f=$("<span>").addClass("clear fa fa-times-circle").click((function(){VoteGuide(i,s,0)}));o.append(f)}if(e>=0)o.mouseover((function(t){WH.Tooltip.showAtCursor(t,"Rating:&nbsp;"+e+"&nbsp;/&nbsp;"+n,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));return o}function VoteGuide(guideId,oldRating,newRating){$("#guiderating").html(GetStars(oldRating,true,newRating,guideId));$.ajax({cache:false,url:WH.Url.generatePath("/guide=vote"),type:"POST",error:function(){$("#guiderating").html(GetStars(oldRating,true,0,guideId));alert("Voting failed. Try again later.")},success:function(json){var data=eval("("+json+")");$("#guiderating-value").text(data.rating);$("#guiderating-votes").text(WH.getN5(data.nvotes))},data:{id:guideId,rating:newRating}})}WH.Highlight=function(e,t,a,i){const n=WH.LocalStorage;const s={buttonSize:undefined,class:undefined,closeButtonText:undefined,contents:undefined,elements:{target:undefined,wrapper:undefined},extraButtons:[],fixedPosition:false,id:e,position:undefined,useLocalStorage:true};function r(e,t,a){a=a||{};if(a.hasOwnProperty("useLocalStorage")){s.useLocalStorage=a.useLocalStorage}if(s.useLocalStorage){let e=n.get(n.KEY_HIGHLIGHTS_CLOSED);if(Array.isArray(e)&&e.includes(s.id)){return}}else{let e=WH.qs(`.element-highlight[data-id="${s.id}"]`);if(e){WH.de(e)}}s.elements.target=$(e);if(!s.elements.target.length||!s.elements.target.is(":visible")){return}s.fixedPosition=WH.isElementPositionFixedOrSticky(s.elements.target[0]);if(typeof a.buttonSize==="string"){s.buttonSize=a.buttonSize}if(a.extraButtons instanceof Array){s.extraButtons=a.extraButtons}if(typeof a["class"]==="string"){s["class"]=a["class"]}s.contents=t;s.closeButtonText=a.closeButtonText||WH.TERMS.gotIt_exclamation;s.position=["bottom","left","right","top"].indexOf(a.position)!==-1?a.position:"bottom";l();o()}function o(){$(window).resize((function(){var e=document.querySelectorAll(".element-highlight");for(var t=0,a=e.length;t<a;t++){WH.de(e[t])}}));o=function(){}}function l(){var e=s.fixedPosition?s.elements.target[0].getBoundingClientRect():s.elements.target.offset();var t=s.elements.target.outerHeight();var a=s.elements.target.outerWidth();s.elements.wrapper=$("<div/>",{class:"element-highlight",css:{left:e.left+"px",top:e.top+"px"},"data-id":s.id});if(s.fixedPosition){s.elements.wrapper.css("position","fixed")}$("<div/>",{class:"element-highlight-highlighter",css:{height:t+"px",width:a+"px","border-radius":s.elements.target.css("border-radius")}}).appendTo(s.elements.wrapper);var i={};switch(s.position){case"bottom":i.left=a/2+"px";i.top=t+"px";break;case"left":i.right="0px";i.top=t/2+"px";break;case"right":i.left=a+"px";i.top=t/2+"px";break;case"top":i.bottom="0px";i.left=a/2+"px";break}var n=$("<div/>",{class:"element-highlight-dialog",css:i,"data-position":s.position}).appendTo(s.elements.wrapper);var r=$("<div/>",{class:"element-highlight-dialog-content","data-buttons":s.extraButtons.length+1}).appendTo(n);if(s["class"]){s.elements.wrapper.addClass(s["class"])}if(typeof s.contents==="string"){r.text(s.contents)}else{$(s.contents).appendTo(r)}var o=$("<div/>",{class:"element-highlight-dialog-content-buttons"}).appendTo(r);if(s.extraButtons.length){for(var l=0,u=s.extraButtons.length;l<u;l++){var d=s.extraButtons[l];if(!d.url&&!d.action){continue}var f=$("<a/>",{class:"element-highlight-dialog-content-button btn btn-site",text:d.text}).appendTo(o);if(d.url){f.attr("href",d.url)}if(d.action){f.click(d.action)}if(s.buttonSize){f.addClass("btn-"+s.buttonSize)}}}var h=$("<a/>",{class:"element-highlight-dialog-content-close btn btn-site",text:s.closeButtonText,click:c}).appendTo(o);if(s.buttonSize){h.addClass("btn-"+s.buttonSize)}s.elements.wrapper.appendTo(document.body);switch(s.position){case"left":case"right":setTimeout((function(){r.css("top","-"+r.outerHeight()/2+"px")}),0);break}}function c(){s.elements.wrapper.fadeOut((function(){$(this).remove()}));if(s.useLocalStorage){let e=n.get(n.KEY_HIGHLIGHTS_CLOSED);if(!Array.isArray(e)){e=[]}if(!e.includes(s.id)){e.push(s.id)}n.set(n.KEY_HIGHLIGHTS_CLOSED,e)}}r(t,a,i)};WH.jQuery=new function(){this.formatJqxhrMessage=function(e){let t=[];if(e.status){t.push("status: ["+e.status+"]")}if(e.statusText){t.push("statusText: ["+e.statusText+"]")}if(e.responseJSON&&e.responseJSON.error){t.push("responseJSON.error: ["+e.responseJSON.error+"]")}else if(e.responseText){t.push("responseText: ["+e.responseText+"]")}return t.join(", ")}};WH.Layout=new function(){const e=this;const t=WH.Device;const a=WH.DOM;const i=WH.Game;const n=WH.LocalStorage;const s=WH.SessionStorage;this.EVENT_FULLSCREEN_MODE_CHANGED="wh-layout-fullscreen-mode-changed";const r={activeNavItem:null,autoSearchFocus:true,breadcrumb:null,checkedMenuItems:[],disableLayoutAnimation:0,elements:{$breadcrumb:$('<div class="breadcrumb"/>'),header:undefined,headerNav:undefined,"header-search":undefined,"header-wrapper":undefined,layout:undefined,"main-contents":undefined,"page-content":undefined,sidebar:undefined,sidebarWrapper:undefined},forcedFullscreenMode:false,fullscreenMode:undefined,fullscreenModeDefault:false,fullscreenModeLocalStorageKey:null,initialized:false,navMenusAttached:false,pageName:null,sidebarTrackCount:1};this.addShareLinks=function(e,t,a){e=typeof e==="string"?e.replace(/\./g,"\\."):e;let i=$("<div>",{class:"share-links"}).prependTo(e);let n=WH.ShareServices.getShareServices(t,WH.ShareServices.getSubredditByNewsType(a));for(let e=0,t=n.length;e<t;e++){let t=n[e].type==="permalink"?WH.term("copy_format",n[e].name):WH.Strings.sprintf(WH.TERMS.shareon_format,n[e].name);let a=$("<a>",{class:"fa fa-"+n[e].fontIcon,href:n[e].url,rel:"np",target:"_blank"}).appendTo(i);WH.Tooltip.simple(a[0],t,"q2");if(n[e].type==="permalink"){WH.aE(a[0],"click",(t=>{t.preventDefault();WH.copyToClipboard(n[e].url,t)}))}}};this.disableLayoutAnimation=function(){document.body.dataset.disableLayoutAnimation="true";r.disableLayoutAnimation++};this.enableLayoutAnimation=function(){if(r.disableLayoutAnimation===0||--r.disableLayoutAnimation===0){delete document.body.dataset.disableLayoutAnimation}};this.expandContent=()=>WH.WAS.remove("vertical");this.expandContentVertically=()=>WH.WAS.remove("responsive");this.expandSite=function(t){if(!WH.WAS||!document.body){WH.aE(document,"bodyAvailable",e.expandSite.bind(this,t));return}if(!WH.WAS.showAds()){return}t=t!==false;if(!t){e.disableLayoutAnimation();setTimeout((function(){requestAnimationFrame(e.enableLayoutAnimation)}),10)}WH.WAS.removeAll(t);document.body.dataset.showSideExpander="false";document.body.classList.add("no-ads-breadcrumb");setTimeout((function(){document.body.classList.remove("has-ads");document.body.classList.add("no-ads")}),(t?WH.WAS.ANIMATION_DURATION_MS:0)+1)};this.getBreadcrumb=function(){return r.elements.$breadcrumb};this.getEnvSwitcherUrl=e=>{const t=WH.Url;let a=WH.getDataTree(e);let i=(WH.PageMeta.disabledInTrees||[]).includes(a)?"/":t.removePathPrefixes(location.pathname);i=t.getAlternatePathCommand(e,i)??i;let n=location.search;if(i!=="/"){switch(WH.getDataTree()){case WH.dataTree.CLASSIC:n+=(n?"&":"?")+"fromClassic";break;case WH.dataTree.TBC:n+=(n?"&":"?")+"fromBurningCrusade";break;case WH.dataTree.WRATH:n+=(n?"&":"?")+"fromWrath";break}}return t.generate(i,{dataEnv:e})+n+location.hash};this.getElement=function(e){if(!r.elements.hasOwnProperty(e)){WH.error("Requested unsupported element.",e);return null}if(r.elements[e]===undefined){r.elements[e]=WH.qs("."+e);if(!r.elements[e]){if(document.readyState!=="complete"){r.elements[e]=undefined}else{r.elements[e]=null}}}return r.elements[e]};this.getFaviconUrl=(e,t)=>`${WH.STATIC_URL}/images/logos/favicon-${e}-${t||32}.png`;this.getFullscreenMode=function(){if(r.forcedFullscreenMode){return true}if(r.fullscreenMode===undefined){r.fullscreenMode=m()}return r.fullscreenMode};this.getHeaderBottom=()=>ZUL.getEnabled()?ZUL.HEIGHT:e.getElement("header-wrapper")?.getBoundingClientRect().bottom||0;this.getPageName=function(){return r.pageName||null};this.getShareTypes=function(){let e=["twitter","facebook","reddit"];if(Locale.get().id===LOCALE_RURU){e.unshift("vk")}return e};this.init=function(){r.elements.sidebar=WH.qs(".sidebar");_();let e=v();T();g();WH.Layout.Responsive.init(e);S();r.initialized=true};this.initPageState=(a,i,n)=>{if(Locale.exists(a)){Locale.set(a)}if(n!==false){ZUL.init(i)}c();let s=t.isMobile()?"mobile":t.isTablet()?"tablet":"pointer";document.documentElement.classList.add(s+"-device");if(t.isTouch()){document.documentElement.classList.add("touch-device")}N();C();e.initPageState=()=>{}};this.initSidebar=function(){if(!WH.WAS.showAds()){return}if(t.isTouch()||window.innerWidth<=WH.Responsive.SIDEBAR_REMOVAL_BREAKPOINT){WH.WAS.remove("vertical");WH.de(".header-expand-site-tab")}else{r.elements.sidebarWrapper=WH.qs(".sidebar-wrapper");WH.DynamicFixedElement.init("sidebar",".sidebar");let e=new ResizeObserver((t=>{t.forEach((t=>{if(t.contentRect.height>=window.innerHeight*3&&r.sidebarTrackCount===1){o();e.disconnect()}}))}));e.observe(r.elements.sidebarWrapper);let t=new ResizeObserver((e=>{e.forEach((()=>{if(window.innerWidth<=WH.Responsive.SIDEBAR_REMOVAL_BREAKPOINT){WH.WAS.remove("vertical");t.disconnect()}}))}));t.observe(r.elements.sidebarWrapper)}};this.locateBreadcrumb=function(){let t=Menu.getFullPath(Menu.getMenu(),r.breadcrumb);if(!t.length){return}if(!g_pageInfo||!g_pageInfo.hasOwnProperty("typeId")){return}let a=new RegExp("\\b"+WH.Types.getDetailPageName(g_pageInfo.type)+"="+g_pageInfo.typeId+"\\b");let i=JSON.parse(JSON.stringify(r.breadcrumb));i.pop();let n=false;let s=function(e){i.push(e[Menu.ITEM_CRUMB]);let t=Menu.getSubmenu(e);if(t&&t.length){for(let e=0,a=t.length;e<a&&!n;e++){s(t[e])}}else{n|=e.length>2&&a.test(e[Menu.ITEM_URL])}if(!n){i.pop()}};s(t.pop());if(n){r.breadcrumb=i;e.updateBreadcrumb()}};this.onHeaderBottomMove=t=>{const i="onHeaderBottomMove resize observer attached";const n="onHeaderBottomMove callbacks";let s=e.getElement("header-wrapper");if(a.getData(s,i)!==true){WH.aE(s,"resize",(()=>{(a.getData(s,n)??[]).forEach((t=>t(e.getHeaderBottom())))}));a.setData(s,i,true)}let r=a.getData(s,n)??[];r.push(t);a.setData(s,n,r);t(e.getHeaderBottom())};this.set=function(t){if(!t){return}let a=false;if(t.hasOwnProperty("activeTab")&&r.activeNavItem!==t.activeTab){r.activeNavItem=typeof t.activeTab==="string"&&t.activeTab.match(/^\d+$/)?parseInt(t.activeTab):t.activeTab;a=true}let i=false;if(t.hasOwnProperty("breadcrumb")&&JSON.stringify(r.breadcrumb)!==JSON.stringify(t.breadcrumb)){r.breadcrumb=t.breadcrumb;i=true}if(t.hasOwnProperty("pageName")){r.pageName=t.pageName}if(t.hasOwnProperty("autoSearchFocus")){r.autoSearchFocus=t.autoSearchFocus}if(r.initialized){if(a){O()}if(i){e.updateBreadcrumb()}}};this.setForcedFullscreenMode=function(t){let a=e.getFullscreenMode();r.forcedFullscreenMode=t;if(e.getFullscreenMode()!==a){C()}else{document.body.dataset.forcedFullscreenMode=JSON.stringify(t)}};this.setFullscreenMode=function(t){let a=e.getFullscreenMode();r.fullscreenMode=t;let i=t?r.fullscreenModeDefault===false&&p()===false?"Re-enabled":"Enabled":r.fullscreenModeDefault===true&&p()===true?"Re-disabled":"Disabled";n.set(d(),!!t);WH.Track.interactiveEvent("Changed Option","Fullscreen Mode",i);if(e.getFullscreenMode()!==a){C()}};this.setFullscreenModeLocalStorageKey=function(t,a){let i=e.getFullscreenMode();r.fullscreenModeLocalStorageKey=t;r.fullscreenModeDefault=t===null||typeof a!=="boolean"?false:a;r.fullscreenMode=undefined;if(e.getFullscreenMode()!==i){C()}};this.setTitle=e=>{if(e.includes(WH.TERMS.wowhead)){document.title=e;return}let t=(e=>({[WH.dataEnv.MAIN]:WH.term("worldofwarcraft"),[WH.dataEnv.PTR]:WH.term("ptrVersion_format",WH.Wow.getVersionString(e)),[WH.dataEnv.PTR2]:WH.term("ptrVersion_format",WH.Wow.getVersionString(e)),[WH.dataEnv.BETA]:WH.term("betaVersion_format",WH.Wow.getVersionString(e)),[WH.dataEnv.CLASSIC]:WH.term("classicworldofwarcraft")}[e]||WH.Seo.getDataEnvName(e)))(WH.getDataEnv());if(e.includes(t)){document.title=e}else{document.title=e+WH.TERMS.hyphen_punct+t}};this.toggleFullscreenMode=function(){e.setFullscreenMode(!m())};this.updateBreadcrumb=function(){if(!r.breadcrumb||!r.breadcrumb.length){r.elements.$breadcrumb.detach();setTimeout((function(){if(r.elements.$breadcrumb.is(":empty")){r.elements.$breadcrumb.detach()}}),0);return}r.elements.$breadcrumb.empty();if(r.checkedMenuItems.length){$.each(r.checkedMenuItems,(function(){this.checked=false;Menu.updateItem(this)}));r.checkedMenuItems=[]}let e=Menu.getFullPath(Menu.getMenu(),r.breadcrumb);if(!e.length){return}let t=e.length-1;let a=[];for(let i=0,n=e.length;i<n;i++){let n=e[i];let s=Menu.getItemOptions(n);n.checked=true;if(n[Menu.ITEM_OPTIONS]&&n[Menu.ITEM_OPTIONS].breadcrumbParent||e[i+1]&&e[i+1][Menu.ITEM_OPTIONS]&&e[i+1][Menu.ITEM_OPTIONS].breadcrumbParent){if(!n[Menu.ITEM_OPTIONS]){n[Menu.ITEM_OPTIONS]={}}n[Menu.ITEM_OPTIONS].checkedFunc=function(e){let t=$("#main-precontents .breadcrumb span a.open");return t.text()===e[Menu.ITEM_LABEL]}}r.checkedMenuItems.push(n);Menu.updateItem(n);let o=h();let l=o;let c=Menu.getItemUrl(n);if(typeof c==="string"){c=WH.ensureUrlProtocol(c);l=$("<a/>",{href:c,rel:"np"}).appendTo(o)}else{c=undefined}let u=Menu.getLabel(n,true);l.text(u);Menu.add(l,n.parentMenu);o.appendTo(r.elements.$breadcrumb);a.push({name:u,url:c,image:s.tinyIcon?WH.ensureUrlProtocol(WH.Icon.getIconUrl(s.tinyIcon,WH.Icon.MEDIUM)):undefined});if(s.onBreadcrumbDisplay){s.onBreadcrumbDisplay(r.breadcrumb)}let d=Menu.getSubmenu(n);if(i===t&&d){o.addClass("breadcrumb-arrow");let e=$('<span class="breadcrumb-ellipsis">...</span>');Menu.add(e,d);e.appendTo(r.elements.$breadcrumb)}}WH.Seo.addJsonLdBreadcrumb(a);r.elements.$breadcrumb.trigger("update");if(!r.elements.$breadcrumb.is(":empty")){r.elements.$breadcrumb.appendTo("#main-precontents");r.elements.$breadcrumb.show()}ZUL.regenerateMenu()};this.updateContentHeight=function(){let t=WH.qs(".main-contents");let i=r.elements.sidebar;let n=!t||!i;if(!WH.WAS.showAds()){n=true;e.updateContentHeight=function(){}}if(n){if(t&&t.style.minHeight){t.style.minHeight=""}return}let s=a.getInnerHeight(t);let o=t.offsetHeight-s;let l=a.getInnerHeight(i)-o;let c=WH.ge("main-precontents");if(c){l-=c.offsetHeight}if(s<l){t.style.minHeight=l+"px"}};this.updateDataEnvLink=function(t,a){if(t.dataset.disabled==="true"){delete t.href;return}t.href=e.getEnvSwitcherUrl(a)};this.updateSearchWidth=function(e){if(!WH.Theme.isStandardType()){return}let t=WH.qs(".header");let a=WH.qs(".header-right");let i=WH.qs(".header-user");let n=WH.qs(".header-search");let s=WH.qs(".header-search form");let r=WH.qs('.header-search input[type="text"]');let o=WH.qs(".header-search-button");if(t&&a&&i&&n&&s&&r&&o){let e=n.getBoundingClientRect().left-t.getBoundingClientRect().left;let l=window.getComputedStyle(a).getPropertyValue("left");s.style.position="absolute";s.style.top=o.style.top="10px";s.style.left=o.style.left=e-parseInt(l)+"px";s.style.right=a.getBoundingClientRect().right-i.getBoundingClientRect().left+"px";r.style.width="100%"}if(e!==false){WH.Layout.Responsive.check()}};this.useAlternateSwitcherPathCommand=(e,t)=>WH.Url.getAlternatePathCommand(e,t)!==undefined;function o(){r.sidebarTrackCount=2;let e=WH.ce("div",{classList:"sidebar-track",dataset:{trackId:2}});let t=WH.ce("div",{classList:"sidebar-2"});WH.ae(r.elements.sidebarWrapper,e);WH.ae(e,t);WH.DynamicFixedElement.init("sidebar-2",".sidebar-2");w();let a=false;if(e.getBoundingClientRect().top<window.innerHeight){WH.WAS.assign("verticalBTF",t,{height:600,width:300});a=true}else{WH.aE(window,"scroll",(()=>{if(a){return}if(e.getBoundingClientRect().top<window.innerHeight){WH.WAS.assign("verticalBTF",t,{height:600,width:300});a=true}}))}WH.aE(window,WH.WAS.EVENT_SIDEBAR_2_REMOVED,(()=>{WH.de(e);r.sidebarTrackCount=1;r.elements.sidebar.parentNode.style.height=null}))}function l(){let e=location.pathname+location.search;let t=e.indexOf("?")!==-1||e.indexOf("&")!==-1?"&":"?";e+=t+"classicRedirect";e+=location.hash;location.href=WH.Url.generate(e,{dataEnv:WH.PageMeta.classicDataEnv,locale:Locale.getId()})}function c(){let e=Locale.getPreferred();if(e===undefined){return}Locale.setPreferred(e);if(e===Locale.getId()){return}if(!document.referrer){return}let t;try{t=new URL(document.referrer)}catch(e){return}if(/\.wowhead\.com$/.test("."+t.hostname)){return}if(Locale.getDataEnvForcedLocale(WH.getDataEnv())){return}if(location.href.indexOf(location.origin)!==0){WH.warn("Could not determine path by removing origin",location);return}let a=WH.Url.generate(location.href.substr(location.origin.length),{locale:e});if(location.href!==a){location.href=a}}function u(){return n.get(n.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC)===true}function d(){return r.fullscreenModeLocalStorageKey||n.KEY_LAYOUT_FULLSCREEN}function f(e){let t=Menu.getItemOptions(e);let a=WH.ce("a",{className:t.headerNavIcon?"header-nav-icon":"header-nav-text",href:e[Menu.ITEM_URL],rel:"np"});if(!e[Menu.ITEM_URL]){a.href="javascript:";a.className+=" unlinked"}if(t.className){a.className+=" "+t.className}if(t.title){a.title=t.title}let i=Menu.getSubmenu(e);let n=WH.ce("span");WH.ae(a,n);if(t.headerNavIcon){n.classList.add("header-nav-icon-image");if(t.headerNavIconClass){n.classList.add(t.headerNavIconClass)}else if(t.headerNavIcon.indexOf("/")>-1){n.style.background="url("+WH.staticUrl+t.headerNavIcon+")"}else{n.style.background="url("+WH.staticUrl+"/images/wow/icons/medium/"+t.headerNavIcon+".jpg)"}if(t.headerNavIconWithName){let t=WH.ce("span",{className:"header-nav-icon-text"});WH.st(t,e[Menu.ITEM_LABEL]);WH.ae(a,t)}}else{WH.st(n,e[Menu.ITEM_LABEL]);if(i&&WH.Theme.isClassicType()){WH.ae(a,WH.ce("span",{className:"fa fa-caret-down"}))}}if(i){Menu.add(a,i,{padded:true})}return a}function h(){r.elements.$breadcrumb.children("span:last").addClass("breadcrumb-arrow");return $("<span/>").appendTo(r.elements.$breadcrumb)}function p(){let e=n.get(d());return typeof e==="boolean"?e:undefined}function m(){let e=p();return e===undefined?r.fullscreenModeDefault:e}function H(){let e=WH.ge("main-contents");let t=WH.qs(WH.PageMeta.classicLinkSelector);let i="bottom";if(!t||!a.isVisible(t)){t=WH.qs(".main-contents > .text > .heading-size-1");if(!t||!a.isVisible(t)){if(WH.Layout.Responsive.check()){return}t=e;i="top";if(!t||!a.isVisible(t)){return}}}let n=a.getInnerWidth(t);if(n&&n+230<(a.getInnerWidth(e)||window.innerWidth)){i="right"}let s=WH.Page.getType();let r=WH.Types.hasName(s)?WH.Types.getLowerSingular(s):WH.TERMS.page_lc;let o=WH.Strings.escapeHtml(WH.Url.generate(location.pathname,{dataEnv:WH.PageMeta.classicDataEnv}));let l=WH.ce("div",{className:"highlight-classic-link-content"});l.innerHTML=WH.term("dataEnvVersionLink_format",WH.getDataEnvSeoName(WH.PageMeta.classicDataEnv),r,'<a href="'+o+'">',"</a>");setTimeout((function(){let e="classic-link-type-"+(s||"other");new WH.Highlight(e,t,l,{buttonSize:"small",class:"highlight-classic-link",closeButtonText:WH.TERMS.close,extraButtons:[{text:WH.TERMS.wowheadClassic,url:o}],position:i})}),250)}function g(){e.updateBreadcrumb()}function W(){if(!WH.Theme.isStandardType()){return}requestAnimationFrame(e.updateSearchWidth);if(typeof MutationObserver!=="undefined"){let t=WH.qs(".header");if(t){let a=new MutationObserver(e.updateSearchWidth);a.observe(t,{characterData:true,childList:true,subtree:true})}}}function E(){e.initPageState(LOCALE_ENUS,null);WH.prepInfobox();WH.Responsive.test();b();M()}function _(){const t=WH.Url;$(".header-expand-site-tab").attr("href","javascript:").click(WH.Layout.expandSite);let a=WH.getPageData("listPage.notFoundPath");if(a){history.replaceState({},"",t.generatePath(a))}WH.qsa(".data-env-links a[title]").forEach((function(t){let a=WH.getDataEnvFromKey(t.dataset.env);if(WH.getDataEnv()!==a){WH.aE(t,"click",e.updateDataEnvLink.bind(t,t,a));WH.aE(t,"mouseover",e.updateDataEnvLink.bind(t,t,a));e.updateDataEnvLink(t,a)}let i=t.title;if(WH.PageMeta.page==="home"||(WH.PageMeta.page||"").indexOf("news")===0){let e=a===WH.dataEnv.MAIN?WH.TERMS.newsTypes+WH.TERMS.colon_punct+WH.TERMS.all:WH.TERMS.newsType+WH.TERMS.colon_punct+WH.TERMS[WH.getDataEnvTerm(a)];i+='<div style="margin-top:10px">'+e+"</div>"}WH.Tooltips.attach(t,'<span class="no-wrap">'+i+"</span>",t.href?"q2":"q");t.title=""}));$(".header-theme-switcher a").click((function(){if(this.classList.contains("current")){return}this.classList.remove("fa-square");this.classList.add("fa-refresh");this.classList.add("fa-spin");if(!WH.User.isLoggedIn()){window.location=t.generatePath(t.getLoginPath(t.getPathCommand()+window.location.hash));return}WH.Theme.set(this.dataset.theme)}))}function v(){let t=e.getElement("header");if(!t){return null}let a=WH.ce("div",{className:"header-nav-wrapper"});WH.ae(t,a);r.elements.headerNav=WH.ce("div",{className:"header-nav"});WH.ae(a,r.elements.headerNav);let i=Menu.getMenu();let n=[];let s=[];for(let e=0,t;t=i[e];e++){let e=Menu.getItemOptions(t);if(e.breadcrumbOnly||e.hide){continue}let a=WH.ce("a",{dataset:{id:t[Menu.ITEM_CRUMB]}});a.whMenuItem=t;WH.st(a,t[Menu.ITEM_LABEL]);if(e.collapseOrder){a.dataset.collapseOrder=e.collapseOrder;s.push(a)}if(e.rel){a.rel=e.rel}let i=$(a);Menu.linkifyItem(t,i);a.menuItem=t;i.data("menuItem",t);n.push(a);WH.ae(r.elements.headerNav,a)}O();let o=f([null,"",null,null,{className:"header-nav-ellipsis"}]);let l=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(o.firstElementChild,l);WH.ae(r.elements.headerNav,o);let c=WH.ce("div",{className:"header-nav-features"});WH.ae(a,c);let u=Menu.getFeaturedNavigationMenu();let d=[];for(let e=0,t;t=u[e];e++){let e=f(t);e.menuItem=t;d.push(e);WH.ae(c,e)}let h=f([null,"",null,null,{className:"header-nav-ellipsis"}]);let p=WH.ce("span",{className:"fa fa-ellipsis-h"});WH.ae(h.firstElementChild,p);WH.ae(c,h);y(d);s.sort((function(e,t){return e.menuItem[Menu.ITEM_OPTIONS].collapseOrder-t.menuItem[Menu.ITEM_OPTIONS].collapseOrder}));return{collapsibleNavLinks:s,featuredEllipsis:h,featuredLinks:d,featuredNav:c,header:t,headerWrapper:t.parentNode,nav:r.elements.headerNav,navEllipsis:o,navLinks:n,navWrapper:a}}function T(){let e=$(".header-search");if(e.length){let t=$('input[type="text"]',e).focus((function(){WH.qs(".header-search").dataset.hasFocus="true"})).blur((function(){WH.qs(".header-search").dataset.hasFocus="false"}));let a=$("body");if(a.hasClass("home")){WH.safeFocus(t)}if(s.get(s.KEY_RANDOM_SHOW_ICON)===true){s.remove(s.KEY_RANDOM_SHOW_ICON);let e=WH.qs(".header-nav");if(e){let t=WH.ce("a",{className:"header-search-random fa fa-random fa-no-padding",href:WH.Url.generatePath("/random")});WH.Tooltip.simple(t,WH.TERMS.anotherrandompage_exclamation,"q2");WH.ae(e,t)}}$("<a/>",{class:"header-search-button fa fa-search",href:"javascript:"}).click(I).appendTo(e);$("form",e).submit(WH.preventEmptyFormSubmission);WH.Search.Live.attach(t[0]);if(Array.prototype.indexOf&&r.autoSearchFocus){a.keydown(function(e,t){if(!t.ctrlKey&&!t.metaKey&&!t.altKey&&WH.keyPressIsAlphaNumeric(t)&&(!document.activeElement||!["INPUT","SELECT","TEXTAREA"].includes(document.activeElement.tagName)&&!document.activeElement.isContentEditable)){if(e.offset().top>=window.scrollY){e.focus()}}}.bind(null,t))}W()}}function b(){setTimeout((()=>{e.updateContentHeight();if(!r.elements.sidebar||!WH.qs(".main-contents")){return}if(MutationObserver){let t=undefined;let a=(e,a)=>{if(t!==undefined){return}t=setTimeout((function(){e();t=undefined}),a)};let i=new MutationObserver(a.bind(null,e.updateContentHeight,200));let n={childList:true,attributes:true,characterData:true,subtree:true};i.observe(r.elements.sidebar,n);i.observe(WH.qs(".main-contents"),n)}else{setInterval(e.updateContentHeight,200)}}),9)}function S(){if(WH.getGets().hasOwnProperty("classicRedirect")&&!WH.isRetailTree()){if(window.history){window.history.replaceState({},"",location.pathname.replace(/[?&]classicRedirect$/,"")+location.search.replace(/[?&]classicRedirect$/,"")+location.hash)}setTimeout((function(){let e='.data-env-links [data-env="live"]';new WH.Highlight("highlight-retail",e,WH.term("returnToRetail_tip",WH.getDataEnvSeoName()),{extraButtons:[{text:WH.Strings.sprintf(WH.TERMS.backTo_format,WH.qs(e).textContent.trim()),url:WH.qs(e).href}],position:"bottom"})}),250)}}function y(e){let t=function(e){return Math.floor(Math.random()*e)+1};switch(document.body.dataset.logo){case"april-fools":const a=WH.Time.MS_SEC*3;const i=WH.Time.MS_SEC*30;let n=true;let s=e.slice();let r=function(){let e=t(s.length)-1;let o=s[e];o.className="header-nav-text header-nav-april-fools";o.classList.add(n?"first-fool":"entrance-"+t(3));s.splice(e,1);n=false;if(s.length){setTimeout(r,t(i))}else{setTimeout((function(){let e=WH.qs(".header-nav-april-fools.first-fool");e.classList.add("fool-behaves");e.classList.remove("first-fool")}),a)}};setTimeout(r,a);break;case"noblegarden":let o=function(e,a){if(a>3){e.classList.add("header-nav-noblegarden-"+a);e.classList.add("header-nav-noblegarden-dye-"+t(6))}else{e.className="header-nav-text header-nav-noblegarden-"+a;e.classList.add("header-nav-noblegarden-dye-"+t(6))}};if(t(20)===20){for(let t=0,a=e.length;t<a;t++){let a=e[t];if(a.classList.contains("header-nav-classes")){o(a,1)}else{o(a,4)}}break}let l=t(20)===20?6:t(3);let c=[];let u=[];while(c.length<l){let a=t(6);if(c.includes(a)){continue}let i=t(e.length)-1;if(u.includes(i)){continue}let n=e[i];if(a>3&&n.classList.contains("header-nav-classes")){continue}c.push(a);u.push(i);o(n,a)}break}}function I(){let e=$(this).siblings("form").submit().children("input");WH.safeFocus(e)}function R(){let e=WH.getGets();if(e.hasOwnProperty("classicRedirect")||e.hasOwnProperty("fromClassic")||e.hasOwnProperty("fromBurningCrusade")||e.hasOwnProperty("fromWrath")){WH.Url.replacePageQuery((function(e){delete e.classicRedirect;delete e.fromClassic;delete e.fromBurningCrusade;delete e.fromWrath}));return true}return false}function N(){document.body.dataset.isWowhead="true";document.body.dataset.env=WH.getDataEnvKey();document.body.dataset.game=i.getKey(i.get());document.body.dataset.locale=Locale.getName();document.body.dataset.sidebar=JSON.stringify(!!WH.PageMeta.hasSidebar);document.body.dataset.theme=WH.Theme.getTheme();document.body.dataset.themeType=WH.Theme.getThemeType();document.body.dataset.touch=JSON.stringify(t.isTouch());document.body.dataset.tree=WH.getDataTreeKey();document.body.dataset.width=WH.PageMeta.fullWidth?"full":"standard";if(WH.PageMeta.logo){document.body.dataset.logo=WH.PageMeta.logo}if(WH.PageMeta.page){document.body.dataset.page=WH.Strings.slug(WH.PageMeta.page)}}function w(){let e=window.innerHeight*2;WH.qsa(".sidebar-track").forEach(((t,a)=>{t.style.height=a===0?`${e}px`:`calc(100% - ${e-10}px)`}))}function A(){n.set(n.KEY_LAYOUT_USER_RETURNED_FROM_CLASSIC,true)}function M(){if(R()){A();return}if(!WH.isRetailTree()||!WH.PageMeta.classicDataEnv||u()){return}if(!WH.PageMeta.classicRedirectSkip){l();return}H()}function C(){let t=e.getFullscreenMode();let a=JSON.stringify(t);let i=document.body.dataset.fullscreenMode&&document.body.dataset.fullscreenMode!==a;document.body.dataset.fullscreenMode=a;document.body.dataset.forcedFullscreenMode=JSON.stringify(r.forcedFullscreenMode);let n=WH.qs(".header-user-fullscreen span");if(n){WH.st(n,t?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen)}if(i){Menu.hide(true);WH.Tooltip.hide();if(t){WH.Layout.Responsive.disableNavScrollLimit()}WH.WAS.updateSkinMode()}WH.Layout.Responsive.check(true);WH.WAS.updateSkinPosition(true);document.body.dispatchEvent(new CustomEvent(e.EVENT_FULLSCREEN_MODE_CHANGED,{bubbles:true}))}function O(){if(!r.elements.headerNav){return}let e=Menu.getMenu();for(let a=0,i=e.length;a<i;a++){let i=e[a];let n=WH.qs('a[data-id="'+i[Menu.ITEM_CRUMB]+'"]',r.elements.headerNav);if(!n){continue}let s=t.isTouch();if(i[Menu.ITEM_CRUMB]===r.activeNavItem){n.classList.add(s?"active-touch":"active")}else{n.classList.remove(s?"active-touch":"active")}if(r.navMenusAttached){continue}let o=Menu.getSubmenu(i);if(o){if(s){Menu.addTouch(n,o)}else{Menu.add(n,o,{padded:true})}}}r.navMenusAttached=true}WH.onLoad(E)};WH.DynamicFixedElement=new function(){const e=WH.Layout;const t={elements:{}};this.checkAll=function(){for(let e in t.elements){if(t.elements.hasOwnProperty(e)){a(e,true)}}};this.init=function(i,n,s){s=s||{};if(typeof n==="string"){n=WH.qs(n)}if(!n||n.nodeType!==Node.ELEMENT_NODE){WH.error("Could not find element to set up a dynamic fixed position.",i,n,s);return}if(n.dataset.dynamicFixedElementInitialized){WH.error("Element is already set up for a dynamic fixed position.",i,n,s);return}let r=["left","right"].includes(s.side)?s.side:"right";let o=getComputedStyle(n);t.elements[i]={checkCallback:s.checkCallback,defaultSide:parseInt(o.getPropertyValue(r))||0,defaultTop:parseInt(o.getPropertyValue("top"))||0,element:n,fixed:false,minWidth:s.minWidth,offset:false,getTopOffsetCallback:s.getTopOffsetCallback,parent:n.parentNode,side:r};WH.aE(window,"scroll",(()=>a(i)));[window,t.elements[i].element,t.elements[i].parent,e.getElement("layout")].forEach((e=>WH.aE(e,"resize",(()=>a(i,true)))));a(i);n.dataset.dynamicFixedElementInitialized="true"};function a(a,o){let l=t.elements[a];if(l.minWidth&&window.innerWidth<l.minWidth){i(a);n(a);return}let c=l.parent.getBoundingClientRect();let u=10+e.getHeaderBottom();let d=l.getTopOffsetCallback?l.getTopOffsetCallback():0;if(c.top<u-l.defaultTop-d){let e=(l.parent.offsetHeight||0)-(l.element.offsetHeight||0)-d;let t=c.top*-1+u-d;if(t<e){n(a);s(a,u,o)}else{i(a);e=(l.parent.offsetHeight||0)-(l.element.offsetHeight||0)-d;r(a,Math.min(t,e),o)}}else{i(a);n(a)}if(l.checkCallback){l.checkCallback(l)}}function i(e){let a=t.elements[e];if(a.fixed){a.element.classList.remove("fixed-"+e,"scrollable-"+e);a.element.style[a.side]=null;a.element.style.top=null;a.fixed=false}}function n(e){let a=t.elements[e];if(a.offset){a.element.style.marginTop=null;a.offset=false}}function s(e,a,i){let s=t.elements[e];let r=WH.getOffset(s.parent);if(!s.fixed||i===true){n(e);let t=s.side==="left"?r.left:document.documentElement.getBoundingClientRect().width-r.left-s.parent.offsetWidth+s.defaultSide;s.element.classList.add("fixed-"+e);s.element.style[s.side]=t+"px";s.element.style.top=a+"px";if(s.element.offsetHeight+10+a>window.innerHeight){s.element.classList.add("scrollable-"+e)}s.fixed=true}}function r(e,a,i){let n=t.elements[e];if(!n.offset||i===true){n.element.style.marginTop=a-n.defaultTop+"px";n.offset=true}}};window.Lightbox=new function(){const e=this;const t=WH.DOM;const a=WH.Tooltip;this.BLEED_SIZE=50*2;this.UI_HEIGHT=52;this.UI_WIDTH=20;const i={callbacks:{onHide:undefined,onResize:undefined,onShow:undefined},elements:{frame:undefined,frames:{},inner:undefined,outer:undefined},initialized:false,lastId:undefined};this.addListviewCloseButton=function(e){let t=WH.ce("a",{className:"listview-option-button fa fa-times",dataset:{type:"close"},href:"javascript:"});WH.aE(t,"click",Lightbox.hide);WH.ae(e,t)};this.hide=function(){if(!i.initialized||!e.isVisible()){return}l();if(i.callbacks.onHide){i.callbacks.onHide()}WH.displayNone(i.elements.outer);i.elements.inner.style.width="";Menu.hide(true);a.hide();WH.WAS.restoreHidden();PoundChecker.resume();WH.preventScroll(false)};this.isVisible=function(){return!!i.elements.outer&&t.isVisible(i.elements.outer)};this.reveal=function(){i.elements.outer.dataset.frame=i.lastId;i.elements.frame=i.elements.frames[i.lastId];WH.displayDefault(i.elements.frame);WH.displayDefault(i.elements.outer);dispatchEvent(new Event("resize"))};this.setSize=function(e){i.elements.inner.style.width=e+"px"};this.show=function(t,r,o){r=r||{};i.callbacks.onHide=r.onHide;i.callbacks.onResize=r.onResize;i.callbacks.onShow=r.onShow;Menu.hide(true);a.hide();WH.WAS.hideAll();PoundChecker.pause();s();n();if(i.lastId!==t&&i.elements.frames[i.lastId]){WH.displayNone(i.elements.frames[i.lastId])}i.lastId=t;let l=!i.elements.frames[t];if(l){let e=WH.ce("div",{className:"lightbox-frame"});WH.ae(i.elements.inner,e);i.elements.frames[t]=e}i.elements.frame=i.elements.frames[t];if(i.callbacks.onShow){i.callbacks.onShow(i.elements.frame,l,o)}e.reveal();WH.preventScroll(true,".lightbox-content")};this.showPicker=function(e,t,a){e+="-picker";Lightbox.show(e,{onShow:function(i,n){Lightbox.setSize(800);let s;if(n){i.classList.add(e);WH.ae(i,WH.ce("div",{className:"lightbox-content listview",id:"lv-"+e}));let a=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(a,"click",Lightbox.hide);WH.ae(i,a);t.id=e;s=new Listview(t)}if(a){a(i,n,s)}}})};function n(){WH.aE(document,"keydown",r);WH.aE(window,"resize",o)}function s(){if(i.initialized){return}i.initialized=true;i.elements.inner=WH.ce("div",{className:"lightbox-inner"});i.elements.outer=WH.ce("div",{className:"lightbox-outer",style:{display:"none"}},i.elements.inner);WH.ae(document.body,i.elements.outer);let t=false;let a=false;let n=false;WH.aE(i.elements.inner,"mousedown",(function(){a=true;t=true}));WH.aE(i.elements.inner,"mouseup",(function(){a=false;t=true}));WH.aE(i.elements.outer,"mousedown",(function(){n=true;if(a){a=false;t=true}else{t=false}}));WH.aE(i.elements.outer,"mouseup",(function(a){if(!n){return}n=false;if(!t&&a.target===i.elements.outer){e.hide()}}))}function r(t){if(t.key==="Escape"){e.hide()}}function o(){c();if(i.callbacks.onResize){i.callbacks.onResize()}}function l(){WH.dE(document,"keydown",r);WH.dE(window,"resize",o)}function c(){if(window.innerWidth>=WH.Responsive.BREAKPOINTS.MOBILE_MODE){let t=window.innerHeight-e.BLEED_SIZE;if(i.elements.frame.scrollHeight>t){i.elements.inner.style.maxHeight=t+"px";i.elements.frame.style.maxHeight=t+"px";return}}i.elements.inner.style.maxHeight="";i.elements.frame.style.maxHeight=""}};window.g_listviews={};function Listview(e){const t=WH.User;if(!this.initialSetupComplete){WH.cO(this,e);if(typeof this.tabs==="string"){this.tabs=window[this.tabs]}if(this.id){let e=(this.tabs?"tab-":"lv-")+this.id;if(this.parent){this.container=WH.ce("div",{id:e});WH.ae(WH.ge(this.parent),this.container)}else{this.container=WH.ge(e)}if(this.tabs){this.container.style.display="none"}}else{return}g_listviews[this.id]=this;if(this.tabs){this.tabIndex=this.tabs.add(this.getTabName(),$.extend({id:this.id,onLoad:this.initialize.bind(this),onShow:function(){this.updateTileSizes();this.writeHash()}.bind(this)},this.tabOpts));this.tabClick=Tabs.trackClick.bind(this.tabs,this.tabs.tabs[this.tabIndex])}this.initialSetupComplete=true}if(!this.template){WH.error("Every listview requires a template");return}if(typeof this.template==="string"){this.container.dataset.template=this.template;this.loadingTemplate=true;Listview.loadTemplate(this.template,function(){this.template=Listview.templates[this.template];delete this.loadingTemplate;Listview.call(this,e)}.bind(this));return}if(this.template.templateName){this.container.dataset.template=this.template.templateName}if(t.getDebug()){this.debug=true}if(this.data==null){this.data=[]}if(!this.hasOwnProperty("hash")){if(this.template.hasOwnProperty("hash")){this.hash=this.template.hash}else{this.hash=Listview.HASH_FULL}}this.lockHash=true;if(this.searchable==null){if(this.template.searchable!=null){this.searchable=this.template.searchable}else{this.searchable=false}}if(this.filtrable==null){if(this.template.filtrable!=null){this.filtrable=this.template.filtrable}else{this.filtrable=false}}if(this.sortable==null){if(this.template.sortable!=null){this.sortable=this.template.sortable}else{this.sortable=true}}this.specialHashes={};if(this.data.length===1){this.filtrable=false;this.searchable=false;this.sortable=false}if(this.searchable&&this.searchDelay==null){if(this.template.searchDelay!=null){this.searchDelay=this.template.searchDelay}else{this.searchDelay=333}}if(this.clickable==null){if(this.template.clickable!=null){this.clickable=this.template.clickable}else{this.clickable=true}}if(this.hideBands==null)this.hideBands=this.template.hideBands;if(this.hideNav==null)this.hideNav=this.template.hideNav;if(this.hideHeader==null)this.hideHeader=this.template.hideHeader;if(this.hideCount==null)this.hideCount=this.template.hideCount;if(!this.hiddenControls){this.hiddenControls=this.template.hiddenControls||[]}if(typeof this.createHeaderRow!=="boolean"&&typeof this.template.createHeaderRow==="boolean"){this.createHeaderRow=this.template.createHeaderRow}if(this.computeDataFunc==null&&this.template.computeDataFunc!=null){this.computeDataFunc=this.template.computeDataFunc}if(this.createCbControls==null&&this.template.createCbControls!=null){this.createCbControls=this.template.createCbControls}if(this.createTooltipToggle==null&&this.template.createTooltipToggle!=null){this.createTooltipToggle=this.template.createTooltipToggle}if(this.template.onBeforeCreate!=null){if(this.onBeforeCreate==null){this.onBeforeCreate=this.template.onBeforeCreate}else{this.onBeforeCreate=[this.template.onBeforeCreate,this.onBeforeCreate]}}if(this.onAfterCreate==null&&this.template.onAfterCreate!=null){this.onAfterCreate=this.template.onAfterCreate}if(this.onNoData==null&&this.template.onNoData!=null){this.onNoData=this.template.onNoData}if(this.createNote==null&&this.template.createNote!=null){this.createNote=this.template.createNote}if(this.template.sortOptions){this.sortOptions=[];WH.cOr(this.sortOptions,this.template.sortOptions)}if(this.customFilter==null&&this.template.customFilter!=null){this.customFilter=this.template.customFilter}if(this.onSearchSubmit==null&&this.template.onSearchSubmit!=null){this.onSearchSubmit=this.template.onSearchSubmit}if(this.getItemLink==null&&this.template.getItemLink!=null){this.getItemLink=this.template.getItemLink}if(this.noRowClick==null&&this.template.noRowClick!=null){this.noRowClick=this.template.noRowClick}if(this.forceBandTop==null&&this.template.forceBandTop!=null){this.forceBandTop=this.template.forceBandTop}if(this.completionText==null&&this.template.completionText!=null){this.completionText=this.template.completionText}if(this.completionText==null){this.completionText=Listview.getCompletionText()}if(this.clip==null&&this.template.clip!=null){this.clip=this.template.clip}if(this.clip||this.template.compute||this.id==="topics"||this.id==="recipes"||this.template.noDebug){this.debug=false}if(this.mode==null){this.mode=this.template.mode}if(this.alternateVersions==null){this.alternateVersions=this.template.alternateVersions}if(this.template.noStyle!=null){this.noStyle=this.template.noStyle}if(this.nItemsPerPage==null){if(this.template.nItemsPerPage!=null){this.nItemsPerPage=this.template.nItemsPerPage}else{this.nItemsPerPage=50}}this.nItemsPerPage|=0;if(this.nItemsPerPage<=0){this.nItemsPerPage=0}if(this.validateHashPagination==null){this.validateHashPagination=true}this.resetRowVisibility();if(this.mode===Listview.MODE_CALENDAR){this.dates=[];this.nItemsPerPage=1;this.nDaysPerMonth=[];if(this.template.startOnMonth!=null){this.startOnMonth=this.template.startOnMonth}else{this.startOnMonth=new Date}this.startOnMonth.setDate(1);this.startOnMonth.setHours(0,0,0,0);if(this.nMonthsToDisplay==null){if(this.template.nMonthsToDisplay!=null){this.nMonthsToDisplay=this.template.nMonthsToDisplay}else{this.nMonthsToDisplay=1}}let e=this.startOnMonth.getFullYear();let t=this.startOnMonth.getMonth();for(let a=0;a<this.nMonthsToDisplay;++a){let i=new Date(e,t+a,32);this.nDaysPerMonth[a]=32-i.getDate();for(let i=1;i<=this.nDaysPerMonth[a];++i){this.dates.push({date:new Date(e,t+a,i)})}}if(this.template.rowOffset!=null){this.rowOffset=this.template.rowOffset}}this.columns=[];for(let e=0,t=this.template.columns.length;e<t;++e){let t={};WH.cO(t,this.template.columns[e]);this.columns.push(t)}if(this.extraCols!=null){for(let e=0,t=this.extraCols.length;e<t;++e){let t=null;let a=this.extraCols[e];if(typeof a==="string"){if(!Listview.extraCols.hasOwnProperty(a)){WH.error("Unknown extraCol ["+a+"].");continue}a=Listview.extraCols[a]}if(!a){WH.error("Could not find the requested listview column:",this.extraCols[e]);continue}if(a.after||a.before){let e=WH.inArray(this.columns,a.after?a.after:a.before,(function(e){return e.id}));if(e!==-1){t=a.after?e+1:e}}if(t==null){t=this.columns.length}if(a.id===Listview.COLUMN_ID_DEBUG_ID){this.columns.splice(0,0,WH.cO({},a))}else{this.columns.splice(t,0,WH.cO({},a))}if(!this.sortOptions){continue}t=null;if(a.hasOwnProperty("sortOptionsPosition")){switch(a.sortOptionsPosition){case Listview.SORT_OPTIONS_FIRST:t=0;break}}else if(a.after||a.before){let e=WH.inArray(this.sortOptions,a.after?a.after:a.before,(function(e){return e.id}));if(e!==-1){t=a.after?e+1:e}}if(t==null){t=this.sortOptions.length}if(a.id===Listview.COLUMN_ID_DEBUG_ID){this.sortOptions.splice(0,0,a)}else{this.sortOptions.splice(t,0,a)}}}this.visibility=[];let a=[];let i=[];if(this.columnList){(this.sortOptions||this.columns).forEach((e=>{if(this.columnList.includes(e.id)){a[e.id]=true}else{i[e.id]=true}}))}else{if(this.visibleCols){this.visibleCols.forEach((e=>a[e]=true))}if(this.hiddenCols){this.hiddenCols.forEach((e=>i[e]=true))}}(this.sortOptions||this.columns).forEach(((e,t)=>{e.__index=t;if(a[e.id]||!e.hidden&&!i[e.id]){this.visibility.push(t)}}));if(this.sort==null&&this.template.sort){this.sort=this.template.sort.slice(0)}if(this.sort!=null){let e=this.sort;this.sort=[];for(let t=0,a=e.length;t<a;++t){let a=parseInt(e[t]);if(isNaN(a)){let a=0;if(e[t].charAt(0)==="-"){a=1;e[t]=e[t].substring(1)}let i=WH.inArray(this.columns,e[t],(function(e){return e.id}));if(i!==-1){if(a){this.sort.push(-(i+1))}else{this.sort.push(i+1)}}}else{this.sort.push(a)}}}else{this.sort=[]}if(this.debug){this.columns.splice(0,0,{id:Listview.COLUMN_ID_DEBUG_ID,name:WH.TERMS.id,width:"5%",compute:function(e,t){if(e.id){let a=WH.ce("pre",{style:{display:"inline",margin:"0"}},WH.ct(e.id));WH.clickToCopy(a);WH.ae(t,a)}},getVisibleText:function(e){return e.id||""},getValue:function(e){return e.id||0},sortFunc:function(e,t){if(e.id==null){return-1}else if(t.id==null){return 1}return WH.stringCompare(e.id,t.id)}});for(let e=0,t;t=this.columns[e];e++){t.__index=e}this.visibility.splice(0,0,-1);for(let e=0,t=this.visibility.length;e<t;++e){this.visibility[e]=this.visibility[e]+1}for(let e=0,t=this.sort.length;e<t;++e){if(this.sort[e]<0){this.sort[e]=this.sort[e]-1}else{this.sort[e]=this.sort[e]+1}}}this.originalSort=JSON.parse(JSON.stringify(this.sort));for(let e=0,t;t=this.columns[e];++e){t.actions=t.actions||[]}this.Filters=new Listview.Filters(this);if(!this.tabs||this.tabsCalledInitialize){this.initialize()}}Listview.COLUMN_ID_COMPLETION="completed";Listview.COLUMN_ID_DEBUG_ID="debug-id";Listview.COLUMN_ID_POPULARITY="popularity";Listview.COLUMN_TYPE_NUMBER="number";Listview.COLUMN_TYPE_RANGE="range";Listview.COLUMN_TYPE_TEXT="text";Listview.COMPLETION_TYPE_NONE=0;Listview.COMPLETION_TYPE_BATTLE_PET=1;Listview.COMPLETION_TYPE_COLLECTION=2;Listview.HASH_DISABLED=0;Listview.HASH_FULL=1;Listview.HASH_SIMPLE=2;Listview.HASH_DELIMITER=";";Listview.SORT_OPTIONS_FIRST=0;Listview.MODE_DEFAULT=0;Listview.MODE_CHECKBOX=1;Listview.MODE_DIV=2;Listview.MODE_TILED=3;Listview.MODE_CALENDAR=4;Listview.prototype={addOptions:function(e,t){t=t||{};t.className="listview-note-options";let a=WH.ce("div",t);WH.ae(this.getNoteTopDiv(),a);for(let t=0,i;i=e[t];t++){let e=WH.ce("div",{className:"listview-note-options-option"});let t=WH.ce("label",undefined,WH.ct(i.label));if(i.option.nodeType===Node.ELEMENT_NODE&&/^(input|select|textarea|button|object)$/.test(i.option.tagName.toLowerCase())){if(!i.option.id){i.option.id="listview-option-"+WH.Strings.guid()}t.htmlFor=i.option.id}else{t.style.cursor="default"}WH.ae(e,t);WH.ae(e,WH.ce("div",undefined,i.option));WH.ae(a,e)}},initialize:function(){const e=this;if(this.loadingTemplate){this.tabsCalledInitialize=true;return}delete this.tabsCalledInitialize;if(this.data.length){if(this.computeDataFunc!=null){for(let e=0,t=this.data.length;e<t;++e){this.computeDataFunc(this.data[e])}}}let t;if(this.onBeforeCreate!=null){if(typeof this.onBeforeCreate=="function"){t=this.onBeforeCreate()}else{for(let e=0;e<this.onBeforeCreate.length;++e){this.onBeforeCreate[e].bind(this)()}}}this.noData=WH.ce("div");this.noData.className="listview-nodata text";this.createMainContainer();this.createBands();if(this.customFilter!=null){this.Filters.applyDataOnly()}if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateNav();this.refreshRows(true);this.updateBrowseSession();if(!e.clip&&e.scrollerVertical&&e.bandTop&&e.bandBot){e.updateScrollEnhancements();WH.aE(window,"resize",e.updateScrollEnhancements.bind(e));WH.aE(window,"scroll",e.updateScrollEnhancements.bind(e))}if(this.onAfterCreate){this.onAfterCreate(t)}this.lockHash=false},createHeader:function(){let e=WH.ce("tr");if(this.mode===Listview.MODE_CHECKBOX){let t=WH.ce("th",{style:{width:"33px"}});WH.ae(e,t);let a=WH.ce("div");WH.ae(t,a);let i=WH.ce("a",{className:"listview-cb"},WH.ct(WH.Strings.nbsp));WH.ae(a,i)}let t=WH.Device.isTouch();for(let a=0,i=this.visibility.length;a<i;++a){let i=this.visibility[a];let n=this.sortOptions?this.sortOptions[i]:this.columns[i];let s=WH.ce("th");let r=WH.ce("span");let o=WH.ce("span");let l=WH.ce("div");let c=WH.ce("a");n.__th=s;if(n.actions&&n.actions.length){c.href="javascript:";c.onclick=c.oncontextmenu=Listview.onColumnHeaderClick.bind(this,n,i)}else if(this.sortable&&(n.sortable==null||n.sortable)){c.href="javascript:";c.onclick=this.sortBy.bind(this,i+1,false)}if(c.onclick){if(!t){c.onmouseover=Listview.onColumnHeaderHover.bind(this,c,n);c.onmouseout=WH.Tooltip.hide}}else{c.className="static"}if(n.width!=null)s.style.width=n.width;if(n.align!=null)s.style.textAlign=n.align;if(n.span!=null)s.colSpan=n.span;let u=n.headerClasses||[];if(u.length){c.classList.add(...u)}WH.ae(o,WH.ct(n.name?n.name:WH.Strings.nbsp));WH.ae(r,o);WH.ae(c,r);WH.ae(l,c);WH.ae(s,l);WH.ae(e,s)}if(this.hideHeader){this.thead.style.display="none"}WH.ae(this.thead,e)},createSortOptions:function(e){if(!Array.isArray(this.sortOptions)){return}let t=null;if(Array.isArray(this.sort)){t=this.sort[0]}let a=[];for(let e=0;e<this.sortOptions.length;e++){if(this.sortOptions[e].hidden){continue}let i=WH.ce("a",{href:"javascript:"});i.innerHTML=this.sortOptions[e].name;i.onclick=this.sortGallery.bind(this,i,e+1);if(t===e+1){i.className="active"}a.push(i)}let i=WH.ce("span",{className:"listview-sort-options-choices"});for(let e=0;e<a.length;e++){WH.ae(i,a[e])}let n=WH.ce("div",{className:"listview-sort-options"},WH.ct(WH.TERMS.sortby_colon));WH.ae(n,i);WH.aef(e,n)},getSpecialHash:function(e){let t=e+":";let a=location.hash.slice(1).split(Listview.HASH_DELIMITER);for(let e=0,i=a.length;e<i;e++){if(a[e].indexOf(t)===0){return a[e].substr(t.length)}}return undefined},getSpecialHashesString:function(){let e=[];for(let t in this.specialHashes){if(this.specialHashes.hasOwnProperty(t)){e.push(t+":"+this.specialHashes[t])}}return e.join(Listview.HASH_DELIMITER)},isColumnVisible:function(e){return this.visibility.indexOf(e.__index)!==-1},removeSpecialHash:function(e){delete this.specialHashes[e];let t=e+":";let a=location.hash.slice(1).split(Listview.HASH_DELIMITER).filter((function(e){return e.slice(0,t.length)!==t}));location.hash=a.join(Listview.HASH_DELIMITER)},setSpecialHash:function(e,t){this.specialHashes[e]=t},sortGallery:function(e,t){let a=$(e);a.siblings("a").removeClass("active");a.addClass("active");this.sortBy(t)},copyValues:function(e,t,a,i){WH.copyToClipboard(this.data.map((t=>{if(t.__hidden){return null}let a=e(t);if(typeof a==="string"){a=a.trim();if(a.includes(",")){a=JSON.stringify(a)}}return a==null||a===""?"-":a})).filter((e=>e!=null)).join(a),i);t.classList.remove("fa-clipboard");t.classList.add("fa-check");setTimeout((()=>{t.classList.remove("fa-check");t.classList.add("fa-clipboard")}),1.5*WH.Time.MS_SEC)},createBands:function(){const e=WH.LocalStorage;let t=WH.ce("div");let a=WH.ce("div");let i=WH.ce("div");let n=WH.ce("div");this.bandTop=t;this.bandBot=a;this.noteTop=i;this.noteBot=n;t.className="listview-band-top";a.className="listview-band-bottom";this.navTop=this.createNav(true);this.navBot=this.createNav(false);i.className=n.className="listview-note";if(this.note){i.innerHTML=this.note}else if(this.createNote){this.createNote(i,n)}this.createSortOptions(i);if(this._errors){let e=WH.ce("b",{className:"q10 fa fa-exclamation-triangle fa-size-s"},WH.ct(" "+WH.TERMS.error));let t=WH.ce("span",{className:"tip"},e);WH.Tooltip.simple(t,WH.TERMS.invalidfilters_tip,"q",{maxWidth:200});if(i.innerHTML){t.style.marginLeft="10px"}WH.ae(i,t)}if(!i.firstChild&&!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(i,WH.ct(WH.Strings.nbsp))}if(!(this.createCbControls||this.mode===Listview.MODE_CHECKBOX)){WH.ae(n,WH.ct(WH.Strings.nbsp))}WH.ae(t,this.navTop);if(this.createHeaderRow){this.header=WH.ce("section",{className:"listview-header"});WH.ae(t,this.header)}let s=this.header||t;if(!this.hiddenControls.includes("hideFilter")){let e=this.Filters.getOptionsToggle();if(e){WH.ae(s,e)}}if(!this.hiddenControls.includes("copyButton")){let e=this.getCopyButton();if(e){WH.ae(s,e)}}WH.ae(t,i);if(this.showLootSpecs){this.classSelectorDiv=WH.ce("div");this.classSelectorDiv.id="class-selector";this.classSelectorDiv.style.paddingLeft="3px";let a="";a+='<div id="class-selector-c0" class="iconmedium active">'+'<ins><span style="text-align: center; line-height: 30px; height: 30px; width: 30px;">'+WH.TERMS.all+"</span></ins>"+"<del></del>"+'<a href="javascript:" data-classid="0"></a></div>';WH.Wow.PlayerClass.getAll().forEach((e=>{a+='<div id="class-selector-c'+e+'" class="iconmedium">'+'<ins><img src="'+WH.staticUrl+"/images/wow/icons/medium/"+WH.Wow.PlayerClass.getIconName(e)+'.jpg" /></ins>'+"<del></del>"+'<a href="javascript:" data-classid="'+e+'"></a></div>'}));this.classSelectorDiv.innerHTML=a;$("div.iconmedium a",this.classSelectorDiv).bind("mouseover",(function(e){let t=parseInt($(e.target).attr("data-classid"));if(t){let a=WH.Wow.PlayerClass.getName(t);WH.Tooltip.showAtCursor(e,a,"q")}}));$("div.iconmedium",this.classSelectorDiv).bind("mouseout",(function(e){WH.Tooltip.hide()}));let i=this;$("div.iconmedium a",this.classSelectorDiv).bind("contextmenu",(function(e){return false}));let n=function(t){if(t){e.set(e.KEY_WOW_DATABASE_CLASS_FILTER,t);this.classFilter=function(e){for(let a in e.specs){if(WH.inArray(g_chr_specs_by_class[t],e.specs[a])!==-1){return true}}return false};if(!WH.isSet("g_filterByClassAchievement")){if(!(WH.isSet("g_user")&&g_user.id)){return}$.ajax({url:WH.Url.generatePath("/website-achievement-explored"),data:{trigger:"bosslootfilter"},success:function(){AchievementCheck()},type:"POST"});window.g_filterByClassAchievement=true}}else{e.remove(e.KEY_WOW_DATABASE_CLASS_FILTER);this.classFilter=null;this.deleteRowCaches()}this.Filters.apply();this.applySort();this.refreshRows(true)};$("div.iconmedium a",this.classSelectorDiv).bind("mousedown",(function(e){let t=parseInt($(e.target).attr("data-classid"));const a="iconmedium-gold-selected";switch(e.which){case 3:if(t&&$(e.target).parent().hasClass(a)){$(e.target).parent().removeClass(a);n.call(i,null);$("#class-selector-c0").addClass(a)}break;default:$(".iconmedium",i.classSelectorDiv).removeClass(a);$(e.target).parent().addClass(a);n.call(i,t);break}}));$(t).append(this.classSelectorDiv);$(t).append('<div class="pad" style="clear: left;"></div>');let s=e.get(e.KEY_WOW_DATABASE_CLASS_FILTER);if(s){$("#class-selector-c"+s+" a",this.classSelectorDiv).trigger("mousedown")}}WH.ae(a,this.navBot);WH.ae(a,n);if(this.createCbControls||this.mode===Listview.MODE_CHECKBOX){if(this.note&&!this.showLootSpecs){i.style.paddingBottom="5px"}this.cbBarTop=this.createCbBar(true);this.cbBarBot=this.createCbBar(false);WH.ae(t,this.cbBarTop);WH.ae(a,this.cbBarBot);if(!this.noteTop.firstChild&&!this.cbBarTop.firstChild){this.noteTop.innerHTML="&nbsp;"}if(!this.noteBot.firstChild&&!this.cbBarBot.firstChild){this.noteBot.innerHTML="&nbsp;"}if(this.noteTop.firstChild&&this.cbBarTop.firstChild&&!this.showLootSpecs){this.noteTop.style.paddingBottom="6px"}if(this.noteBot.firstChild&&this.cbBarBot.firstChild){this.noteBot.style.paddingBottom="6px"}}if(this.hideBands&1){t.style.display="none"}if(this.hideBands&2){a.style.display="none"}WH.ae(this.container,this.bandTop);this.scrollerHorizontal=WH.ce("div");this.scrollerHorizontal.className="listview-scroller-horizontal";WH.ae(this.container,this.scrollerHorizontal);this.scrollerVertical=WH.ce("div");this.scrollerVertical.className="listview-scroller-vertical";if(this.clip){this.scrollerVertical.style.width=this.clip.w+"px";this.scrollerVertical.style.height=this.clip.h+"px"}if(this.containVerticalScrolling){WH.aE(this.scrollerVertical,"wheel",WH.pickerWheel)}WH.ae(this.scrollerVertical,this.mainContainer);WH.ae(this.scrollerVertical,this.noData);WH.ae(this.scrollerHorizontal,this.scrollerVertical);WH.ae(this.container,this.bandBot)},createMainContainer:function(){let e=this.mainContainer;if(this.mode===Listview.MODE_DIV){this.mainContainer=this.mainDiv=WH.ce("div");if(!this.noStyle){this.mainContainer.className="listview-mode-div"}}else if(this.mode===Listview.MODE_TILED){this.mainContainer=this.mainDiv=WH.ce("div",{className:"listview-mode-tiled"});if(this.clickable){this.mainContainer.className+=" clickable"}if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}WH.aE(window,"resize",this.updateTileSizes.bind(this))}else{this.mainContainer=this.table=WH.ce("table");this.thead=WH.ce("thead");this.tbody=WH.ce("tbody");if(this.clickable){this.tbody.className="clickable"}if(this.mode===Listview.MODE_CALENDAR){this.table.className="listview-mode-calendar";let e=100/WH.Time.DAYS_PER_WEEK+"%";let t=WH.ce("colgroup");for(let a=0;a<WH.Time.DAYS_PER_WEEK;++a){let a=WH.ce("col");a.style.width=e;WH.ae(t,a)}WH.ae(this.mainContainer,t);if(this.sortOptions){setTimeout(this.updateSortArrow.bind(this),0)}}else{this.table.className="listview-mode-default";this.createHeader();this.updateSortArrow()}WH.ae(this.table,this.thead);WH.ae(this.table,this.tbody)}if(e){e.after(this.mainContainer);WH.de(e);this.deleteRowCaches()}},createNav:function(e){let t=WH.ce("div");t.firstLink=WH.ce("a");t.previousLink=WH.ce("a");t.nextLink=WH.ce("a");t.lastLink=WH.ce("a");t.statusText=WH.ce("span");t.firstIndex=WH.ce("b");t.lastIndex=WH.ce("b");t.totalCount=WH.ce("b");t.className="listview-nav";t.firstLink.href=t.previousLink.href=t.nextLink.href=t.lastLink.href="javascript:";WH.ae(t.firstLink,WH.ct(WH.Strings.laquo+" "+WH.TERMS.first));WH.ae(t.previousLink,WH.ct(WH.Strings.lsaquo+" "+WH.TERMS.previous));WH.ae(t.nextLink,WH.ct(WH.TERMS.next+" "+WH.Strings.rsaquo));WH.ae(t.lastLink,WH.ct(WH.TERMS.last+" "+WH.Strings.raquo));t.firstLink.onclick=this.firstPage.bind(this);t.previousLink.onclick=this.previousPage.bind(this);t.nextLink.onclick=this.nextPage.bind(this);t.lastLink.onclick=this.lastPage.bind(this);if(this.mode===Listview.MODE_CALENDAR){WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.statusText,t.firstIndex)}else{WH.ae(t.firstIndex,WH.ct("a"));WH.ae(t.lastIndex,WH.ct("a"));WH.ae(t.totalCount,WH.ct("a"));WH.ae(t.statusText,t.firstIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.hyphen_punct));WH.ae(t.statusText,t.lastIndex);WH.ae(t.statusText,WH.ct(WH.TERMS.of_lc));WH.ae(t.statusText,t.totalCount)}WH.ae(t,t.firstLink);WH.ae(t,t.previousLink);WH.ae(t,t.statusText);WH.ae(t,t.nextLink);WH.ae(t,t.lastLink);if(e){if(this.hideNav&1){t.style.display="none"}}else{if(this.hideNav&2){t.style.display="none"}}if(this.tabClick){$("a",t).click(this.tabClick)}if(e){this.resetSortLink=WH.ce("a",{className:"listview-reset-sort fa fa-times-circle",href:"javascript:",style:{display:"none"}},WH.ct(WH.TERMS.resetSort));WH.aE(this.resetSortLink,"click",this.resetSort.bind(null,this));WH.aef(t,this.resetSortLink)}return t},createCbBar:function(e){let t=WH.ce("div");if(this.createCbControls){this.createCbControls(t,e)}if(this.createTooltipToggle){this.createTooltipToggle(t,e)}if(t.firstChild){t.className="listview-withselected"+(e?"":"2");WH.ae(t,this.createToggleAll())}return t},createToggleAll:function(){let e=WH.ce("a");e.className="listview-toggleall";let t=function(e){let t=$("td:first-child input:checkbox:not(:checked)",$(this).parents(".listview")).length?WH.TERMS.selectall_stc:WH.TERMS.deselectall_stc;WH.Tooltip.showAtCursor(e,t,"q")};e.onclick=function(e,t,a){let i=$("td:first-child",$(this).parents(".listview"));if($("input:checkbox:not(:checked)",i).length){Listview.cbSelect.call(e,true)}else{Listview.cbSelect.call(e,false)}t.call(this,a)}.bind(e,this,t);e.onmousedown=WH.rf;e.onmouseover=t;e.onmousemove=WH.Tooltip.cursorUpdate;e.onmouseout=WH.Tooltip.hide;return e},deleteRowCaches:function(){for(let e in this.data){this.data[e].__tr=null}},getCopyButton:function(){const e=this;if(!this.template.columns||this.template.copyableColumns===false){return null}let t=WH.ce("a",{className:"listview-option-button fa fa-clipboard"});let a=[];let i=false;this.visibility.forEach((n=>{let s=e.columns[n];if(!s||s.copyable===false||!s.name||s.id===Listview.COLUMN_ID_COMPLETION){return}let r=(s.getPlainText?e=>s.getPlainText(e):null)||(s.getVisibleText&&!(s.id==="name"&&s.value)?e=>s.getVisibleText(e):null)||(s.getValue?e=>s.getValue(e):null)||(s.value?e=>e[s.value]:null);if(!r){return}a.push(Menu.createItem({label:s.name,url:e.copyValues.bind(e,r,t,WH.TERMS.comma_punct)}));i=i||["id",Listview.COLUMN_ID_DEBUG_ID].includes(s.id)}));if(!i){for(let n=0;n<10;n++){if(this.data[n]&&this.data[n].id!=null){i=true;a.unshift(Menu.createItem({label:WH.TERMS.id,url:e.copyValues.bind(e,(e=>e.id),t,WH.TERMS.comma_punct)}));break}}}if(i&&this.template.entityType){let i=WH.markup.Tags.getByEntityType(this.template.entityType);if(i){a.push(Menu.createItem({label:WH.TERMS.wowheadMarkupTag,url:e.copyValues.bind(e,(e=>WH.markup.Tags.getWhml(i,e.id)),t,"\n")}))}}if(!a.length){return null}let n;if(a.length===1){n=WH.term("copyEach_format",Menu.getLabel(a[0]));WH.aE(t,"click",Menu.getItemUrl(a[0]))}else{n=WH.TERMS.copy_clipboard+WH.TERMS.ellipsis_punct;a.unshift(Menu.createHeading({label:WH.TERMS.copyAll}));Menu.add(t,a,{showAtElement:true})}WH.Tooltip.simple(t,n,"q2");return t},refreshRows:function(e){let t;switch(this.mode){case Listview.MODE_DIV:t=this.mainContainer;break;case Listview.MODE_TILED:t=this.mainDiv;break;default:t=this.tbody}if(!t){return}WH.ee(t);if(this.nRowsVisible===0){if(!this.filtered&&!this.forceBandTop){this.bandTop.style.display=this.bandBot.style.display="none";this.mainContainer.style.display="none"}this.noData.style.display="";this.showNoData();return}let a;let i;if(!(this.hideBands&1)){this.bandTop.style.display=""}if(!(this.hideBands&2)){this.bandBot.style.display=""}if(this.nDaysPerMonth&&this.nDaysPerMonth.length){a=0;for(let e=0;e<this.rowOffset;++e){a+=this.nDaysPerMonth[e]}i=a+this.nDaysPerMonth[this.rowOffset]}else if(this.nItemsPerPage>0){a=this.rowOffset;i=Math.min(a+this.nRowsVisible,a+this.nItemsPerPage);if(this.filtered&&this.rowOffset>0){for(let e=0,t=0;e<this.data.length&&t<this.rowOffset;++e){let i=this.data[e];if(i.__hidden||i.__deleted){a++}else{t++}}i+=a-this.rowOffset}}else{a=0;i=this.nRowsVisible}let n=i-a;if(this.mode===Listview.MODE_DIV){for(let e=0;e<n;++e){let t=a+e;let i=this.data[t];if(!i){break}if(i.__hidden||i.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}}else if(this.mode===Listview.MODE_TILED){for(let e=0;e<n;++e){let t=a+e;let i=this.data[t];if(!i){break}if(i.__hidden||i.__deleted){++n;continue}WH.ae(this.mainDiv,this.getDiv(t))}this.updateTileSizes();let e=WH.qsa("img",this.mainDiv);for(let t=0,a;a=e[t];t++){WH.aE(a,"load",this.updateTileSizesAfterDelay.bind(this))}}else if(this.mode===Listview.MODE_CALENDAR){let e=WH.ce("tr");for(let t=0;t<7;++t){WH.ae(e,WH.ce("th",undefined,WH.ct(WH.Time.getWeekdayName(t))))}WH.ae(this.tbody,e);e=WH.ce("tr");let t=this.dates[a].date.getDay();for(let a=0;a<t;a++){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}let n=t;for(let t=a;t<i;++t){WH.ae(e,this.getEvent(t));if(++n===7){WH.ae(this.tbody,e);e=WH.ce("tr");n=0}}if(n!==0){for(;n<7;++n){WH.ae(e,WH.ce("td",{className:"empty-cell"}))}WH.ae(this.tbody,e)}}else{for(let t=0;t<n;++t){let i=a+t;let s=this.data[i];if(!s){break}if(s.__hidden||s.__deleted){++n;continue}WH.ae(this.tbody,this.getRow(i,e))}}this.mainContainer.style.display="";this.noData.style.display="none";$WowheadPower.attachTouchTooltips(t)},showNoData:function(){let e=this.noData;WH.ee(e);let t=-1;if(this.onNoData){t=this.onNoData.bind(this,e)()}if(t===-1){if(this.noDataElement){WH.ae(this.noData,this.noDataElement)}else if(this.noDataText){WH.ae(this.noData,WH.ct(this.noDataText))}else{WH.ae(this.noData,WH.ct(this.filtered?WH.TERMS.nomatches_tip:WH.TERMS.nodata_tip))}}},getColumn:function(e){for(let t=0,a;a=this.columns[t];t++){if(a.id===e){return a}}return undefined},getDiv:function(e){let t=this.data[e];if(t.__div==null||this.minPatchVersion!=t.__minPatch){this.createDiv(t,e)}return t.__div},createDiv:function(e,t){let a=WH.ce("div");e.__div=a;if(this.minPatchVersion){e.__minPatch=this.minPatchVersion}if(this.onItemClick){WH.aE(a,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink&&this.clickable){WH.aE(a,"click",this.onStandardClickableRowClick.bind(this,e))}this.template.compute.bind(this,e,a,t)()},getCell:function(e,t){let a=this.data[e];if(t||a.__td==null){this.createCell(a,e)}return a.__td},createCell:function(e,t){let a=WH.ce("td");e.__td=a;this.template.compute.bind(this,e,a,t)()},getEvent:function(e){let t=this.dates[e];if(t.__td==null){this.createEvent(t,e)}return t.__td},createEvent:function(e,t){e.events=WH.arrayFilter(this.data,(function(t){if(t.__hidden||t.__deleted||t.name.match(/^\[#/)){return false}if(!WH.Wow.Event){return false}let a=WH.Wow.Event.getNextEvent(t.occurrences,e.date);if(a){let t=new Date(a.start);let i=new Date(a.end);t.setHours(0,0,0,0);i.setHours(0,0,0,0);return t<=e.date&&i>e.date}return false}));let a=WH.ce("td");e.__td=a;if(e.date.getFullYear()===WH.getServerTime().getFullYear()&&e.date.getMonth()===WH.getServerTime().getMonth()&&e.date.getDate()===WH.getServerTime().getDate()){a.className="calendar-today"}let i=WH.ce("div",{className:"calendar-date"});WH.st(i,e.date.getDate());WH.ae(a,i);i=WH.ce("div");i.className="calendar-event";WH.ae(a,i);this.template.compute.bind(this,e,i,t)();if(this.onItemClick){WH.aE(a,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(a,"click",this.onStandardClickableRowClick.bind(this,e))}},getRow:function(e,t){let a=this.data[e];if(t||a.__tr==null){this.createRow(a)}return a.__tr},setRow:function(e){if(this.data[e.pos]){this.data[e.pos]=e;this.data[e.pos].__tr=e.__tr;this.createRow(this.data[e.pos]);this.refreshRows()}},createRow:function(e){let t=WH.ce("tr",{className:"listview-row"});e.__tr=t;if(this.mode===Listview.MODE_CHECKBOX){let a=WH.ce("td");if(!e.__nochk){a.className="listview-cb";a.onclick=Listview.cbCellClick;let t=WH.ce("input",{type:"checkbox"});t.onclick=Listview.cbClick;if(e.__chk){t.checked=true}e.__cb=t;WH.ae(a,t)}WH.ae(t,a)}for(let a=0,i=this.visibility.length;a<i;++a){let i=this.visibility[a];let n=this.sortOptions?this.sortOptions[i]:this.columns[i];let s=WH.ce("td");let r;if(n.align!=null){s.style.textAlign=n.align}if(n.compute){r=n.compute.bind(this,e,s,t,i)()}else if(n.getValue){r=n.getValue(e)}else if(e[n.value]!=null){r=e[n.value]}if(r!=null){s.insertBefore(WH.ct(r),s.firstChild)}WH.ae(t,s)}if(this.mode===Listview.MODE_CHECKBOX&&e.__chk){t.className="checked"}if(e.frommerge){t.className+=" mergerow"}if(this.onItemClick){WH.aE(t,"click",this.onItemClick.bind(this,e))}else if(this.getItemLink){WH.aE(t,"click",this.onStandardClickableRowClick.bind(this,e))}},onStandardClickableRowClick:function(e,t){if(this.noRowClick){return}if(t.target&&WH.closest(t.target,"a")){return}location.href=this.getItemLink(e)},submitSearch:function(e){if(!this.onSearchSubmit||e.keyCode!==13){return}for(let e=0,t=this.data.length;e<t;++e){if(this.data[e].__hidden){continue}this.onSearchSubmit.bind(this,this.data[e])()}},validatePage:function(e){if(e===true&&!this.validateHashPagination){return}if(this.rowOffset<0){this.rowOffset=0}else if(this.mode===Listview.MODE_CALENDAR){this.rowOffset=Math.min(this.rowOffset,this.nDaysPerMonth.length-1)}else{this.rowOffset=this.getRowOffset(this.rowOffset+this.nItemsPerPage>this.nRowsVisible?this.nRowsVisible-1:this.rowOffset)}},getRowOffset:function(e){return this.nItemsPerPage>0&&e>0?Math.floor(e/this.nItemsPerPage)*this.nItemsPerPage:0},resetRowVisibility:function(e){for(let e=0,t=this.data.length;e<t;++e){this.data[e].__hidden=false}this.filtered=false;if(e!==true){this.rowOffset=0}this.nRowsVisible=this.data.length},changePage:function(){this.refreshRows();this.updateNav();this.writeHash();this.updateBrowseSession();WH.scrollTo(this.container,{allowScrollingDown:false,asNeeded:true})},firstPage:function(){if(this.rowOffset>0){this.rowOffset=0;this.changePage()}return false},previousPage:function(){if(this.rowOffset>0){this.rowOffset-=this.nItemsPerPage;this.validatePage();this.changePage()}return false},nextPage:function(){let e=this.rowOffset;this.rowOffset+=this.nItemsPerPage;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},lastPage:function(){let e=this.rowOffset;this.rowOffset=99999999;this.validatePage();if(this.rowOffset!==e){this.changePage()}return false},addSort:function(e,t){let a=WH.inArray(e,Math.abs(t),(function(e){return Math.abs(e)}));if(a!==-1){t=e[a];e.splice(a,1)}e.splice(0,0,t)},sortBy:function(e,t){let a=this.sortOptions||this.columns;if(e<=0||e>a.length){return}this.searchSort=false;if(Math.abs(this.sort[0])==e&&!t){this.sort[0]=-this.sort[0]}else{let t=-1;if(a[e-1].type===Listview.COLUMN_TYPE_TEXT){t=1}this.addSort(this.sort,t*e)}if(this.data[0]&&!this.data[0].__originalIndex){for(let e in this.data){if(this.data.hasOwnProperty(e)&&this.data[e]){this.data[e].__originalIndex=e}}}if(this.resetSortLink){this.resetSortLink.style.display=""}this.applySort();this.refreshRows();this.updateSortArrow();this.writeHash()},applySort:function(){if(!this.sort.length){return}Listview.sort=this.sort;Listview.columns=this.columns;Listview.sortOptions=this.sortOptions;if(this.template.beforeSort){this.template.beforeSort.call(this)}if(this.indexCreated){this.data.sort(Listview.sortIndexedRows.bind(this))}else{this.data.sort(Listview.sortRows.bind(this))}this.updateSortIndex();this.updateBrowseSession()},resetSort:function(e){if(e.originalSort&&e.data[0]&&e.data[0].hasOwnProperty("__originalIndex")){e.sort=JSON.parse(JSON.stringify(e.originalSort));e.data.sort((function(e,t){return(e.__originalIndex||0)-(t.__originalIndex||0)}));e.indexCreated=false;e.applySort();e.refreshRows();e.removeSortArrow();e.writeHash(true)}else{WH.error("Could not revert to default sort.",e.id,!e.originalSort?"No original sort":!e.data[0]?"No first row":"No original indexes")}if(e.resetSortLink){e.resetSortLink.style.display="none"}},setSort:function(e,t,a){this.searchSort=false;if(this.sort.toString()!==e.toString()){this.sort=e;this.applySort();if(t){this.refreshRows()}if(a){this.writeHash()}}},readHash:function(){if(!this.hash||!location.hash.length){return}let e=location.hash.substr(1);let t=this.rowOffset;let a=false;this.Filters.reset();const i=this;e.split(/[;:]/).forEach((function(e){if(/^\d+([+-]\d+)*$/.test(e)){let t=parseInt(e);if(isNaN(t)){return}i.rowOffset=t;a=true;i.validatePage(true);if(i.hash!==Listview.HASH_SIMPLE){let t=[];let a=e.match(/([+-])[0-9]+/g);if(a){let e=(i.sortOptions||i.columns).length;for(let n=a.length-1;n>=0;n--){let s=parseInt(a[n])||0;let r=Math.abs(s);if(r<=0||r>e){break}i.addSort(t,s)}i.setSort(t,false,false)}}if(i.tabs){i.tabs.setTabPound(i.tabIndex,i.buildHash())}}else{i.Filters.readHashPart(e)}}));if(!a){this.rowOffset=t}i.Filters.apply();i.updateSortArrow()},setHashMode:function(e){this.hash=e},updateBrowseSession:function(){const e=WH.SessionStorage;if(!window.JSON||!e.isSupported()){return}if(typeof Filter=="undefined"&&location.pathname!=="/search"){return}if(this.data.length<3){return}if(typeof this.getItemLink!="function"){return}const t=5;let a=location.pathname+location.search;let i=new Date(WH.getServerTime().getTime()-3*WH.Time.MS_DAY).getTime();let n=e.get(e.KEY_LISTVIEW_BROWSE);if(n){for(let e=0;e<n.length;e++){if(n[e].path===a||n[e].when<i){n.splice(e--,1)}}if(n.length>=t){n.splice(t-1,n.length-t-1)}}else{n=[]}let s=[];let r;let o=/^(.*\bwowhead\.com)?(\/[a-z-]+(=|\/([\w-]*-)?)\d+[^?&#]*)/i;for(let e=0;e<this.data.length;e++){if(r=o.exec(this.getItemLink(this.data[e]))){s.push(r[2])}}if(s.length<3){return}n.unshift({hash:location.hash,path:a,urls:s,when:WH.getServerTime().getTime()});e.set(e.KEY_LISTVIEW_BROWSE,n)},updateScrollEnhancements:function(){if(!this.bandTop.offsetParent){return}const e=200;let t=window.innerHeight-this.scrollerVertical.getBoundingClientRect().top-this.bandBot.offsetHeight;t=Math.max(t,e);if(t<this.scrollerVertical.scrollHeight){if(!this.container.dataset.fixedBottom){this.container.dataset.fixedBottom="true"}this.bandBot.style.width=this.bandBot.parentNode.offsetWidth+"px";this.container.style.paddingBottom=this.bandBot.offsetHeight+"px";if(this.scrollerVertical.scrollWidth>this.scrollerVertical.clientWidth){this.scrollerHorizontal.style.minHeight=this.scrollerVertical.scrollHeight+"px";this.scrollerVertical.style.maxHeight=t+"px"}else if(this.scrollerHorizontal.style.minHeight){this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}if(t===e){let e=this.bandTop.offsetParent;let a=t+this.scrollerVertical.getBoundingClientRect().top-e.getBoundingClientRect().top-parseInt(getComputedStyle(e).getPropertyValue("border-top-width"));this.bandBot.dataset.atTop="true";this.bandBot.style.top=a+"px"}else{if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}}}else{if(this.container.dataset.fixedBottom){delete this.container.dataset.fixedBottom;this.bandBot.style.width="";this.container.style.paddingBottom="";if(this.bandBot.dataset.atTop){delete this.bandBot.dataset.atTop;this.bandBot.style.top=""}this.scrollerHorizontal.style.minHeight="";this.scrollerVertical.style.maxHeight=""}}},removeSortArrow:function(){if(this.lsa){this.lsa.classList.remove("listview-sort-desc","listview-sort-asc");this.lsa.classList.remove("active")}},updateSortArrow:function(){if(!this.sort.length||!this.thead||this.mode===Listview.MODE_CALENDAR||this.searchSort){return}let e=WH.inArray(this.visibility,Math.abs(this.sort[0])-1);if(e===-1){return}if(this.mode===Listview.MODE_TILED){if(!this.sortOptions){return}let t=$(".listview-sort-options a",this.noteTop).get(e);if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"active listview-sort-desc":"active listview-sort-asc";this.lsa=t;return}if(this.mode===Listview.MODE_CHECKBOX&&e<this.thead.firstChild.childNodes.length-1){e+=1}let t=this.thead.firstChild.childNodes[e].firstChild.firstChild.firstChild;if(this.lsa&&this.lsa!=t){this.lsa.className=""}t.className=this.sort[0]<0?"listview-sort-desc":"listview-sort-asc";this.lsa=t},updateSortIndex:function(){let e=this.data;for(let t=0,a=e.length;t<a;++t){e[t].__si=t}this.indexCreated=true},updateTabName:function(){if(this.tabs&&this.tabIndex!=null){this.tabs.setTabName(this.tabIndex,this.getTabName())}},updateTileSizes:function(){if(this.mode!==Listview.MODE_TILED||!this.mainDiv||!this.mainDiv.offsetParent){return}this.mainDiv.dataset.widthTesting="true";let e=0;for(let t=0,a;a=this.mainDiv.childNodes[t];t++){e=Math.max(e,a.offsetWidth)}if(e>30){this.mainDiv.style.gridTemplateColumns=`repeat(auto-fit, minmax(${e}px, 1fr))`}delete this.mainDiv.dataset.widthTesting;clearTimeout(this.updateTileSizesDelay)},updateTileSizesAfterDelay:function(){if(!this.updateTileSizesDelay){this.updateTileSizesDelay=setTimeout(this.updateTileSizes.bind(this),100)}},writeHash:function(e){if(!this.hash||this.lockHash||!this.Filters){return}function t(e){let t=[];e=Listview.HASH_DELIMITER+e;let a=location.hash.slice(1).split(Listview.HASH_DELIMITER);for(let i=0,n=a.length;i<n;i++){let n=a[i].match(/^[a-zA-Z0-9_]+:/);if(n&&!e.includes(Listview.HASH_DELIMITER+n[0])){t.push(a[i])}}return t}let a=e===true?"":this.buildHash();if(this.tabs){this.tabs.setTabPound(this.tabIndex,a)}let i=this.getSpecialHashesString();let n=[];let s=t(i);if(this.tabs){if(s.length&&s[0].indexOf(this.id+":")===0){n.push(s.shift())}else{n.push(this.id)}}n.push(i);n=n.concat(s);n.push(a);let r=n.filter(Boolean).join(Listview.HASH_DELIMITER);if(this.tabs&&r===this.id&&this.tabs.selectedTab===-1&&!location.hash){r=""}if(r){location.replace("#"+r)}else{WH.clearHash()}},updateNav:function(){let e=[this.navTop,this.navBot];let t=false;let a=false;let i=new Date;if(this.nRowsVisible>0){if(!(this.hideNav&1)){e[0].style.display=""}if(!(this.hideNav&2)){e[1].style.display=""}}else{e[0].style.display=e[1].style.display="none"}if(this.mode===Listview.MODE_CALENDAR){for(let e=0;e<this.nDaysPerMonth.length;++e){if(e===this.rowOffset){if(e>0){t=true}if(e<this.nDaysPerMonth.length-1){a=true}}}i.setTime(this.startOnMonth.valueOf());i.setMonth(i.getMonth()+this.rowOffset)}else{if(this.nItemsPerPage){if(this.rowOffset>0){t=true}if(this.rowOffset+this.nItemsPerPage<this.nRowsVisible){a=true}}}for(let n=0;n<2;++n){let s=e[n];s.firstLink.dataset.active=t?"yes":"no";s.previousLink.dataset.active=t?"yes":"no";s.nextLink.dataset.active=a?"yes":"no";s.lastLink.dataset.active=a?"yes":"no";if(this.mode===Listview.MODE_CALENDAR){s.firstIndex.firstChild.nodeValue=WH.Time.getMonthName(i.getMonth())+" "+i.getFullYear()}else{s.firstIndex.firstChild.nodeValue=this.rowOffset+1;s.lastIndex.firstChild.nodeValue=this.nItemsPerPage?Math.min(this.rowOffset+this.nItemsPerPage,this.nRowsVisible):this.nRowsVisible;s.totalCount.firstChild.nodeValue=this.nRowsVisible}}if(!t&&!a){$(e[0]).addClass("listview-nav-nocontrols");$(e[1]).addClass("listview-nav-nocontrols")}else{$(e[0]).removeClass("listview-nav-nocontrols");$(e[1]).removeClass("listview-nav-nocontrols")}},getTabName:function(){let e=this.name;let t=this.data.length;for(let e=0,a=this.data.length;e<a;++e){if(this.data[e].__hidden||this.data[e].__deleted){--t}}if(typeof this.forceQuantity=="number"||typeof this.forceQuantity=="string"){t=this.forceQuantity}if((t>0||typeof this.forceQuantity=="string")&&!this.hideCount){e+=WH.sprintf(WH.TERMS._paren,t)}return e},buildHash:function(){let e=[];let t="";t+=this.rowOffset;if(this.hash===Listview.HASH_FULL&&this.sort.length&&JSON.stringify(this.originalSort)!==JSON.stringify(this.sort)){t+=("+"+this.sort.join("+")).replace(/\+-/g,"-")}if(t!=="0"){e.push(t)}e=e.concat(this.Filters.getHashParts());return e.join(Listview.HASH_DELIMITER)},getCheckedRows:function(){let e=[];for(let t=0,a=this.data.length;t<a;++t){let a=this.data[t];if(a.__cb&&a.__cb.checked||!a.__cb&&a.__chk){e.push(a)}}return e},resetCheckedRows:function(){for(let e=0,t=this.data.length;e<t;++e){let t=this.data[e];if(t.__cb){t.__cb.checked=false}else if(t.__chk){t.__chk=null}if(t.__tr){t.__tr.className=t.__tr.className.replace("checked","")}}},deleteRows:function(e){if(!e||!e.length){return}for(let t=0,a=e.length;t<a;++t){let a=e[t];if(!a.__hidden&&!a.__hidden){this.nRowsVisible-=1}a.__deleted=true}this.updateTabName();if(this.rowOffset>=this.nRowsVisible){this.previousPage()}else{this.refreshRows();this.updateNav();this.updateBrowseSession()}},setData:function(e){this.data=e;this.indexCreated=false;this.resetCheckedRows();this.resetRowVisibility();if(this.tabs){if(this.tabs.poundedTab===this.tabIndex){this.readHash()}}else{this.readHash()}this.applySort();this.updateSortArrow();if(this.customFilter!=null||this.classFilter!=null){this.Filters.applyDataOnly()}this.updateNav();this.refreshRows();this.updateBrowseSession()},getNoteTopDiv:function(){return this.noteTop},getNoDataDiv:function(){return this.noData},createIndicator:function(e,t,a,i){if(!this.noteIndicators){this.noteIndicators=WH.ce("div");this.noteIndicators.className="listview-indicators";$(this.noteIndicators).insertBefore($(this.noteTop))}let n=$('<span class="indicator"></span>').html(e).append(!t?"":$('<a class="indicator-x">[x]</a>').attr("href",t).click((function(){if(this.tabClick){this.tabClick()}}))).css("cursor",typeof a=="function"?"pointer":null).click((function(){if(this.tabClick){this.tabClick()}if(typeof a==="function"){a()}}));if(i){WH.Tooltip.simple(n.get(0),i,"q")}$(this.noteIndicators).append(n);$(this.noteTop).css("padding-top","7px");if(!this.showLootSpecs){$(this.noteTop).css("padding-bottom","11px")}return n[0]},removeIndicators:function(){if(this.noteIndicators){$(this.noteIndicators).remove();this.noteIndicators=null}$(this.noteTop).css("padding-top","")},createProgressBar:function(e,t,a,i,n,s){if(!this.noteProgressBars){this.noteProgressBars=WH.ce("table");this.noteProgressBars.className="listview-progressbars";$(this.noteProgressBars).insertBefore($(this.noteTop))}let r=4;if(isNaN(n)||n<1){n=1}if(n>r){n=r}let o=this.noteProgressBars.lastChild;let l=n;if(o&&o.childNodes){for(let e=0;e<o.childNodes.length;++e){l+=o.childNodes[e].colSpan||1}}if(!o||l>r){o=WH.ce("tr");WH.ae(this.noteProgressBars,o)}let c=WH.ce("td");if(n>1){c.colSpan=n}if(a){c.className="clickable";c.onclick=function(){a.apply(this,i)}}if(e){WH.ae(c,WH.ce("div",{className:"heading"},WH.ct(e)))}let u=WH.ce("div",{className:"bar-wrap"});let d=WH.ce("div",{className:"bar-bg"});WH.ae(u,d);if(t[2]){let e=WH.ce("div",{className:"bar yellow"});e.style.width=Math.round((t[1]+t[2]+t[5])/t[0]*1e3)/10+"%";WH.ae(u,e)}let f=WH.ce("div",{className:"bar"});f.style.width=Math.round((t[1]+t[5])/t[0]*1e3)/10+"%";if(s){f.className+=" "+s}WH.ae(u,f);if(t[5]){let e=WH.ce("div",{className:"bar gray"});e.style.width=Math.round(t[5]/t[0]*1e3)/10+"%";WH.ae(u,e)}else{t[5]=0}let h=WH.ce("span");WH.st(h,t[1]+t[5]+(t[2]||t[3]?" ("+(t[3]||t[2])+")":"")+" / "+t[0]);WH.ae(u,h);WH.ae(c,u);WH.ae(o,c);$(this.noteTop).css("padding-top","")},removeProgressBars:function(){if(this.noteProgressBars){$(this.noteProgressBars).remove();this.noteProgressBars=null}$(this.noteTop).css("padding-top","")},addTooltipToggle:function(e,t){const a=WH.LocalStorage;if(!WH.User.isPremium()){return}let i=false;for(let e=0;e<this.data.length;e++){if(t[this.data[e].id]&&t[this.data[e].id].hasOwnProperty("screenshot")){i=true;break}}if(!i){return}WH.Tooltips.setScreenshotsEnabled(false);if(a.isSupported()){WH.Tooltips.setScreenshotsEnabled(a.get(a.KEY_TOOLTIP_SCREENSHOTS)===1)}let n=function(){WH.Tooltips.setScreenshotsEnabled(this.checked);if(a.isSupported()){if(this.checked){a.set(a.KEY_TOOLTIP_SCREENSHOTS,1)}else{a.remove(a.KEY_TOOLTIP_SCREENSHOTS)}}$("input[type=checkbox].tooltipToggle").prop("checked",!!this.checked)};let s=WH.ce("label");let r=WH.ce("input",{checked:WH.Tooltips.getScreenshotsEnabled(),className:"tooltipToggle",type:"checkbox"});WH.aE(r,"click",n.bind(r));WH.ae(s,r);WH.ae(s,WH.ct(WH.TERMS.screenshotsontooltips_stc));WH.ae(e,s)},noteTopFormIsEmpty:function(){let e=true;$("input, select",this.noteTop).each((function(){switch(this.tagName){case"INPUT":if(this.value){e=false;return false}break;case"SELECT":if($(this).val()){e=false;return false}break}}));return e}};Listview.sortRows=function(e,t){let a=Listview.sort;let i=Listview.sortOptions||Listview.columns;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let n=0,s=a.length;n<s;++n){let s;let r=i[Math.abs(a[n])-1];if(!r){r=this.template}if(r.sortFunc){s=r.sortFunc.call(this,e,t,a[n])}else if(r.getValue){s=WH.stringCompare(r.getValue(e),r.getValue(t))}else{s=WH.stringCompare(e[r.value],t[r.value])}if(s){return s*a[n]}}return 0};Listview.sortIndexedRows=function(e,t){let a=Listview.sort;let i=Listview.sortOptions||Listview.columns;let n;if(this.searchSort&&e.hasOwnProperty("searchpopularity")&&t.hasOwnProperty("searchpopularity")&&(e.searchpopularity>0||t.searchpopularity>0)){return WH.stringCompare(t.searchpopularity,e.searchpopularity)}for(let s in a){let r=i[Math.abs(a[s])-1];if(!r){r=this.template}if(r.sortFunc){n=r.sortFunc.call(this,e,t,a[0])}else if(r.getValue){n=WH.stringCompare(r.getValue(e),r.getValue(t))}else{let a=r.stat||r.value;n=WH.stringCompare(e[a],t[a])}if(n){return n*a[s]}}return e.__si-t.__si};Listview.cbSelect=function(e){for(let t=0,a=this.data.length;t<a;++t){let a=this.data[t];let i=e;if(a.__hidden){continue}if(!a.__nochk&&a.__cb){let e=a.__cb,t=e.parentNode.parentNode;if(i==null){i=!e.checked}if(e.checked!==i){e.checked=i;t.className=e.checked?t.className+" checked":t.className.replace("checked","")}}else if(i==null){i=true}a.__chk=i}};Listview.cbClick=function(e){setTimeout(Listview.cbUpdate.bind(0,0,this,this.parentNode.parentNode),1);WH.sp(e)};Listview.cbCellClick=function(e){setTimeout(Listview.cbUpdate.bind(0,1,this.firstChild,this.parentNode),1);WH.sp(e)};Listview.cbUpdate=function(e,t,a){if(e){t.checked=!t.checked}a.className=t.checked?a.className+" checked":a.className.replace("checked","")};Listview.getCompletionText=function(e){return WH.cO({all:WH.TERMS.all,identical:WH.TERMS.complete,similar:WH.TERMS.inprogress,extra:WH.TERMS.excluded,duplicate:WH.TERMS.duplicate,missing:WH.TERMS.incomplete,this:WH.TERMS.current,other:WH.TERMS.other},{[Listview.COMPLETION_TYPE_BATTLE_PET]:{identical:WH.TERMS.maxlevel,similar:WH.TERMS.lowlevel,missing:WH.TERMS.missing},[Listview.COMPLETION_TYPE_COLLECTION]:{identical:WH.TERMS.collected,missing:WH.TERMS.missing}}[e]||{})};Listview.onColumnHeaderClick=function(e,t,a){const i=this;if(this.tabClick){this.tabClick()}if(a.button===2||a.shiftKey||a.ctrlKey){WH.Tooltip.hide();requestAnimationFrame((function(){if(e.actions.length===1||a.ctrlKey){let n=e.actions[0];if(n.menu){Menu.show(n.menu,WH.closest(a.target,"th"))}else{n.action.apply(i,e,t,a)}}else{let n=[];for(let a=0,s;s=e.actions[a];a++){if(s.heading){n.push(Menu.createHeading({label:s.name}))}else{n.push(Menu.createItem({label:s.name,submenu:s.menu,url:s.menu?undefined:s.action.bind(i,e,t)}))}}Menu.show(n,WH.closest(a.target,"th"))}}))}else{this.sortBy(t+1)}return false};Listview.onColumnHeaderHover=function(e,t){if(!(this.sortable&&(t.sortable==null||t.sortable)||t.actions.length)){return}let a=WH.ce("div");if(t.tooltipElement){WH.ae(a,t.tooltipElement)}else{WH.ae(a,WH.ce("b",{className:"q1"},WH.ct(t.tooltip||t.name)))}let i=this.Filters.getColumnTooltipAdditions(t);if(i){WH.ae(a,i)}WH.ae(a,WH.ce("div",{className:"q2 no-wrap"},WH.ct(WH.TERMS.clicktosort_stc)));if(t.actions.length){let e=t.actions.length>1?WH.TERMS.rightClickForMoreActions_stc:t.actions[0].tooltipText||WH.TERMS.rightClickTo_format.replace("%s",t.actions[0].name);WH.ae(a,WH.ce("div",{className:"q2 no-wrap"},WH.ct(e)))}WH.Tooltip.show(e,a.innerHTML,"q")};(function(){let e={};Listview.loadTemplate=function(t,a){let i=()=>{if(typeof Listview.templates[t]==="function"){Listview.templates[t]=Listview.templates[t]()}};if(Listview.templates.hasOwnProperty(t)){i();if(a){a()}return}let n=t;if(n.indexOf(".")>0){n=n.substr(0,n.indexOf("."))}let s=e.hasOwnProperty(n);if(!s){e[n]=[i]}if(a){e[n].push(a)}if(!s){let a=WH.ce("script");let i=WH.staticUrl+"/js/WH/Listview/Templates/"+n+".js";if(WH.PageMeta.scriptVersionQueryString){i+="?"+WH.PageMeta.scriptVersionQueryString}a.src=i;WH.aE(a,"load",(function(){if(!Listview.templates.hasOwnProperty(t)){WH.error('Loaded listview template file "'+n+'", but template "'+t+'" still not defined!')}else{while(e[n].length){e[n].shift()()}}}));WH.aE(a,"error",(function(){WH.error('Could not load listview template "'+t+'" from file "'+n+'"!')}));WH.ae(WH.qs("head"),a)}}})();Listview.extraCols={id:{id:"id",name:"ID",width:"5%",compute:function(e,t){if(e.id){WH.ae(t,WH.ct(e.id))}},sortFunc:function(e,t){let a=parseInt(e.id||0);let i=parseInt(t.id||0);if(a===i){return 0}return a<i?-1:1}},patch:{id:"obj-patch",name:WH.TERMS.patch,compute:function(e,t){if(typeof e.patch!="undefined"){let a=parseInt(e.patch);if(a===0||a===-1){WH.ae(t,WH.ct("???"))}else{let e=Math.floor(a/1e4);let i=Math.floor(a/100)%100;let n=a%100;let s=WH.sprintf("$1.$2.$3",e,i,n);WH.ae(t,WH.ct(s))}}},sortFunc:function(e,t){if(e.patch===t.patch){return 0}else if(e.patch<t.patch){return-1}else{return 1}}},date:{id:"obj-date",name:WH.TERMS.added,compute:function(e,t){if(e.date){if(e.date<=86400){WH.ae(t,WH.ct("???"))}else{let a=new Date(e.date*1e3);let i=(WH.getServerTime()-a)/1e3;return WH.formatDate(t,i,a,null,true)}}},sortFunc:function(e,t){if(e.date===t.date){return 0}else if(e.date<t.date){return-1}else{return 1}}},cost:{id:"cost",name:WH.TERMS.cost,getValue:function(e){if(e.cost){return(e.cost[2]&&e.cost[2][0]?e.cost[2][0][1]:0)||(e.cost[1]&&e.cost[1][0]?e.cost[1][0][1]:0)||e.cost[0]}},compute:function(e,t){if(e.cost){WH.ae(t,WH.Wow.buildMoney({copper:e.cost[0],currencies:e.cost[1],items:e.cost[2]}))}},sortFunc:function(e,t){if(e.cost==null){return-1}else if(t.cost==null){return 1}let a=0,i=0,n=0,s=0;if(e.cost[2]!=null)WH.arrayWalk(e.cost[2],(function(e,t,i,n){a+=Math.pow(10,n)+e[1]}));if(t.cost[2]!=null)WH.arrayWalk(t.cost[2],(function(e,t,a,n){i+=Math.pow(10,n)+e[1]}));if(e.cost[1]!=null)WH.arrayWalk(e.cost[1],(function(e,t,a,i){n+=Math.pow(10,i)+e[1]}));if(t.cost[1]!=null)WH.arrayWalk(t.cost[1],(function(e,t,a,i){s+=Math.pow(10,i)+e[1]}));return WH.stringCompare(a,i)||WH.stringCompare(n,s)||WH.stringCompare(e.cost[0],t.cost[0])}},count:{id:"count",name:WH.TERMS.count,value:"count",compute:function(e,t){let a=WH.ct(e.count>0?WH.Strings.formatNumber(e.count):"??");if(WH.PageMeta.page==="item"&&e.hasOwnProperty("name")){a=WH.ce("span",{className:"tip",dataset:{simpleTooltip:WH.term("lootedNumerator_tip",e.name)}},a)}else if(WH.PageMeta.page==="npc"){a=WH.ce("span",{className:"tip",dataset:{simpleTooltip:WH.term("lootedNumerator_tip",g_pageInfo.name)}},a)}WH.ae(t,a);if(e.outof){let a=WH.ct(WH.Strings.sprintf(WH.TERMS.outOf_format,WH.Strings.formatNumber(e.outof)));if(WH.PageMeta.page==="item"&&e.hasOwnProperty("name")){let t=WH.ce("span",{className:"tip",dataset:{simpleTooltip:WH.term("lootedDenominator_tip",e.name)}},WH.ct(WH.Strings.formatNumber(e.outof)));a=WH.ce("span",{},WH.ct(WH.TERMS.outOf_format));a.innerHTML=WH.Strings.sprintf(a.innerHTML,t.outerHTML)}WH.ae(t,WH.ce("div",{className:"small q0"},a))}},getVisibleText:function(e){let t=e.count;if(e.outof){t+=" "+e.outof}return t},sortFunc:function(e,t){if(e.count==null){return-1}else if(t.count==null){return 1}return WH.stringCompare(e.count,t.count)}},percent:{id:"percent",name:"%",value:"percent",compute:function(row,td){const Npc=WH.Wow.Npc;let personalLootDifficulty=this.selectedDifficulty==WH.Wow.Difficulty.ID_LEGACY_RAID_FINDER;if(row.modes&&personalLootDifficulty||g_pageInfo&&(g_pageInfo.type===WH.Types.NPC&&Npc.usesPersonalLootOutdoors(g_pageInfo.typeId)||g_pageInfo.type===WH.Types.ITEM&&(Npc.usesPersonalLootOutdoors(row.id)||row.personal_loot))){$(td).addClass("tip").mouseover((function(e){WH.Tooltip.showAtCursor(e,WH.TERMS.personal_loot_tip,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}));return WH.TERMS.personal_loot_abbrev}if(row.hasOwnProperty("percentOverride")){let e=row.percentOverride;return parseFloat(e.toFixed(e>=1.95?0:e>=.195?1:2))}if(row.count<=0||!this._totalCount&&!row.outof){return"??"}if(row.pctstack){let text="";let data=eval("("+row.pctstack+")");for(let e in data){let t=data[e]*row.percent/100;if(t>=1.95){t=parseFloat(t.toFixed(0))}else if(t>=.195){t=parseFloat(t.toFixed(1))}else{t=parseFloat(t.toFixed(2))}text+=WH.sprintf(WH.TERMS.stackof_format,e,t)+"<br />"}$(td).addClass("tip").mouseover((function(e){WH.Tooltip.showAtCursor(e,text,"q")})).mousemove((function(e){WH.Tooltip.cursorUpdate(e)})).mouseout((function(){WH.Tooltip.hide()}))}let value=parseFloat(row.percent.toFixed(row.percent>=1.95?0:row.percent>=.195?1:2));if(row.pctstack){$(td).append($("<span>").addClass("tip").text(value))}else{return value}},getVisibleText:function(e){let t=e.percent;if(e.hasOwnProperty("percentOverride")){t=e.percentOverride}else if(e.count<=0){return"??"}if(t>=1.95){return t.toFixed(0)}else if(t>=.195){return parseFloat(t.toFixed(1))}else{return parseFloat(t.toFixed(2))}},sortFunc:function(e,t){let a=e.percent;let i=t.percent;if(e.count==null){a=0}if(t.count==null){i=0}if(e.hasOwnProperty("percentOverride")){a=e.percentOverride}if(t.hasOwnProperty("percentOverride")){i=t.percentOverride}let n;if(a>=1.95){n=a.toFixed(0)}else if(a>=.195){n=parseFloat(a.toFixed(1))}else{n=parseFloat(a.toFixed(2))}let s;if(i>=1.95){s=i.toFixed(0)}else if(i>=.195){s=parseFloat(i.toFixed(1))}else{s=parseFloat(i.toFixed(2))}return WH.stringCompare(n,s)}},stock:{id:"stock",name:WH.TERMS.stock,width:"10%",value:"stock",compute:function(e,t){if(e.stock>0){return e.stock}else{return String.fromCharCode(8734)}},getVisibleText:function(e){if(e.stock>0){return e.stock}else{return String.fromCharCode(8734)+" infinity"}}},currency:{id:"currency",name:WH.TERMS.currency,getValue:function(e){if(e.currency){return e.currency[0]?e.currency[0][1]:0}},compute:function(e,t){if(e.currency){WH.ae(t,WH.Wow.buildMoney({currencies:e.currency}))}},sortFunc:function(e,t){if(e.currency==null){return-1}else if(t.currency==null){return 1}let a=0,i=0;WH.arrayWalk(e.currency,(function(e,t,i,n){a+=Math.pow(10,n)+e[1]}));WH.arrayWalk(t.currency,(function(e,t,a,n){i+=Math.pow(10,n)+e[1]}));return WH.stringCompare(a,i)}},mode:{id:"mode",name:"Mode",after:"name",type:"text",compute:function(e,t){if(e.modes&&e.modes.mode){if(this.validateBonuses){for(let t in this.validateBonuses){if(WH.inArray(e.bonustrees,this.validateBonuses[t])!==-1){if(this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}else{break}}}}if(e.bonustrees&&this.diffLangref&&this.diffLangref[this.selectedDifficulty]){return this.diffLangref[this.selectedDifficulty]}let t=WH.Wow.Difficulty;let a=function(a){for(let i=0;i<t.GROUPS[a].length;i++){if(e.modes.mode.indexOf(t.GROUPS[a][i])<0){return false}}return true};let i=false;i=i||a(t.GROUP_RAID);i=i||a(t.GROUP_LEGACY_RAID);i=i||e.modes.mode.indexOf(t.ID_DUNGEON_NORMAL)>=0&&e.modes.mode.indexOf(t.ID_DUNGEON_HEROIC)>=0;return i?WH.TERMS.all:Listview.extraCols.mode.getVisibleText(e)}},getVisibleText:function(e){let t=WH.Wow.Difficulty;let a=e.modes.mode.includes.bind(e.modes.mode);let i=(a(t.ID_SEASON_OF_MASTERY_DUNGEON)||a(t.ID_SEASON_OF_MASTERY_20_PLAYER)||a(t.ID_SEASON_OF_MASTERY_40_PLAYER))&&!(a(t.ID_DUNGEON_NORMAL)||a(t.ID_RAID_40_PLAYER)||a(t.ID_CLASSIC_RAID_20_PLAYER)||a(t.ID_RAID_NORMAL));if(i){return WH.TERMS.seasonOfMastery_abbrev}if(a(t.ID_RAID_NORMAL)){return WH.TERMS.normal}if(a(t.ID_RAID_HEROIC)){return WH.TERMS.heroic}if(a(t.ID_RAID_MYTHIC)){return WH.TERMS.mythic}if(a(t.ID_RAID_FINDER)){return WH.TERMS.raidfinder}let n=a(t.ID_DUNGEON_NORMAL)||a(t.ID_TBC_DUNGEON_NORMAL)||a(t.ID_LEGACY_10_PLAYER)||a(t.ID_LEGACY_25_PLAYER);let s=a(t.ID_DUNGEON_HEROIC)||a(t.ID_TBC_DUNGEON_HEROIC)||a(t.ID_LEGACY_10_PLAYER_HEROIC)||a(t.ID_LEGACY_25_PLAYER_HEROIC)||a(t.ID_WOTLK_10_PLAYER_HEROIC)||a(t.ID_WOTLK_25_PLAYER_HEROIC);let r=a(t.ID_DUNGEON_MYTHIC);let o=a(t.ID_DUNGEON_TIMEWALKING);let l=a(t.ID_LEGACY_10_PLAYER)||a(t.ID_LEGACY_10_PLAYER_HEROIC)||a(t.ID_TBC_10_PLAYER)||a(t.ID_WOTLK_10_PLAYER_HEROIC);let c=a(t.ID_LEGACY_25_PLAYER)||a(t.ID_LEGACY_25_PLAYER_HEROIC)||a(t.ID_TBC_25_PLAYER)||a(t.ID_WOTLK_25_PLAYER_HEROIC);let u=a(t.ID_LEGACY_RAID_FINDER);let d=u;t.GROUPS[t.GROUP_DUNGEON].concat(t.GROUPS[t.GROUP_LEGACY_RAID]).forEach((function(e){d=d&&!a(e)}));let f=a(t.ID_RAID_NORMAL);let h=f;t.GROUPS[t.GROUP_DUNGEON].concat(t.GROUPS[t.GROUP_LEGACY_RAID]).forEach((function(e){h=h&&!a(e)}));let p;if(l&&!c){p=10}else if(c&&!l){p=25}let m;if(n&&!s&&!r&&!o){m="normal"}else if(s&&!n&&!r&&!o){m="heroic"}else if(r&&!n&&!s&&!o){m="mythic"}if(m&&!u&&!f){if(p&&!r){return WH.sprintf(WH.TERMS[m+"_format"],p)}else{return WH.TERMS[m]}}if(p&&!u&&!f){return WH.sprintf(WH.TERMS.dungeonplayer_format,p)}if(d){return WH.TERMS.raidfinder}if(h){return WH.TERMS.flexible}return WH.TERMS.all},sortFunc:function(e,t){return-WH.stringCompare(Listview.extraCols.mode.compute.call(this,e),Listview.extraCols.mode.compute.call(this,t))}},requires:{id:"requires",name:WH.TERMS.requires,type:"text",compute:function(e,t){let a=e.achievement?WH.Gatherer.get(WH.Types.ACHIEVEMENT,e.achievement):null;if(a){WH.noWrap(t);t.className="small";t.style.lineHeight="18px";let i=WH.ce("a",{className:"icontiny tinyspecial",href:WH.Entity.getUrl(WH.Types.ACHIEVEMENT,e.achievement),style:{backgroundImage:"url("+WH.Icon.getIconUrl(a.icon,WH.Icon.TINY)+")",whiteSpace:"nowrap"}},WH.ct(a["name_"+Locale.getName()]));WH.ae(t,i)}},getVisibleText:function(e){return WH.Gatherer.getName(WH.Types.ACHIEVEMENT,e.achievement)},sortFunc:function(e,t){let a=this.getColumn("requires");return WH.stringCompare(a.getVisibleText(e),a.getVisibleText(t))}},reqskill:{id:"reqskill",name:WH.TERMS.skill,width:"10%",value:"reqskill",before:"yield"},yield:{id:"yield",name:WH.TERMS.yields,type:"text",align:"left",span:2,value:"name",compute:function(e,t,a){if(e["yield"]&&g_items[e["yield"]]){let i=WH.ce("td");i.style.width="1px";i.style.paddingRight="0";i.style.borderRight="none";WH.ae(i,g_items.createIcon(e["yield"],1));WH.ae(a,i);t.style.borderLeft="none";let n=WH.ce("div");let s=WH.ce("a",{className:"q"+g_items[e["yield"]].quality,href:WH.Entity.getUrl(WH.Types.ITEM,e["yield"])});WH.ae(s,WH.ct(g_items[e["yield"]]["name_"+Locale.getName()]));WH.ae(n,s);WH.ae(t,n)}},getVisibleText:function(e){if(e["yield"]&&g_items[e["yield"]]){return g_items[e["yield"]]["name_"+Locale.getName()]}},sortFunc:function(e,t){if(!e["yield"]||!g_items[e["yield"]]||!t["yield"]||!g_items[t["yield"]]){return e["yield"]&&g_items[e["yield"]]?1:t["yield"]&&g_items[t["yield"]]?-1:0}return-WH.stringCompare(g_items[e["yield"]].quality,g_items[t["yield"]].quality)||WH.stringCompare(g_items[e["yield"]]["name_"+Locale.getName()],g_items[t["yield"]]["name_"+Locale.getName()])}},compare:{id:"compare",name:WH.TERMS.completion,getValue:function(e){return Math.floor(e.compare.progress*100)},compute:function(e,t,a){let i=WH.ce("span",{className:"compare-text"});if(!this.completionMode){i.style.display="block";i.style.margin="0 auto";i.style.textAlign="left";i.style.width="53px"}if(!this.completionText){this.completionText=Listview.getCompletionText()}let n=e.compare.hasOwnProperty("progressAmount")?e.compare.progressAmount:e.compare.progress;if(n<0){n=0}let s=WH.ce("span",{className:"progress-icon progress-"+(n===1?"8":Math.min(Math.round(n*8),7))});let r=WH.ce("span");if(this.completionMode){if(e.compare.progress===1){WH.st(r,this.completionText["identical"])}else if(e.compare.progress===-1){WH.st(r,this.completionText["duplicate"])}else if(!e.compare.progress&&e.compare.primary==this.dataSource){WH.st(r,this.completionText["extra"])}else if(!e.compare.progress){WH.st(r,this.completionText["missing"])}else{WH.ae(r,WH.ct(this.completionText["similar"]+" ("));WH.ae(r,WH.ce("span",{className:"tip"},WH.ct(Math.floor(e.compare.progress*100)+"%")));WH.ae(r,WH.ct(")"))}}else{WH.st(r,Math.floor(e.compare.progress*100)+"%")}let o=true;for(let t in e.compare.tooltip){o=o&&e.compare.tooltip[t].length!==e.compare.data.length}if(e.compare.tooltip.length&&o){i.onmouseover=function(e,t,a,i,n){let s='<table class="compare"><tr>';let r;s+="<tr>";for(let t=0;t<e.data.length;++t){r=e.data[t].status==a?"this":"other";s+="<td><b>"+i[r]+"</b></td>"}s+="</tr>";for(let t=0;t<e.tooltip.length;++t){let a=1;if(e.progress<1){a=e.tooltip[t][e.data[0].status]?1:0;for(let i=1;a&&i<e.data.length;++i){let n=e.tooltip[t];let s=n[e.data[i].status];if(s==="&lt;"+WH.TERMS.any+"&gt;"){continue}if(!s||s!==n[e.data[0].status]){a=0}}}s+="<tr>";for(let i=0;i<e.data.length;++i){s+='<td class="q'+a+'">'+e.tooltip[t][e.data[i].status]+"</td>"}s+="</tr>"}s+="</table>";WH.Tooltip.showAtCursor(n,s,"q")}.bind(i,e.compare,this.completionMode,this.dataSource,this.completionText);i.onmousemove=WH.Tooltip.cursorUpdate;i.onmouseout=WH.Tooltip.hide;if(!this.completionMode){r.className="tip"}}r.insertBefore(WH.ct(" "),r.firstChild);r.insertBefore(s,r.firstChild);r.style.whiteSpace="nowrap";WH.ae(i,r);WH.ae(t,i)},sortFunc:function(e,t){return e.compare.progress-t.compare.progress}},modify:{id:"modify",sortable:0,filtrable:0,compute:function(e,t,a){if(this.createModifyButton){t.style.cursor="default";$(t).click((function(e){e.stopPropagation()}));let a=WH.ce("a",{className:"icon-edit",href:"javascript:"},WH.ct(WH.TERMS.modify));WH.ae(t,this.createModifyButton(e,a))}}},bpetquality:{id:"quality",name:WH.TERMS.quality,compute:function(e,t,a){let i=e.compare.data[0].bpet&&e.compare.data[0].bpet.id?WH.Wow.Item.getQualityName(e.compare.data[0].bpet.quality):"";WH.ae(t,WH.ct(i))},sortFunc:function(e,t){let a=e.compare.data[0].bpet&&e.compare.data[0].bpet.id?e.compare.data[0].bpet.quality:-1;let i=t.compare.data[0].bpet&&t.compare.data[0].bpet.id?t.compare.data[0].bpet.quality:-1;return a-i}},popularity:{id:Listview.COLUMN_ID_POPULARITY,copyable:false,name:WH.TERMS.popularity_abbrev,sortOptionsPosition:Listview.SORT_OPTIONS_FIRST,tooltip:WH.TERMS.popularity,max:null,value:"popularity",compute:function(e,t,a,i){let n=this.columns[i];if(n.max===null){n.initMax.call(this,n)}let s=e.hasOwnProperty("popularity")?e.popularity:0;let r=n.max===0?0:s/n.max;r=Math.round(r*8);WH.ae(t,WH.ce("span",{className:"popularity-icon popularity-"+r}))},initMax:function(e){e.max=0;for(let t=0;t<this.data.length;t++){if(this.data[t].hasOwnProperty("popularity")){e.max=Math.max(e.max,this.data[t].popularity||0)}}},sortFunc:function(e,t){let a=e.hasOwnProperty("popularity")?e.popularity:0;let i=t.hasOwnProperty("popularity")?t.popularity:0;return i-a}},contentPhase:{id:"contentPhase",name:WH.isClassicTree()?WH.TERMS.seasonOfMasteryPhase:WH.TERMS.phase,tooltip:WH.isClassicTree()?WH.TERMS.seasonOfMasteryContentPhase:WH.TERMS.contentPhase,value:"contentPhase",width:"5%",getVisibleText:function(e){if(typeof e.contentPhase==="number"){return e.contentPhase.toFixed(2).replace(/\D?0*$/,"")}return e.contentPhase||""}}};Listview.templates={};Listview.funcBox={getCurrentItemBonuses:function(e){var t=[];var a=e.bonuses?e.bonuses:this.itemBonusesFromDD?this.itemBonusesFromDD:null;var i=!e.bonuses&&this.itemBonusesFromDD;var n=i?this.validateBonuses:[];if((!a||!a.length)&&e.context){var s=Listview.funcBox.getBonusDataForContext.call(this,e.context);if(s.length==2){a=s[0];n=s[1];i=true}}if(a){for(var r in a){var o=a[r];if(WH.inArray(t,o)==-1&&(!i||WH.inArray(e.bonustrees,n[r])!=-1)){t.push(o)}}}return t},getItemLevelWithBonuses:function(e){var t=e.level;var a=false;var i=false;var n=Listview.funcBox.getCurrentItemBonuses.call(this,e);if(n.length>0&&WH.isSet("g_itembonuses")){for(var s in n){var r=n[s];if(g_itembonuses[r]){WH.arrayWalk(g_itembonuses[r],(function(e){switch(e[0]){case 1:t+=e[1];break;case 11:case 13:a=e[1];break;case 14:i=e[1];break}}))}}}if(a){let e=WH.getScalingDistributionCurve(a);if(e&&e.maxLevel){let t=e.maxLevel;let a=WH.maxLevel<=t?WH.maxLevel:t;let i=Math.round(WH.getCurveValue(e.curve,a));if(i){return i}}}if(i&&t==e.level&&i<600){return i}return t},createSimpleCol:function(e,t,a,i){return{id:e,name:WH.TERMS[t]||t,width:a,value:i}},initLootTable:function(e){var t;if(this._totalCount!=null)t=this._totalCount;else t=e.outof;if(t==0){if(e.count!=-1)e.percent=e.count;else e.percent=0}else{e.percent=e.count/t*100}Listview.funcBox.initModeFilter.bind(this,e)()},initModeFilter:function(e){if(this._lootModes==null){this._lootModes={}}if(this._distinctModes==null){this._distinctModes={}}if(e.modes){let t=WH.Wow.Difficulty.getIds();for(let a=0;a<t.length;a++){let i=t[a];if(this._lootModes[i]==null){this._lootModes[i]=0}if(e.modes.mode.indexOf(i)>=0){this._lootModes[i]++}}let a=e.modes.mode.join(",");if(this._distinctModes[a]==null){this._distinctModes[a]=0}this._distinctModes[a]++}},addModeIndicator:function(){const e=this;const t=WH.Wow.Difficulty;if(!this._distinctModes){WH.error("Cannot add difficulty mode indicator, difficulty modes were not initialized.","Cause: "+(!this.data.length?"No listview data.":"Unknown."));return}let a=0;for(let e in this._distinctModes){if(this._distinctModes.hasOwnProperty(e)&&this._distinctModes[e]){a++}}if(this._distinctModes[t.GROUPS[t.GROUP_NONE].join(",")]&&a<2){return}let i=[t.ID_NONE,t.ID_DUNGEON_NORMAL,t.ID_DUNGEON_HEROIC,t.ID_DUNGEON_MYTHIC,t.ID_DUNGEON_TIMEWALKING,t.ID_TBC_DUNGEON_NORMAL,t.ID_TBC_DUNGEON_HEROIC,t.ID_SEASON_OF_MASTERY_DUNGEON,t.ID_LEGACY_RAID_FINDER,t.ID_LEGACY_10_PLAYER,t.ID_LEGACY_10_PLAYER_HEROIC,t.ID_LEGACY_25_PLAYER,t.ID_LEGACY_25_PLAYER_HEROIC,t.ID_CLASSIC_RAID_20_PLAYER,t.ID_SEASON_OF_MASTERY_20_PLAYER,t.ID_RAID_40_PLAYER,t.ID_SEASON_OF_MASTERY_40_PLAYER,t.ID_TBC_10_PLAYER,t.ID_TBC_25_PLAYER,t.ID_WOTLK_10_PLAYER_HEROIC,t.ID_WOTLK_25_PLAYER_HEROIC,t.ID_RAID_FINDER,t.ID_RAID_NORMAL,t.ID_RAID_HEROIC,t.ID_RAID_MYTHIC];let n={};n[t.ID_DUNGEON_HEROIC]=WH.TERMS.heroic;n[t.ID_DUNGEON_NORMAL]=WH.TERMS.normal;n[t.ID_TBC_DUNGEON_NORMAL]=WH.TERMS.normal;n[t.ID_TBC_DUNGEON_HEROIC]=WH.TERMS.heroic;n[t.ID_NONE]=WH.TERMS.normal;n[t.ID_LEGACY_10_PLAYER]=WH.sprintf(WH.TERMS.normal_format,10);n[t.ID_LEGACY_25_PLAYER]=WH.sprintf(WH.TERMS.normal_format,25);n[t.ID_LEGACY_10_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,10);n[t.ID_LEGACY_25_PLAYER_HEROIC]=WH.sprintf(WH.TERMS.heroic_format,25);n[t.ID_LEGACY_RAID_FINDER]=WH.TERMS.raidfinder;n[t.ID_RAID_40_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;n[t.ID_RAID_NORMAL]=WH.TERMS.normal;n[t.ID_RAID_HEROIC]=WH.TERMS.heroic;n[t.ID_RAID_MYTHIC]=WH.TERMS.mythic;n[t.ID_RAID_FINDER]=WH.TERMS.raidfinder;n[t.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic;n[t.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking;n[t.ID_CLASSIC_RAID_20_PLAYER]=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;n[t.ID_TBC_10_PLAYER]=t.getName(t.ID_TBC_10_PLAYER);n[t.ID_TBC_25_PLAYER]=t.getName(t.ID_TBC_25_PLAYER);n[t.ID_WOTLK_10_PLAYER_HEROIC]=t.getName(t.ID_WOTLK_10_PLAYER_HEROIC);n[t.ID_WOTLK_25_PLAYER_HEROIC]=t.getName(t.ID_WOTLK_25_PLAYER_HEROIC);n[t.ID_SEASON_OF_MASTERY_DUNGEON]=t.getName(t.ID_SEASON_OF_MASTERY_DUNGEON);n[t.ID_SEASON_OF_MASTERY_20_PLAYER]=t.getName(t.ID_SEASON_OF_MASTERY_20_PLAYER);n[t.ID_SEASON_OF_MASTERY_40_PLAYER]=t.getName(t.ID_SEASON_OF_MASTERY_40_PLAYER);let s={};this.diffLangref={};$.extend(this.diffLangref,n);if(WH.WAS.showAds()){s[t.ID_LEGACY_10_PLAYER]=n[t.ID_LEGACY_10_PLAYER];s[t.ID_LEGACY_25_PLAYER]=n[t.ID_LEGACY_25_PLAYER];s[t.ID_LEGACY_10_PLAYER_HEROIC]=n[t.ID_LEGACY_10_PLAYER_HEROIC];s[t.ID_LEGACY_25_PLAYER_HEROIC]=n[t.ID_LEGACY_25_PLAYER_HEROIC];s[t.ID_LEGACY_RAID_FINDER]=n[t.ID_LEGACY_RAID_FINDER];n[t.ID_LEGACY_10_PLAYER]=WH.TERMS.normal_abbrev+10;n[t.ID_LEGACY_25_PLAYER]=WH.TERMS.normal_abbrev+25;n[t.ID_LEGACY_10_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+10;n[t.ID_LEGACY_25_PLAYER_HEROIC]=WH.TERMS.horde_abbrev+25;n[t.ID_LEGACY_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;n[t.ID_RAID_NORMAL]=WH.TERMS.normal_abbrev;n[t.ID_RAID_HEROIC]=WH.TERMS.horde_abbrev;n[t.ID_RAID_MYTHIC]=WH.TERMS.mythic_abbrev;n[t.ID_RAID_FINDER]=WH.TERMS.lookingforraid_abbrev;n[t.ID_DUNGEON_MYTHIC]=WH.TERMS.mythic_abbrev;n[t.ID_DUNGEON_TIMEWALKING]=WH.TERMS.timewalking_abbrev;n[t.ID_SEASON_OF_MASTERY_DUNGEON]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_DUNGEON);n[t.ID_SEASON_OF_MASTERY_20_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_20_PLAYER);n[t.ID_SEASON_OF_MASTERY_40_PLAYER]=t.getNameShorthand(t.ID_SEASON_OF_MASTERY_40_PLAYER)}let r=[];let o=function(t){WH.setSelectedLink(this.closest&&this.closest(".indicator")||this,"lootmode-"+e.tabIndex);e.selectedDifficulty=t;let a=Listview.funcBox.getItemBonusesForDifficulty.call(e,t);e.itemBonusesFromDD=a[0];e.validateBonuses=a[1];if(t!=null){e.setSpecialHash("mode",WH.Strings.slug(n[t].replace(" ","")))}else{e.removeSpecialHash("mode")}e.customFilter=function(a){if(e.hasMultipleSeasonsPhases){return Listview.funcBox.filterSeasonPhaseMode(a,e._totalCount,t)}else{return Listview.funcBox.filterMode(a,e._totalCount,t)}};e.Filters.apply();e.applySort();e.refreshRows(true)};let l;let c=e.getSpecialHash("mode");for(let e=0;e<i.length;e++){let a=i[e];if(!this._lootModes[a]){continue}let u=WH.ce("a");WH.ae(u,WH.ce("span",{},WH.ct(n[a])));WH.ae(u,WH.ct(WH.Strings.sprintf(WH.TERMS.parens_format,"",this._lootModes[a])));u._clickAction=o.bind(u,a);WH.aE(u,"click",u._clickAction);let d=t.getIconClass(a);if(d){u.classList.add(d)}r.push({indicator:$('<span class="indicator-mode"></span>').append(u).append($("<b"+(d?' class="'+d+'"':"")+">"+n[a]+" ("+this._lootModes[a]+")</b>")),tooltip:s[a]});if(r.length===1){l=o.bind(u[0],a)}if(c===WH.Strings.slug(n[a].replace(" ",""))){u._clickAction()}}if(l&&(!WH.setSelectedLink.groups||!WH.setSelectedLink.groups["lootmode-"+e.tabIndex])){l()}let u=false;for(let e=0;e<r.length;++e){let t=$("a",r[e].indicator);if(!$("span",t).html()&&r.length==3){u=true}else{this.createIndicator(r[e].indicator,null,t[0]._clickAction,r[e].tooltip)}}if(u){l()}if(this.showLootSpecs){this.classSelectorDiv.style.marginTop="0px"}$(this.noteTop).append($('<div class="clear"></div>'))},addModesAndSeasonsPhases:function(){this._selectedSeasonId=this._selectedSeasonId||0;this._selectedPhaseId=this._selectedPhaseId||0;Listview.funcBox.addModeIndicator.call(this);if(this.hasMultipleSeasonsPhases&&this.seasonPhaseData!=undefined){let e=function(e,t,a,i,n,s){this._selectedSeasonId=e;this._selectedPhaseId=t;WH.st(i,Menu.getLabel(s));n.forEach((e=>{if(e==s){e.checked=true}else{e.checked=false}}));a.Filters.apply();a.applySort();a.refreshRows(true)};let t=[];let a=WH.DOM.createImitationSelect({menu:t});let i=Object.keys(this.seasonPhaseData);for(let n in this.seasonPhaseData){for(let s in this.seasonPhaseData[n]){let r="";n=parseInt(n);s=parseInt(s);if(i.length>1){if(n===0&&s===0){r=WH.term("allSeasonsAndPhases")}else{r=WH.term("seasonAndPhase_format",n,s)}}else{if(s===0){r=WH.term("allPhases")}else{r=WH.term("phase_format",s)}}let o=Menu.createItem({label:r});Menu.setItemUrl(o,e.bind(Listview.funcBox,n,s,this,a,t,o));t.push(o);if(n==this._selectedSeasonId&&s==this._selectedPhaseId){o.checked=true;WH.st(a,r)}}}a.style.float="left";a.style.marginRight="10px";this.noteTop.style.paddingTop="6px";WH.aef(this.bandTop,a);if(Object.keys(this._distinctModes).length<=1){this.customFilter=function(e){return Listview.funcBox.filterSeasonPhaseMode(e,this._totalCount,WH.Wow.Difficulty.ID_NONE)};this.Filters.apply();this.applySort();this.refreshRows(true)}}},filterMode:function(e,t,a){if(t!=null&&e.count!=null){if(e._count==null)e._count=e.count;var i=e._count;if(a!=null&&e.modes[a]){i=e.modes[a].count;t=e.modes[a].outof;if(e.modes[a].percentOverride){e.percentOverride=e.modes[a].percentOverride}}e.__tr=null;e.count=i;e.outof=t;if(t)e.percent=i/t*100;else e.percent=i}if(a==null){return true}return e.modes&&e.modes.mode&&e.modes.mode.indexOf(a)>=0},filterSeasonPhaseMode:function(e,t,a){let i=this._selectedSeasonId||0;let n=this._selectedPhaseId||0;if(e.seasonId!=undefined&&e.phaseId!=undefined){e.percent=e.count/e.outof*100;return e.seasonId==i&&e.phaseId==n}a=a||WH.Wow.Difficulty.ID_NONE;let s=0;if(e.itemSeasonPhaseData){let r=((e.itemSeasonPhaseData[i]||{})[n]||{})[a];if(!r){return false}s=r.count;t=r.outof;if(r.percentOverride){e.percentOverride=r.percentOverride}}if(e._count==null){e._count=e.count}e.__tr=null;e.count=s;e.outof=t;if(t){e.percent=s/t*100}else{e.percent=s}return true},getItemBonusesForDifficulty:function(e){var t=[];if(e&&WH.isSet("g_pageInfo")){var a=e<0?-e:e;var i=0;var n=g_pageInfo.typeId;switch(g_pageInfo.type){case 1:i=g_npcs[n]&&g_npcs[n].hasOwnProperty("location")?g_npcs[n].location[0]:0;break;case 7:i=n;break;default:break}var s=0;if(WH.isSet("g_mapdifficulties")&&g_mapdifficulties[i]&&g_mapdifficulties[i][a]){s=g_mapdifficulties[i][a]}else if(WH.isSet("g_difficulties")&&g_difficulties[a]){s=g_difficulties[a].context||0}t=Listview.funcBox.getBonusDataForContext.call(this,s)}return t},getItemUrl:function(e){var t;if(e.baseName){t=e.baseName}else if(typeof e.name==="string"&&e.name!==""){t=e.name}var a={};var i=Listview.funcBox.getCurrentItemBonuses.call(this,e);if(i.length>0){a.bonus=i.join(":")}if(this.ilvlOverride){a[this.ilvlOverride.name]=""}else if(this.addIlvlToLinks){a.ilvl=Listview.funcBox.getItemLevelWithBonuses(e)}return WH.Entity.getUrl(WH.Types.ITEM,e.id,t,a)},getBonusDataForContext:function(e){var t=[];if(e&&WH.isSet("g_item_bonuscontexts")&&g_item_bonuscontexts[e]){var a=[];var i=[];for(var n in g_item_bonuscontexts[e]){var s=g_item_bonuscontexts[e][n];a.push(s[1]);i.push(s[0])}t=[a,i]}return t},assocArrCmp:function(e,t,a){if(e==null)return-1;else if(t==null)return 1;var i=Math.max(e.length,t.length);for(var n=0;n<i;++n){if(e[n]==null)return-1;else if(t[n]==null)return 1;var s=WH.stringCompare(a[e[n]],a[t[n]]);if(s!=0)return s}return 0},location:function(e,t,a){if(e.location==null){return}var i=a?a:3;var n=e.location.slice(0,i);if(n.length<e.location.length){n.push(-1)}for(var s=0,r=n.length;s<r;++s){if(s>0)WH.ae(t,WH.ct(WH.TERMS.comma_punct));var o=n[s];if(o==-1)WH.ae(t,WH.ct(WH.TERMS.ellipsis_punct));else{var l=WH.ce("a");l.className="q1";l.href=WH.Entity.getUrl(WH.Types.ZONE,o,WH.Wow.Area.getName(o));WH.ae(l,WH.ct(WH.Wow.Area.getName(o)||WH.Gatherer.getName(WH.Types.ZONE,o)));WH.ae(t,l)}}},arrayText:function(e,t){if(e==null){return}else if(!Array.isArray(e)){return t[e]}var a="";for(var i=0,n=e.length;i<n;++i){if(i>0)a+=" ";if(!t[e[i]])continue;a+=t[e[i]]}return a},createCenteredIcons:function(e,t,a,i,n,s,r){if(e!=null){var o=0;var l=WH.ce("div"),c=WH.ce("div");WH.ae(document.body,l);if(a&&(e.length!=1||!r)){var u=WH.ce("div");u.style.position="relative";u.style.width="1px";var d=WH.ce("div");d.className="q0";d.style.position="absolute";d.style.right="2px";d.style.lineHeight="26px";d.style.fontSize="11px";d.style.whiteSpace="nowrap";WH.ae(d,WH.ct(a));WH.ae(u,d);WH.ae(l,u);l.style.paddingLeft=$(d).width()+"px"}var f=g_items;if(i==WH.Types.SPELL){f=g_spells}else if(i==WH.Types.BATTLE_PET_ABILITY){f=g_petabilities}for(var h=0,p=e.length;h<p;++h){if(s&&o%s==0){WH.ae(l,WH.ce("div",{className:"clear-left"}))}o++;var m;if(e[h]==null){m=WH.ce("div");m.style.width=m.style.height="26px"}else{var H=undefined;var g=undefined;var W=undefined;if(typeof e[h]=="object"){H=e[h][0];g=e[h][1];W=e[h][2]}else{H=e[h]}if(typeof H=="string"){m=Icon.create(H,0,null,W)}else if(H){m=f.createIcon(H,0,g)}else{m=Icon.create("inventoryslot_empty",0,null,"javascript:")}if(n){m.children[2].rel=n[h]}}if(e.length==1&&r){if(H&&g_items[H]){WH.ee(l);var E=g_items[H],_=WH.ce("a"),v=WH.ce("span");v.style.paddingTop="4px";_.href=WH.Entity.getUrl(WH.Types.ITEM,H);_.className="q"+E.quality+" icontiny tinyspecial";_.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+E.icon.toLowerCase()+".gif)";_.style.whiteSpace="nowrap";WH.st(_,WH.Gatherer.getName(WH.Types.ITEM,H));WH.ae(v,_);if(g>1)WH.ae(v,WH.ct(" ("+g+")"));if(a){var u=WH.ce("span");u.className="q0";u.style.fontSize="11px";u.style.whiteSpace="nowrap";WH.ae(u,WH.ct(a));WH.ae(l,u);if($(d).length>0)v.style.paddingLeft=$(d).width()+"px"}WH.ae(l,v)}}else{m.style.cssFloat=m.style.styleFloat="left";WH.ae(l,m);l.style.margin="0 auto";l.style.textAlign="left";var T=e.length;if(s&&s<e.length){T=s}l.style.width=26*T+"px"}}c.className="clear";WH.ae(t,l);WH.ae(t,c);return true}},createSocketedIcons:function(e,t,a,i,n){var s=0,r=WH.ce("div"),o=WH.ce("div");for(var l=0,c=e.length;l<c;++l){var u,d=a[l];if(g_items&&g_items[d])u=g_items.createIcon(d,0);else if(WH.isSet("g_gems")&&g_gems&&g_gems[d])u=Icon.create(g_gems[d].icon,0,null,WH.Entity.getUrl(WH.Types.ITEM,d));else u=Icon.create(null,0,null,"javascript:");u.className+=" iconsmall-socket-"+g_file_gems[e[l]]+(!a||!d?"-empty":"");u.style.cssFloat=u.style.styleFloat="left";if(i&&i[l]){u.insertBefore(WH.ce("var"),u.childNodes[1]);++s}WH.ae(r,u)}r.style.margin="0 auto";r.style.textAlign="left";r.style.width=26*e.length+"px";o.className="clear";WH.ae(t,r);WH.ae(t,o);if(n&&s==e.length){r=WH.ce("div");r.style.paddingTop="4px";WH.ae(r,WH.ct(n));WH.ae(t,r)}}};var LOCALE_ENUS=0;var LOCALE_KOKR=1;var LOCALE_FRFR=2;var LOCALE_DEDE=3;var LOCALE_ZHCN=4;var LOCALE_ESES=6;var LOCALE_RURU=7;var LOCALE_PTBR=8;var LOCALE_ITIT=9;var LOCALE_ZHTW=10;var LOCALE_ESMX=11;var Locale={DEFAULT:LOCALE_ENUS,current:{},locales:{0:{id:LOCALE_ENUS,name:"enus",code:"en",description:"English",descriptionEnglish:"English"},1:{id:LOCALE_KOKR,name:"kokr",code:"ko",description:"한국어",descriptionEnglish:"Korean"},2:{id:LOCALE_FRFR,name:"frfr",code:"fr",description:"Français",descriptionEnglish:"French"},3:{id:LOCALE_DEDE,name:"dede",code:"de",description:"Deutsch",descriptionEnglish:"German"},4:{id:LOCALE_ZHCN,name:"zhcn",code:"zh",description:"简体中文",descriptionEnglish:"Simplified Chinese"},6:{id:LOCALE_ESES,name:"eses",code:"es",description:"Español",descriptionEnglish:"Spanish"},7:{id:LOCALE_RURU,name:"ruru",code:"ru",description:"Русский",descriptionEnglish:"Russian"},8:{id:LOCALE_PTBR,name:"ptbr",code:"pt",description:"Português Brasileiro",descriptionEnglish:"Brazilian Portuguese"},9:{id:LOCALE_ITIT,name:"itit",code:"it",description:"Italiano",descriptionEnglish:"Italian"}},exists:function(e){return Locale.locales.hasOwnProperty(e)},getAll:function(){var e=[];for(var t in Locale.locales){e.push(Locale.locales[t])}return e},getAllByName:function(){var e=Locale.getAll();e.sort((function(e,t){return WH.stringCompare(e.description,t.description)}));return e},getBySelector:function(e){return WH.getLocaleFromDomain.L[e]},getCode:function(e){return(Locale.locales[e]||Locale.locales[Locale.getId()]).code},getDataEnvForcedLocale:function(e){switch(e){case WH.dataEnv.PTR:case WH.dataEnv.PTR2:case WH.dataEnv.BETA:return LOCALE_ENUS}return undefined},getDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return Locale.locales[e].description},getEnglishDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return Locale.locales[e].descriptionEnglish},getLocalizedDescription:function(e){if(typeof e!=="number"&&typeof e!=="string"){e=Locale.getId()}return WH.GlobalStrings["LFG_LIST_LANGUAGE_"+Locale.getName(e).toUpperCase()]},getId:function(){return Locale.current.id},getIetf:function(e){let t=Locale.getName(e);return t.substr(0,2)+"-"+t.substr(2,2).toUpperCase()},getName:function(e){if(!Locale.locales[e]){e=Locale.getId()}return Locale.locales[e].name},getPathSelectors:function(){return Object.keys(WH.getLocaleFromDomain.L)},getPreferred:function(){if(!WH.Cookies.available()){return}let e=WH.getCookies("prefLocale");if(e==undefined){return}e=parseInt(e);return Locale.exists(e)?e:undefined},get:function(){var e=Locale.getId();return Locale.locales[e]},getSelector:function(e){return WH.findKey(WH.getLocaleFromDomain.L,e)},isLocaleName:function(e){for(var t in Locale.locales){if(Locale.locales.hasOwnProperty(t)&&Locale.locales[t].name===e){return true}}return false},set:function(e){$.extend(Locale.current,Locale.locales[e]);if(e!==LOCALE_ENUS){Menu.sortGlobalMenus()}},setPreferred:function(e){if(!WH.Cookies.available()){return}if(e==null){WH.deleteCookie("prefLocale","/",WH.Cookies.getDomain(),true)}else if(!Locale.exists(e)){WH.error("Invalid locale: ["+e+"]")}else{WH.setCookie("prefLocale",365,e,"/",WH.Cookies.getDomain(),true)}},formatList:function(e,t,a){var i=t==="or"?e.length===2?WH.TERMS.wordspace_punct+WH.TERMS.or_lc+WH.TERMS.wordspace_punct:WH.TERMS.finalenumerationseparatoror_punct:e.length===2?WH.TERMS.and_lc:WH.TERMS.finalenumerationseparator_punct;if(a){var n=Math.max((WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct).length,i.length);var s=(""+e[e.length-1]).length;a-=n+s}var r="";for(var o=0,l=e.length;o<l;o++){if(o>0){r+=o===l-1?i:WH.TERMS.enumerationseparator_punct}r+=e[o];if(a&&r.length>=a&&o<e.length-2){r+=WH.TERMS.wordspace_punct+WH.TERMS.ellipsis_punct+WH.TERMS.wordspace_punct+e[e.length-1];break}}return r},hasSentenceSpaces:function(e){return e!==LOCALE_ZHCN},hasWordSpaces:function(e){return e!==LOCALE_ZHCN}};Locale.set(LOCALE_ENUS);function Mapper(e,t){WH.cO(this,e);if(this.parent&&!this.parent.nodeName){this.parent=WH.ge(this.parent)}else{if(!this.parent){return}}var a;this.mouseX=0;this.mouseY=0;this.editable=this.editable||false;this.overlay=this.overlay||false;this.dataEnv=this.dataEnv||WH.getDataEnv();if(WH.isClassicTree(this.dataEnv)){this.rootMapDir="/images/wow/classic/maps"}else if(WH.isTbcTree(this.dataEnv)){this.rootMapDir="/images/wow/tbc/maps"}else if(WH.isWrathTree(this.dataEnv)){this.rootMapDir="/images/wow/wrath/maps"}else if(this.legacy){this.rootMapDir="/images/wow/maps/legacy"}else{this.rootMapDir="/images/wow/maps"}this.localeDir=Locale.getName();if(this.dataEnv===WH.dataEnv.PTR){this.localeDir="ptr"}else if(this.dataEnv===WH.dataEnv.PTR2){this.localeDir="ptr2"}else if(this.dataEnv===WH.dataEnv.BETA){this.localeDir="beta"}if(this.editable){this.zoomable=this.toggle=false;this.show=this.mouse=true}else{this.zoomable=this.zoomable==null?true:this.zoomable;this.toggle=this.toggle==null?true:this.toggle;this.show=this.show==null?true:this.show;this.mouse=this.mouse==null?false:this.mouse}this.buttons=this.buttons==null?true:this.buttons;this.zoneLink=this.zoneLink==null?true:this.zoneLink;if(location.href.indexOf("zone=")!=-1){this.zoneLink=false}this.zoom=this.zoom||0;this.zone=this.zone||0;this.level=this.level==null?Mapper.zoneDefaultLevel[this.zone]||0:this.fixLevel(this.level,this.zone);this.phase=0;if(Mapper.zoneDefaultPhase){this.phase=Mapper.zoneDefaultPhase[this.zone]||0}this.pins=[];this.nCoords=0;this.tempWidth=null;this.tempHeight=null;this.parent.className="mapper";this.parent.appendChild(this.span=WH.ce("span",{className:"mapper-map"}));this.overlaySpan=a=WH.ce("div",{className:"mapper-overlay"});this.overlaySpan.appendChild(WH.ce("div",{className:"mapper-overlay-expander"}));this.span.appendChild(a);this.buttonDiv=a=WH.ce("div");a.style.position="absolute";a.style.top=a.style.right="3px";if(this.buttons){this.parent.appendChild(a)}if(this.editable){this.span.onmouseup=this.addPin.bind(this);this.parent.appendChild(WH.ce("span",{className:"mapper-pins-tip"},WH.ct(WH.TERMS.clickmappins_tip)))}else{this.sToggle=a=WH.createButton(WH.TERMS.hidepins_stc,null,{click:this.toggleShow.bind(this)});a.style["float"]="right";a.style.display="none";this.buttonDiv.appendChild(a)}if(this.zoomable){this.span.onclick=this.toggleZoom.bind(this);this.span.id="sjdhfkljawelis"+(this.unique!==undefined?this.unique:"");this.zoomTip=WH.ce("span",{className:"mapper-zoom-tip"},WH.ct(WH.TERMS.clickmapzoom_tip));this.span.appendChild(this.zoomTip)}this.sZoneLink=WH.ce("span",{className:"mapper-zone-link",style:{display:"none"}});this.parent.appendChild(this.sZoneLink);if(this.mouse){this.parent.onmouseout=function(){this.timeout=setTimeout(function(){this.sMouse.style.display="none"}.bind(this),1)}.bind(this);this.parent.onmouseover=function(){clearTimeout(this.timeout);this.sMouse.style.display=""}.bind(this);this.span.onmousemove=this.updateMouseCoords.bind(this);this.span.onmousedown=this.updateMouseCoords.bind(this);this.sMouse=WH.ce("span",{className:"mapper-coords",style:{display:"none"}},WH.ct("(0.0, 0.0)"));this.sMouse.onmouseup=WH.sp;this.span.appendChild(this.sMouse)}this.floorPins={};if(e.coords!=null){this.setCoords(e.coords,this.level,e.uiMapId,e.uiMapName)}else{if(e.link!=null){this.setLink(e.link)}}if(e.objectives){this.setObjectives(e.objectives)}if(e.zoneparent&&e.zones){this.setZones(e.zoneparent,e.zones)}this.onlyPhases=false;if(Mapper.multiLevelZones.hasOwnProperty(this.zone)){this.onlyPhases=Mapper.multiLevelZones[this.zone].length==Mapper.multiLevelZones[this.zone].filter((function(e){return e.indexOf("_")!=-1})).length+1}this.updateMap(t)}Mapper.sizes=[[488,325,"normal"],[772,515,"zoom"],[1002,668,"original"],[224,149,"small"]];Mapper.zoneLevelOffset={};Mapper.multiLevelZones={};Mapper.zonePhased={};Mapper.garrisonLevelsToMapTiers={};Mapper.zoneDefaultLevel={};Mapper.remappedLevels={};Mapper.prototype={getMap:function(){return this.parent},update:function(e,t){if(e.zoom!=null){this.zoom=e.zoom}if(e.zone!=null){this.zone=e.zone}if(e.show!=null){this.show=e.show}this.pins=[];this.nCoords=0;for(var a in this.floorPins){if(this.floorPins[a].parentNode){WH.de(this.floorPins[a])}}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}var i=e.level===undefined?0:this.fixLevel(parseInt(e.level),this.zone);if(!e.preservelevel){this.level=i}else{i=this.level}var n=WH.isSet("g_mapperData")?g_mapperData:false;if(n&&n[this.zone]&&!e.coords){var s=n[this.zone];var r=-1;for(var a in s){if(!s.hasOwnProperty(a)){continue}var o=this.fixLevel(parseInt(a),this.zone);if(e.level===undefined&&s[a].count>r){i=parseInt(o);r=s[a].count}if(s[a].coords){this.setCoords(s[a].coords,o,s[a].uiMapId,s[a].uiMapName)}}this.level=i;if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(e.coords!=null){var l=999;for(var a in e.coords){if(!e.coords.hasOwnProperty(a)){continue}var o=this.fixLevel(parseInt(a),this.zone);this.setCoords(e.coords[a],o,e.uiMapId,e.uiMapName);if(o<l){l=o}}if(l!=999&&!e.preservelevel){this.level=l}if(this.floorPins[this.level]){WH.ae(this.span,this.floorPins[this.level])}}else{if(e.link!=null){this.setLink(e.link)}}}this.updateMap(t)},fixLevel:function(e,t){if(Mapper.remappedLevels[t]&&Mapper.remappedLevels[t].hasOwnProperty(e)){return Mapper.remappedLevels[t][e]}if(Mapper.multiLevelZones.hasOwnProperty(t)){var a=parseInt(Mapper.multiLevelZones[t][0].substr((""+t).length+1));var i;for(var n=1;n<Mapper.multiLevelZones[t].length;n++){i=parseInt(Mapper.multiLevelZones[t][n].substr((""+t).length+1));if(Math.abs(e-i)<Math.abs(e-a)){a=i}}return a}return e},getZone:function(){return this.zone},setZone:function(e,t,a){this.pins=[];this.nCoords=0;if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}this.floorPins={};if(this.floorButton){WH.de(this.floorButton);this.floorButton=null}this.zone=e;this.level=t||0;this.updateMap(a);return true},getFloorsMenu:function(){if(!Mapper.multiLevelZones[this.zone]){return null}var e=[];var t=Mapper.multiLevelZones[this.zone];var a=Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas;var i=function(e){return e[Menu.ITEM_CRUMB]==this.mapName||this.level===undefined&&e[Menu.ITEM_CRUMB]==0}.bind(this);var n,s,r;for(var o=0;s=t[o];o++){var l=0;var c=s.indexOf("-");var u=s.indexOf("_");if(c<0){n=o}else if(u>=0){n=s.substring(c+1,u);l=s.substr(u+1)}else{n=s.substr(c+1)}var d=this.getMapDisplayName(s,this.zone,n,l);r=[s,d,this.setMap.bind(this,s,n,l,true)];r[Menu.ITEM_OPTIONS]={checkedFunc:i};e.push(r)}return e},getMapDisplayName:function(e,t,a,i){var n="";var s;if(Mapper.zonePhased[t]&&g_zone_phases[t]){var r=Mapper.multiLevelZones[t].indexOf(e);if(g_zone_phases[t].hasOwnProperty(r)){s=g_zone_phases[t][r]}}if(g_zone_areas[t]&&g_zone_areas[t].hasOwnProperty(a)){n=g_zone_areas[t][a]}else if(g_zone_playerconditions[t]&&g_zone_playerconditions[t].hasOwnProperty(i)){n=g_zone_playerconditions[t][i]}else if(s){n=s}else{if(this.onlyPhases){n=WH.Strings.sprintf(WH.TERMS.zonePhase_format,i)}else if(Mapper.multiLevelZones[t].filter((function(e){return e.indexOf("-"+a+"_")!=-1})).length+(a==0?1:0)>1){n=WH.Strings.sprintf(WH.TERMS.zoneLevelPhase_format,a,i)}else{n=WH.Strings.sprintf(WH.TERMS.zoneLevel_format,a)}}return n},setMap:function(e,t,a,i){if(t!=this.level){if(this.floorPins[this.level]){WH.de(this.floorPins[this.level])}if(this.floorPins[t]){WH.ae(this.span,this.floorPins[t])}this.level=t}this.mapName=e;this.phase=a;this.span.style.background="url("+WH.staticUrl+this.rootMapDir+"/"+this.localeDir+"/"+Mapper.sizes[this.zoom][2]+"/"+e+".jpg?"+WH.getDataCacheVersion()+")";if(this.overlay){this.overlaySpan.style.background="url("+WH.staticUrl+this.rootMapDir+"/overlay/"+Mapper.sizes[this.zoom][2]+"/"+e+".png?"+WH.getDataCacheVersion()+")"}if(this.sZoneLink&&!this.noZoneName){var n="";var s=parseInt(this.zone);var r=WH.Wow.Area.getName(s)!=null;var o=Mapper.zonePhased[this.zone]?g_zone_phases:g_zone_areas;if(r){if(this.zoneLink){n+=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.ZONE,s)},WH.ct(WH.Wow.Area.getName(s))).outerHTML}if(Mapper.multiLevelZones[s]){if(this.zoneLink){n+=": "}n+=this.getMapDisplayName(e,s,t,a)}this.sZoneLink.innerHTML=n}this.sZoneLink.style.display=r?"":"none"}if(i){this.onMapUpdate&&this.onMapUpdate(this)}},setObjectives:function(e){var t={start:1,end:1,startend:1,sourcestart:1,sourceend:1};for(var a in e){var i=e[a];if(g_mapperData[a]===undefined){g_mapperData[a]={}}for(var n in i.levels){var s=i.levels[n];var r=ShowOnMap.combinePins(s);var o=r[0];g_mapperData[a][n]={count:o.length,coords:[]};for(var l=0;l<o.length;++l){var c=ShowOnMap.buildTooltip(o[l].list);g_mapperData[a][n].coords.push([o[l].coord[0],o[l].coord[1],{type:c[1],url:c[2],menu:c[3],label:c[0]}])}}}},setZones:function(e,t){e=$("#"+e);if(!e||!t||t.length==0||!this.objectives){return}var a=function(e,a,i,n){var s=[false,-1];for(var r=0;r<i.length;++r){if(r>0){d.append(r==i.length-1?WH.TERMS.and_lc:WH.TERMS.comma_punct)}var o=null;if(e.objectives[i[r][0]].mappable>0){o=$("<a/>",{href:"javascript:",text:e.objectives[i[r][0]].zone});o.click(function(t,a){e.update({zone:a});WH.setSelectedLink(t,"mapper")}.bind(e,o[0],i[r][0]));o.isLink=true}else{let t=WH.Entity.getUrl(WH.Types.ZONE,i[r][0]);o=$("<a/>",{href:t,text:e.objectives[i[r][0]].zone});WH.Tooltip.simple(o[0],WH.TERMS.zonelink_tip,"q")}if(t.length>1){var l=n[i[r][0]];if(l.start&&l.end){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_startend.gif)");o.css("padding-left","20px")}else{if(l.start){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_start.gif)");o.css("padding-left","14px")}else{if(l.end){o.addClass("icontiny");o.css("background-image","url("+WH.staticUrl+"/images/wow/icons/tiny/quest_end.gif)");o.css("padding-left","16px")}}}}a.append(o);if(i[r][1]>s[1]){s=[o,i[r][1]]}}return s[0]};var i=function(e,t,a){var i=[];for(var n=0;n<e.length;++n){if(t[e[n][0]][a]){i.push(e[n])}}return i};var n={};var s={start:[],end:[],objective:[]};for(var r in this.objectives){if(n[r]===undefined){n[r]={}}var o=this.objectives[r];for(var l in o.levels){var c=o.levels[l];for(var u=0;u<c.length;++u){if(c[u].point=="start"||c[u].point=="sourcestart"){s.start.push(r);n[r].start=true}else{if(c[u].point=="end"||c[u].point=="sourceend"){s.end.push(r);n[r].end=true}else{if(c[u].point=="requirement"||c[u].point=="sourcerequirement"){s.objective.push(r);n[r].objective=true}}}}}}e.append(WH.getMajorHeading(WH.TERMS.relevantlocations,2,3));if(t.length==1&&this.missing==0){var d=$("<span/>",{html:WH.TERMS.questobjectives1zone_tip.replace("$$","<b>"+this.objectives[t[0][0]].zone+"</b>.")});e.append(d);this.update({zone:t[0][0]})}else{if(this.missing>0){var f=function(e,t){if(e.length!=t.length){return false}var a={};for(var i=e.length;i>=0;--i){a[e[i]]=true}for(var n=t.length;n>=0;--n){if(a[t[n]]===undefined){return false}}return true};var d=$("<span/>");var h=false,p=false,m=false;s.objective=WH.arrayUnique(s.objective);s.start=WH.arrayUnique(s.start);s.end=WH.arrayUnique(s.end);var H=s.start.length>0&&f(s.start,s.end);var g=s.start.length>0&&f(s.start,s.objective);var W=s.end.length>0&&f(s.end,s.objective);var E=i(t,n,"objective");var _=i(t,n,"start");var v=i(t,n,"end");let r=WH.getPageData("mapper.objectiveTerms");let o;switch(true){case!!(H&&g):o=WH.TERMS.partofquesthappensin_format.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!(H&&s.objective.length==0):o=r.sex.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!H:o=r.ox_sey.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);break;case!!(g&&s.end.length==0):o=r.osx.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!g:o=r.osx_ey.split("$$");d.text(o[0]);h=a(this,d,E,n);d.append(o[1]);p=a(this,d,v,n);d.append(o[2]);break;case!!(W&&s.start.length==0):o=r.oex.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case!!W:o=r.oex_sy.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);break;case!!(s.start.length>0&&s.end.length>0&&s.objective.length>0):o=r.ox_sy_ez.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);m=a(this,d,v,n);d.append(o[3]);break;case!!(s.start.length>0&&s.end.length>0):o=r.sx_ey.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,v,n);d.append(o[2]);break;case!!(s.start.length>0&&s.objective.length>0):o=r.ox_sy.split("$$");d.text(o[0]);h=a(this,d,_,n);d.append(o[1]);p=a(this,d,E,n);d.append(o[2]);break;case!!(s.end.length>0&&s.objective.length>0):o=r.ox_ey.split("$$");d.text(o[0]);h=a(this,d,E,n);d.append(o[1]);p=a(this,d,v,n);d.append(o[2]);break;case s.start.length>0:o=r.sx.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case s.end.length>0:o=r.ex.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;case s.objective.length>0:o=r.ox.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break;default:o=WH.TERMS.partofquesthappensin_format.split("$$");d.text(o[0]);h=a(this,d,t,n);d.append(o[1]);break}e.append(d);if(h&&h.isLink){h.click()}else{if(p&&p.isLink){p.click()}else{if(m&&m.isLink){m.click()}}}}else{var T=WH.TERMS.partofquesthappensin_format.split("$$");var d=$("<span/>",{text:T[0]});var h=a(this,d,t,n);d.append(T[1]);e.append(d);if(h&&h.isLink){h.click()}}}},setSize:function(e,t){this.tempWidth=e;this.tempHeight=t;this.updateMap(true)},getZoom:function(){return this.zoom},setZoom:function(e,t){this.zoom=e;this.tempWidth=this.tempHeight=null;this.updateMap(t)},toggleZoom:function(e){this.zoom=1-this.zoom;this.zoom++;this.updateMap(true);if(e){this.updateMouseCoords(e)}if(this.zoomTip){this.zoomTip.style.display=this.zoomTip.style.display==="none"?"":"none"}if(this.zoom){if(window.innerWidth>=900){MapViewer.show({mapper:this,zoom:this.zoom})}}},getShow:function(){return this.show},setShow:function(e){this.show=e;var t=this.show?"":"none";for(var a in this.floorPins){this.floorPins[a].style.display=t}this.sToggle.innerHTML=this.show?WH.TERMS.hidepins_stc:WH.TERMS.showpins_stc},toggleShow:function(){this.setShow(!this.show)},getCoords:function(){var e=[];for(var t in this.pins){if(!this.pins[t].free){e.push([this.pins[t].x,this.pins[t].y])}}return e},clearPins:function(){for(var e in this.pins){this.pins[e].style.display="none";this.pins[e].free=true}},setCoords:function(e,t,a,i){var n;var s,r;if(t===undefined){this.clearPins();if(e.length){r=true;s=0}else{for(let t in e){s=t;break}if(s==null){return}e=e[s]}s=parseInt(s);if(!r){s=this.fixLevel(s,this.zone);this.level=s}}else{s=t;if(!e.length){e=e[s]&&e[s].length?e[s]:[]}}this.nCoords=e.length;a=a||this.uiMapId;i=i||this.uiMapName;for(let t in e){var o=e[t],l=o[2];if(o[0]===undefined||o[1]===undefined){continue}if(o[0]===null||o[1]===null){var c=this.parent.id?this.parent.id.replace(/^mapper-parent-/,""):this.parent;if(WH.Wow.Area.getName(c)){c=WH.Wow.Area.getName(c)}WH.error("Bad coordinates for",c,"-- Pin Coords:",o);continue}n=this.getPin(s);n.x=o[0];n.y=o[1];n.style.left=n.x+"%";n.style.top=n.y+"%";let r=false;if(this.editable&&!(l&&l.locked)){n.a.onmouseup=this.delPin.bind(this,n);r=true}else{if(l&&l.url){n.a.href=l.url;n.a.rel="np"+(l.rel?"&"+l.rel:"");n.a.style.cursor="pointer";r=true}}if(l&&l.tooltip){n.a.tt="";var u=false;for(var d in l.tooltip){if(n.a.tt!=""){n.a.tt+="<br />"}n.a.tt+='<b class="q">'+d+"</b> ($)<br />";for(var f in l.tooltip[d].info){n.a.tt+="<div>"+l.tooltip[d].info[f]+"</div>"}if(!u&&l.tooltip[d].footer){n.a.tt+=l.tooltip[d].footer+"<br />";u=true}}}else{if(l&&l.label){n.a.tt=l.label}else{if(l&&l.fixTooltip){n.a.rel=n.a.rel.replace(/^np&?/,"");WH.dE(n.a,"mouseover",this.pinOver);WH.dE(n.a,"mouseout",WH.Tooltip.hide);n.a.tt="";if(typeof l.fixTooltip=="function"){n.a._fixTooltip=l.fixTooltip}}else{n.a.tt="$";if(!r){WH.dE(n.a,"mouseover",this.pinOver);let e={getAllCoords:function(){let e=[];WH.qsa("div.pin a",this.floorPins[s]).forEach((function(t){if(typeof t.tt==="string"){e.push(t.tt.split(", "))}}));return e}.bind(this)};if(a){e.uiMapId=a}if(i){e.uiMapName=i}if(this.name){e.name=this.name}WH.Wow.UiMap.clickToCopyCoordinates(n.a,function(){return this.tt.split(", ")}.bind(n.a),e)}}}}if(l&&l.menu){n.a.menu=l.menu;Menu.add(n.a,n.a.menu,{showAtCursor:true})}if(l&&l.type){n.className+=" pin-"+l.type}if(l&&l.mapicon){n.className+=" pin-object";n.a.style.backgroundPosition=(l.mapicon+2)%8*-16+"px "+Math.floor((l.mapicon+2)/8)*-16+"px"}n.a.tt=WH.stringReplace(n.a.tt,"$",n.x.toFixed(1)+", "+n.y.toFixed(1));if(l&&l.lines){for(var h=0,p=l.lines.length;h<p;++h){if(o[0]==l.lines[h][0]&&o[1]==l.lines[h][1]){continue}for(var m=0,H=Mapper.sizes.length;m<H;++m){var g=Mapper.sizes[m];n=this.line(o[0]*g[0]/100,o[1]*g[1]/100,l.lines[h][0]*g[0]/100,l.lines[h][1]*g[1]/100,l.type);n.className+=" "+g[2];WH.ae(this.floorPins[s],n)}}}if(l&&l.dataset){WH.cO(n.dataset,l.dataset)}}this.onPinUpdate&&this.onPinUpdate(this)},getLink:function(){var e="";for(var t in this.pins){if(!this.pins[t].free&&this.pins[t].floor==this.level){e+=(this.pins[t].x<10?"0":"")+(this.pins[t].x<1?"0":"")+(this.pins[t].x*10).toFixed(0)+(this.pins[t].y<10?"0":"")+(this.pins[t].y<1?"0":"")+(this.pins[t].y*10).toFixed(0)}}return(this.zone?this.zone:"")+(Mapper.multiLevelZones[this.zone]&&this.level!=0?"."+this.level:"")+(e?":"+e:"")},setLink:function(e,t,a){var i=[];e=e.split(":");var n=e[0];var s=0;if(n.indexOf(".")!=-1){var r=n.split(".");n=r[0];s=parseInt(r[1])}s=a&&a!=-1&&!s?a:s;if(!this.setZone(n,s,t)){return false}if(e.length==2){for(var o=0;o<e[1].length;o+=6){var l=e[1].substr(o,3)/10;var c=e[1].substr(o+3,3)/10;if(isNaN(l)||isNaN(c)){break}i.push([l,c])}}this.setCoords(i,s);return true},updateMap:function(e){this.parent.style.width=this.span.style.maxWidth=(this.tempWidth?this.tempWidth:Mapper.sizes[this.zoom][0])+"px";this.span.style.maxHeight=(this.tempHeight?this.tempHeight:Mapper.sizes[this.zoom][1])+"px";this.parent.setAttribute("data-mapsize",Mapper.sizes[this.zoom][2]);if(!this.editable){this.parent.style.cssFloat=this.parent.style.styleFloat="left"}if(this.zone=="0"){this.span.style.background="black"}else{var t=this.level;var a=this.phase;var i=this.zone+(t?"-"+t:"");if(Mapper.multiLevelZones[this.zone]&&!Mapper.multiLevelZones[this.zone].includes(i)&&Mapper.multiLevelZones[this.zone][t]){i=Mapper.multiLevelZones[this.zone][t];let e=i.match(/^\d+\-(\d+)$/);if(e){t=parseInt(e[1])}if(a!=0){i+="_"+a}}else if(Mapper.garrisonLevelsToMapTiers[this.zone]&&Mapper.garrisonLevelsToMapTiers[this.zone][t]){i=this.zone+"__"+Mapper.garrisonLevelsToMapTiers[this.zone][t]}this.setMap(i,t,a);if(!this.floorButton&&Mapper.multiLevelZones[this.zone]){var n;this.floorButton=n=WH.createButton(Mapper.zonePhased[this.zone]?WH.TERMS.changephase_ellipsis:WH.TERMS.changefloor_ellipsis);n.menu=this.getFloorsMenu();if(n.menu&&n.menu.length){Menu.add(n,n.menu,{showAtElement:true})}n.style["float"]="right";this.buttonDiv.appendChild(n)}else{if(this.floorButton){this.floorButton.style.display=Mapper.multiLevelZones[this.zone]?"":"none"}}}if(this.sToggle){this.sToggle.style.display=this.toggle&&this.nCoords?"":"none"}$(".line",this.floorPins[t]).hide();$(".line."+Mapper.sizes[this.zoom][2],this.floorPins[t]).show();this.onMapUpdate&&this.onMapUpdate(this)},cleanPin:function(e,t){var a=this.pins[e];a.style.display="";a.free=false;a.className="pin";for(var i in a.dataset){if(a.dataset.hasOwnProperty(i)){delete a.dataset[i]}}a.a.onmousedown=WH.rf;a.a.onmouseup=WH.rf;a.a.href="javascript:";a.a.style.cursor="default";a.floor=t;return a},getPin:function(e){for(var t=0;t<this.pins.length;++t){if(this.pins[t].free){return this.cleanPin(t,e)}}var a=WH.ce("div"),i=WH.ce("a");a.className="pin";a.appendChild(i);a.a=i;a.floor=e;WH.aE(i,"mouseover",this.pinOver);WH.aE(i,"mouseout",WH.Tooltip.hide);i.onclick=WH.sp;this.pins.push(a);this.cleanPin(this.pins.length-1,e);if(!this.floorPins[e]){this.floorPins[e]=WH.ce("div");this.floorPins[e].style.display=this.show?"":"none";if(e==this.level){WH.ae(this.span,this.floorPins[e])}}WH.ae(this.floorPins[e],a);return a},addPin:function(e){if(!WH.isLeftClick(e)){return}this.updateMouseCoords(e);let t=this.getPin(this.level);t.x=this.mouseX;t.y=this.mouseY;t.style.left=t.x.toFixed(1)+"%";t.style.top=t.y.toFixed(1)+"%";t.a.onmouseup=this.delPin.bind(this,t);t.a.tt=t.x.toFixed(1)+", "+t.y.toFixed(1);this.onPinUpdate&&this.onPinUpdate(this);return false},delPin:function(e,t){e.style.display="none";e.free=true;WH.sp(t);WH.Tooltip.hide();this.onPinUpdate&&this.onPinUpdate(this)},pinOver:function(){WH.Tooltip.show(this,this.tt,undefined,{padX:4})},updateMouseCoords:function(e){let t=WH.getOffset(this.parent);let a=WH.getScroll();this.mouseX=Math.floor((e.clientX+a.x-t.left-3)/Mapper.sizes[this.zoom][0]*1e3)/10;this.mouseY=Math.floor((e.clientY+a.y-t.top-3)/Mapper.sizes[this.zoom][1]*1e3)/10;if(this.mouseX<0){this.mouseX=0}else{if(this.mouseX>100){this.mouseX=100}}if(this.mouseY<0){this.mouseY=0}else{if(this.mouseY>100){this.mouseY=100}}if(this.mouse){WH.st(this.sMouse,"("+this.mouseX.toFixed(1)+", "+this.mouseY.toFixed(1)+")")}},line:function(e,t,a,i,n){var s=Math.min(e,a);var r=Math.max(e,a);var o=Math.min(t,i);var l=Math.max(t,i);var c=r-s;var u=l-o;var d=Math.sqrt(Math.pow(c,2)+Math.pow(u,2));var f=Math.atan2(u,c);var h=$('<span class="line" />').css({top:o.toFixed(2)+"px",left:s.toFixed(2)+"px",width:c.toFixed(2)+"px",height:u.toFixed(2)+"px"}).append($("<var />").css({width:d.toFixed(2)+"px",transform:"rotate("+f+"rad)"}));if(!(e==s&&t==o)&&!(a==s&&i==o)){h.addClass("flipped")}if(n!=null){h.addClass("line-"+n)}return h[0]}};var g_zone_areas={};window.MapViewer=new function(){const e=WH.DOM;const t={desiredScale:undefined,elements:{aCover:undefined,container:undefined,mapDiv:undefined,placeholder:undefined,screen:undefined,temporaryParent:undefined,oldParent:undefined},imageWidth:undefined,imageHeight:undefined,mapper:undefined,oldOnClick:undefined,oldOnUpdate:undefined,scale:undefined,zoom:undefined};this.checkPound=function(){if(location.hash&&location.hash.startsWith("#map")){let e=location.hash.split("=");if(e.length===2){let t=e[1];if(t){MapViewer.show({link:t})}}else{e=location.hash.split(":");let a=WH.ge("sjdhfkljawelis");if(a){a.onclick()}if(e.length===2){if(!a){MapViewer.show({link:e[1]})}let i=e[1].split(".");let n={zone:i[0]};if(i.length===2){n.level=parseInt(i[1])+1}t.mapper.update(n)}}}};this.getZoom=function(){if(typeof t.zoom==="number"){return t.zoom}return 1};this.show=function(e){t.zoom=e.zoom;WH.Track.interactiveEvent("Zone Maps","Show",e.link?e.link:"General");if(e.link){t.elements.temporaryParent=WH.ce("div",{id:"fewuiojfdksl"});WH.ae(document.body,t.elements.temporaryParent);let a=new Mapper({parent:t.elements.temporaryParent.id});a.setLink(e.link,true);a.toggleZoom()}else Lightbox.show("mapviewer",{onShow:s,onHide:n,onResize:o.bind(self,true)},e)};function a(){let e="#map";if(t.elements.temporaryParent){e+="="+t.mapper.getLink()}else if(Mapper.zoneDefaultLevel[t.mapper.zone]){if(Mapper.zoneDefaultLevel[t.mapper.zone]!==t.mapper.level){e+=i(t.mapper)}}else if(t.mapper.level!==0){e+=i(t.mapper)}else if((!window.g_mapperData||!g_mapperData[t.mapper.zone])&&(!window.g_mapper_data||!g_mapper_data[t.mapper.zone])){e+=i(t.mapper)}return e}function i(e){let t=":"+e.zone;if(e.level){t+="."+e.level}return t}function n(){t.mapper.span.onclick=t.oldOnClick||null;t.mapper.onMapUpdate=t.oldOnUpdate||null;t.mapper.span.style.cursor="";t.oldOnClick=null;t.oldOnUpdate=null;if(!t.elements.temporaryParent){WH.de(t.mapper.parent);t.mapper.parent.style.borderWidth="";t.mapper.parent.style.marginTop="";if(t.elements.placeholder){if(!t.elements.placeholder.parentNode){return}t.elements.oldParent.insertBefore(t.mapper.parent,t.elements.placeholder)}else{WH.ae(t.elements.oldParent,t.mapper.parent)}WH.de(t.elements.placeholder);t.elements.oldParent=null}else{WH.de(t.elements.temporaryParent);t.elements.temporaryParent=null}t.mapper.toggleZoom();if(location.hash.indexOf("#show")===-1){WH.clearHash()}else if(window.mapShowObject){mapShowObject.onCollapse()}}function s(e,a,i){t.mapper=i.mapper;t.elements.container=e;if(a){e.classList.add("mapviewer");t.elements.screen=WH.ce("div",{className:"lightbox-content mapviewer-screen",style:{height:Mapper.sizes[MapViewer.getZoom()][1]+"px",width:Mapper.sizes[MapViewer.getZoom()][0]+"px"}});t.elements.aCover=WH.ce("a",{className:"mapviewer-cover",href:"javascript:"});WH.aE(t.elements.aCover,"click",Lightbox.hide);let a=WH.ce("span");let i=WH.ce("b");WH.ae(i,WH.ct(WH.TERMS.close));WH.ae(a,i);WH.ae(t.elements.aCover,a);WH.ae(t.elements.screen,t.elements.aCover);t.elements.mapDiv=WH.ce("div");WH.ae(t.elements.screen,t.elements.mapDiv);WH.ae(e,t.elements.screen);let n=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"});WH.aE(n,"click",Lightbox.hide);WH.ae(n,WH.ct(WH.TERMS.close));WH.ae(e,n)}o()}function r(){if(t.oldOnUpdate){t.oldOnUpdate(t.mapper)}location.replace(a())}function o(e=false){if(e&&t.scale===t.desiredScale&&window.innerHeight>t.elements.container.offsetHeight){return}t.elements.container.style.visibility="hidden";l();if(!e){if(!t.elements.placeholder){t.elements.placeholder=WH.ce("div",{style:{height:"325px",padding:"3px",marginTop:"10px"}})}t.mapper.parent.style.borderWidth="0px";t.mapper.parent.style.marginTop="0px";t.mapper.span.style.cursor="pointer";if(t.mapper.span.onclick){t.oldOnClick=t.mapper.span.onclick}t.mapper.span.onclick=Lightbox.hide;if(t.mapper.onMapUpdate){t.oldOnUpdate=t.mapper.onMapUpdate}t.mapper.onMapUpdate=r;if(!t.elements.temporaryParent){t.elements.oldParent=t.mapper.parent.parentNode;t.elements.oldParent.insertBefore(t.elements.placeholder,t.mapper.parent);WH.de(t.mapper.parent);WH.ae(t.elements.mapDiv,t.mapper.parent)}else{WH.de(t.elements.temporaryParent);WH.ae(t.elements.mapDiv,t.elements.temporaryParent)}if(!location.hash.includes("#show")){location.replace(a())}else if(window.mapShowObject){mapShowObject.onExpand()}}Lightbox.reveal();t.elements.container.style.visibility="visible"}function l(){t.desiredScale=1;t.scale=1;if(t.desiredScale>1){t.desiredScale=1}if(t.scale>1){t.scale=1}t.imageWidth=Math.round(t.scale*Mapper.sizes[MapViewer.getZoom()][0]);t.imageHeight=Math.round(t.scale*Mapper.sizes[MapViewer.getZoom()][1]);if(t.elements.screen){WH.de(".mapviewer-screen-sizer",t.elements.screen);let a=WH.ce("div",{className:"mapviewer-screen-sizer"});e.setRelativeHeight(a,t.imageWidth,t.imageHeight);WH.ae(t.elements.screen,a)}let a=Math.max(480,t.imageWidth);Lightbox.setSize(a+Lightbox.UI_WIDTH)}WH.onLoad(this.checkPound)};WH.markup=new function(){this.MODE={COMMENT:1,ARTICLE:2,QUICK_FACTS:3,SIGNATURE:4,REPLY:5};this.CLASS={ADMIN:40,STAFF:30,PREMIUM:20,USER:10,PENDING:1};this.modes={[this.MODE.COMMENT]:"comment",[this.MODE.REPLY]:"reply",[this.MODE.ARTICLE]:"article",[this.MODE.QUICK_FACTS]:"quickfacts",[this.MODE.SIGNATURE]:"signature"};this.globalAttributes={id:{req:false,valid:/^[a-z0-9_-]+$/i},title:{req:false,valid:/[\S ]+/},class:{req:false,valid:/\S+/}};this.regex={anyChars:/.+/,cssUnitOrInt:/\d+(%|px|em)?/,dataEnv:new RegExp("^("+Object.values(WH.dataEnvKey).join("|")+"|wotlk)$"),domain:/^((www|classic|tbc|bc|wrath|wotlk|ptr|ptr2|beta|mop|wod|legion|bfa|shadowlands|sl|d2)$|((ko|fr|de|cn|es|ru|pt|it)($|\.(classic|tbc|bc|wrath|wotlk|ptr|ptr2|beta|mop|wod|legion|bfa|shadowlands|sl|d2)$)))/,iconSizeOrFalse:/^(false|tiny|small|medium|large)$/,intCsv:/^[\d,]+$/,isInt:/^\d+$/,isItemList:/^(\d+(;\d+(:\d+)*)?)(,(\d+(;\d+(:\d+)*)?))*$/,kebabCase:/^[a-z\d-]+$/,noWhitespace:/^\S+$/};const e=["about-us-team-tables","guide-51","guide-53","guide-61","guide-block-nav","guide-brewfest","guide-children","guide-classes","guide-foundry","guide-hallows","guide-highmaul","guide-hub","guide-irontide","guide-love","guide-lunar","guide-mop","guide-moplaunch","guide-noblegarden","guide-orgrimmar","guide-pilgrim","guide-role","guide-summer","guide-theramore","guide-thunderking","guide-transmog","guide-winter","guide-wodlaunch"];let t="abc";let a;let i;this.mode=this.MODE.ARTICLE;this.allow=this.CLASS.STAFF;this.root=undefined;this.dbPage=false;this.isPreview=false;this.inNewsType=0;this.mediaUid=t;this.tags={};this.initialized=false;this.disabledEnvironments={BETA:false,PTR:false,PTR2:false};this.blockTags={};this.postTags=[];this.collectTags={};this.excludeTags={};this.tooltipTags={};this.tooltipTagsWithRawText={};this.applyCommonAttributes=function(e,t){if(WH.markup.allow<this.CLASS.STAFF){return}if(t.id){e.id=t.id}if(t.title){e.title=t.title}if(t["class"]){if(e.className){e.className+=" "+t["class"]}else{e.className=t["class"]}}if(t.style){var a=e.getAttribute("style");if(a){e.setAttribute("style",a+"; "+t.style)}else{e.setAttribute("style",t.style)}}if(t["data-highlight"]){e.setAttribute("data-highlight",t["data-highlight"])}};this.attachMarkupTooltip=function(e,t,a,i){let n=()=>{let e={className:WH.markup.tooltipTagsWithRawText[t]?undefined:"q",content:WH.markup.tooltipTags[t],content2:a&&WH.markup.tooltipTags[a]||undefined};if(!e.content){e.content='Markup tooltip named "'+t+'" not found.';e.className="q10"}return e};if(i){WH.aE(e,"mouseover",(function(){let t=n();WH.Tooltip.show(e,t.content,t.className,{text2:t.content2})}));WH.aE(e,"mouseout",WH.Tooltip.hide)}else{WH.aE(e,"mouseover",(function(e){let t=n();WH.Tooltip.showAtCursor(e,t.content,t.className,{text2:t.content2})}));WH.aE(e,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(e,"mouseout",WH.Tooltip.hide)}};this.init=function(){if(this.initialized){return}var e=[],t=[],a=[];for(var i in WH.markup.tags){if(!WH.markup.tags.hasOwnProperty(i)){continue}if(WH.markup.tags[i].block){WH.markup.blockTags[i]=true}if(WH.markup.tags[i].exclude){for(var n in WH.markup.tags[i].exclude){if(!WH.markup.tags[i].exclude.hasOwnProperty(n)){continue}if(!this.excludeTags[n]){this.excludeTags[n]={}}this.excludeTags[n][i]=WH.markup.tags[i].exclude[n]}}if(WH.markup.tags[i].post){this.postTags.push(i)}if(WH.markup.tags[i].trim){a.push(i)}if(WH.markup.tags[i].ltrim){e.push(i)}if(WH.markup.tags[i].rtrim){t.push(i)}}if(e.length>0){this.ltrimRegex=new RegExp("\\s*\\[("+e.join("|")+")([^a-z0-9]+.*)?]","ig")}if(t.length>0){this.rtrimRegex=new RegExp("\\[/("+t.join("|")+")\\]\\s*","ig")}if(a.length>0){this.trimRegex=new RegExp("\\s*\\[("+a.join("|")+")([^\\[]*)?\\]\\s*","ig")}this.initialized=true;$((function(){$("body").delegate("[data-highlight]","mouseenter",(function(){var e=$(this).attr("data-highlight").split(":");if(e.length!=2){return}var t=$("#"+e[0]).get(0),a=parseInt(e[1]),i=$(t).val();if(!t||!a||!i){return}var n=$(t).val(i.substr(0,a))[0].scrollHeight;$(t).val(i).animate({scrollTop:n},250);t.selectionStart=a;t.selectionEnd=a}))}))};this.assembleDomNode=function(e,t){if(e===null){return document.createDocumentFragment()}if(!(e instanceof Node)){WH.Track.nonInteractiveEvent("Markup","Legacy HTML",JSON.stringify(e));if(g_user.roles&U_GROUP_ADMIN&&!this.convertToDomNodeWarned){this.convertToDomNodeWarned=true;alert("Some markup on this page returned something other than a node!")}let t=document.createDocumentFragment();t.appendChild(WH.ct(e));return t}if(t){let a;if(e instanceof Element&&e.dataset.markupContentTarget){a=e}else if(e.querySelector&&e.querySelector("[data-markup-content-target]")){a=e.querySelector("[data-markup-content-target]")}else{a=e;while(a.hasChildNodes()&&a.firstChild instanceof Element){a=a.firstChild}}a.appendChild(t)}return e};this.finalizeUrl=function(e,t,a){const i=WH.Url;if(!e){return""}if(e==="#"){return"javascript:"}e=e.replace(/&amp;/g,"&");if(/^([a-z.]+\.)?wowhead\.com/.test(e)){e="https://"+e}if(!i.isRelative(e)||e.startsWith("javascript:")||e.startsWith("#")){return e}if(e.startsWith("?")){e="/"+e.replace(/^\?+/,"")}else{e=i.ensurePathSlash(e)}if(!i.hasPathPrefixes(e)||t||typeof a==="number"){e=i.generate(e,{dataEnv:t,locale:a})}else{let t=i.parsePathPrefixes(e);e=i.generate(e,{dataEnv:t.dataEnv,locale:t.locale})}return e};this.getDatabaseDomainInfo=function(e){var t=function(e){var t={};e=(e||"").split(".");if(e.length>2){WH.warn("Markup trying to parse long domain",e)}var a=e.length?e[e.length-1]:"";if(a){for(let e in WH.dataEnv){if(!WH.dataEnv.hasOwnProperty(e)||!WH.dataEnvKey.hasOwnProperty(WH.dataEnv[e])){continue}if(a===WH.dataEnvKey[WH.dataEnv[e]]){t.dataEnv=WH.dataEnv[e];break}if(a==="bc"){t.dataEnv=WH.dataEnv.TBC;break}if(a==="wotlk"){t.dataEnv=WH.dataEnv.WRATH;break}}}var i=e[0];if(i){if(WH.getLocaleFromDomain.L.hasOwnProperty(i)){t.locale=WH.getLocaleFromDomain.L[i]}else if(i==="www"){t.locale=LOCALE_ENUS}if(!t.hasOwnProperty("dataEnv")){t.dataEnv=WH.dataEnv.MAIN}}return t};var n=t(e.domain||e.site);var s=n.locale;if(s===undefined&&i!==undefined){s=i}if(s===null){s=Locale.getId()}var r=n.dataEnv||a||WH.getDataEnv();if(r===WH.dataEnv.PTR&&WH.markup.disabledEnvironments.PTR){r=WH.dataEnv.MAIN}if(r===WH.dataEnv.PTR2&&WH.markup.disabledEnvironments.PTR2){r=WH.dataEnv.MAIN}if(r===WH.dataEnv.BETA&&WH.markup.disabledEnvironments.BETA){r=WH.dataEnv.MAIN}let o=Locale.getDataEnvForcedLocale(r);if(o!==undefined){s=o}return{host:WH.Url.generate("",{dataEnv:r,locale:s}).replace(/\/$/,""),nameKey:"name_"+Locale.getName(s),subdomain:"www",dataEnv:r,localeId:s}};this.getDataEnvFromSiteAttr=function(e){return WH.getDataEnvFromKey(e)||WH.Game.getDataEnvBySelector(e)};this.getEscapedHtml=function(e){e=e.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"–").replace(/&mdash;/g,"—");return WH.Strings.escapeHtml(e)};this.getDomFragment=function(t,a){if(!a){a={}}if(!a.allow){if(a.roles){a.allow=this.rolesToClass(a.roles)}else{a.allow=this.CLASS.STAFF}}try{var i=s(t,a);var r=i.toNode()}catch(e){var r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error!"));WH.ae(r,WH.ce("br"));WH.ae(r,WH.ct(e));WH.error(e)}if(r.querySelector("."+e.join(",."))){e.filter((function(e){return!!r.querySelector("."+e)})).forEach((function(t){let a=WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"markup/"+t+".css";if(WH.PageMeta.scriptVersionQueryString){a+="?"+WH.PageMeta.scriptVersionQueryString}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:a}));let i=e.indexOf(t);if(i>=0){e.splice(i,1)}}))}if(a.prepend){$(r).prepend($.parseHTML(a.prepend))}if(a.append){$(r).append($.parseHTML(a.append))}n(r);return r};this.getMarkupFromHtml=function(e,t){var a=e.replace(/\n+/g,"");a=a.replace(/\s+/g," ");a=a.replace(/> </g,"><");a=a.replace(/&amp;/gi,"&");a=a.replace(/(&#160;|$nbsp;)/gi," ");for(var i in WH.markup.tags){if(WH.markup.tags.hasOwnProperty(i)&&WH.markup.tags[i].fromHtml){a=WH.markup.tags[i].fromHtml(a,t)}}a=a.replace(/<style\b[\s\S]*?>[\s\S]*?<\/style>/g,"");a=a.replace(/<\/?[a-z][a-z0-9]*\b[\s\S]*?>/g," ");a=a.replace(/<!--(.*?)-->/g,"");a=a.replace(/\n[\n]+/g,"\n\n");a=a.replace(/[ ]+/g," ");a=a.replace(/\t/g,"  ");return WH.trim(a)};this.insertEntityTag=function(e,t,a){let i=prompt(WH.term("enterEntityId_format",t));if(i!=null){WH.insertTag(e,"["+a+"="+(parseInt(i)||0)+"]")}};this.isUrlExternal=function(e){if(!e){return false}var t=WH.ce("a");t.href=e;return!(!t.hostname||/(^|\.)wowhead\.com$/.test(t.hostname))};this.isUrlSafe=function(e,t){if(!e){return true}if(e==="javascript:"){return true}var a=e.match(/^([^:\\./]+):/i);if(a&&a[1]){var i=a[1];if(i==="http"||i==="https"){return true}if(t&&(i==="mailto"||i==="irc")){return true}return false}return true};this.matchOuterTags=function(e,t,a,i){var n=i.indexOf("g")>-1,s=i.replace(/g/g,""),r=new RegExp(t+"|"+a,"g"+s),o=new RegExp(t,s),l=[],c,u,d,f;do{c=0;while(d=r.exec(e)){if(o.test(d[0])){if(!c++){u=r.lastIndex;f=d}}else if(c){if(!--c){l.push([e.slice(u,d.index),f[0],d[0]]);if(!n){return l}}}}}while(c&&(r.lastIndex=u));return l.length?l:false};this.printHtml=function(e,t,a){var i=WH.ge(t);if(a&&a.removeTableTags){e=e.replace(/\[\/?(td|tr|table)[^\]]*]/g,"")}$(i).empty().append(WH.markup.getDomFragment(e,a))};this.rolesToClass=function(e){if(e&(U_GROUP_ADMIN|U_GROUP_VIP|U_GROUP_DEV)){return this.CLASS.ADMIN}else if(e&U_GROUP_STAFF){return this.CLASS.STAFF}else if(e&(U_GROUP_PREMIUM|U_GROUP_BLIZZARD)){return this.CLASS.PREMIUM}else if(e&U_GROUP_PENDING){return this.CLASS.PENDING}else{return this.CLASS.USER}};this.setDataEnv=function(e){switch(e){case WH.dataEnvKey[WH.dataEnv.PTR]:a=WH.markup.disabledEnvironments.PTR?WH.dataEnv.MAIN:WH.dataEnv.PTR;break;case WH.dataEnvKey[WH.dataEnv.PTR2]:a=WH.markup.disabledEnvironments.PTR2?WH.dataEnv.MAIN:WH.dataEnv.PTR2;break;case WH.dataEnvKey[WH.dataEnv.BETA]:a=WH.markup.disabledEnvironments.BETA?WH.dataEnv.MAIN:WH.dataEnv.BETA;break;case WH.dataEnvKey[WH.dataEnv.CLASSIC]:a=WH.dataEnv.CLASSIC;break;case"bc":case WH.dataEnvKey[WH.dataEnv.TBC]:a=WH.dataEnv.TBC;break;case"wotlk":case WH.dataEnvKey[WH.dataEnv.WRATH]:a=WH.dataEnv.WRATH;break;default:a=WH.dataEnv.MAIN}};this.stripTags=function(e,t){let a=s(e,t);return a.toHtml()};function n(e){Array.from(e.childNodes).forEach((e=>{switch(e.nodeType){case Node.ELEMENT_NODE:if(e.hasChildNodes()&&!["SCRIPT","STYLE"].includes(e.nodeName)){n(e)}break;case Node.TEXT_NODE:let t=e.nodeValue.split("/");if(t.length>1){let a=document.createDocumentFragment();for(let e=0;e<t.length;e++){let i=t[e];if(e<t.length-1){i+="/";let a=e+1;while(t[a]===""&&a+1!==t.length){i+="/";e++;a++}}WH.ae(a,WH.ct(i));if(e<t.length-1){WH.ae(a,WH.ce("wbr"))}}e.parentNode.replaceChild(a,e)}break}}))}function s(e,n){i=undefined;if(n&&n.hasOwnProperty("locale")){i=n.locale}var s=(e||"").replace(/\r/g,"");if(!n)n={};if(!n.skipReset){WH.markup.mediaUid=n.uid||t;WH.markup.root=n.root;WH.markup.isPreview=n.isPreview||false;WH.markup.dbPage=n.dbPage||false;a=WH.getDataEnv();if(Locale.getDataEnvForcedLocale(a)!==undefined){i=Locale.getDataEnvForcedLocale(a)}WH.markup.disabledEnvironments={BETA:(!WH.isBetaActive()||n.disabledEnvironments&&n.disabledEnvironments.beta)&&!WH.isBeta(),PTR:(!WH.isPtrActive()||n.disabledEnvironments&&n.disabledEnvironments.ptr)&&!WH.isPtr(),PTR2:(!WH.isPtr2Active()||n.disabledEnvironments&&n.disabledEnvironments.ptr2)&&!WH.isPtr2()};if(WH.markup.mediaUid!=t){g_screenshots[WH.markup.mediaUid]=[]}}if(n.roles&&n.roles&(U_GROUP_ADMIN|U_GROUP_EDITOR|U_GROUP_MOD|U_GROUP_BUREAU|U_GROUP_DEV|U_GROUP_BLOGGER)&&n.mode!=WH.markup.MODE.SIGNATURE){n.mode=WH.markup.MODE.ARTICLE}WH.markup.mode=n.mode||WH.markup.MODE.ARTICLE;WH.markup.allow=n.allow||WH.markup.CLASS.STAFF;WH.markup.inNewsType=n.inNewsType?n.inNewsType:0;if(n.stopAtBreak){var r=s.indexOf("[break]");if(r!=-1){s=s.substring(0,r)}}else{s=s.replace("[break]","")}var o=new WH.markup.Tree;s=s.trim();if(WH.markup.postTags.length){for(var l in WH.markup.postTags){var c=WH.markup.postTags[l];if(s.indexOf("["+c)!=-1){if(!(WH.markup.tags[c].allowedModes&&WH.markup.tags[c].allowedModes[WH.markup.modes[n.mode]]==undefined)){for(var u in WH.markup.tags[c].collect){WH.markup.collectTags[u]=true}}}}}s=s.replace(/\n(\s*)\n/g,"\n\n");var d=s.length;var f=0,h=0,p=-1,m=-1,H=true,g=false;var W=function(e){var t,a,i;if(e.charAt(0)=='"'||e.charAt(0)=="'"){t=e.charAt(0);var n=e.indexOf(t,1);if(n>-1){i=e.substring(1,n);e=e.substring(n+1).trim();return{value:i,str:e}}}a=e.indexOf(" ");if(a>-1){i=e.substring(0,a);e=e.substring(a+1).trim()}else{i=e;e=""}return{value:i,str:e}};var E=/^\s*[a-z0-9-]+\s*=/;while(h<d){p=s.indexOf("[",h);if(p>-1){h=p+1;if(p>0&&s.charAt(p-1)=="\\"){H=false;p=-1}else{m=s.indexOf("]",h)}}else{h=d}var _,v={};if(n.highlight&&$(n.highlight)){v["data-highlight"]=n.highlight+":"+p}if(m>-1){var T=s.substring(p+1,m);if(T.charAt(0)=="/"){g=true;_=T.substr(1).trim().toLowerCase()}if(!g){var b=T.indexOf(" "),S=T.indexOf("=");var y;if((S<b||b==-1)&&S>-1){_=T.substring(0,S).toLowerCase();T=T.substring(S+1).trim();var I=W(T);T=I.str;if(WH.markup.tags[_]==undefined||WH.markup.tags[_].attr==undefined||WH.markup.tags[_].attr.unnamed==undefined){H=false}else{v.unnamed=I.value}}else if(b>-1){_=T.substring(0,b).toLowerCase();T=T.substring(b+1).trim();if(T.indexOf("=")==-1){if(WH.markup.tags[_]==undefined||WH.markup.tags[_].attr==undefined||WH.markup.tags[_].attr.unnamed==undefined){H=false}else{v.unnamed=T}T=""}}else{_=T.toLowerCase();T=""}if(WH.markup.tags[_]==undefined){H=false}else if(H){var c=WH.markup.tags[_];while(T!=""){var R="";if(!E.test(T)){let[e,...t]=T.split(" ");if(c?.attr?.[e]?.empty){v[e]="";T=t.join(" ");continue}else{R="unnamed"}}else{S=T.indexOf("=");if(S==-1){H=false;break}R=T.substring(0,S).trim().toLowerCase();T=T.substring(S+1).trim()}var I=W(T);T=I.str;if(c.attr==undefined||c.attr[R]==undefined){if(WH.markup.globalAttributes[R]==undefined||WH.markup.globalAttributes[R].valid!=undefined&&!WH.markup.globalAttributes[R].valid.test(I.value)){H=false;break}}v[R]=I.value}if(H&&c.attr){for(var N in c.attr){if(c.attr[N].req&&v[N]==undefined){H=false;break}else if(v[N]==undefined){continue}if(c.attr[N].valid!=undefined&&!c.attr[N].valid.test(v[N])){H=false;break}}if(H&&c.validate!=undefined){H=c.validate(v)}}}}else if(WH.markup.tags[_]==undefined){H=false}}else{H=false}if(H){if(f!=p){var w=s.substring(f,p).replace(/\\\[/g,"[");var A={_rawText:w};o.openTag("<text>",A)}if(g){H=o.closeTag(_)}else{H=o.openTag(_,v)}if(H){f=h=m+1}else{f=p}}H=true;g=false;p=m=-1}if(f<d){var w=s.substr(f).replace(/\\\[/g,"[");var A={_rawText:w};o.openTag("<text>",A)}return o}};WH.markup.tags.artifactcalc={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(){return null}};WH.markup.tags["azerite-finder"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{class:{req:true,valid:/.+/},spec:{req:false,valid:/.+/},selectmultiple:{req:false,valid:/^true|false$/},showtiers:{req:false,valid:/^true|false$/},spells:{req:false,valid:/^\d+(,\d+){0,19}$/}},callbacks:[],toNode:function(e){let t=WH.ce("div",{className:"clear azerite-finder-markup-parent",style:{display:"none"}});let a=function(){let a={embed:WH.Strings.guid(),class:e["class"]};if(e.spec){a.spec=e.spec}if(e.selectmultiple){a.multiselect=e.selectmultiple==="true"?1:0}if(e.showtiers){a.showtier=e.showtiers==="true"?1:0}if(e.spells){a.spellids=e.spells}$(t).load("/azerite-finder?"+WH.Url.buildQuery(a))};if(!WH.Wow.AzeriteFinder){this.callbacks.push(a);if(this.callbacks.length===1){WH.loadAssets("azerite-finder",(function(){let e;while(e=WH.markup.tags["azerite-finder"].callbacks.shift()){e()}}))}}else{a()}return t}};WH.markup.tags["blizzconline-giveaway"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(){let e=false;return function(){if(!e){$.getScript("https://widget.gleamjs.io/e.js");e=true}return WH.ce("a",{className:"e-widget no-button",href:"https://gleam.io/nsPDV/wowheads-blizzconline-giveaway",rel:"nofollow"},WH.ct("Wowhead's BlizzConline 2021 Giveaway"))}}()};WH.markup.tags["bloodmallet-chart"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{axiscolor:{req:false,valid:/.+/},azeritetier:{req:false,valid:/.+/},backgroundcolor:{req:false,valid:/.+/},class:{req:true,valid:/.+/},chartmode:{req:false,valid:/.+/},corruptionrepresentation:{req:false,valid:/.+/},covenant:{req:false,valid:/.+/},entries:{req:false,valid:/^\d+$/},fontcolor:{req:false,valid:/.+/},fightstyle:{req:false,valid:/.+/},renown:{req:false,valid:/^\d+$/},spec:{req:true,valid:/.+/},type:{req:false,valid:/.+/}},toNode:function(e){WH.Tools.Highcharts.loadScript((function(){clearTimeout(WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout);WH.markup.tags["bloodmallet-chart"].loadScriptsTimeout=setTimeout(WH.Tools.Bloodmallet.loadCharts,0)}));var t=WH.ce("div",{className:"bloodmallet_chart",textContent:WH.TERMS.loading_ellipsis,id:WH.Strings.guid()});t.setAttribute("data-wow-class",e["class"].replace("-","_"));t.setAttribute("data-wow-spec",e.spec.replace("-","_"));if(!e["backgroundcolor"]){e["backgroundcolor"]="#242424"}if(!e["axiscolor"]){e["axiscolor"]=WH.Wow.Item.getQualityColor(WH.Wow.Item.QUALITY_POOR)}if(!e["fontcolor"]){e["fontcolor"]="#ccc"}var a={axiscolor:"axis-color",azeritetier:"azerite-tier",backgroundcolor:"background-color",chartmode:"chart-mode",corruptionrepresentation:"corruption-representation",covenant:"covenant",entries:"entries",fontcolor:"font-color",fightstyle:"fight-style",renown:"renown",type:"type"};for(var i in a){if(e[i]){t.setAttribute("data-"+a[i],e[i].replace("-","_"))}}return t}};WH.markup.tags.bluetweet={empty:true,ltrim:true,attr:{id:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"markup-bluetweet"},WH.ce("a",{href:"https://twitter.com/wowheadtweets/status/"+e.id},WH.ct("Tweet #"+e.id)));WH.Twitter.renderTweet(e.id,t);return t}};WH.markup.tags.chart={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{id:{req:true,valid:/^[0-9a-zA-Z-]+$/},type:{req:true,valid:/^barpercent|pie|rank|rankpercent$/},width:{req:false,valid:/^\d+$/},height:{req:false,valid:/^\d+$/},credits:{req:false,valid:/^profiler|none$/},sort:{req:false,valid:/^asc|desc$/}},toNode:function(e){var t;if(!g_charts.hasOwnProperty(e.id)){t=WH.ce("div",{className:"highchart "+e.type,style:{border:"1px solid #CCC"}},WH.ct("(Chart "+e.id+" not found)"));if(e.width){t.style.width=""+e.width+"px"}if(e.height){t.style.height=""+e.height+"px"}return t}var a=WH.markup.getDatabaseDomainInfo(e);var i=a.nameKey;var n={};if(!e.credits||e.credits=="profiler"){n.href=WH.Url.generatePath("/list");n.text=WH.TERMS.poweredbyprofiler_tip}if(e.credits=="none"){n.enabled=false}switch(e.type){case"rank":case"rankpercent":var s=g_charts[e.id];var r=s[0].keyType;var o;var l;var c;var u;var d=[];for(var f in s[0].data){d.push(f)}d.sort((function(e,t){return WH.stringCompare(s[0].data[e],s[0].data[t])}));if(e.sort=="desc"){d.reverse()}else if(!e.sort){if(s[1].data){if(s[0].data[d[0]]/s[1].data>.5){d.reverse()}}}t=WH.ce("div",{style:{display:"inline-block"}});if(e.width){t.style.width=""+e.width+"px"}var h;var p;var m=WH.ce("ol");WH.ae(t,m);for(var H=0;H<d.length;H++){f=d[H];u=false;o=f;l="";c="";if(u=WH.Gatherer.get(s[0].keyType,parseInt(f,10),a.dataEnv)){o=u.hasOwnProperty(i)?u[i]:f;l=u.hasOwnProperty("quality")?u.quality:"";c=u.hasOwnProperty("icon")?u.icon:""}p=WH.ce("li");WH.ae(m,p);if(c){var g=document.createDocumentFragment();WH.ae(g,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+c+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(g,WH.ct(WH.Strings.nbsp))}if(r){h=WH.ce("a",{href:WH.Entity.getUrl(r,f),className:"q"+l+(c?" icontiny":"")})}else{h=WH.ce("span",{className:"q"+l})}WH.ae(p,h);if(c){WH.ae(h,g)}WH.ae(h,WH.ct(o));if(e.type=="rankpercent"&&s[1].data){WH.ae(p,WH.ct(" "));WH.ae(p,WH.ce("small",{className:"q0"},WH.ct(WH.sprintf(WH.TERMS._paren,(s[0].data[f]/s[1].data*100).toFixed(4)+"%"))))}}if(n.text){var W=WH.ce("div",{style:{position:"relative",top:"-12px",textAlign:"right",fontSize:"10px"}});WH.ae(t,W);if(n.href){h=WH.ce("a",{href:n.href,className:"q0"},WH.ct(n.text))}else{h=WH.ce("span",{className:"q0"},WH.ct(n.text))}WH.ae(W,h)}return t;break}if(!WH.isSet("g_highcharts")){WH.Tools.Highcharts.loadScript();g_highcharts={charts:[],divIndex:0,pending:undefined};g_highcharts.ShowCharts=function(e){if(e){g_highcharts.pending=undefined}else if(typeof g_highcharts.pending!="undefined"){return}var t=false;if(WH.isSet("Highcharts")){for(var a=0;a<g_highcharts.charts.length;a++){if(g_highcharts.charts[a].rendered){continue}if($(g_highcharts.charts[a].container).length==0){t=true;continue}$(g_highcharts.charts[a].container).highcharts(g_highcharts.charts[a].chart);g_highcharts.charts[a].rendered=true}}else{t=true}if(t){g_highcharts.pending=window.setTimeout(g_highcharts.ShowCharts,250,true);return}}}t=WH.ce("div",{className:"highcharts-wowhead-style highchart "+e.type});if(e.width){t.style.width=""+e.width+"px"}if(e.height){t.style.height=""+e.height+"px"}switch(e.type){case"barpercent":var s=g_charts[e.id];var E={container:t,chart:{}};E.chart={credits:n,chart:{type:"bar",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,max:100,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var e=this.x+": "+this.y+"%";let t=WH.User.Completion.getByType(s[0].keyType);if(Object.keys(t).length){for(var a in g_user.lists){var i=g_user.lists[a];if(!(i.id in t)){continue}var n=WH.inArray(t[i.id],this.point.id)!=-1;e+='<br><span class="progress-icon '+(n?"progress-8":"progress-0")+'"></span> ';e+=i.character+" - "+i.realm+" "+i.region}}return e},useHTML:true},series:[{data:[],events:{click:function(t){if(g_charts[e.id][0].keyType){location.href=WH.Entity.getUrl(g_charts[e.id][0].keyType,t.point.series.data[t.point.x].id)}}}}]};var _;var v=[];let r=WH.User.Completion.getByType(s[0].keyType);if(Object.keys(r).length&&g_user.hasOwnProperty("lists")&&g_user.lists&&g_user.lists.length){for(var H=0;H<g_user.lists.length;H++){_=""+g_user.lists[H].id;if(g_user.lists[H].pinned>0&&r.hasOwnProperty(_)){v=r[_];if(g_user.lists[H].pinned>1){break}}}}var T=[];for(var f in s[0].data){if(!s[0].data.hasOwnProperty(f)){continue}T.push({k:f,v:s[0].data[f]})}T.sort((function(e,t){return WH.stringCompare(t.v,e.v)}));if(e.sort=="asc"){T.reverse()}for(var H=0;H<T.length;H++){var b=T[H];var u=WH.Gatherer.get(s[0].keyType,b.k,a.dataEnv);u=u?u[i]:b.k;var S={id:b.k,y:Math.round(b.v/s[1].data*100)};if(v.indexOf(parseInt(S.id,10))!=-1){S.colorIndex=6}E.chart.xAxis.categories.push(u);E.chart.series[0].data.push(S)}g_highcharts.charts.push(E);break;case"pie":var E={container:t,chart:{}};E.chart={credits:n,chart:{type:"pie",styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{pie:{dataLabels:{style:{textShadow:"none"}}}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){return this.point.name+": "+Math.round(this.y)+"%"}},series:[{data:[]}]};var s=g_charts[e.id];var T=[];var y=0;var I=true;var u;var R={};if(s[0].keyType==WH.Types.RACE){var R={24:WH.TERMS.neutral,25:WH.TERMS.alliance,26:WH.TERMS.horde};for(var N in R){if(R.hasOwnProperty(N)){R[N]=WH.TERMS.wordspace_punct+WH.TERMS.openparenthesis_punct+R[N]+WH.TERMS.closedparenthesis_punct}}}for(var f in s[0].data){if(!s[0].data.hasOwnProperty(f)){continue}y+=s[0].data[f];I&=!isNaN(f)&&f!="0";u=(WH.Gatherer.get(s[0].keyType,f,a.dataEnv)||{})[i]||f;u+=R[f]||"";T.push({k:f,keyName:u,v:s[0].data[f]})}if(!isNaN(s[1].data)&&y/s[1].data<.98){T.push({k:I?0:"Other",v:s[1].data-y})}if(g_gathered_types.hasOwnProperty(s[0].keyType)){T.sort((function(e,t){return WH.stringCompare(t.v,e.v)||WH.stringCompare(e.keyName,t.keyName)}))}else{T.sort((function(e,t){return WH.stringCompare(e.keyName,t.keyName)||WH.stringCompare(t.v,e.v)}))}for(var H=0;H<T.length;H++){var b=T[H];E.chart.series[0].data.push({id:b.k,name:b.keyName,y:b.v/s[1].data*100})}g_highcharts.charts.push(E);break;default:return WH.ce("div",{},WH.ct("(Chart type "+e.type+" unknown)"));break}g_highcharts.ShowCharts();return t}};WH.markup.tags.countdown={empty:true,attr:{bg:{req:true,valid:/^(https?:)?\/\/[^\/]+\/.+/},time:{req:true,valid:/^[A-Za-z0-9 :,-]+$/},text:{req:false,valid:/.*/},completion:{req:false,valid:/.*/},url:{req:false,valid:/^(https?:)?\/\/[^\/]+\/.+/}},toNode:function(e){var t=WH.ce("div");var a={element:t,bg:e.bg,completionText:e.completion,time:e.time};if(e.text){a.text=e.text}if(e.url){a.url=e.url}WH.countdownClock(a);return t}};WH.markup.tags["d2-skill-calc"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/},order:{req:false,valid:/^true|false$/}},toNode:function(t){let a=WH.ce("div",{className:"diablo-2-skill-calc-markup"});let i={embedded:true,hash:t.unnamed,editable:t.editable==="true",order:t.order!=="false"};let n=function(){new WH.D2.SkillCalc(a,i)};if(!WH.D2.hasOwnProperty("SkillCalc")){e.push(n);if(e.length===1){WH.loadAssets("diablo-2-skill-calc",(function(){let t;while(t=e.shift()){t()}}))}}else{n()}return a}}}();WH.markup.tags["d2-tooltip"]=function(){return{empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{float:{req:false,valid:/^(left|right)$/i},style:{req:false,valid:/^[^"<>]+$/}},toNode:function(e){let t=WH.ce("span",{className:"d2tt"});if(e["float"]){t.classList.add("markup-float-"+e["float"])}WH.markup.applyCommonAttributes(t,e);WH.Fonts.load(WH.Game.D2);return t}}}();WH.markup.tags["dps-rankings"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[a-z0-9-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.getDataTree(t.dataEnv);let i=WH.getPageData(["markup.dpsRankings",a,e.unnamed].join("."));return!!i},toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.getDataTree(t.dataEnv);let i=a===WH.dataTree.CLASSIC?"classic.warcraftlogs.com":"www.warcraftlogs.com";let n=WH.getPageData(["markup.dpsRankings",a,e.unnamed].join("."));let s=n.data;let r=n.info;let o=document.createDocumentFragment();if(r){WH.ae(o,WH.ce("div",{style:{fontSize:"90%"}},WH.ct(r)))}var l=WH.ce("div",{className:"highchart bar highcharts-wowhead-style"});WH.ae(o,l);WH.Tools.Highcharts.loadScript((function(){var e={credits:{href:"https://"+i+"/",text:WH.TERMS.warcraftlogs_site},chart:{type:"bar",height:Math.max(400,Math.min(600,s.length*30)),styledMode:true,plotBorderWidth:0,style:{fontFamily:"Open Sans"}},plotOptions:{bar:{borderWidth:0,dataLabels:{style:{textShadow:"none"}}}},xAxis:{categories:[]},yAxis:{min:0,title:{enabled:false}},legend:{enabled:false},title:{text:""},tooltip:{formatter:function(){var e=Math.ceil(Math.min(2,Math.max(0,4-Math.log10(this.y))));var t=WH.ce("div");WH.ae(t,WH.ct(this.x+WH.TERMS.colon_punct));WH.ae(t,WH.ce("b",{},WH.ct(WH.Strings.formatNumber(this.y,false,e,e))));WH.ae(t,WH.ct(WH.TERMS.wordspace_punct+WH.GlobalStrings.DPS));return t.innerHTML},useHTML:true},series:[{data:[]}]};s.sort((function(e,t){return t.dps-e.dps}));for(var t,n=0;t=s[n];n++){var r=WH.Wow.PlayerClass.getName(t.classId);if(t.spec==="DPS"){r=WH.Strings.sprintf(WH.TERMS.dpsRoleClass_format,r)}else{r=WH.Strings.sprintf(WH.TERMS.specclass_format,a===WH.getDataTree()?WH.Wow.PlayerClass.Specialization.getName(t.specId):t.spec,r)}e.xAxis.categories.push(r);var o={id:r,y:t.dps,colorIndex:"c"+t.classId};e.series[0].data.push(o)}Highcharts.chart(l,e)}));return o}};WH.markup.tags["heart-of-azeroth-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var a=WH.ce("div",{id:"markup-heart-of-azeroth-calc-"+this.counter++});var i=function(){new WH.Wow.HeartOfAzerothCalc(a,{embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true"})};if(!WH.Wow.HeartOfAzerothCalc){this.callbacks.push(i);if(this.callbacks.length==1){WH.loadAssets("heart-of-azeroth-calc",(function(){for(var e,t=0;e=WH.markup.tags["heart-of-azeroth-calc"].callbacks[t];t++){e()}}))}}else{i()}return a}};WH.markup.tags.galleryupload={empty:false,allowedClass:WH.markup.CLASS.ADMIN,attr:{unnamed:{req:true,valid:/^[0-9]+$/},submittext:{req:false,valid:/.+/}},toNode:function(e){var t="";var a=document.createDocumentFragment();var i=WH.ce("form",{method:"POST",action:"/gallery-upload",enctype:"multipart/form-data"});WH.aE(i,"submit",WH.markup.tags.galleryupload._validateForm.bind(null,i));WH.ae(a,i);WH.ae(a,WH.ce("div",{style:{display:"none"},dataset:{markupContentTarget:1}}));WH.ae(i,WH.ce("input",{type:"hidden",name:"gallery",value:e.unnamed}));WH.ae(i,WH.ce("input",{type:"hidden",name:"message",value:""}));WH.ae(i,WH.ce("input",{type:"hidden",name:"from",value:location.pathname+location.search}));WH.ae(i,WH.ce("input",{type:"file",name:"incoming",accept:".jpg,.jpeg,.png,image/jpeg,image/png",required:true}));WH.ae(i,WH.ct(" "));WH.ae(i,WH.ce("button",{type:"submit",className:"btn btn-primary"},WH.ct(e.submittext||WH.TERMS.submit)));return a},_validateForm:function(e){var t=3;var a=e.incoming;if(!a||a.value==""){return false}if(a.files&&a.files.length){if(a.files.length>1){alert("Too many files");return false}if(a.files[0].size>t*1048576){alert(WH.TERMS.filesizelimit_format.replace("%d",t).replace("&gt;",">"));return false}}e.message.value=e.nextSibling.textContent;return true}};WH.markup.tags["gear-planner"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);if(!WH.isClassicTree()&&!WH.isTbcTree()&&!WH.isWrathTree()){return WH.ce("div",{className:"q10"},WH.ct("[gear-planner] "+WH.TERMS.errorClassicOnly_tip))}let a="GearPlanner";if(WH.isTbcTree())a="GearPlannerTbc";if(WH.isWrathTree())a="GearPlannerWrath";var i=WH.ce("div",{id:"markup-gear-planner-calc-"+this.counter++});var n=function(){new WH.Wow[a](i,{embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true"})};if(!WH.Wow[a]){this.callbacks.push(n);if(this.callbacks.length==1){WH.loadAssets("gear-planner",(function(){for(var e,t=0;e=WH.markup.tags["gear-planner"].callbacks[t];t++){e()}}))}}else{n()}return i}};WH.markup.tags["guide-content"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=document.createDocumentFragment();let a=WH.Entity.getUrl(WH.Types.GUIDE,e.unnamed);WH.ae(t,WH.ct("(Content from "));WH.ae(t,WH.ce("a",{href:a},WH.ct("Guide #"+e.unnamed)));WH.ae(t,WH.ct(")"));return t}};WH.markup.tags["guild-rankings"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/[a-z-]+/},raid:{req:true,valid:/[a-z-]+/},difficulty:{req:false,valid:/(normal|heroic|mythic)/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ce("h3",{className:"heading-size-2 guild-boss-rankings-heading",dataset:{markupContentTarget:1}},WH.ce("a",{href:"https://raider.io/"},WH.ct("Powered by Raider.IO"))));var a;var i=WH.ce("tr");WH.ae(t,WH.ce("table",{className:"guild-boss-rankings"},i));var n=WH.Strings.slug(e.unnamed);var s=WH.Strings.slug(e.raid);var r=WH.Strings.slug(e.difficulty||"mythic");let o=s+"."+n+"."+r;for(var l=1;l<=3;l++){a=WH.ce("td");WH.ae(i,a);let e=WH.getPageData(["markup.guildRankings",o].join("."));if(e){let t=e[l-1];if(t){var c=t.realm.toLowerCase().replace(/[^a-z ]/,"").replace(" ","-");a.className="guild-boss-rankings-earned";WH.ae(a,WH.ce("div",{className:"guild-boss-rankings-"+t.faction},WH.ce("a",{href:"https://raider.io/guilds/"+t.region.toLowerCase()+"/"+c+"/"+t.name,target:"_blank"},WH.ct(t.name))));WH.ae(a,WH.ce("a",{href:"https://raider.io/"+s+"/realm-rankings/"+t.region.toLowerCase()+"/"+c+"/"+r,target:"_blank"},WH.ct("("+t.region+") "+t.realm)));continue}}switch(l){case 1:WH.st(a,"1st Place");break;case 2:WH.st(a,"2nd Place");break;case 3:WH.st(a,"3rd Place");break;default:WH.st(a,l+"th Place")}WH.ae(a,WH.ce("br"));WH.ae(a,WH.ct("Not Earned"))}return t},toText:function(e){var t=WH.Strings.slug(e.unnamed);var a=WH.Strings.slug(e.raid);var i=WH.Strings.slug(e.difficulty||"mythic");let n=a+"."+t+"."+i;var s="";for(var r=1;r<=3;r++){var o="";switch(r){case 1:o="1st";break;case 2:o="2nd";break;case 3:o="3rd";break;default:o=r+"th"}s+=o+" Place: ";let e=WH.getPageData(["markup.guildRankings",n].join("."));if(e){let t=e[r-1];if(t){s+=t.name+", ("+t.region+") "+t.realm+", "+WH.ucfirst(t.faction)+". ";continue}}s+="Not Earned. "}return e._textContents+": "+s}};WH.markup.tags.lightbox={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^map$/},zone:{req:false,valid:/^-?[0-9]+[a-z]?$/i},floor:{req:false,valid:/^[0-9]+$/},pins:{req:false,valid:/^[0-9]+$/}},validate:function(e){switch(e.unnamed){case"map":if(e.zone){return true}break}return false},toNode:function(e){var t=WH.ce("a");WH.markup.applyCommonAttributes(t,e);var a="";switch(e.unnamed){case"map":a=WH.Url.generatePath("/maps")+"?data="+e.zone;if(e.floor){a+="."+e.floor}if(e.pins){a+=":"+e.pins}var i=a.substr(6).replace("data=","");t.href=a;WH.aE(t,"click",(function(e){if(!WH.isLeftClick(e)){return true}MapViewer.show({link:i});e.preventDefault()}))}return t}};WH.markup.tags.listview={empty:true,attr:{id:{req:true,valid:/^\d+/},rows:{req:false,valid:/^\d+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div");let a=WH.Gatherer.get(WH.Types.GATHERER_LISTVIEW,e.id);if(!a){t.className="error-message";WH.ae(t,WH.ct("Listview #"+e.id+" not found."));return t}if(a.template!=="db2-file-markup"){t.className="error-message";WH.ae(t,WH.ct("Listview #"+e.id+" uses unknown template: ["+a.template+"]."));return t}let i={id:WH.Strings.guid(),clickable:false,filtrable:true,hash:Listview.HASH_DISABLED,searchable:true,template:{noDebug:true,columns:[]},data:a.rows,parent:t,nItemsPerPage:e.rows,createNote:function(e,t){let i=[{label:"Product",option:WH.ct(a.product)},{label:"Build",option:WH.ct(a.build)},{label:"File",option:WH.ct(a.file)}];this.addOptions(i,{style:{minHeight:"39px"}})}};for(let e,t=0;e=a.cols[t];t++){i.template.columns.push({id:"col"+t,align:"left",compute:function(e,t,i,n){let s=t["col"+e];let r=WH.ct(s);if(a.cols[e].numeric){r=WH.ce("pre",{style:{display:"inline",margin:"0"}},r)}let o=t["col"+e+"icon"];if(o){if(r.nodeType!==Node.ELEMENT_NODE){r=WH.ce("span",{},r)}r.classList.add("icontiny");WH.aef(r,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+o+".gif",style:{paddingRight:"5px",verticalAlign:"middle"},loading:"lazy"}))}let l;if(l=a.cols[e].entityType){r=WH.ce("a",{href:WH.Entity.getUrl(l,s,undefined,undefined,a.dataEnv,a.locale)},r)}WH.ae(i,r);if(t.hotfixAdd){n.classList.add("new-row-2");WH.Tooltip.simple(i,"<i>New row via hotfix.</i>","q0",{byCursor:true})}else if(t.hotfixDelete){n.classList.add("deleted");WH.Tooltip.simple(i,"<i>Deleted row via hotfix.</i>","q0",{byCursor:true})}else if((t.changes||[])[e]){i.classList.add("changed-cell");WH.Tooltip.simple(i,WH.Strings.escapeHtml(t.changes[e]),"q0",{byCursor:true})}else if(t["new"]){n.classList.add("new-row");WH.Tooltip.simple(i,"<i>New row this build.</i>","q0",{byCursor:true})}}.bind(null,t),name:e.label||"[col"+t+"]",type:e.numeric?Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT,value:"col"+t,pos:t,sortFunc:function(e,t,a){let i=t["col"+e];let n=a["col"+e];return WH.stringCompare(i,n)}.bind(null,t)})}new Listview(i);t.querySelector("div").className="listview";return t}};WH.markup.tags.map={empty:false,attr:{zone:{req:true,valid:/^-?[0-9a-z\-_]+$/i},floor:{req:false,valid:/^\d+/},source:{req:false,valid:/\S+/},legacy:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{pin:1},mapHits:0,toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);var a=[];while(e._contents.hasChildNodes()){var i=e._contents.removeChild(e._contents.firstChild);a=a.concat(i.whMarkupInfo)}var n=document.createDocumentFragment();var s=WH.ce("div");WH.markup.applyCommonAttributes(s,e);WH.ae(n,s);WH.ae(n,WH.ce("div",{style:{clear:"left"}}));new Mapper({parent:s,unique:WH.markup.tags.map.mapHits++,zone:e.zone,coords:a?a:null,legacy:e.legacy||false,level:e.hasOwnProperty("floor")?e.floor:undefined,dataEnv:t.dataEnv});return n}};WH.markup.tags.pin={empty:false,attr:{url:{req:false,valid:/\S+/},type:{req:false,valid:/^[0-9]+$/},x:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},y:{req:true,valid:/^[0-9]{1,2}(\.[0-9])?$/},path:{req:false,valid:/^([0-9]{1,2}(\.[0-9])?[,:]?)+$/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{map:1},toNode:function(e){let t=e.url;if(t&&!WH.markup.isUrlSafe(t)){t=""}let a=e._contents;if(t&&t.includes("npc=")){let e=document.createDocumentFragment();WH.ae(e,WH.ce("b",{className:"q"},a));WH.ae(e,WH.ce("br"));WH.ae(e,WH.ce("span",{className:"q2"},WH.ct(WH.TERMS.clicktoviewthisnpc_stc)));a=e}if(t&&!t.includes("/")&&t.includes("=")){t=`/${t}`}let i=null;if(e.path){i=[];e.path.split(":").forEach((e=>{let t=e.split(",");if(t.length===2){i.push([parseFloat(t[0]||0),parseFloat(t[1]||0)])}}))}let n=WH.ce("div");n.whMarkupInfo=[[parseFloat(e.x||0),parseFloat(e.y||0),{label:WH.ce("div",{},a).innerHTML,url:WH.markup.finalizeUrl(t),type:e.type,lines:i}]];return n}};WH.markup.tags.model={empty:false,attr:{item:{req:false,valid:/^[0-9]+$/},object:{req:false,valid:/^[0-9]+$/},npc:{req:false,valid:/^[0-9]+$/},itemset:{req:false,valid:/^[0-9,]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},border:{req:false,valid:/^[0-9]+$/},fileid:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},humanoid:{req:false,valid:/^1$/},img:{req:false,valid:/\S+/},label:{req:false,valid:/[\S ]+/},link:{req:false,valid:/\S+/},shadow:{req:false,valid:/^(true|false)$/},slot:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,skipSlots:{4:1,5:1,6:1,7:1,8:1,9:1,10:1,16:1,19:1,20:1},toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var a=WH.ce("a");var i;WH.markup.applyCommonAttributes(a,e);var n=false;if(e.npc){a.href="#modelviewer:"+WH.Types.NPC+":"+e.npc+":"+(e.humanoid?"1":"0");WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.NPC,displayId:e.npc,slot:e.slot,displayAd:1,fromTag:1};if(e.humanoid){a.humanoid=1}if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.ModelViewer.getContentPath(t.dataEnv)+"thumbs/npc/"+e.npc+".png"};if(!e.img){s.width="150";s.height="150"}WH.ae(a,i=WH.ce("img",s));n=true}else if(e.object){a.href="#modelviewer:"+WH.Types.OBJECT+":"+e.object;WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.OBJECT,displayId:e.object,displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.ModelViewer.getContentPath(t.dataEnv)+"thumbs/obj/"+e.object+".png"};if(!e.img){s.width="150";s.height="150"}WH.ae(a,i=WH.ce("img",s));n=true}else if(e.item&&e.slot){a.href="#modelviewer:"+WH.Types.ITEM+":"+e.item+":"+e.slot;WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.ITEM,displayId:e.item,slot:e.slot,displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}));var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img||WH.Wow.Item.getThumbUrl(e.item,undefined,t.dataEnv)};if(!e.img){s.width="150";s.height="150"}WH.ae(a,i=WH.ce("img",s));n=true}else if(e.itemset){a.href="javascript:";WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,type:WH.Types.ITEM_SET,equipList:e.itemset.split(","),displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}if(e.fileid){a.fileId=e.fileid}WH.Wow.ModelViewer.showLightbox(a)}))}else if(e.fileid){a.href="javascript:";WH.aE(a,"click",(function(){var a={dataEnv:t.dataEnv,fileId:e.fileid,displayAd:1,fromTag:1};if(e.link){a.link=e.link}if(e.label){a.label=e.label}WH.Wow.ModelViewer.showLightbox(a)}));if(e.img){var s={alt:e._contents.textContent,title:e._contents.textContent,src:e.img};WH.ae(a,i=WH.ce("img",s));n=true}}else{var r=document.createDocumentFragment();WH.ae(r,WH.ct("[model]"));WH.ae(r,WH.ce("span",{dataset:{markupContentTarget:1}}));WH.ae(r,WH.ct("[/model]"));return r}if(i){if(e["float"]){i.classList.add("markup-float-"+e["float"])}if(e.border!==undefined){if(e.border==0){i.classList.add("no-border")}else{i.classList.add("border");i.style.borderWidth=""+e.border+"px"}}else{i.classList.add("content-image");if(e.shadow=="true"){i.classList.add("content-image-shadowed")}}i.loading="lazy"}while(n&&e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}return a}};WH.markup.tags.modelviewer=WH.markup.tags.model;WH.markup.tags["mythic-damage-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){let t=WH.ce("div");let a=function(){new WH.Wow.MythicDamageCalc(t,{embedded:true,hash:e.unnamed})};if(!WH.Wow.MythicDamageCalc){this.callbacks.push(a);if(this.callbacks.length===1){WH.loadAssets("mythic-damage-calc",(function(){let e;while(e=WH.markup.tags["mythic-damage-calc"].callbacks.shift()){e()}}))}}else{a()}return t}};WH.markup.tags["raid-bots-form"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^droptimizer|gear|talents|quick|stats$/}},toNode:function(e){return WH.Raidbots.createForm(e.unnamed)}};WH.markup.tags["reddit"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"reddit-markup"});let a=e.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+a,(function(a){if(!a||!a.data||!a.data.children||!a.data.children[0]||!a.data.children[0].data||a.data.children[0].kind!=="t3"){WH.st(t,"Error: could not fetch Reddit post "+e.unnamed);t.classList.add("error-message");return}let i=a.data.children[0].data;WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let n=Math.min(window.innerWidth-40,e.width||800);WH.ae(t,WH.ce("div",{className:"reddit-markup-container",style:{width:n+"px"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+i.permalink}))))}));return t}};WH.markup.tags["reddit-video"]={empty:true,ltrim:true,attr:{unnamed:{req:true,valid:/\br\/[^\/]+\/comments\/[a-z0-9]+/},width:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("div",{className:"reddit-markup"});let a=e.unnamed.match(/\br\/[^\/]+\/comments\/([a-z0-9]+)/)[1];WH.xhrJsonRequest("https://api.reddit.com/api/info?id=t3_"+a,(function(a){if(!a||!a.data||!a.data.children||!a.data.children[0]||!a.data.children[0].data||a.data.children[0].kind!=="t3"){WH.st(t,"Error: could not fetch Reddit post "+e.unnamed);t.classList.add("error-message");return}let i=a.data.children[0].data;let n=i.secure_media&&i.secure_media.reddit_video||i.preview&&i.preview.reddit_video_preview;if(!n||!n.fallback_url){WH.st(t,"Error: could not find any video in Reddit post "+e.unnamed);t.classList.add("error-message");return}WH.DOM.addScriptOnce("https://embed.redditmedia.com/widgets/platform.js",{async:true});let s=Math.min(window.innerWidth-40,e.width||800,n.width);WH.ae(t,WH.ce("div",{className:"reddit-markup-container",style:{width:s+"px"}},WH.ce("blockquote",{className:"reddit-card"},WH.ce("a",{href:"https://www.reddit.com"+i.permalink}))))}));return t}};WH.markup.tags.regexreplace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^[^a-z\\].+[^a-z\\]$/},with:{req:true,valid:/^.*$/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ct(" "));var a=WH.ce("span",{className:"q0"});WH.ae(t,a);WH.ae(a,WH.ct('Regex Replacing: "'));WH.ae(a,WH.ce("b",{},WH.ct(e.unnamed)));WH.ae(a,WH.ct('" With: "'));WH.ae(a,WH.ce("b",{},WH.ct(e["with"])));WH.ae(a,WH.ct('"'));return t}};WH.markup.tags.replace={empty:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{"guide-content":1},attr:{unnamed:{req:true,valid:/^.+$/},with:{req:true,valid:/^.*$/}},toNode:function(e){var t=document.createDocumentFragment();WH.ae(t,WH.ct(" "));var a=WH.ce("span",{className:"q0"});WH.ae(t,a);WH.ae(a,WH.ct('Replacing: "'));WH.ae(a,WH.ce("b",{},WH.ct(e.unnamed)));WH.ae(a,WH.ct('" With: "'));WH.ae(a,WH.ce("b",{},WH.ct(e["with"])));WH.ae(a,WH.ct('"'));return t}};WH.markup.tags.screenshot={empty:false,attr:{id:{req:false,valid:/^[0-9]+$/},url:{req:false,valid:/\S+/},thumb:{req:false,valid:/\S+/},size:{req:false,valid:/^(thumb|small|resized|normal)$/i},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.url&&!e.thumb){return false}else if(!e.id&&!e.url){return false}return true},toNode:function(e){var t=[];var a=[];var i="javascript:";var n="";let s=false;let r=e.size||"thumb";var o={};if(e.id){o=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,e.id)||{};s=o.staffOnly;i=WH.getScreenshotUrl(e.id,"normal",{description:e.title,imageType:o.imageType,staffOnly:o.staffOnly});var l=e.id;if(e.thumb&&e.thumb.match(/^[0-9]+$/)){l=e.thumb;e.thumb=null}n=WH.getScreenshotUrl(l,r,{description:e.title,imageType:o.imageType,staffOnly:o.staffOnly})}else if(e.url){i=e.url}if(e.thumb){n=e.thumb}if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var c=WH.ce("a",{href:i});WH.markup.applyCommonAttributes(c,e);WH.aE(c,"click",function(e,t,a){if(!WH.isLeftClick(a)){return}ScreenshotViewer.show({screenshots:e,pos:t});a.preventDefault()}.bind(null,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length));var u=WH.ce("img");WH.ae(c,u);if(o.staffOnly){if(!e.height){switch(r){case"normal":u.style.maxHeight="1200px";break;case"resized":u.style.maxHeight="618px";break;case"small":u.style.maxHeight="300px";break;case"thumb":u.style.maxHeight="150px";break}}if(!e.width){switch(r){case"normal":u.style.maxWidth="1600px";break;case"resized":u.style.maxWidth="772px";break;case"small":u.style.maxWidth="300px";break;case"thumb":u.style.maxWidth="150px";break}}WH.Screenshots.showStaffOnlyWarning();if(WH.User.hasRole(WH.Screenshots.ROLE_GALLERY_ADMIN)){u.style.outline="3px dashed #f60"}}if(e.size&&e.width){u.width=e.width}if(e.size&&e.height){u.height=e.height}u.src=WH.Url.addMaxSizeParams(n,{height:u.height,width:u.width});u.loading="lazy";if(e.border!==undefined){if(e.border==0){u.classList.add("no-border")}else{u.classList.add("border");u.style.borderWidth=""+e.border+"px"}}else{u.classList.add("content-image");if(e.shadow=="true"){u.classList.add("content-image-shadowed")}}if(e["float"]){u.classList.add("markup-float-"+e["float"])}u.alt=e.title||"";var d={caption:e.title,width:e.size?null:e.width,height:e.size?null:e.height,noMarkup:true,staffOnly:s};if(e.id){d.id=e.id;d.imageType=o.imageType}else{d.url=e.url}g_screenshots[WH.markup.mediaUid].push(d);return c}};WH.markup.tags["google-sheet"]={empty:true,attr:{unnamed:{req:true,valid:/^[a-zA-Z0-9_-]+$/}},libraryLoaded:false,toNode:function(e){var t=WH.Strings.guid();var a=e.unnamed;var i=document.createDocumentFragment();WH.ae(i,WH.ce("img",{src:WH.staticUrl+"/images/icons/ajax-medium-242424.gif",style:{margin:"0 5px 0 0",position:"relative",top:"-1px",verticalAlign:"middle",width:"16px"}}));WH.ae(i,WH.ct(WH.TERMS.loading_ellipsis));var n=WH.ce("div",{id:t},i);n.dataset.loading=1;if(!WH.markup.tags["google-sheet"].libraryLoaded){$.getScript("https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.3.4/tabletop.min.js");WH.markup.tags["google-sheet"].libraryLoaded=true}setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,n,a),0);return n},fetchSheet:function(e,t){if(typeof Tabletop==="undefined"){setTimeout(WH.markup.tags["google-sheet"].fetchSheet.bind(null,e,t),50);return}Tabletop.init({key:t,callback:WH.markup.tags["google-sheet"].renderSheet.bind(null,e,t),simpleSheet:true});setTimeout(function(e,t){if(e.dataset.loading){WH.markup.tags["google-sheet"].renderError(e,t)}}.bind(null,e,t),5e3)},renderError:function(e,t){var a=document.createDocumentFragment();WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.googlesheeterror_tip));WH.ae(a,WH.ce("a",{href:"https://docs.google.com/spreadsheets/d/"+t,target:"_blank"},WH.ct(t)));delete e.dataset.loading;$(e).empty().append(a)},renderSheet:function(e,t,a,i){if(!i||!i.model_names||!i.model_names.length||!i.models||!i.models[i.model_names[0]]){WH.markup.tags["google-sheet"].renderError(e,t);return}var n={columns:[],searchable:true,filtrable:true,clickable:false};var s=i.models[i.model_names[0]].column_names;for(var r=0;r<s.length;r++){var o=s[r];if(!o){continue}n.columns.push({id:WH.Strings.slug(o),name:WH.deUrlize(o),type:"text",align:a[0][o].length>10?"left":"center",compute:function(e,t,a,i){if(t[e].length<=10){var n=WH.ce("span",{className:"no-wrap"});WH.st(n,t[e]);WH.ae(a,n)}else{WH.st(a,t[e])}}.bind(null,o),getVisibleText:function(e,t){return t[e]}.bind(null,o),sortFunc:function(e,t,a){return WH.stringCompare(t[e],a[e])}.bind(null,o)})}Listview.templates[e.id]=n;delete e.dataset.loading;e.className="listview";WH.ee(e);new Listview({template:e.id,id:e.id,parent:e.id,data:a})}};WH.markup.tags["soulbind-calc"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:true,valid:/^[^\/][\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.ce("div");let i=function(){new WH.Wow.SoulbindCalc(a,{embedded:true,hash:e.unnamed,editable:e.editable==="true",dataEnv:t.dataEnv})};if(!WH.Wow.SoulbindCalc){this.callbacks.push(i);if(this.callbacks.length===1){WH.loadAssets("soulbind-calc",(function(){let e;while(e=WH.markup.tags["soulbind-calc"].callbacks.shift()){e()}}))}}else{i()}return a}};WH.markup.tags["survey-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},class:{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/},date:{req:false,valid:/^\d{4}-\d\d-\d\d$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Gatherer;const a=WH.Strings;const i=WH.WarcraftLogs;let n=a.slug(e["class"]||"",true);let s=a.slug(e.spec||"",true);let r=[n,s].filter((function(e){return!!e})).join(".");if(e.date){r+="/"+e.date}let o=t.get(WH.Types.GATHERER_SURVEY_COVENANTS,r);if(!o){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(a.nbsp+" "+WH.TERMS.notenoughdata));return e}let l=WH.ce("div",{className:"top-covenants"});if(e.background==="false"){l.classList.add("no-background")}let c=WH.ce("div");WH.ae(l,c);let u=0;o.data.sort((function(e,a){return WH.stringCompare(t.getName(WH.Types.COVENANT,e.id),t.getName(WH.Types.COVENANT,a.id))}));for(let e=0,n;n=o.data[e];e++){let e=t.get(WH.Types.COVENANT,n.id);let s=a.slug(e.name_enus||"");let r=WH.ce("span",{className:"covenant-"+s+" icon-"+s},WH.ct(t.getName(WH.Types.COVENANT,n.id)+" "+WH.Strings.formatNumber(n.pop/100,true,0,1)));WH.ae(c,r);WH.Tooltip.simple(r,i.getCovenantTooltip.bind(undefined,n),"q",{byCursor:true});u++}while(u<4){WH.ae(c,WH.ce("span"));u++}if(o.endTimestamp){let e=WH.ce("div",{className:"top-covenants-time"});WH.ae(l,e);let t=o.startTimestamp?new Date(o.startTimestamp*1e3):null;let a=new Date(o.endTimestamp*1e3);let i=(new Date).getFullYear()>(t||a).getFullYear()?{month:"short",day:"numeric",year:"numeric"}:{month:"long",day:"numeric"};let n=Locale.getIetf();a=a.toLocaleDateString(n,i);if(t){t=t.toLocaleDateString(n,i);WH.st(e,WH.term("dataCollectedDateRange_format",t,a))}else{WH.st(e,WH.term("dataCollectedDate_format",a))}}return l}};WH.markup.tags.talent={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},abilities:{req:false,valid:/^true|false$/},editable:{req:false,valid:/^true$/},glyphs:{req:false,valid:/^false$/},specs:{req:false,valid:/^true$/},builds:{req:false,valid:/^true|false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],toNode:function(e){if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()){return WH.markup.tags.talent.toNodeClassic(e)}var t=WH.markup.getDatabaseDomainInfo(e);if(e.unnamed.indexOf("-")<0){e.glyphs="false"}var a=WH.ce("div",{className:"talentcalc-markup-parent"});if(e.glyphs=="false"){a.className+="talentcalc-markup-no-glyphs"}if(e.specs!="true"){a.className+=" talentcalc-markup-no-specs"}var i={parent:a,embedded:true,markup:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true",dataDomain:t.host,dataEnv:t.dataEnv};if(e.builds){i.builds=JSON.parse(e.builds)}var n=function(){new TalentCalc(i)};if(!WH.isSet("TalentCalc")){this.callbacks.push(n);if(this.callbacks.length==1){WH.loadAssets("talent-calc",(function(){for(var e,t=0;e=WH.markup.tags.talent.callbacks[t];t++){e()}}))}}else{n()}return a},toNodeClassic:function(e){var t=WH.ce("div",{className:"talentcalc-markup-parent"});var a={embedded:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable==="true",abilities:e.abilities==="true"};var i=function(){new WH.Wow.TalentCalcClassic(t,a)};if(!WH.Wow.hasOwnProperty("TalentCalcClassic")||!WH.Wow.TalentCalcClassic.isReady(false)){this.callbacks.push(i);if(this.callbacks.length==1){WH.loadAssets("talent-calc-classic",(()=>WH.markup.tags.talent.callbacks.forEach((e=>e()))),WH.getDataEnv())}}else{i()}return t}};WH.markup.tags["pvp-calc"]={empty:true,attr:{unnamed:{req:true,valid:/^#?[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icons:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},callbacks:[],counter:0,toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);var a=WH.ce("div",{id:"markup-pvptalent-"+this.counter++,className:"pvptalentcalc-markup-parent"});var i=function(){new PvpTalentCalc({id:a.id,embedded:true,markup:true,hash:e.unnamed.replace(/^#+/,""),editable:e.editable=="true",dataDomain:t.host})};if(!WH.isSet("PvpTalentCalc")){this.callbacks.push(i);if(this.callbacks.length==1){WH.loadAssets("pvp-talent-calc",(function(){for(var e,t=0;e=WH.markup.tags["pvp-calc"].callbacks[t];t++){e()}}))}}else{i()}return a}};WH.markup.tags["talent-pvp"]=WH.markup.tags["pvp-calc"];WH.markup.tags["honor-calc"]=WH.markup.tags["pvp-calc"];WH.markup.tags.time={empty:true,attr:{until:{req:false,valid:/^\d+$/},since:{req:false,valid:/^\d+$/},server:{req:false,valid:/^true$/}},validate:function(e){if(!e.until&&!e.since){return false}return true},toNode:function(e){var t=WH.ce("span");t.title=new Date((e.until?e.until:e.since)*1e3).toLocaleString();WH.st(t,WH.markup.tags.time.getTime(e));setInterval(WH.markup.tags.time.updateTime.bind(null,t,e),5e3);return t},getTime:function(e){var t;if(e.server){t=WH.getServerTime().getTime()/1e3}else{t=(new Date).getTime()/1e3}var a=0;if(e.until){a=e.until-t}else{a=t-e.since}if(a>0){return WH.formatTimeElapsed(a)}else{return"0 "+WH.TERMS.seconds_lc}},updateTime:function(e,t){e.firstChild.nodeValue=WH.markup.tags.time.getTime(t)}};WH.markup.tags.tooltip={empty:false,attr:{name:{req:false,valid:/\S+/},bare:{req:false,valid:/^true$/i},label:{req:false,valid:/[\S ]+/}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(!e.unnamed&&!e.name){return false}return true},toNode:function(e){var t=document.createElement("div");if(e.label){var a=document.createElement("table");t.appendChild(a);var i=document.createElement("tr");a.appendChild(i);var n=document.createElement("td");i.appendChild(n);n.className="q0";n.style.width="300px";var s=document.createElement("small");n.appendChild(s);s.appendChild(document.createTextNode(e.label))}t.appendChild(e._contents);WH.markup.tooltipTags[e.name]=t.innerHTML;if(e.bare){WH.markup.tooltipTagsWithRawText[e.name]=true}return null}};WH.markup.tags["top-builds"]={empty:true,attr:{background:{req:false,valid:/^false$/},boss:{req:true,valid:/^.+$/},class:{req:true,valid:/^.+$/},difficulty:{req:true,valid:/^(heroic|mythic)$/},spec:{req:true,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(){return null}};WH.markup.tags["top-covenants"]={empty:true,attr:{background:{req:false,valid:/^false$/},class:{req:false,valid:/^.+$/},spec:{req:false,valid:/^.+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Gatherer;const a=WH.Strings;const i=WH.WarcraftLogs;let n=a.slug(e["class"]||"all",true);let s=a.slug(e.spec||"all",true);let r=WH.getPageData(["markup.topCovenants",n,s].join("."));if(!r||!r.topCovenants||!r.topCovenants.length){let e=WH.ce("div");WH.ae(e,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(e,WH.ct(a.nbsp+" "+WH.TERMS.notenoughdata));return e}let o=WH.ce("div",{className:"top-covenants"});if(e.background==="false"){o.classList.add("no-background")}let l=WH.ce("div");WH.ae(o,l);let c=0;r.topCovenants.sort((function(e,a){return WH.stringCompare(t.getName(WH.Types.COVENANT,e.id),t.getName(WH.Types.COVENANT,a.id))}));for(let e=0,n;n=r.topCovenants[e];e++){let e=t.get(WH.Types.COVENANT,n.id);let s=a.slug(e.name_enus||"");let r=WH.ce("span",{className:"covenant-"+s+" icon-"+s},WH.ct([e["name_"+Locale.getName()],WH.Strings.formatNumber(n.pop/100,true,0,1)].join(" ")));WH.ae(l,r);WH.Tooltip.simple(r,i.getCovenantTooltip.bind(undefined,n),"q",{byCursor:true});c++}while(c<4){WH.ae(l,WH.ce("span"));c++}return o}};WH.markup.tags["top-mythic-classes"]={empty:true,attr:{unnamed:{req:true,valid:/^[A-Za-z0-9' -]+$/},affixes:{req:true,valid:/^(current|all)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.getPageData(["markup.topMythicClasses",e.unnamed,e.affixes].join("."));let a=WH.ce("div");WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicclassesdata_tip));if(!t){return a}var i=WH.ce("div",{className:"top-mythic-classes"});var n=["tank","healer","dps"];for(var s=0,r;r=t.classes[s];s++){var o=WH.staticUrl+"/images/classes/symbols/icon-"+WH.Wow.PlayerClass.getIdString(r.class_id)+".png";var l=Math.round(r.total/t.counts.total*100)+"%";var c=WH.ce("div",{className:"top-mythic-classes-class"});WH.ae(i,c);var u=WH.ce("div",{className:"top-mythic-classes-class-content"});WH.ae(c,u);WH.ae(u,WH.ce("div",{className:"top-mythic-classes-class-crest",style:{backgroundImage:"url("+o+")"}}));var d=WH.ce("div",{className:"top-mythic-classes-class-title"});WH.ae(u,d);WH.ae(d,WH.ce("span",{className:"c"+r.class_id},WH.ct(WH.Wow.PlayerClass.getName(r.class_id))));WH.ae(d,WH.ce("small",{},WH.ct(l)));for(var f=0,h;h=n[f];f++){if(r.hasOwnProperty(h)){var p=WH.ce("span");WH.ae(p,WH.ce("b",{},WH.ct(Math.round(r[h]/t.counts[h]*100))));WH.ae(p,WH.ct("%"));WH.ae(u,WH.ce("span",{className:"iconrole iconsmall "+h},p))}}}if(!i.hasChildNodes()){return a}return i}};WH.markup.tags["top-mythic-runs"]={empty:true,attr:{unnamed:{req:true,valid:/^.*$/},affixes:{req:true,valid:/^.*$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.getPageData(["markup.topMythicRuns",e.unnamed,e.affixes].join("."));let a=WH.ce("div");WH.ae(a,WH.ce("i",{className:"fa fa-exclamation-triangle"}));WH.ae(a,WH.ct(WH.Strings.nbsp+" "+WH.TERMS.notopmythicrunsdata_tip));if(!t){return a}var i=WH.ce("div",{className:"top-mythic-runs"});var n=5;for(var s=0,r;r=t.runs[s];s++){r=r.run;var o=WH.ce("div",{className:"top-mythic-runs-run"});WH.ae(i,o);WH.ae(o,WH.ce("div",{className:"top-mythic-runs-run-level"},WH.ct(WH.TERMS.mythicplus+WH.TERMS.wordspace_punct+r.mythic_level)));var l=r.clear_time_ms/1e3;var c=Math.floor(l/60);l=Math.round(l-c*60);WH.ae(o,WH.ce("div",{className:"top-mythic-runs-run-time"},WH.ct(c+WH.TERMS.wordspace_punct+(c===1?WH.TERMS.minute_lc:WH.TERMS.minutes_lc)+WH.TERMS.wordspace_punct+l+WH.TERMS.wordspace_punct+(l===1?WH.TERMS.second_lc:WH.TERMS.seconds_lc))));if(r.roster.length){var u=document.createDocumentFragment();var d=document.createDocumentFragment();for(var f=0,h;h=r.roster[f];f++){h=h.character;var p=WH.Wow.PlayerClass.Specialization.getSlug(h["class"].id,h.spec.id);var m=Icon.create(WH.Wow.PlayerClass.Specialization.getIconName(h.spec.id),Icon.sizeIds.small,undefined,"/"+p+"-"+WH.Wow.PlayerClass.getSlug(h["class"].id)+"-guide",undefined,undefined,undefined,undefined,true);WH.Tooltip.simple(m,'<span class="no-wrap">'+WH.sprintf(WH.TERMS.guide_format,WH.TERMS.specclass_format.replace("%1$s",WH.Wow.PlayerClass.Specialization.getName(h.spec.id)).replace("%2$s",WH.Wow.PlayerClass.getName(h["class"].id)))+"</span>","c"+h["class"].id);WH.ae(u,WH.ce("td",{},m));let e=h.race.id===WH.Wow.Race.ID_BLOOD_ELF?WH.Wow.Gender.Female:WH.Wow.Gender.Male;let t=WH.Icon.create(WH.Wow.Race.getIcon(h.race.id,e),WH.Icon.SMALL,WH.Entity.getUrl(WH.Types.RACE,h.race.id,WH.Wow.Race.getName(h.race.id)),{span:true});WH.Tooltip.simple(t,WH.Wow.Race.getName(h.race.id),"q");WH.ae(d,WH.ce("td",{},t))}var H=WH.ce("table");WH.ae(o,H);WH.ae(H,WH.ce("tr",{},u));WH.ae(H,WH.ce("tr",{},d))}if(e.affixes==="all"){var g=WH.ce("div",{className:"top-mythic-runs-run-affixes"});WH.ae(o,g);WH.ae(g,WH.ct(WH.TERMS.affixes+WH.TERMS.colon_punct));for(var W=0,E;E=r.weekly_modifiers[W];W++){var _=WH.Icon.create(E.icon,WH.Icon.SMALL,WH.Entity.getUrl(WH.Types.AFFIX,E.id,E.name),{span:true});var v=Icon.getLink(_);v.setAttribute("data-whattach","true");WH.ae(g,_)}}if(s+1===n){break}}if(!i.hasChildNodes()){return a}return i}};WH.markup.tags.twitch={empty:true,attr:{unnamed:{req:true,valid:/^\S+$/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},time:{req:false,valid:/^(?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=function(){let t=window.innerWidth-40;let a;let i;let n=16/9;if(e.width&&e.height){a=parseInt(e.width);i=parseInt(e.height);n=a/i;if(a>t){a=t;i=a/n}}else if(e.width){a=Math.min(parseInt(e.width),t);i=a/n}else if(e.height){i=parseInt(e.height);a=i*n;if(a>t){a=t;i=a/n}}else{a=Math.min(t,620);i=a/n}return{width:a,height:i}}();let a=function(){if(/^[a-zA-Z0-9_-]{4,25}$/.test(e.unnamed)){return{type:"channel",id:e.unnamed,time:undefined}}let t;if(t=e.unnamed.match(/\/videos?\/(\d+)/)){let a={type:"video",id:t[1],time:undefined};if(t=e.unnamed.match(/[&?]t=((?:\d+h)?(?:\d{1,2}m)?(?:\d{1,2}s)?)/)){a.time=t[1]}return a}if(t=e.unnamed.match(/clips\.twitch\.tv\/([a-zA-Z0-9_-]+)/)){return{type:"clip",id:t[1],time:undefined}}if(t=e.unnamed.match(/\/clips?\/([a-zA-Z0-9_-]+)/)){return{type:"clip",id:t[1],time:undefined}}if(t=e.unnamed.match(/twitch\.tv\/([a-zA-Z0-9_-]{3,25})/)){return{type:"channel",id:t[1],time:undefined}}return{type:undefined,id:undefined,time:undefined}}();let i="&parent="+encodeURIComponent(location.hostname);i+="&autoplay=false";if(e.time&&a.type==="video"){i+="&time="+encodeURIComponent(e.time)}else if(a.time){i+="&time="+encodeURIComponent(a.time)}switch(a.type){case"channel":return WH.ce("iframe",{src:"https://player.twitch.tv/?channel="+a.id+i,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"});case"video":return WH.ce("iframe",{src:"https://player.twitch.tv/?video=v"+a.id+i,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"});case"clip":return WH.ce("iframe",{src:"https://clips.twitch.tv/embed?clip="+a.id+i,frameBorder:0,scrolling:"no",height:t.height,width:t.width,allow:"fullscreen"})}return WH.ce("div",{className:"error-message",style:{border:"1px dashed",boxSizing:"border-box",height:t.height+"px",width:t.width+"px",padding:"5px"}},WH.ct("Error: Could not detect Twitch embed type for ["+e.unnamed+"]."))}};WH.markup.tags.video={empty:true,attr:{border:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right)$/i},id:{req:true,valid:/^[0-9]+$/},loop:{req:false,valid:/^(true|false)$/},shadow:{req:false,valid:/^(true|false)$/},unnamed:{req:false,valid:/^embed$/i},width:{req:false,valid:WH.markup.regex.isInt}},ltrim:true,rtrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!g_videos[e.id]){return WH.ce("b",{},WH.ct("Video #"+e.id))}var t=g_videos[e.id];var a=[];var i=[];if(e.unnamed){switch(t.videoType){case 1:return WH.markup.tags.youtube.toNode({unnamed:t.videoId,width:e.width});case 2:let a=WH.ce("video",{controls:true,loop:e.loop==="true"},WH.ce("source",{src:WH.Url.generateAnonymous("/video-stream/"+t.id+"-"+t.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})}));if(t.thumbnailScreenshot){let i=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,t.thumbnailScreenshot)||{};if(i.id){let n=WH.getScreenshotUrl(i.id,"normal",{description:t.videoId,imageType:i.imageType,staffOnly:i.staffOnly});if(e.width){n+="?maxWidth="+e.width}a.poster=n;a.preload="metadata"}}if(e.width){a.style.width=e.width+"px"}return a;default:return WH.ce("b",{},WH.ct("Video id "+e.id+" cannot be embedded with unsupported type: "+t.videoType))}}if(!g_videos[WH.markup.mediaUid]){g_videos[WH.markup.mediaUid]=[]}let n=t.videoId;if(t.videoType===2){n=e.id+"-"+n}var s=WH.ce("div",{style:{position:"relative",display:"inline-block",zoom:1}});var r=WH.ce("a",{href:WH.sprintf(vi_siteurls[t.videoType],n)});WH.ae(s,r);WH.markup.applyCommonAttributes(r,e);WH.aE(r,"click",(function(e){if(!WH.isLeftClick(e)){return}VideoViewer.show({videos:WH.markup.mediaUid,pos:g_videos[WH.markup.mediaUid].length});e.preventDefault()}));if(vi_thumbnails[t.videoType]){var o=WH.ce("img",{src:WH.sprintf(vi_thumbnails[t.videoType],t.videoId)});if(e.width){o.style.width=e.width+"px"}o.loading="lazy";WH.ae(r,o);if(e.border!==undefined){if(e.border==0){o.classList.add("no-border")}else{o.classList.add("border");o.style.borderWidth=""+e.border+"px"}}else{o.classList.add("content-image");if(e.shadow!=="false"){o.classList.add("content-image-shadowed")}}if(e["float"]){o.classList.add("markup-float-"+e["float"])}if(t.hasCaption){o.alt=t.caption}WH.ae(r,WH.ce("img",{src:WH.staticUrl+"/images/icons/play-sm.png",style:{opacity:"0.6",position:"absolute",width:"48px",height:"48px",top:"23px",left:"38px"}}))}else{WH.st(r,t.caption)}g_videos[WH.markup.mediaUid].push(WH.dO(t));return s}};WH.markup.tags.youtube={empty:true,attr:{unnamed:{req:true,valid:/\S+/},title:{req:false,valid:/[\S ]+/},thumb:{req:false,valid:/\S+/},width:{req:false,valid:/^[0-9]+$/},height:{req:false,valid:/^[0-9]+$/},start:{req:false,valid:/^\d+$/},end:{req:false,valid:/^\d+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.width?e.width:640;var a=e.height?e.height:360;if(window.outerWidth&&window.outerWidth-20<t){t=window.outerWidth-20;a=Math.floor(t*.5625)}var i={height:a,width:t,videoId:e.unnamed,playerVars:{autoplay:1}};if(e.start){i.playerVars.start=e.start}if(e.end){i.playerVars.end=e.end}if(!WH.markup.tags.youtube.listeningForApiReady){WH.markup.tags.youtube.listeningForApiReady=true;var n;if(WH.isSet("onYouTubeIframeAPIReady")&&typeof window.onYouTubeIframeAPIReady=="function"){n=window.onYouTubeIframeAPIReady}else{n=function(){}}window.onYouTubeIframeAPIReady=function(){WH.markup.tags.youtube.apiReady=true;n()};if(!WH.isSet("YT")){window.YT={};WH.ajaxIshRequest("https://www.youtube.com/iframe_api",true)}}var s={yt:i,loaded:false};var r=WH.ce("div",{className:"wh-youtube"});s.container=r;var o=a/t*100;var l="https://i.ytimg.com/vi/"+i.videoId+"/sddefault.jpg";if(t<=480||$(document).width()<=500){l="https://i.ytimg.com/vi/"+i.videoId+"/hqdefault.jpg"}if(e.thumb){l=e.thumb;r.classList.add("wh-youtube-custom-thumb")}if(o<=35){r.classList.add("wh-youtube-short")}r.style.background="url("+l+")";r.style.maxWidth=""+t+"px";let c=WH.ce("a",{className:"wh-youtube-inner",href:"javascript:",style:{paddingTop:""+o+"%"}});WH.ae(r,c);if(e.title){WH.ae(c,WH.ce("div",{className:"wh-youtube-title"},WH.ct(e.title)))}WH.ae(c,WH.ce("i",{className:"fa fa-circle"}));WH.ae(c,WH.ce("i",{className:"fa fa-play-circle"}));WH.aE(c,"click",WH.markup.tags.youtube.onClick.bind(s));return r},fromHtml:function(e){var t;if(t=e.match(/<iframe\b[\s\S]*?src="[\s\S]*?youtube\.com\/embed\/[\s\S]*?"[\s\S]*?><\/iframe>/gi)){for(var a=0;a<t.length;++a){var i=t[a].match(/src="[\s\S]*?youtube\.com\/embed\/([\s\S]*?)"/i),n=t[a].match(/width[:="]+\s*([0-9]+)/i),s=t[a].match(/height[:="]+\s*([0-9]+)/i),r=t[a].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(t[a],"[youtube="+i[1]+(n?" width="+n[1]:"")+(s?" height="+s[1]:"")+"]")}}return e},listeningForApiReady:false,apiReady:false,onClick:function(){if(this.loaded){return}if(!WH.markup.tags.youtube.apiReady){setTimeout(WH.markup.tags.youtube.onClick.bind(this),125);return}this.container.classList.add("wh-youtube-loaded");this.loaded=true;this.player=new YT.Player(this.container.firstChild,this.yt)}};WH.markup.entityTag=function(e,t){t=t||{};let a=t.tag||WH.Types.getStringId(e);WH.markup.tags[a]={entityType:e,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false}},validate:function(e){return!((e.domain||e.site)&&WH.markup.dbPage)},toNode:WH.markup.entityTagToNode.bind(WH.markup,e),toText:WH.markup.entityTagToText.bind(WH.markup,e)};if(WH.Tooltips.isTypeSupported(e)){WH.markup.tags[a].attr.tooltip={req:false,empty:true}}if(t.icons){WH.markup.tags[a].attr.icon={req:false,valid:WH.markup.regex.iconSizeOrFalse}}return WH.markup.tags[a]};WH.markup.entityTagToNode=function(e,t,a,i){const n=WH.Icon;const s=WH.Types;const r=WH.Entity;const o=WH.Game;var l=t.unnamed;var c=WH.markup.getDatabaseDomainInfo(t);let u=c.dataEnv;let d=o.getByTree((s.getRequiredTrees(e)||[])[0]||u&&WH.getDataTree(u));var f=c.nameKey;const h=f.replace(/^name_/,"nameHtml_");if(typeof i==="undefined"){i=[]}let p=r.getPlaceholderName(e,l);let m=undefined;if(t.spec){i.push("spec="+t.spec)}if(i.length){m=i.join("&")}if(t.diff){i.push("diff="+t.diff)}if(t.diffnew){i.push("diffnew="+t.diffnew)}if(t.tempname){p=t.tempname}var H=WH.ce("a");if(i.length){H.rel=i.join("&")}var g=parseInt(l,10);var W=null;var E=g_gathered_types[e]||{};var _=WH.Gatherer.get(e,g,c.dataEnv);if(_?.displayName||_?.[h]||_?.[f]||_?.name){if(_.hasOwnProperty("fromDataEnv")){u=_.fromDataEnv;d=o.getByTree(WH.getDataTree(u))||d}if(_.hasOwnProperty("inventoryColor")){H.classList.add(o.getKey(o.DI)+"-ic"+_.inventoryColor)}else if(_.hasOwnProperty("dropRank")){H.classList.add(o.getKey(o.DI)+"-q"+_.dropRank)}else if(_.hasOwnProperty("quality")){var v=_.quality;if(t.quality){v=t.quality}let e=d===o.WOW?"":`${o.getKey(d)}-`;H.classList.add(`${e}q${v}`)}var T=_[f]||_.name;var b;if((b=T.indexOf(" / "))!=-1){if(/\.1$/.test(l)){T=T.substr(0,b)}else if(/\.2$/.test(l)){T=T.substr(b+3)}}if(e===s.ITEM&&!_.icon){_.icon=n.UNKNOWN}if(e===s.RACE){_.icon=WH.Wow.Race.getIcon(g,WH.Wow.Gender.tryFrom(t.gender))}let a=undefined;let p=!t.icon||t.icon!=="false";let m=_.icon||_.iconImageHash||typeof E.getIcon==="function";if(p&&m){a=_.icon||_.iconImageHash;switch(e){case s.ITEM:a=E.getIcon(g,undefined,undefined,c.dataEnv)||a;break;case s.PLAYER_CLASS:case s.CURRENCY:a=E.getIcon(g)||a;break}}let S=e===s.ITEM&&_.qualityTier>0;let y=t=>{if(!_.displayName&&!S){H.classList.add("icontiny")}H.dataset.game=o.getKey(d);H.dataset.type=s.getStringId(e);WH.ae(H,WH.ce("img",{src:typeof t==="string"&&t.includes("/")?t:n.getIconUrl(t,n.TINY,d),style:{verticalAlign:"middle"},loading:"lazy"}));if(d===o.DI&&_.gridType){H.dataset.gridType=_.gridType}};if(t.icon&&n.isValidSize(t.icon)){if(t.icon===n.TINY){y(a||n.getIconUrl(n.UNKNOWN,t.icon))}else{if(!a){return WH.ce("span",{className:"q10"},WH.ct(r.getPlaceholderName(e,l+WH.TERMS.wordspace_punct+WH.TERMS.icon)))}let n=r.createIcon(_,e,{id:l,game:d,size:t.icon,span:true,type:e});if(i.length){let e=n.nodeName==="A"?n:WH.qs("a",n);if(e){e.rel=i.join("&")}}return n}}else{if(a){y(a);WH.ae(H,WH.ct(" "))}let e=WH.ce("span",{className:"tinyicontxt"});if(_.displayName||_[h]){e.innerHTML=_.displayName||_[h]}else{WH.ae(e,WH.ct(T))}WH.ae(H,e)}if(S){WH.ae(H,WH.ct(WH.TERMS.wordspace_punct));WH.ae(H,WH.ce("img",{src:`${WH.STATIC_URL}/images/wow/TextureAtlas/${WH.getDataEnvKey()}/professions-chaticon-quality-tier${_["qualityTier"]}.png`,style:{maxHeight:"1.4em",verticalAlign:"bottom"}}))}W=T}else{WH.st(H,p)}H.href=r.getUrl(e,l,W,m,u,c.localeId);WH.markup.applyCommonAttributes(H,t);if(t.tooltip!=null){H=WH.markup.replaceNodeWithTooltip(H,e,t,i)}return H};WH.markup.entityTagToText=function(e,t){var a=t.unnamed;var i=WH.markup.getDatabaseDomainInfo(t);var n=i.nameKey;var s=WH.Gatherer.get(e,a,i.dataEnv);if(s&&s[n]){return WH.markup.getEscapedHtml(s[n])}return WH.Types.getUpperSingular(e)+WH.TERMS.wordspace_punct+"#"+a};WH.markup.replaceNodeWithTooltip=(e,t,a,i)=>{const n=WH.DOM;const s=WH.Entity;const r=WH.Game;let o=WH.ce("span",{dataset:{markupTooltipContainer:"true"}},e);let l=WH.markup.getDatabaseDomainInfo(a).dataEnv;let c=WH.Types.getRequiredTrees(t)??[];if(c.length&&!c.includes(WH.getDataTree(l))){l=WH.dataTreeToRoot[c[0]]}WH.Tooltips.replaceWithTooltip(o,t,a.unnamed,l,undefined,WH.Tooltips.relToParams(i),(e=>{let n=WH.ce("div",{innerHTML:e});let o=c.length?r.getByTree(c[0]):null;let l;switch(o){case r.D4:l=WH.qs(".whtt-name",n);break;case r.DI:l=WH.qs(".whtt-name",n);break;default:l=WH.qs("b",n)}if(l){let e=WH.ce("a",{href:s.getUrl(t,a.unnamed,undefined,i.join("&")),dataset:{disableWowheadTooltip:"true"}},[...l.childNodes]);WH.ae(l,e)}return n.innerHTML}));if(a.tooltip){let e;switch(a.tooltip){case"tiny":e=1-1/3;break;case"small":e=1-1/6;break;case"medium":break;case"large":e=1+1/3;break;case"true":break;default:WH.warn("Invalid tooltip size requested.",a.tooltip,WH.Types.getUpperSingular(t),a.unnamed)}if(e){WH.onMutate(o,(()=>{let t=o.firstChild;if(t?.classList?.contains("wowhead-tooltip")&&n.getData(t,"tooltipScaled")!==true){n.setData(t,"tooltipScaled",true);n.scaleElementInParent(t,e)}}))}}return o};WH.markup.tags.achievement={entityType:WH.Types.ACHIEVEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ACHIEVEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ACHIEVEMENT)};WH.markup.tags["adventure-combatant-ability"]={entityType:WH.Types.ADVENTURE_COMBATANT_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:/^false$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ADVENTURE_COMBATANT_ABILITY)};WH.markup.tags.affix={entityType:WH.Types.AFFIX,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AFFIX),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AFFIX)};WH.markup.tags["azerite-essence"]={entityType:WH.Types.AZERITE_ESSENCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE)};WH.markup.tags["azerite-essence-power"]={entityType:WH.Types.AZERITE_ESSENCE_POWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},spec:{req:false,valid:/^[0-9]+$/},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.AZERITE_ESSENCE_POWER)};WH.markup.tags["bfa-champion"]={entityType:WH.Types.BFA_CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.BFA_CHAMPION,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BFA_CHAMPION)};WH.markup.tags.building={entityType:WH.Types.BUILDING,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},nolvl:{req:false,valid:/^true$/},short:{req:false,valid:/^true$/},side:{req:false,valid:/^1|2$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.unnamed;var a=WH.markup.getDatabaseDomainInfo(e);let i=a.dataEnv;var n=a.nameKey;var s=WH.ce("a");var r=WH.Gatherer.get(WH.Types.BUILDING,t,a.dataEnv);if(r&&r[n]){if(r.hasOwnProperty("fromDataEnv")){i=r.fromDataEnv}var o=r[n];s.href=WH.Entity.getUrl(WH.Types.BUILDING,t,o,undefined,i,a.localeId);var l=e["short"]?WH.TERMS.level_abbrev:WH.TERMS.level;if(e.side){var c=new RegExp(e.side==1?" \\/ .+$":"[^\\/]+ \\/ ");o=o.replace(c,"")}else if(e["short"]){if(WH.Wow.Building.hasShortName(t)){o=WH.Wow.Building.getShortName(t)}}var u=!e.nolvl&&r.hasOwnProperty("level")?l+WH.TERMS.wordspace_punct+r.level+WH.TERMS.wordspace_punct:"";WH.st(s,u+o)}else{s.href=WH.Entity.getUrl(WH.Types.BUILDING,t,undefined,undefined,i,a.localeId);WH.st(s,WH.Entity.getPlaceholderName(WH.Types.BUILDING,t))}WH.markup.applyCommonAttributes(s,e);return s},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BUILDING)};WH.markup.tags["class"]={entityType:WH.Types.PLAYER_CLASS,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}if(WH.Wow.PlayerClass.exists(parseInt(e.unnamed),WH.markup.getDataEnvFromSiteAttr(e.site))){return true}return false},toNode:function(e){var t=WH.markup.entityTagToNode(WH.Types.PLAYER_CLASS,e);t.classList.add("c"+e.unnamed);return t},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.PLAYER_CLASS)};WH.markup.tags.champion={entityType:WH.Types.CHAMPION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.CHAMPION,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CHAMPION)};WH.markup.tags.currency={entityType:WH.Types.CURRENCY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},amount:{req:false,valid:/^[0-9\:]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=WH.markup.entityTagToNode(WH.Types.CURRENCY,e);if(t.dataset.markupTooltipContainer){return t}var a=t.querySelector(".tinyicontxt");if(a){t.classList.add("q1")}if(e.amount){if(a){var i=t.textContent;t.classList.add("tip");WH.aE(t,"mouseover",(function(e){WH.Tooltip.showAtCursor(e,i,"q1")}));WH.aE(t,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltip.hide);WH.st(t.querySelector(".tinyicontxt")||t,e.amount.split(":").join(" - "));var n=t.querySelector("img");if(n){t.style.backgroundImage="url("+n.src+")";t.classList.remove("icontiny");t.classList.add("icontinyr");n.parentNode.removeChild(n)}}else{WH.ae(t,WH.ct(WH.TERMS.wordspace_punct+"x"+e.amount.split(":").join(" - ")))}}else{var s=WH.ce("span");while(t.hasChildNodes()){WH.ae(s,t.firstChild)}WH.ae(t,s)}return t},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.CURRENCY)};WH.markup.tags.event={entityType:WH.Types.EVENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.EVENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.EVENT)};WH.markup.tags.faction={entityType:WH.Types.FACTION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.FACTION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FACTION)};WH.markup.tags.follower={entityType:WH.Types.FOLLOWER,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},level:{req:false,valid:/^[0-9:]+$/},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.FOLLOWER,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.FOLLOWER)};WH.markup.tags["gear-set"]={entityType:WH.Types.GEAR_SET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=e.unnamed;var a=g_gearsets[t];let i=WH.Entity.getUrl(WH.Types.GEAR_SET,t,(a||{}).name);var n=WH.ce("a",{href:i,target:"_blank"});n.setAttribute("whattach","true");if(a){if(a["class"]){n.className="icontiny c"+a["class"];WH.ae(n,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(a["class"])+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(n,WH.ct(" "))}WH.ae(n,WH.ct(a.name))}else{WH.ae(n,WH.ct(WH.Types.getUpperSingular(WH.Types.GEAR_SET)+WH.TERMS.wordspace_punct+"#"+t))}return n}};WH.markup.tags.guide={empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.GUIDE),toText:function(e){var t=e.unnamed;var a="name";if(g_guides[t]&&g_guides[t][a]){return WH.markup.getEscapedHtml(g_guides[t][a])}return WH.Types.getUpperSingular(WH.Types.GUIDE)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags["mission-ability"]={entityType:WH.Types.MISSION_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION_ABILITY)};WH.markup.tags.garrisonability=WH.cO(WH.markup.tags["mission-ability"]);delete WH.markup.tags.garrisonability.entityType;WH.markup.tags.icondb={entityType:WH.Types.ICON,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},block:{req:false,valid:/^(true|false)$/},color:{req:false,valid:WH.markup.regex.noWhitespace},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},kind:{req:false,valid:WH.markup.regex.noWhitespace},name:{req:false,valid:/^true$/},site:{req:false,valid:WH.markup.regex.domain},size:{req:false,valid:/^(tiny|small|medium|large)$/},type:{req:false,valid:WH.markup.regex.noWhitespace},tempname:{req:false}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){let t=e.size?e.size:"small";let a=e.name==="true";let i=e.unnamed;let n=WH.markup.getDatabaseDomainInfo(e);let s=WH.Entity.getPlaceholderName(WH.Types.ICON,i);if(["simple","round"].includes(e.type)){e.kind=e.type;delete e.type}let r=[];if(e.diff){r.push("diff="+e.diff)}if(e.diffnew){r.push("diffnew="+e.diffnew)}r=r.length?r.join("&"):null;if(e.tempname){s=e.tempname}let o=WH.ce("a");let l=WH.Gatherer.get(WH.Types.ICON,i,n.dataEnv);let c=n.dataEnv;let u;if(l&&l.name){if(l.hasOwnProperty("fromDataEnv")){c=l.fromDataEnv}u=WH.Entity.getUrl(WH.Types.ICON,i,l.name,undefined,c,n.localeId)}else{u=WH.Entity.getUrl(WH.Types.ICON,i,undefined,undefined,c,n.localeId)}o.href=u;if(l&&l.name){if(a){s=" "+l.name}if(t==="tiny"){o.classList.add("icontiny");let e=WH.ce("img",{src:WH.STATIC_URL+"/images/wow/icons/tiny/"+l.icon.toLowerCase()+".gif",style:{verticalAlign:"middle"},loading:"lazy"});WH.ae(o,e)}else{let i={color:e.color,kind:e.kind,span:a||e.block!=="true"};if(!a){if(r){i.rel=r}return WH.Icon.create(l.name,t,u,i)}WH.ae(o,WH.Icon.create(l.name,t,null,i))}}if(r){o.rel=r}if(a){WH.ae(o,WH.ct(s))}WH.markup.applyCommonAttributes(o,e);return o},toText:function(e){let t=e.unnamed;if(g_icons[t]&&g_icons[t].name){return WH.markup.getEscapedHtml(g_icons[t].name)}return WH.Types.getUpperSingular(WH.Types.ICON)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags.item={entityType:WH.Types.ITEM,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/i},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},"azerite-powers":{req:false,valid:/^[0-9:]+$/},bonus:{req:false,valid:/^[0-9:]+$/},covenant:{req:false,valid:/^[a-zA-Z\- ]+$/},"crafting-quality":{req:false,valid:WH.markup.regex.isInt},spec:{req:false,valid:/^[0-9]+$/},"spell-modifier":{req:false,valid:/^\d+$/},ak:{req:false,valid:/^[0-9]+$/},tooltip:{req:false,empty:true},tempname:{req:false},transmog:{req:false,valid:/^([0-9]+|hidden)$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.ak){t.push("artk="+e.ak)}if(e["azerite-powers"]){t.push("azerite-powers="+e["azerite-powers"])}if(e.bonus){t.push("bonus="+e.bonus)}if(e["crafting-quality"]){t.push("crafting-quality="+e["crafting-quality"])}if(e.spec){t.push("spec="+e.spec)}if(e.transmog){t.push("transmog="+e.transmog)}var a=WH.markup.entityTagToNode(WH.Types.ITEM,e,undefined,t);if(a.dataset.markupTooltipContainer){return a}a.dataset.entity="item";a.dataset.entityHasIcon="true";if(e["spell-modifier"]){a.href+=`?spellModifier=${e["spell-modifier"]}`}if(e.covenant){let t=WH.Wow.Covenant.getIdBySlug(WH.Strings.slug(e.covenant,true));if(t){a.href+=`?covenant=${t}`}}return a},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM)};WH.markup.tags["item-set"]={entityType:WH.Types.ITEM_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^-?[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ITEM_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ITEM_SET)};WH.markup.tags.itemset=WH.cO({},WH.markup.tags["item-set"]);delete WH.markup.tags.itemset.entityType;WH.markup.tags.mission={entityType:WH.Types.MISSION,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.MISSION),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.MISSION)};WH.markup.tags.npc={entityType:WH.Types.NPC,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.NPC),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.NPC)};WH.markup.tags["order-advancement"]={entityType:WH.Types.ORDER_ADVANCEMENT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ORDER_ADVANCEMENT)};WH.markup.tags.outfit={entityType:WH.Types.OUTFIT,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},toNode:function(e){var t=e.unnamed;var a=g_outfits[t];let i=WH.markup.getDatabaseDomainInfo(e);let n=WH.Entity.getUrl(WH.Types.OUTFIT,t,a&&a.name,undefined,i.dataEnv,i.localeId);var s=WH.ce("a",{href:n,target:"_blank"});s.setAttribute("whattach","true");if(a){if(a.classs){s.className="icontiny c"+a.classs;WH.ae(s,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+g_classes.getIcon(a.classs)+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(s,WH.ct(" "))}WH.ae(s,WH.ct(a.name))}else{WH.ae(s,WH.ct(WH.Types.getUpperSingular(WH.Types.OUTFIT)+WH.TERMS.wordspace_punct+"#"+t))}return s}};WH.markup.tags["pet-ability"]={entityType:WH.Types.BATTLE_PET_ABILITY,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.BATTLE_PET_ABILITY),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.BATTLE_PET_ABILITY)};WH.markup.tags.petability=WH.cO({},WH.markup.tags["pet-ability"]);delete WH.markup.tags.petability.entityType;WH.markup.tags.object={entityType:WH.Types.OBJECT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.OBJECT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.OBJECT)};WH.markup.tags.pet={entityType:WH.Types.HUNTER_PET,empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.HUNTER_PET),toText:function(e){let t=e.unnamed;let a=WH.Wow.Pet.getName(t);if(a){return WH.markup.getEscapedHtml(a)}return WH.Types.getUpperSingular(WH.Types.HUNTER_PET)+WH.TERMS.wordspace_punct+"#"+t}};WH.markup.tags.quest={entityType:WH.Types.QUEST,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){let t=e.unnamed;let a=WH.Gatherer.get(WH.Types.QUEST,t);let i=WH.markup.entityTagToNode(WH.Types.QUEST,e);if(i.dataset.markupTooltipContainer){return i}if(a){let e=i.querySelector("span");if(e&&a.hasOwnProperty("_side")){switch(a["_side"]){case 1:e.classList.add("icon-alliance");break;case 2:e.classList.add("icon-horde");break}}}return i},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.QUEST)};WH.markup.tags.race={entityType:WH.Types.RACE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},gender:{req:false,valid:/^(0|1)$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RACE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RACE)};WH.markup.tags.resource={entityType:WH.Types.RESOURCE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.RESOURCE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.RESOURCE)};WH.markup.tags.ship={entityType:WH.Types.SHIP,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},quality:{req:false,valid:/^[2345]$/},abilities:{req:false,valid:/^[0-9:]+$/},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=[];if(e.quality){t.push("q="+e.quality)}if(e.level){t.push("level="+e.level)}if(e.abilities){t.push("abil="+e.abilities)}return WH.markup.entityTagToNode(WH.Types.SHIP,e,undefined,t)},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SHIP)};WH.markup.tags.skill={entityType:WH.Types.SKILL,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},icon:{req:false,valid:/^false$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.SKILL),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SKILL)};WH.markup.tags.sound={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+$/},src:{req:false,valid:/\S+/},title:{req:false,valid:/\S+/},type:{req:false,valid:/\S+/},src2:{req:false,valid:/\S+/},type2:{req:false,valid:/\S+/},domain:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if(e.unnamed){return true}if(!e.src){return false}return true},toNode:function(e){var t;var a;var i;var n;var s;var r;var o=WH.markup.getDatabaseDomainInfo(e);if(e.unnamed){if(!(e.unnamed in g_sounds)){return null}if(!g_sounds[e.unnamed].hasOwnProperty("files")){return null}var l;var c=g_sounds[e.unnamed].files;c.sort((function(){return Math.sign(Math.random()-.5)}));while(!l&&c.length){l=c.shift();if(!l.hasOwnProperty("type")){l=undefined}}if(!l){return null}t=l.type;a=l.url;i=g_sounds[e.unnamed].name?g_sounds[e.unnamed].name:l.title;n=WH.Entity.getUrl(WH.Types.SOUND,e.unnamed,i,undefined,o.dataEnv,o.localeId)}else{if(WH.markup.allow<WH.markup.CLASS.STAFF){return null}a=e.src;i=e.title?e.title:"(Unknown)";if(!/^(https?:)?\/\//.test(a)){if(/^\d+$/.test(a)){let e=parseInt(a);let t=Locale.getName(o.localeId);a=WH.STATIC_URL+"/sound-ids/live/"+t+"/"+(e&255)+"/"+e}else{a=WH.STATIC_URL+"/wowsounds"+a}}if(e.hasOwnProperty("type")){t=e.type}else{switch(e.src.toLowerCase().substr(-4)){case".mp3":t="audio/mpeg";break;case".ogg":t='audio/ogg; codecs="vorbis"';break}}if(e.src2){s=e.src2;if(!/^(https?:)?\/\//.test(s)){if(/^\d+$/.test(s)){let e=parseInt(s);let t=Locale.getName(o.localeId);a=WH.STATIC_URL+"/sound-ids/live/"+t+"/"+(e&255)+"/"+e}else{s=WH.STATIC_URL+"/wowsounds"+s}}if(e.hasOwnProperty("type2")){r=e.type2}else{switch(e.src2.toLowerCase().substr(-4)){case".mp3":r="audio/mpeg";break;case".ogg":r='audio/ogg; codecs="vorbis"';break}}}}var u=document.createDocumentFragment();var d=WH.ce("audio");WH.ae(u,d);d.preload="none";d.controls="true";WH.markup.applyCommonAttributes(d,e);if(e.unnamed){d.setAttribute("rel","sound="+e.unnamed)}var f=WH.ce("source",{src:a});WH.ae(d,f);if(t){f.type=t}if(s){f=WH.ce("source",{src:s});WH.ae(d,f);if(r){f.type=r}}if(n){var h=WH.ce("div",{className:"audiomarkup"});h.appendChild(u.firstChild);WH.ae(h,WH.ce("br"));WH.ae(h,WH.ce("a",{href:n},WH.ct(i)));WH.ae(u,h)}return u},fromHtml:function(e){var t=e.match(/<audio [^>]*\brel="sound=(\d+)/);if(t){return"[sound="+t[1]+"]"}return e.replace(/<audio\b[\s\S]*?><source\b[\s\S]*\bsrc="([^"]*?)"[\s\S]*?<\/audio>/gi,'[sound src="$1"]')}};WH.markup.tags.spell={entityType:WH.Types.SPELL,empty:true,allowInReplies:true,attr:{buff:{req:false,valid:/^true$/},covenant:{req:false,valid:/^[a-zA-Z\- ]+$/},def:{req:false,valid:WH.markup.regex.isInt},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},domain:{req:false,valid:WH.markup.regex.domain},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},rank:{req:false,valid:WH.markup.regex.isInt},site:{req:false,valid:WH.markup.regex.domain},tempname:{req:false},tooltip:{req:false,empty:true},unnamed:{req:true,valid:/^[0-9]+$/}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(e){var t=e.unnamed;var a=WH.markup.getDatabaseDomainInfo(e);let i=a.dataEnv;var n=a.nameKey;var s;var r=[];let o={};let l=WH.Entity.getPlaceholderName(WH.Types.SPELL,t);if(e.buff){r.push("buff")}if(e.diff){r.push("diff="+e.diff)}if(e.diffnew){r.push("diffnew="+e.diffnew)}if(e.rank){o.rank=e.rank}if(e.def){o.def=e.def}if(e.tempname){l=e.tempname}var c=document.createDocumentFragment();var u=WH.Gatherer.get(WH.Types.SPELL,t,a.dataEnv);if(u?.displayName||u?.[n]){if(u.hasOwnProperty("fromDataEnv")){i=u.fromDataEnv}var d=false;var f=false;switch(e.icon){case"false":break;case"large":case"medium":case"small":d=WH.Icon.create(u.icon.toLowerCase(),e.icon,WH.Entity.getUrl(WH.Types.SPELL,t,u[n],undefined,i,a.localeId),{span:true});d.dataset.entityIcon="spell";WH.ae(c,d);break;case"tiny":default:if(!u.displayName){if(e["class"]){e["class"]+=" icontiny"}else{e["class"]="icontiny"}}f=u.icon.toLowerCase()}s=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.SPELL,t,u[n],o,i,a.localeId)});WH.ae(c,s);if(r.length){s.rel=r.join("&")}WH.markup.applyCommonAttributes(s,e);s.dataset.entity="spell";s.dataset.entityHasIcon=d||f?"true":"false";if(f){WH.ae(s,WH.ce("img",{src:WH.staticUrl+"/images/wow/icons/tiny/"+f+".gif",style:{verticalAlign:"middle"},loading:"lazy"}));WH.ae(s,WH.ct(" "));let e=WH.ce("span",{className:"tinyicontxt"});if(u.displayName){e.innerHTML=u.displayName}else{WH.ae(e,WH.ct(u[n]))}WH.ae(s,e)}else{if(u.displayName){s.innerHTML=u.displayName}else{WH.ae(s,WH.ct(u[n]))}}if(u.hasOwnProperty("quality")&&u.quality>=0){s.classList.add("q"+u.quality)}}else{s=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.SPELL,t,undefined,o,i,a.localeId)});WH.ae(c,s);if(r.length){s.rel=r.join("&")}s.dataset.entity="spell";WH.st(s,l)}if(e.covenant){let t=WH.Wow.Covenant.getIdBySlug(WH.Strings.slug(e.covenant,true));if(t){s.href+=`?covenant=${t}`}}if(e.tooltip!=null){c=WH.markup.replaceNodeWithTooltip(c,WH.Types.SPELL,e,r)}return c},toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.SPELL)};WH.markup.tags.statistic=WH.cO({},WH.markup.tags.achievement);delete WH.markup.tags.statistic.entityType;WH.markup.tags.storyline={entityType:WH.Types.STORYLINE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.STORYLINE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.STORYLINE)};WH.markup.tags.threat={entityType:WH.Types.THREAT,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.THREAT),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.THREAT)};WH.markup.tags.title={entityType:WH.Types.TITLE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TITLE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TITLE)};WH.markup.tags["transmog-set"]={entityType:WH.Types.TRANSMOG_SET,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.TRANSMOG_SET),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.TRANSMOG_SET)};WH.markup.tags.zone={entityType:WH.Types.ZONE,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},tooltip:{req:false,empty:true}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:WH.markup.entityTagToNode.bind(WH.markup,WH.Types.ZONE),toText:WH.markup.entityTagToText.bind(WH.markup,WH.Types.ZONE)};WH.markup.tags.acronym={empty:false,attr:{unnamed:{req:true}},toNode:function(e){var t=WH.ce("span");t.className="tip";WH.markup.applyCommonAttributes(t,e);WH.aE(t,"mouseover",(function(t){WH.Tooltip.showAtCursor(t,e.unnamed,"q1")}));WH.aE(t,"mousemove",WH.Tooltip.cursorUpdate);WH.aE(t,"mouseout",WH.Tooltip.hide);return t}};WH.markup.tags.b={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("b");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(b|big|strong)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[b]$2[/b]")}};WH.markup.tags.box={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{align:{req:false,valid:/^(left|right|center)$/i},clear:{req:false,valid:/^(left|right|both)$/i},display:{req:false,valid:/^block$/},float:{req:false,valid:/^(left|right|none)$/i}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(e){return true},toNode:function(e){let t=WH.ce("div",{className:"box"});WH.markup.applyCommonAttributes(t,e);if(e.display)t.style.display=e.display;if(e.align)t.style.textAlign=e.align;if(e.clear)t.style.clear=e.clear;if(e.first)t.classList.add("first");if(e.last)t.classList.add("last");if(e["float"])t.classList.add("markup-float-"+e["float"]);return t}};WH.markup.tags.br={empty:true,toNode:function(e){return WH.ce("br")},fromHtml:function(e){return e.replace(/<br\b[\s\S]*?>/gi,"\n")}};WH.markup.tags.center={empty:false,allowInReplies:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");t.style.textAlign="-moz-center";t.style.textAlign=t.style.textAlign||"-webkit-center";t.style.textAlign=t.style.textAlign||"center";return t},fromHtml:function(e){return e.replace(/<center>([\s\S]+?)<\/center>/gi,"[pad][div align=center]$1[/div][pad]")}};WH.markup.tags.code={block:true,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},rtrim:true,itrim:true,helpText:true,allowedChildren:{"<text>":1},toNode:function(e){var t=WH.ce("pre");t.className="code";if(e.wrap==="true"){t.style.whiteSpace="normal"}else if(e.wrap==="false"){t.style.whiteSpace="nowrap"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.color={empty:false,attr:{unnamed:{req:true,valid:/^.*/i}},allowedClass:WH.markup.CLASS.STAFF,extraColors:{deathknight:"c6","death-knight":"c6",dk:"c6",demonhunter:"c12","demon-hunter":"c12",dh:"c12",druid:"c11",evoker:"c13",hunter:"c3",mage:"c8",monk:"c10",paladin:"c2",priest:"c5",rogue:"c4",shaman:"c7",warlock:"c9",warrior:"c1","quest-item":"q",poor:"q0",common:"q1",uncommon:"q2",rare:"q3",epic:"q4",legendary:"q5",artifact:"q6",heirloom:"q7",wowtoken:"q8",glyph:"q9",kyrian:"covenant-kyrian",venthyr:"covenant-venthyr",necrolord:"covenant-necrolord","night-fae":"covenant-night-fae","meta-gem":"gem1","red-gem":"gem2","yellow-gem":"gem4","orange-gem":"gem6","blue-gem":"gem8","purple-gem":"gem10","green-gem":"gem12","prismatic-gem":"gem14",yell:"s1",say:"s2",whisper:"s3",exalted:"rep-exalted",revered:"rep-revered",honored:"rep-honored",friendly:"rep-friendly",neutral:"rep-neutral",unfriendly:"rep-unfriendly",hostile:"rep-hostile",hated:"rep-hated","skill-red":"q10","skill-orange":"r1","skill-yellow":"r2","skill-green":"r3","skill-gray":"r4","di-normal":"di-q1","di-magic":"di-q2","di-rare":"di-q3","di-legendary":"di-q4","di-set":"di-q5","di-primal":"di-q6","di-gray":"di-ic0","di-inferior-blue":"di-ic1","di-light-blue":"di-ic2","di-white":"di-ic3","di-blue":"di-ic4","di-gold":"di-ic5","di-orange":"di-ic6","di-green":"di-ic7","di-dubo":"di-ic8","di-violet":"di-ic9","d4-q0":"d4-q0","d4-q1":"d4-q1","d4-q2":"d4-q2","d4-q3":"d4-q3","d4-q4":"d4-q4","d4-q5":"d4-q5","d4-q6":"d4-q6","d4-q7":"d4-q7","d4-collectible":"d4-item-collectible","d4-gambling":"d4-item-gambling","d4-materials":"d4-item-materials","d4-potion":"d4-item-potion","d4-questItem":"d4-item-questItem","d4-resource":"d4-item-resource","d4-rune":"d4-item-rune","d4-tome":"d4-item-tome","d4-number":"d4-color-number",blizzard:"blizzard-blue"},toNode:function(e){let t=/^(aqua|black|blue|fuchsia|gray|green|lightblue|lime|maroon|navy|olive|purple|red|silver|teal|white|yellow|#[a-f0-9]{6}|#[a-f0-9]{3})$/i;let a=WH.ce("span");if(WH.markup.tags.color.extraColors[e.unnamed]){a.className=WH.markup.tags.color.extraColors[e.unnamed]}else if(Object.values(WH.markup.tags.color.extraColors).includes(e.unnamed)){a.className=e.unnamed}else if(t.test(e.unnamed)){if(e.unnamed.toLowerCase()==="#00c0ff"){a.className="blizzard-blue"}else{a.style.color=e.unnamed}}WH.markup.applyCommonAttributes(a,e);return a}};WH.markup.tags["cta-button"]={allowedClass:WH.markup.CLASS.STAFF,empty:false,helpText:"[cta-button=https://www.google.com border=strong class=c3]"+WH.TERMS.text+"[/cta-button]",attr:{unnamed:{req:false,valid:/\S+/},border:{req:false,valid:/^(strong|none)$/},game:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/},guide:{req:false,valid:/^\d+$/},hash:{req:false,valid:/\S+/}},validate:function(e){return WH.markup.tags.url.validate(e)},toNode:function(e){let t=WH.markup.tags.url.toNode(e);if(t.nodeType!==Node.ELEMENT_NODE){return t}t.classList.add("cta-button");if(e.border){t.dataset.border=e.border}if(e.icon){const a=WH.Game;let i=e.game?a.getByKey(e.game):a.DEFAULT;if(!i){WH.warn('Invalid game provided in cta-button markup for "'+e.icon+'" icon: '+e.game);i=a.WOW;e.icon=WH.Icon.UNKNOWN}t.dataset.markupContentTarget=1;t.dataset.icon="true";WH.aef(t,WH.ce("span",{className:"cta-button-icon",style:{"background-image":"url("+WH.Icon.getIconUrl(e.icon,WH.Icon.MEDIUM,i)+")"}}))}return t}};WH.markup.tags.del={empty:false,attr:{copy:{req:false,valid:/^true$/}},toNode:function(e){var t=WH.ce("del");t.className="diffmod";WH.markup.applyCommonAttributes(t,e);if(!e.copy){t.setAttribute("unselectable","on")}return t}};WH.markup.tags.div={empty:false,block:true,ltrim:true,rtrim:true,itrim:true,attr:{clear:{req:false,valid:/^(left|right|both)$/i},unnamed:{req:false,valid:/^hidden$/i},float:{req:false,valid:/^(left|right)$/i},align:{req:false,valid:/^(left|right|center)$/i},margin:{req:false,valid:/^\d+$/},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");if(e.clear){t.style.clear=e.clear}if(e.unnamed){t.style.display="none"}if(e.width){t.style.width=e.width}if(e["float"]){t.className+=" markup-float-"+e["float"]}if(e.align){t.style.textAlign=e.align}if(e.margin){t.style.margin=e.margin+"px"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}t.className=t.className.replace(/^ +/,"");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<div\\b[\\s\\S]*?>","</div>","g")){for(var i=0;i<a.length;++i){var n=a[i][1].match(/float:\s*(left|right)"/i),s=a[i][1].match(/width[:="]+\s*([0-9]+)/i);e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[div"+(n?" float="+n[1]:"")+(s?" width="+s[1]:"")+"]"+WH.markup.tags.div.fromHtml(a[i][0],t+1)+"[/div]")}}return e}};WH.markup.tags["entity-list-toggle"]=new function(){this.block=true;this.empty=false;this.ltrim=true;this.rtrim=true;this.itrim=true;this.attr={for:{req:true,valid:/.+/}};this.toNode=function(t){let i=WH.ce("div",{className:"entity-list-toggle"});i.setAttribute("data-initialized","false");i.dataset["for"]=t["for"];let n=WH.ce("div",{className:"entity-list-toggle-controls"});WH.ae(i,n);WH.markup.applyCommonAttributes(i,t);clearTimeout(e.initTimer);e.initTimer=setTimeout(a,0);return i};const e={initTimer:undefined};function t(e,t){let a=t.id+"-requirement";let i=WH.qs("#"+a,e);if(!i){e.dataset.hasRequirements="true";let n=WH.qs(".entity-list-item-requirement-set",e);if(n){WH.ae(n,WH.ct(WH.TERMS.comma_punct))}else{n=WH.ce("span",{className:"entity-list-item-requirement-set"});let t=WH.ce("div",{className:"entity-list-item-requirement"});WH.aef(e,t);WH.Strings.sprintf(WH.GlobalStrings.SPELL_FAILED_REQUIRES_SPELL_FOCUS,"|").split("|").forEach((function(e,a){if(e){WH.ae(t,WH.ct(e))}if(a===0){WH.ae(t,n)}}))}i=WH.ce("span",{id:a,innerHTML:t.innerHTML});WH.ae(n,i)}}function a(){$('.entity-list-toggle[data-initialized="false"] .entity-list-toggle-controls').each((function(){let e=this;let t=this.parentNode;WH.qsa(".entity-list-toggle-option",e).forEach((function(e){e.classList.add("fa");e.classList.add("fa-fw");WH.aE(e,"click",i.bind(undefined,t,e,false));let a=e;while(a=a.parentNode?.closest(".entity-list-toggle-option")){a.dataset.hasNestedOptions=`${true}`}i(t,e,true);WH.qsa("a",e).forEach((function(e){WH.aE(e,"click",(function(e){e.preventDefault()}))}))}));t.setAttribute("data-initialized","true")}))}function i(e,t,a,i){if(i){i.preventDefault()}let s=WH.ge(e.dataset["for"]);if(!s){WH.error("No target wrapper for entity list toggler.",e);return}let r={enabled:{on:t.dataset.entityListEnable?t.dataset.entityListEnable.split(","):[],off:t.dataset.entityListDisable?t.dataset.entityListDisable.split(","):[],onRequires:parseInt(t.dataset.entityListEnableRequires),offRequires:parseInt(t.dataset.entityListDisableRequires)},shown:{on:t.dataset.entityListShow?t.dataset.entityListShow.split(","):[],off:t.dataset.entityListHide?t.dataset.entityListHide.split(","):[],onRequires:parseInt(t.dataset.entityListShowRequires),offRequires:parseInt(t.dataset.entityListHideRequires)}};if(a===true&&t.dataset.startChecked!=="true"||t.classList.contains("fa-check")){t.classList.remove("fa-check");t.classList.add("fa-times");r.checked=false}else{t.classList.remove("fa-times");t.classList.add("fa-check");r.checked=true}n(s,t,a,r,"enabled","on");n(s,t,a,r,"enabled","off");n(s,t,a,r,"shown","on");n(s,t,a,r,"shown","off")}function n(e,a,i,n,s,r){let o=n[s].onRequires;let l=n[s].offRequires;let c=r==="on"?o:l;let u="entityListItem"+WH.ucfirst(s);n[s][r].forEach((d=>{let f=isNaN(d)?WH.qs(`:scope > [data-entity-list-item-target="${d}"]`,e):e.childNodes[d-1];if(!f){WH.warn(`Entity list toggle target [${d}] not found.`,"List:",e);return}if(i!==true){f.dataset.animate="true"}let h="entityListItemOnCount";let p="entityListItemOffCount";let m=r==="on"?h:p;let H=parseInt(f.dataset[m])||0;if(i!==true||n.checked){H+=n.checked?1:-1}f.dataset[m]=`${H}`;let g=parseInt(f.dataset[h]);let W=parseInt(f.dataset[p]);let E=isNaN(g)?null:o?g===o:g>0;let _=isNaN(W)?null:l?W===l:W>0;if(c){if(f.dataset[u+"Method"]==="direct"){return}}else{f.dataset[u+"Method"]="direct"}switch(null){case E:f.dataset[u]=`${!_}`;break;case _:f.dataset[u]=`${E}`;break;default:f.dataset[u]=`${E||!_}`}if(s==="enabled"){t(f,a)}}))}};WH.markup.tags["entity-list-toggle-option"]={empty:false,attr:{checked:{req:false,empty:true},disable:{req:false,valid:WH.markup.regex.anyChars},"disable-requires":{req:false,valid:WH.markup.regex.isInt},enable:{req:false,valid:WH.markup.regex.anyChars},"enable-requires":{req:false,valid:WH.markup.regex.isInt},hide:{req:false,valid:WH.markup.regex.anyChars},"hide-requires":{req:false,valid:WH.markup.regex.isInt},show:{req:false,valid:WH.markup.regex.anyChars},"show-requires":{req:false,valid:WH.markup.regex.isInt}},toNode:function(e){if(!e.show&&!e.hide&&!e.enable&&!e.disable){return WH.ce("div",{style:{display:"none"}})}let t=WH.ce("div",{className:"entity-list-toggle-option",dataset:{startChecked:`${e.checked!=null}`},id:WH.Strings.guid()});WH.preventSelectStart(t);["show","hide","enable","disable"].forEach((function(a){let i=WH.ucfirst(a);if(e[a]){t.dataset["entityList"+i]=e[a];if(e[a+"-requires"]){t.dataset["entityList"+i+"Requires"]=e[a+"-requires"]}}}));WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.filter={trim:true,itrim:true,attr:{unnamed:{req:true,valid:/^\w+$/},group:{req:true,valid:/^\w+$/}},toNode:function(e,t){let a=t.treeGuid;let i=WH.ce("span",{className:"markup-filter",dataset:{active:"",target:e.unnamed,group:e.group,markupTree:a}});let n=()=>{let e=WH.qsa(`.markup-filter-target[data-markup-tree="${a}"]`);e.forEach((e=>{e.dataset.active="true";let t=JSON.parse(e.dataset.target);for(let[i,n]of Object.entries(t)){let t=WH.qs(`.markup-filter[data-markup-tree="${a}"][data-group="${i}"][data-target="${n}"]`);if(t&&t.dataset.active==="false"){e.dataset.active="false";break}}}))};let s=()=>{let e=i.dataset.group;let t=WH.qsa(`.markup-filter[data-markup-tree="${a}"][data-group="${e}"]`);t.forEach((e=>{if(e.dataset.active!=="true"){e.dataset.active="false"}}));if(i.dataset.active==="true"){i.dataset.active="false"}else{i.dataset.active="true"}let n=WH.qsa(`.markup-filter[data-markup-tree="${a}"][data-group="${e}"][data-active="true"]`).length;if(n===0){t.forEach((e=>{e.dataset.active=""}))}};WH.aE(i,"click",(()=>{s();n()}));return i}};WH.markup.tags["filter-target"]={trim:true,itrim:true,attr:{unnamed:{req:true,valid:/\w+=\w+/}},toNode:function(e,t){let a={};e.unnamed.match(/\w+=\w+/g).forEach((e=>{let t=e.split("=");a[t[0]]=t[1]}));return WH.ce("div",{className:"markup-filter-target",dataset:{active:"",target:JSON.stringify(a),markupTree:t.treeGuid}})}};WH.markup.tags.grid={empty:false,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{align:{req:false,valid:/^centered$/},"column-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},style:{req:false,valid:/^[^"<>]+$/},width:{req:false,valid:WH.markup.regex.cssUnitOrInt}},toNode:function(e){let t=WH.ce("div",{className:"markup-grid"});if(e.align==="centered"){t.dataset.align="centered";if(e["column-width"]){setTimeout((()=>{t.childNodes.forEach((t=>{if(t.tagName!=="BR"){t.style.flexBasis=`${e["column-width"]}px`}}))}),0)}}else{if(e["column-width"]){if(/\d$/.test(e["column-width"])){e["column-width"]+="px"}t.style.gridTemplateColumns="repeat(auto-fill, minmax("+e["column-width"]+", 1fr))"}if(e.width){if(/\d$/.test(e.width)){e.width+="px"}t.style.width="100%";t.style.maxWidth=e.width}}return t}};WH.markup.tags.hr={empty:true,trim:true,allowedModes:{article:1,quickfacts:1,comment:1},toNode:function(e){return WH.ce("hr")},fromHtml:function(e){return e.replace(/<hr\b[\s\S]*?>/gi,"[hr]")}};for(let e=2;e<=6;e++)WH.markup.tags[`h${e}`]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(t){if(!t.id){t.id=WH.Strings.slug(t.toc!=="false"&&t.toc||t._textContents,true)}let a=WH.ce(`h${e}`);WH.markup.applyCommonAttributes(a,t);a.className=(a.className?" ":"")+`heading-size-${e}`;if(t.first||t.unnamed){a.className+=" first"}if(t.last){a.className+=" last"}if(t.clear){if(t.clear=="true"){t.clear="both"}a.style.clear=t.clear}if(t.type==="bar"||t.type==="d4-arrow"){a.classList.add("heading-bar");if(t.type==="d4-arrow"){a.dataset.type=t.type}WH.ae(a,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}return a},fromHtml:function(t){return t.replace(new RegExp("<h"+e+"\\b[\\s\\S]*?>([\\s\\S]*?)<\\/h"+e+">","gi"),`\n[h${e}]$1[/h${e}]`)}};WH.markup.tags.i={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("i");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(i|em)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[i]$2[/i]")}};WH.markup.tags.icon={empty:false,itrim:true,attr:{unnamed:{req:false,valid:/^class$/i},align:{req:false,valid:/^right$/i},color:{req:false,valid:WH.markup.regex.noWhitespace},float:{req:false,valid:/^(left|right)$/i},game:{req:false,valid:/\S+/},inline:{req:false,valid:/^true$/},kind:{req:false,valid:WH.markup.regex.noWhitespace},name:{req:false,valid:/\S+/},preset:{req:false,valid:/\S+/},site:{req:false,valid:WH.markup.regex.dataEnv},size:{req:false,valid:/^(tiny|small|medium|large)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/},type:{req:false,valid:WH.markup.regex.kebabCase},url:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,presets:{boss:WH.STATIC_URL+"/images/icons/boss.gif",heroic:WH.STATIC_URL+"/images/icons/heroic.gif",mythic:WH.STATIC_URL+"/images/icons/mythic.gif"},validate:function(e){if(!e.name&&!e.url&&!e.preset){return false}if(e.preset&&!WH.markup.tags.icon.presets[e.preset]){return false}return true},toNode:function(e){const t=WH.Game;const a=WH.Types;let i=WH.markup.getDataEnvFromSiteAttr(e.site);let n=e.size?e.size:"tiny";if(!e.name){e.name=""}if(["simple","round"].includes(e.type)){e.kind=e.type;delete e.type}let s=e.type&&a.getIdByString(e.type);let r;if(e.game){r=t.getByKey(e.game);if(!r){WH.warn('Invalid game provided in icon markup for "'+e.name+'" icon: '+e.game);r=t.WOW;e.name=WH.Icon.UNKNOWN}}else{r=s&&a.getGame(s)||t.DEFAULT}let o={color:e.color,game:r,kind:e.kind,span:e.hasOwnProperty("inline"),type:s};let l;if(n==="tiny"){l=WH.ce("span");WH.markup.applyCommonAttributes(l,e);if(e.unnamed===undefined){l.className=(l.className?" ":"")+"icontiny"+(e.align?"r":"");let t="";if(e.name){t=WH.Icon.getIconUrl(e.name,WH.Icon.TINY,r)}else if(e.preset){t=WH.markup.tags.icon.presets[e.preset]}else if(e.url&&WH.markup.isUrlSafe(e.url)){t=e.url}else{return document.createDocumentFragment()}l.style.backgroundImage="url("+t+")"}else{l.className=e.name}if(e.tooltip){WH.markup.attachMarkupTooltip(l,e.tooltip,e.tooltip2,true)}}else{let t=null;if(e.url&&WH.markup.isUrlSafe(e.url)){t=WH.markup.finalizeUrl(e.url,i)}else if(e._textContents&&WH.markup.isUrlSafe(e._textContents)){t=WH.markup.finalizeUrl(e._textContents,i)}else if(e.tooltip){t="javascript:"}l=WH.Icon.create(e.name.toLowerCase(),n,t,o);WH.markup.applyCommonAttributes(l,e);if(!t){WH.aE(l,"click",Icon.showIconInfo.bind(null,l))}if(e["float"]){l.style["float"]=e["float"]}while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}if(e.tooltip){let t=WH.Icon.getLink(l);if(t){WH.markup.attachMarkupTooltip(t,e.tooltip,e.tooltip2,true)}}}return l}};WH.markup.tags.iconlist={empty:false,block:true,ltrim:true,rtrim:true,attr:{domain:{req:false,valid:WH.markup.regex.domain}},invisibleContent:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{b:1,achievement:1,currency:1,event:1,faction:1,item:1,itemset:1,npc:1,object:1,pet:1,quest:1,spell:1,title:1,zone:1},toNode:function(e){var t=WH.markup.getDatabaseDomainInfo(e);while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}var a={itemset:"item_set"};let i=WH.ce("div",{className:"icon-list-col"});let n=WH.ce("table",{className:"icon-list"});WH.ae(i,n);var s;var r;for(var o=0;o<e._nodes.length;++o){var l=e._nodes[o];l.attr.domain=WH.getDataEnvKey(t.dataEnv);l.attr.icon="false";var c=WH.markup.tags[l.name].toNode(l.attr);var u="";var d=WH.Types[(a[l.name]||l.name).toUpperCase()];if(d){var f=g_gathered_types[d];var h=parseInt(l.attr.unnamed,10);u=f.getIcon&&f.getIcon(h)||f[h]&&f[h].icon;if(Array.isArray(u)){u=u[0]}}s=WH.ce("tr");WH.ae(n,s);r=WH.ce("th");WH.ae(s,r);if(u){var p="";if(c.tagName==="A"){p=c.href}else{var m=c.querySelector("a");if(m){p=m.href}}WH.ae(r,WH.markup.tags.icon.toNode({name:u,size:"small",url:p,_contents:document.createDocumentFragment()}))}else{WH.ae(r,WH.ce("ul",{},WH.ce("li",{},WH.ct(WH.Strings.nbsp))))}WH.ae(s,WH.ce("td",{},c))}return i}};WH.markup.tags.img={empty:true,count:0,attr:{src:{req:false,valid:/\S+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/^[0-9]+$/},blog:{req:false,valid:/^[0-9]+$/},news:{req:false,valid:/^[0-9]+$/},size:{req:false,valid:/^(thumb|resized|normal|large|medium|small|tiny)$/i},width:{req:false,valid:/^[0-9%]+$/},height:{req:false,valid:/^[0-9]+$/},float:{req:false,valid:/^(left|right|center)$/i},border:{req:false,valid:/^[0-9]+$/},shadow:{req:false,valid:/^(true|false)$/},margin:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/}},blogSize:/^(thumb|normal)$/i,idSize:/^(thumb|resized|normal)$/i,iconSize:/^(large|medium|small|tiny)$/i,allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.src){return true}else if(e.id){return e.size?WH.markup.tags.img.idSize.test(e.size):true}else if(e.icon){return e.size?WH.markup.tags.img.iconSize.test(e.size):true}else if(e.blog||e.news){return e.size?WH.markup.tags.img.blogSize.test(e.size):true}return false},toNode:function(e){var t=WH.ce("img",{loading:"lazy"});var a=t;var i=[];var n=[];WH.markup.applyCommonAttributes(t,e);t.removeAttribute("style");t.className="";let s="";if(e.src){s=e.src}else if(e.id){var r=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,e.id)||{};s=WH.getScreenshotUrl(e.id,e.size||"normal",{description:e.title,imageType:r.imageType})}else if(e.icon){s=WH.staticUrl+"/images/wow/icons/"+(e.size?e.size:"large")+"/"+e.icon+".jpg"}else if(e.blog||e.news){if(g_blogimages[e.blog||e.news]){var o=g_blogimages[e.blog||e.news];if(e.size&&e.size=="thumb"){var l=WH.staticUrl+"/uploads/blog/images/"+(e.blog||e.news)+(o.type==3?".png":".jpg");s=WH.staticUrl+"/uploads/blog/thumbs/"+(e.blog||e.news)+(o.type==3?".png":".jpg");t.alt=o.alt;t.width=o.thumbwidth;t.height=o.thumbheight;if(!g_screenshots[WH.markup.mediaUid]){g_screenshots[WH.markup.mediaUid]=[]}var c=WH.markup.tags.img.count++;a=WH.ce("a",{},a);a.href=l;a.id="img-thumb-"+c;setTimeout(function(e,t,a){var i=WH.ge("img-thumb-"+e);if(i){i.onclick=function(e,t,a){if(!WH.isLeftClick(a)){return}ScreenshotViewer.show({screenshots:e,pos:t});return false}.bind(null,t,a)}}.bind(null,c,""+WH.markup.mediaUid,g_screenshots[WH.markup.mediaUid].length),0);var u={url:l,caption:o.alt,width:o.width,height:o.height,noMarkup:true};g_screenshots[WH.markup.mediaUid].push(u)}else{s=WH.staticUrl+"/uploads/blog/images/"+(e.blog||e.news)+(o.type==3?".png":".jpg");t.alt=o.alt;if(!e.width&&!e.height){e.width=o.width;e.height=o.height}else if(!e.height){if(e.width.toString().indexOf("%")===-1){e.height=Math.round(o.height*e.width/o.width)}}else if(!e.width){e.width=Math.round(o.width*e.height/o.height)}}}else{return WH.ct(WH.TERMS.image+WH.TERMS.wordspace_punct+"#"+(e.blog||e.news))}}if(e.width){t.width=e.width}if(e.height){t.height=e.height}if(e["float"]){if(e["float"]=="center"){a=WH.ce("div",{},a);a.style.textAlign="center";n.push("margin:10px auto")}else{i.push("markup-float-"+e["float"]);if(e.margin){if(e["float"]=="left"){n.push("margin:0 "+e.margin+"px "+e.margin+"px 0")}else{n.push("margin:0 0 "+e.margin+"px "+e.margin+"px")}}}}if(e.border){if(e.border==0){i.push("no-border")}else{i.push("border");n.push("border-width:"+e.border+"px")}}else{i.push("content-image");if(e.shadow=="true"){i.push("content-image-shadowed")}}t.src=WH.Url.addMaxSizeParams(s,{width:t.width,height:t.height});t.alt=e.title||t.alt||"";if(e.style&&WH.markup.allow>=WH.markup.CLASS.STAFF){n.push(e.style)}if(i.length){t.className=i.join(" ")}if(n.length){t.setAttribute("style",n.join(";"))}return a},fromHtml:function(e){var t;if(t=e.match(/<img\b[\s\S]*?src="[\s\S]+?"[\s\S]*?>/gi)){for(var a=0;a<t.length;++a){var i=t[a].match(/src="([\s\S]+?)"/i),n=t[a].match(/width[:="]+\s*([0-9]+)/i),s=t[a].match(/height[:="]+\s*([0-9]+)/i),r=t[a].match(/border[:="]+\s*([0-9]+)/i);e=e.replace(t[a],"[img src="+i[1]+(n?" width="+n[1]:"")+(s?" height="+s[1]:"")+" border="+(r?r[1]:0)+"]")}}return e}};WH.markup.tags["inline-code"]={block:false,empty:false,attr:{wrap:{req:false,valid:/^(true|false)$/}},allowedChildren:{"<text>":1},toNode:function(e){var t=WH.ce("code");if(e.wrap==="true"){t.style.whiteSpace="normal"}else if(e.wrap==="false"){t.style.whiteSpace="nowrap"}if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.ins={empty:false,toNode:function(e){var t=WH.ce("ins");t.className="diffmod";WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.li={empty:false,itrim:true,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},"entity-list-toggle-target":{req:false,valid:WH.markup.regex.anyChars},icon:{req:false,valid:WH.markup.regex.noWhitespace},style:{req:false,valid:/^[^<>]+$/}},helpText:function(){var e="";e+="[ul]";for(var t=0;t<3;++t){e+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}e+="\n[/ul]\n\n";e+="[ol]";for(var t=0;t<3;++t){e+="\n[li]"+WH.TERMS.listitem_stc+"[/li]"}e+="\n[/ol]\n";return e.toLowerCase()},toNode:function(e){let t=WH.ce("li");WH.markup.applyCommonAttributes(t,e);if(e.icon){t.classList.add("fa","fa-"+e.icon)}if(e["entity-list-toggle-target"]){t.dataset.entityListItemTarget=`${e["entity-list-toggle-target"]}`}WH.ae(t,WH.ce("div",{dataset:{markupContentTarget:1}}));return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<li\\b[\\s\\S]*?>","</li>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n\t"+Array(t+1).join("\t")+"[li]"+WH.markup.tags.li.fromHtml(a[i][0],t+1)+"[/li]")}}return e}};WH.markup.tags["major-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,valid:/^first$/i},clear:{req:false,valid:/^(true|both|left|right)$/i},style:{req:false,valid:/^[^"<>]+$/},type:{req:false,valid:WH.markup.regex.noWhitespace},toc:{req:false,valid:/^.+$/i}},toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true)}var t=WH.ce("h2");t.classList.add("heading-size-2");if(e.first||e.unnamed){t.classList.add("first")}if(e.last){t.classList.add("last")}if(e.clear==="true"||e.clear==="both"){t.style.clear="both"}else if(e.clear){t.style.clear=e.clear}if(e.type==="bar"||e.type==="d4-arrow"){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<h2\b[\s\S]*?>([\s\S]*?)<\/h2>/gi,"\n[major-heading]$1[/major-heading]")}};WH.markup.tags["minor-heading"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,attr:{unnamed:{req:false,valid:/^first$/i},style:{req:false,valid:/^[^"<>]+$/},toc:{req:false,valid:/^.+$/i},type:{req:false,valid:WH.markup.regex.noWhitespace}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!e.id){e.id=WH.Strings.slug(e.toc!=="false"&&e.toc||e._textContents,true)}var t=WH.ce("h3");t.classList.add("heading-size-3");if(e.first||e.unnamed){t.classList.add("first")}if(e.last){t.classList.add("last")}if(e.clear==="true"||e.clear==="both"){t.style.clear="both"}else if(e.clear){t.style.clear=e.clear}if(e.type==="bar"||e.type==="d4-arrow"){t.classList.add("heading-bar");if(e.type==="d4-arrow"){t.dataset.type=e.type}WH.ae(t,WH.ce("span",{dataset:{markupContentTarget:"1"}}))}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<h3\b[\s\S]*?>([\s\S]*?)<\/h3>/gi,"\n[minor-heading]$1[/minor-heading]")}};WH.markup.tags.nav={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"nav-item":1},toNode:function(e){var t="nav-markup-"+WH.Strings.guid();var a=document.createDocumentFragment();WH.ae(a,WH.ce("div",{className:"clear"}));var i=WH.ce("div",{className:"smooth-nav-wrapper",id:t});WH.ae(a,i);var n=WH.ce("div",{className:"smooth-nav-outer"});WH.ae(i,n);var s=WH.ce("div",{className:"smooth-nav-inner"});WH.ae(n,s);var r;var o;var l=e._contents;while(l.hasChildNodes()){o=l.removeChild(l.firstChild);r=WH.ce("a",{href:"javascript:",id:t+"-"+d,rel:"np"});if(o.whMarkupInfo.url){let e=WH.markup.getDataEnvFromSiteAttr(o.whMarkupInfo.site);r.href=WH.markup.finalizeUrl(o.whMarkupInfo.url,e)}if(o.whMarkupInfo.tooltip){WH.Tooltip.simple(r,o.whMarkupInfo.tooltip.replace(/&lt;br&gt;/g,"<br>"),"q")}while(o.hasChildNodes()){WH.ae(r,o.firstChild)}var c=false;var u=null;for(var d=0,f=r.childNodes.length;d<f;d++){if(r.childNodes[d].nodeType===Node.TEXT_NODE){r.dataset.text=WH.Strings.slug(r.childNodes[d].textContent,true,LOCALE_ENUS);c=true}else if(!c){u=r.childNodes[d].textContent||u}}if(!c&&u){r.dataset.text=WH.Strings.slug(u,true,LOCALE_ENUS)}WH.ae(s,r)}setTimeout(WH.setupSmoothNavClicks.bind(null,"#"+t),0);return a}};WH.markup.tags["nav-item"]={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{nav:1},attr:{unnamed:{req:false,valid:/\S+/},site:{req:false,valid:WH.markup.regex.dataEnv},tooltip:{req:false,valid:/^.*$/}},toNode:function(e){var t=WH.ce("div");t.whMarkupInfo={site:e.site,tooltip:e.tooltip,url:e.unnamed};return t}};WH.markup.tags.n5={empty:true,attr:{unnamed:{req:true,valid:/^[0-9\.]+$/}},toNode:function(e){return document.createTextNode(WH.getN5(e.unnamed))}};WH.markup.tags.minibox={empty:false,rtrim:true,itrim:true,attr:{float:{req:false,valid:/^(left|right)$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");t.className="minibox";if(e["float"]=="left"){t.className+=" minibox-left"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.money={empty:true,attr:{unnamed:{req:false,valid:/^[0-9]+|[0-9]+-[0-9]+$/},items:{req:false,valid:/^[0-9,]+$/},currency:{req:false,valid:/^[0-9,]+$/},achievement:{req:false,valid:/\S+/},side:{req:false,valid:/^(alliance|horde|both)$/i},arena:{req:false,valid:/^[0-9]+$/},honor:{req:false,valid:/^[0-9]+$/},conquest:{req:false,valid:/^[0-9]+$/},justice:{req:false,valid:/^[0-9]+$/},valor:{req:false,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=[];var a=[];if(e.items){var i=e.items.split(",");if(i.length>=2){for(var n=0,s=i.length;n<s-1;n+=2){t.push({id:i[n],count:i[n+1]})}}}if(e.currency){var r=e.currency.split(",");if(r.length>=2){var o=null;for(var l=0,c=r.length;l<c-1;l+=2){var u=r[l];var d=parseInt(r[l+1]);if(o&&o.id===u){if(o.increment===null&&d-o.max<=5){o.increment=d-o.max}if(o.increment&&(o.max+o.increment===d||o.max/d>.925)){o.values.push(d);o.max=d;o.value=o.min+"-"+o.max;continue}}o={id:u,increment:null,max:d,min:d,value:d,values:[d]};a.push(o)}}}if(e.arena&&!e.conquest){e.conquest=e.arena}if(e.honor){a.push({id:WH.Wow.Currency.ID_HONOR,value:e.honor})}if(e.conquest){a.push({id:WH.Wow.Currency.ID_CONQUEST,value:e.conquest})}if(e.justice){a.push({id:WH.Wow.Currency.ID_JUSTICE,value:e.justice})}if(e.valor){a.push({id:WH.Wow.Currency.ID_VALOR,value:e.valor})}var f=e.achievement;var h=document.createDocumentFragment();if(e.unnamed){var p=null;var m=null;if(e.unnamed.indexOf("-")!==-1){var H=e.unnamed.split("-");p=this.calculateMoney(H[0]);m=this.calculateMoney(H[1])}else{p=this.calculateMoney(e.unnamed)}if(m===null||JSON.stringify(p)===JSON.stringify(m)){this.displayMoney(h,p)}else if(p.length===1&&m.length===1&&p[0].type===m[0].type){p[0].value+="-"+m[0].value;this.displayMoney(h,p)}else{this.displayMoney(h,p);h.appendChild(WH.ct(" - "));this.displayMoney(h,m)}}if(t.length>5){if(h.hasChildNodes()){h.appendChild(WH.ct(" "));h.appendChild(WH.ct(WH.Strings.sprintf(WH.TERMS.oneOfEntityCount_format,t.length,WH.Types.getUpperPlural(WH.Types.ITEM))))}}else{for(var n=0,s=t.length;n<s;n++){var g=t[n];if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}var W=g_items[g.id]||{};var E=W.icon||WH.Icon.UNKNOWN;var _=WH.staticUrl+"/images/wow/icons/tiny/"+E.toLowerCase()+".gif";h.appendChild(WH.ce("a",{href:WH.Entity.getUrl(WH.Types.ITEM,g.id),className:"moneyitem no-wrap",style:{backgroundImage:'url("'+_+'")'}},WH.ct(g.count)))}}for(var v=0,T=a.length;v<T;v++){var b=a[v];if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}var E=g_gatheredcurrencies.getIcon(b.id);if(E===WH.Icon.UNKNOWN){E=WH.Wow.Currency.getIcon(b.id)||E}var S=WH.ce("a",{href:WH.Entity.getUrl(WH.Types.CURRENCY,b.id),className:"icontinyr tip q1 no-wrap",style:{backgroundImage:'url("'+WH.staticUrl+"/images/wow/icons/tiny/"+E.toLowerCase()+'.gif")'}});WH.ae(S,WH.ct(b.value));if(b.values&&b.values.length>2){WH.Tooltip.addTooltipText(S,WH.TERMS.oneOf_colon+Locale.formatList(b.values,"or",280))}h.appendChild(S)}if(f>0){if(h.hasChildNodes()){h.appendChild(WH.ct(" "))}h.appendChild(WH.markup.tags.achievementpoints.toNode({unnamed:f.toString()}))}return h},calculateMoney:function(e){var t=[];if(e>=1e4){t.push({type:"gold",value:WH.numberFormat(Math.floor(e/1e4))});e%=1e4}if(e>=100){t.push({type:"silver",value:WH.numberFormat(Math.floor(e/100))});e%=100}if(e>=1){t.push({type:"copper",value:WH.numberFormat(Math.floor(e))})}return t},displayMoney:function(e,t){var a=false;for(var i=0,n=t.length;i<n;i++){if(a){e.appendChild(WH.ct(WH.TERMS.wordspace_punct))}e.appendChild(WH.ce("span",{className:"money"+t[i].type},WH.ct(t[i].value)));a=true}}};WH.markup.tags.ol={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(e){var t=WH.ce("ol");var a=[];if(e.first){a.push("first")}if(e.last){a.push("last")}if(a.length>0){t.className=a.join(" ")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<ol\\b[\\s\\S]*?>","</ol>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[ol]"+WH.markup.tags.ol.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/ol]")}}return e}};WH.markup.tags.p={empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("p");t.style.lineHeight="1.4em";t.style.margin="1em 0 0 0";WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){var t;if(t=e.match(/<p\b[\s\S]*?>[\s\S]*?<\/p>/gi)){for(var a=0;a<t.length;++a){var i=t[a].match(/^<p\b[\s\S]*?text-align:\s*(center|left|right)/i);var n=t[a].match(/<p\b[\s\S]*?>([\s\S]*?)<\/p>/i);e=e.replace(t[a],"[pad][div"+(i?" align="+i[1]:"")+"]"+(n?n[1]:"")+"[/div][pad]")}}return e}};WH.markup.tags.pad={empty:true,block:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("div");t.className="pad";if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.pre={empty:false,block:true,rtrim:true,toNode:function(e){var t=WH.ce("pre");t.className="code";if(e.first){t.className+=" first"}if(e.last){t.className+=" last"}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<pre\b[\s\S]*?>([\s\S]*?)<\/pre>/gi,"[pre]$1[/pre]")}};WH.markup.tags.quote={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:false,valid:/[\S ]+/},align:{req:false,valid:/^(left|right|center)$/i},blizzard:{req:false,valid:/^true$/},clear:{req:false,valid:/^(left|right|both)$/i},collapse:{req:false,valid:/^true$/},display:{req:false,valid:/^block$/},fancy:{req:false,valid:/^true$/},float:{req:false,valid:/^(left|right|none)$/i},pname:{req:false},type:{req:false,valid:WH.markup.regex.noWhitespace},url:{req:false,valid:WH.markup.regex.noWhitespace},wowhead:{req:false,valid:/^true$/}},allowedModes:{article:1,quickfacts:1,comment:1},validate:function(e){if(e.type||e.blizzard||e.wowhead||e.collapse||e.url){if(WH.markup.allow<WH.markup.CLASS.STAFF){return false}}return true},toNode:function(e){if(e.type==="box"){delete e.type;let t=Object.keys(WH.markup.tags.quote.attr);let a=Object.keys(WH.markup.tags.box.attr);if(!t.some((t=>!a.includes(t)&&e[t]!=null))){if(WH.markup.tags.box.validate(e)){return WH.markup.tags.box.toNode(e)}}WH.warn("[quote type=box] failed to convert to [box] as expected.",e)}let t=[];let a=WH.ce("div",{className:"quote-box"});t.push(a);WH.markup.applyCommonAttributes(a,e);if(e.display)a.style.display=e.display;if(e.align)a.style.textAlign=e.align;if(e.clear)a.style.clear=e.clear;if(e.first)a.classList.add("first");if(e.last)a.classList.add("last");if(e["float"])a.classList.add("markup-float-"+e["float"]);let i=e.type||"user";if(e.fancy){a.dataset.fancy="true"}if(e.blizzard){i="blizzard"}else if(e.wowhead){i="wowhead"}a.dataset.type=i;let n=WH.ce("div",{className:"quote-header"});WH.ae(a,n);let s=WH.ce("div",{className:"quote-body",dataset:{markupContentTarget:1}});t.push(s);WH.ae(a,s);let r=WH.markup.finalizeUrl(e.url);if(i==="blizzard"){let t=r.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/blog\/([0-9]+)/i)||r.match(/^https?:\/\/(us|eu)\.battle\.net\/wow\/en\/forum\/topic\/([0-9]+)/i)||r.match(/^https?:\/\/(www\.)?worldofwarcraft\.com\/en-us\/news\/([0-9]+)/i)||r.match(/^https?:\/\/(us|eu)\.battle\.net\/forums\/(?:en\/)?wow\/topic\/([0-9]+)/i);if(t||r&&WH.markup.isUrlSafe(r)){let i;if(t){i=WH.TERMS.officialPost;let e=["","blue-tracker","topic"];if(["us","eu"].includes(t[1])){e.push(t[1])}e.push(t[2]);WH.ae(n,WH.ce("a",{href:e.join("/"),target:"_blank"},WH.ct(WH.TERMS.bluetracker)));WH.ae(n,WH.ce("span",{className:"quote-header-separator"},WH.ct(" | ")))}else{i=e.pname||(r.indexOf("bluetracker")>=0?WH.TERMS.bluetracker:WH.TERMS.viewOriginal)}WH.ae(n,WH.ce("a",{href:r,target:"_blank"},WH.ct(i)));a.dataset.hasLinks="true"}}else if(r&&WH.markup.isUrlSafe(r)){WH.ae(n,WH.ce("a",{classList:"quote-header-link",href:r,target:"_blank"},WH.ct(WH.TERMS.link)));a.dataset.hasLinks="true"}let o=e.unnamed&&e.unnamed.trim()||null;let l=!!o;a.dataset.hasSource=JSON.stringify(l);if(l){let n=WH.ce("div",{className:"quote-source"});t.push(n);if(e.fancy){WH.ae(a,n)}else{WH.aef(a,n)}if(i==="user"){let t=WH.TERMS.said_format.split("%s");if(t[0]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(t[0])))}if(e.url&&WH.markup.isUrlSafe(e.url)){let t=WH.ce("a",{href:WH.markup.finalizeUrl(e.url)},WH.ct(o));if(WH.markup.isUrlExternal(e.url)){t.target="_blank"}WH.ae(n,t)}else if(WH.User.isUsernameValid(o)){WH.ae(n,WH.ce("a",{href:WH.Url.generatePath("/user="+o)},WH.ct(o)))}else{WH.ae(n,WH.ct(o))}if(t[1]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(t[1])))}}else{WH.ae(n,WH.ct(o))}}if(e._nodes&&e._nodes.length){let t=e._nodes[0].parent;let a=0;let i=t.parent;while(i&&i.name==="quote"){a++;i=i.parent}if(a>=2){e.collapse="true"}}if(i!=="user"||l||e.collapse){let i=()=>a.classList.contains("quote-collapsed")?WH.term("show_format",WH.TERMS.quote):WH.term("hide_format",WH.TERMS.quote);a.dataset.hasToggle="true";let s=WH.ce("a",{className:"quote-toggle",href:"javascript:",ariaLabel:WH.TERMS.toggleQuoteVisibility});WH.Tooltip.simple(s,i,"q2");WH.aE(s,"click",(function(){const e=150;if(!a.classList.contains("quote-collapsed")){t.forEach((e=>{let t=getComputedStyle(e);e.dataset.startingHeight=e.getBoundingClientRect().height-parseInt(t.getPropertyValue("padding-top"))-parseInt(t.getPropertyValue("padding-bottom"))+"px";e.style.height=e.dataset.startingHeight}));a.classList.add("quote-collapsed");requestAnimationFrame((()=>{t.forEach((e=>e.style.height=null))}))}else{t.forEach((e=>e.style.height=e.dataset.startingHeight));a.classList.remove("quote-collapsed");setTimeout((()=>{requestAnimationFrame((()=>t.forEach((e=>e.style.height=null))))}),e+1)}if(WH.Tooltip.isVisible()){WH.Tooltip.show(s,i(),"q2")}}));WH.ae(n,s);if(e.collapse){a.classList.add("quote-collapsed")}}return a}};WH.markup.tags.reveal={empty:false,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){if(!WH.markup.inNewsType||WH.markup.inNewsType>1){return document.createDocumentFragment()}var t=document.createDocumentFragment();var a=WH.ce("span",{style:{display:"none"}});t.appendChild(a);t.appendChild(WH.ct(" "));var i=WH.ce("a",{className:"revealtoggle",href:"javascript:"});t.appendChild(i);WH.aE(i,"click",WH.markup.tags.reveal.toggleReveal.bind(null,i,a));WH.st(i,WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct);return t},toggleReveal:function(e,t){e=$(e);t=$(t);if(t.is(":visible")&&e.is(":visible")){t.hide();e.text(WH.TERMS.openparenthesis_punct+WH.TERMS.readmore.toLowerCase()+WH.TERMS.closedparenthesis_punct)}else{t.show();if(e.hasClass("changelog")){e.hide()}else{e.text(WH.TERMS.openparenthesis_punct+WH.TERMS.hide.toLowerCase()+WH.TERMS.closedparenthesis_punct)}}}};WH.markup.tags.s={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("del");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){e=e.replace(/<del\b[\s\S]*?>([\s\S]*?)<\/del>/gi,"[s]$1[/s]");return e.replace(/<s\b[\s\S]*?>([\s\S]*?)<\/s>/gi,"[s]$1[/s]")}};WH.markup.tags.section={empty:false,ltrim:true,rtrim:true,trim:true,allowedClass:WH.markup.CLASS.STAFF,attr:{},toNode:function(e){var t=WH.ce("div");t.className="secheader";t.dataset.markupContentTarget=1;t.appendChild(WH.ce("var"));return t}};WH.markup.tags.small={empty:false,toNode:function(e){var t=WH.ce("small");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<small\b[\s\S]*?>([\s\S]*?)<\/small>/gi,"[small]$1[/small]")}};WH.markup.tags.span={empty:false,attr:{class:{req:false,valid:/^[a-z0-9 _-]+$/i},style:{req:false,valid:/^[^<>]+$/},unnamed:{req:false,valid:/^(hidden|invisible)$/},tooltip:{req:false,valid:/\S+/},tooltip2:{req:false,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){let t=WH.ce("span");WH.markup.applyCommonAttributes(t,e);if(e.unnamed==="hidden"){t.style.display="none"}else if(e.unnamed==="invisible"){t.style.visibility="hidden"}if(e.tooltip){WH.markup.attachMarkupTooltip(t,e.tooltip,e.tooltip2)}return t},fromHtml:function(e){return e.replace(/<span\b([\s\S]*?)>([\s\S]*?)<\/span>/gi,(function(e,t,a){var i=/style="[\s\S]*?color:\s?#(\w{6});?/i;var n=t.match(i);if(n){var s={ffd100:"q","9d9d9d":"q0",ffffff:"q1","1eff00":"q2","0070dd":"q3",a335ee:"q4",ff8000:"q5",e5cc80:"q6","00ccff":"q8","71d5ff":"q9",ff4040:"q10",ffff98:"q13",ff8040:"r1",ffff00:"r2","40bf40":"r3",808080:"r4",c69b6d:"c1",f48cba:"c2",aad372:"c3",fff468:"c4",c41e3b:"c6","2359ff":"c7","68ccef":"c8","9382c9":"c9","008467":"c10",ff7c0a:"c11",a330c9:"c12","70b3a5":"c13"};var r=s[n[1]];if(r){return"[color="+r+"]"+a+"[/color]"}}return e}))}};WH.markup.tags["spec-badge"]={empty:true,attr:{unnamed:{req:false,valid:/^.*$/},icon:{req:false,valid:/^[a-zA-Z- ]+$/i}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){const t=WH.Icon;const a=WH.Wow.Expansion;const i=WH.Wow.PlayerClass;const n=i.Specialization;let s=WH.ce("section",{classList:"spec-badge"});let r=WH.ce("section",{classList:"spec-badge-icon"});let o=WH.ce("section",{classList:"spec-badge-content"});let l=WH.ce("section",{classList:"spec-badge-content-spec"});let c=WH.ce("section",{classList:"spec-badge-content-class"});WH.ae(s,r);WH.ae(s,o);WH.ae(o,l);WH.ae(o,c);if(e.icon){s.dataset.icon="true";s.classList.add("fa");e.icon.trim().split(" ").forEach((e=>s.classList.add(`fa-${e}`)))}if(e.unnamed){let o=WH.Strings.slug(e.unnamed);let[u,...d]=o.split("-");if(u==="beast"){u=`${u}-${d[0]}`;d.shift()}else if(u==="feral"&&!a.available(a.MOP)){u=n.getSlug(i.DRUID,n.ID_CLASSIC_DRUID_FERAL_COMBAT);if(d.length>1){d.shift()}}let f=d.join("-");let h=i.getBySlug(f);let p=h&&n.getBySlug(f,u);WH.st(l,p&&n.getName(p)||WH.TERMS.unknown);WH.st(c,h&&i.getName(h)||WH.TERMS.unknown);s.dataset.class=h||"0";WH.ae(r,t.create(p?n.getIconName(p):"inv_misc_questionmark",t.LARGE,null,{color:h?`c${h}`:`c0`,kind:"round"}))}else{WH.st(l,WH.TERMS.unknown);WH.st(c,WH.TERMS.unknown)}return s}};WH.markup.tags.spoiler={block:true,empty:false,attr:{unnamed:{req:false,valid:/^.*$/}},rtrim:true,ltrim:true,itrim:true,timer:null,toNode:function(e){var t=document.createDocumentFragment();t.appendChild(WH.ce("div",{className:"pad"}));var a=WH.ce("div",{className:"spoiler-wrapper"});t.appendChild(a);var i=WH.ce("div",{className:"spoiler-desc"});WH.ae(a,i);WH.ae(i,WH.ce("b",{},WH.ct(WH.TERMS.spoiler_colon)));if(e.unnamed){WH.ae(i,WH.ct(WH.TERMS.wordspace_punct+e.unnamed))}WH.ae(i,WH.ct(" "));var n=WH.ce("button",{type:"button",className:"spoiler-revealer btn btn-small btn-site"});WH.st(n,WH.TERMS.revealspoiler);WH.aE(n,"click",(function(){a.classList.add("spoiler-reveal")}));WH.ae(i,n);var s=WH.ce("button",{type:"button",className:"spoiler-hider btn btn-small btn-site"});WH.st(s,WH.TERMS.hidespoiler);WH.aE(s,"click",(function(){a.classList.remove("spoiler-reveal")}));WH.ae(i,s);var r=WH.ce("div",{className:"spoiler",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(r,e);WH.ae(a,r);return t}};WH.markup.tags.sub={empty:false,toNode:function(e){var t=WH.ce("sub");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<sub\b[\s\S]*?>([\s\S]*?)<\/sub>/gi,"[sub]$1[/sub]")}};WH.markup.tags.sup={empty:false,toNode:function(e){var t=WH.ce("sup");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<sup\b[\s\S]*?>([\s\S]*?)<\/sup>/gi,"[sup]$1[/sup]")}};WH.markup.tags.tabs={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{tab:1},attr:{name:{req:true,valid:/\S+/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){e.id=WH.Strings.slug(e.name,true,Locale.getId());var t=document.createDocumentFragment();WH.ae(t,WH.ce("div",{className:"clear"}));WH.ae(t,WH.ce("div",{id:"dsf67g4d-"+e.id+(WH.markup.isPreview?"-preview":"")}));var a=WH.ce("div");WH.ae(t,a);if(e.width){a.style.width=e.width}var i=WH.ce("div",{className:"tabbed-contents"});WH.ae(a,i);var n;var s;var r=[];while(e._contents.hasChildNodes()){s=e._contents.removeChild(e._contents.firstChild);n=s.whMarkupInfo;r.push(n);var o=WH.ce("div",{id:"tab-"+e.id+"-"+n.id});o.style.display="none";while(s.hasChildNodes()){WH.ae(o,s.firstChild)}WH.ae(o,WH.ce("div",{className:"clear"}));WH.ae(i,o)}setTimeout(function(e,t,a){var i=new Tabs({parent:WH.ge("dsf67g4d-"+e.id+(a?"-preview":"")),forum:1,noScroll:a?true:false});for(var n=0;n<t.length;++n){var s=t[n];i.add(s.name,{id:e.id+"-"+s.id,icon:s.icon,class:s["class"]})}i.flush()}.bind(null,e,r,WH.markup.isPreview?"preview":""),0);return t}};WH.markup.tags.tab={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{tabs:1},attr:{name:{req:true,valid:/[\S ]+/},icon:{req:false,valid:/\S+/},id:{req:false,valid:/[\S ]+/}},toNode:function(e){var t=e.id?WH.Strings.slug(e.id,true,Locale.getId()):null;if(!t){t=WH.Strings.slug(e.name,true,Locale.getId())}if(!t){t=WH.Strings.guid()}e.name=WH.stringReplace(e.name,"_"," ");if(typeof e["class"]!="undefined"){e["class"]=WH.stringReplace(e["class"],"_"," ")}var a=WH.ce("div");a.whMarkupInfo={id:t,name:e.name,icon:e.icon,class:e["class"]};return a}};WH.markup.tags.table={empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{tr:1},attr:{background:{req:false,valid:WH.markup.regex.noWhitespace},border:{req:false,valid:/^[0-9]+$/},cellspacing:{req:false,valid:/^[0-9]+$/},cellpadding:{req:false,valid:/^[0-9]+$/},style:{req:false,valid:/^[^<>]+$/},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){var t=WH.ce("table");WH.markup.applyCommonAttributes(t,e);if(e.background){t.dataset.background=e.background}if(typeof e.border!=="undefined"){t.border=e.border;if(t.className){t.className+=" clean-markup-table-borders"}else{t.className="clean-markup-table-borders"}}if(typeof e.cellspacing!=="undefined"){t.cellSpacing=e.cellspacing}if(typeof e.cellpadding!=="undefined"){t.cellPadding=e.cellpadding}if(typeof e.width!=="undefined"){t.style.width=e.width}t.appendChild(WH.ce("tbody"));return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<table\\b[\\s\\S]*?>","</table>","g")){for(var i=0;i<a.length;++i){var n=a[i][1].match(/border[:="]+\s*([0-9]+)/i),s=a[i][1].match(/width[:="]+\s*([0-9]+)/i),r=a[i][1].match(/cellspacing="([\s\S]+?)"/i),o=a[i][1].match(/cellpadding="([\s\S]+?)"/i);e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[table"+(n?" border="+n[1]:"")+(s?" width="+s[1]:"")+(r?" cellspacing="+r[1]:"")+(o?" cellpadding="+o[1]:"")+"]"+WH.markup.tags.table.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/table]")}}return e}};WH.markup.tags.tier={empty:false,itrim:true,allowedChildren:{"tier-label":1,"tier-content":1},toNode:function(){return WH.ce("div",{className:"tier-list-tier"})}};WH.markup.tags["tier-content"]={trim:true,itrim:true,toNode:function(){return WH.ce("div",{className:"tier-content"})}};WH.markup.tags["tier-label"]={trim:true,itrim:true,attr:{bg:{req:false,valid:WH.markup.regex.noWhitespace},icon:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){let t=WH.ce("div",{className:"tier-label",dataset:{background:e.bg||"q0"}});if(e.icon){t.classList.add("fa","fa-"+e.icon)}let a=e._contents&&e._contents.lastChild;if(a&&a.nodeType===Node.TEXT_NODE){let e=a.nodeValue;let t=e.match(/[+-]$/);if(t){a.parentNode.replaceChild(WH.ce("span",{className:"tier-label-text",innerText:e.substr(0,e.length-1)},WH.ce("span",{className:"tier-label-superscript",innerText:t[0]})),a)}}return t}};WH.markup.tags["tier-list"]={block:true,empty:false,itrim:true,trim:true,allowedChildren:{tier:1},attr:{unnamed:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){return WH.ce("div",{className:e.unnamed?"tier-list-"+e.unnamed:"tier-list-rows"})}};WH.markup.tags.tr={empty:false,itrim:true,allowedChildren:{td:1},allowedParents:{table:1},attr:{background:{req:false,valid:WH.markup.regex.noWhitespace}},toNode:function(e){var t=WH.ce("tr");WH.markup.applyCommonAttributes(t,e);if(e.background){t.dataset.background=e.background}return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<tr\\b[\\s\\S]*?>","</tr>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n\t"+Array(t+1).join("\t")+"[tr]"+WH.markup.tags.tr.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/tr]")}}return e}};WH.markup.tags.td={empty:false,itrim:true,allowedParents:{tr:1},attr:{unnamed:{req:false,valid:/^header$/},align:{req:false,valid:/^(right|left|center|justify)$/i},background:{req:false,valid:WH.markup.regex.noWhitespace},colspan:{req:false,valid:/^[0-9]+$/},rowspan:{req:false,valid:/^[0-9]+$/},valign:{req:false,valid:/^(top|middle|bottom|baseline)$/i},width:{req:false,valid:/^[0-9]+(px|em|\%)$/}},toNode:function(e){var t=WH.ce(e.unnamed?"th":"td");WH.markup.applyCommonAttributes(t,e);if(e.align!=undefined){t.style.textAlign=e.align}if(e.valign!=undefined){t.style.verticalAlign=e.valign}if(e.colspan!=undefined){t.colSpan=e.colspan}if(e.rowspan!=undefined){t.rowSpan=e.rowspan}if(e.width!=undefined){t.style.width=e.width}if(e.background){t.dataset.background=e.background}return t},fromHtml:function(e,t){t=t||0;var a=["td","th"],i;for(var n=0;n<a.length;++n){if(i=WH.markup.matchOuterTags(e,"<"+a[n]+"\\b[\\s\\S]*?>","</"+a[n]+">","g")){for(var s=0;s<i.length;++s){var r=i[s][1].match(/width[:="]+\s*([0-9]+)/i),o=i[s][1].match(/align="([\s\S]+?)"/i),l=i[s][1].match(/valign="([\s\S]+?)"/i),c=i[s][1].match(/colspan="([\s\S]+?)"/i),u=i[s][1].match(/rowspan="([\s\S]+?)"/i);e=e.replace(i[s][1]+i[s][0]+i[s][2],"\n\t\t"+Array(t+1).join("\t")+"[td"+(a[n]=="th"?"=header":"")+(r?" width="+r[1]:"")+(o?" align="+o[1]:"")+(l?" valign="+l[1]:"")+(c?" colspan="+c[1]:"")+(u?" rowspan="+u[1]:"")+"]"+WH.markup.tags.td.fromHtml(i[s][0],t+1)+"[/td]")}}}return e}};WH.markup.tags.toc={block:true,post:true,trim:true,ltrim:true,rtrim:true,collect:{h2:1,h3:1,"major-heading":1,"minor-heading":1,toggler:1},exclude:{tabs:{h2:1,h3:1,"major-heading":1,"minor-heading":1},minibox:{h2:1,h3:1,"major-heading":1,"minor-heading":1}},allowedClass:WH.markup.CLASS.STAFF,attr:{h3:{req:false,valid:/^false$/},"minor-heading":{req:false,valid:/^false$/}},postParseNode:function(e,t){var a=document.createDocumentFragment();var i=WH.ce("h3",{className:"heading-size-3"});WH.ae(a,i);if(e.first){i.classList.add("first")}if(e.last){i.classList.add("last")}WH.markup.applyCommonAttributes(i,e);WH.st(i,WH.TERMS.tableofcontents);var n;var s;var r;var o=[a];r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r);var l=WH.ce("b");var c=WH.ge("guide-view-toc");var u=null;if(c){a.removeChild(i);l=false;u=WH.ge("guide-navigation")}var d="";var f=e.h3!="false"&&e["minor-heading"]!="false";var h=[];for(var p in t.h2){h.push(t.h2[p])}for(var p in t["major-heading"]){h.push(t["major-heading"][p])}for(var p in t.h3){h.push(t.h3[p])}for(var p in t["minor-heading"]){h.push(t["minor-heading"][p])}for(var p in t.toggler){h.push(t.toggler[p])}h.sort((function(e,t){return e.offset-t.offset}));var m=false;for(var H in h){if(h[H].name=="h2"||h[H].name=="major-heading"){m=true;break}}for(let e in h){p=h[e];let a=p.attr.toc||(p.name==="toggler"?p.attr.name:p.attr._textContents);let i=WH.Strings.slug(p.attr.id||a,true);let n={href:"#"+i,rel:"np"};let c=function(e){WH.aE(WH.qs("a",e),"click",(function(e){e.preventDefault();WH.setHash(i);WH.scrollTo(WH.ge(i))}))};switch(p.name){case"toggler":if(p.attr.toc!="false"&&p.attr.name){var g=p.attr.size||3;if(g==3&&d=="h2"){r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r)}else if(g==2&&d=="h3"){o.pop()}s=WH.ce("li");WH.ae(o[o.length-1],s);if(l){s.appendChild(l.cloneNode(false))}WH.ae(l?s.firstChild:s,WH.ce("a",n,WH.ct(a)));c(s);d="h"+g}break;case"h2":case"major-heading":if(p.attr.toc!="false"){if(d=="h3"){o.pop()}s=WH.ce("li");WH.ae(o[o.length-1],s);if(l){s.appendChild(l.cloneNode(false))}WH.ae(l?s.firstChild:s,WH.ce("a",n,WH.ct(a)));c(s);d="h2"}break;case"h3":case"minor-heading":if(f&&p.attr.toc!="false"&&(d!=""||t.h2.length==0||t["major-heading"].length==0)){if(d=="h2"){r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r)}else if(!d&&m){WH.ae(o[o.length-1],WH.ce("li",{},WH.ct(WH.TERMS.overview)));r=WH.ce("ul");WH.ae(o[o.length-1],r);o.push(r)}s=WH.ce("li");WH.ae(o[o.length-1],s);if(l){s.appendChild(l.cloneNode(false))}WH.ae(l?s.firstChild:s,WH.ce("a",n,WH.ct(a)));c(s);d="h3"}break}}if(c){if(u){let e=WH.qs('a[href$="wowhead.com'+location.pathname+'"]',u);if(e){let t=WH.closest(c,"table");if(t){WH.de(t.parentNode)}e.classList.add("current");let i=WH.closest(e,"li");if(i){i.classList.add("fa","fa-arrow-right")}e.after(a);return null}}$(c).empty().append(a);return null}return a}};WH.markup.tags.toggler={empty:false,attr:{id:{req:false,valid:/^[a-z0-9_-]+$/i},closed:{req:false,valid:/^(true|false)$/i},class:{req:false,valid:/^[a-z0-9 _-]+$/i},icon:{req:false,valid:/^[a-z0-9 _-]+$/i},name:{req:false,valid:/^.+$/i},size:{req:false,valid:/^[2-6]$/i},toc:{req:false,valid:/^.+$/i},unnamed:{req:false,valid:/^hidden$/i}},toNode:function(e){if(e.id){var t=WH.ce("a");t.href="javascript:";t.className="disclosure-"+(e.unnamed?"off":"on");WH.aE(t,"click",WH.disclose.bind(null,"#"+e.id,t));return t}var a=document.createDocumentFragment();var i=(e.toc!=="false"&&e.toc?WH.Strings.slug(e.toc,true):"")||(e.name?WH.Strings.slug(e.name,true):"")||WH.Strings.guid();var n=WH.getMajorHeading("",e.size||3,undefined,{id:i});a.appendChild(n);var s=WH.ce("div");a.appendChild(s);s.dataset.markupContentTarget=1;if(e.closed=="true"){s.style.display="none"}var t=WH.ce("a");WH.ae(n,t);t.href="javascript:";t.className="toggler-"+(e.closed=="true"?"off":"on");WH.aE(t,"click",WH.toggle.bind(t,s));WH.ae(t,WH.ce("span",{className:"fa fa-chevron-right fa-fw"}));var r=WH.ce("span");WH.ae(t,r);r.className="toggler-title";if(e.icon){r.className+=" toggler-title-with-icon";r.appendChild(Icon.create(e.icon,0,null,false,null,null,null,null,true))}if(e["class"]){r.className+=" "+e["class"]}WH.ae(r,WH.ct(e.name||WH.TERMS.clicktotoggledisplay_stc));return a}};WH.markup.tags.u={empty:false,allowInReplies:true,toNode:function(e){var t=WH.ce("ins");WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e){return e.replace(/<(ins|u)\b[\s\S]*?>([\s\S]*?)<\/\1>/gi,"[u]$2[/u]")}};WH.markup.tags.ul={block:true,empty:false,ltrim:true,rtrim:true,itrim:true,allowedChildren:{li:1,ul:1,ol:1},toNode:function(e){var t=WH.ce("ul");var a=[];if(e.first){a.push("first")}if(e.last){a.push("last")}if(a.length>0){t.className=a.join(" ")}WH.markup.applyCommonAttributes(t,e);return t},fromHtml:function(e,t){t=t||0;var a;if(a=WH.markup.matchOuterTags(e,"<ul\\b[\\s\\S]*?>","</ul>","g")){for(var i=0;i<a.length;++i){e=e.replace(a[i][1]+a[i][0]+a[i][2],"\n"+Array(t+1).join("\t")+"[ul]"+WH.markup.tags.ul.fromHtml(a[i][0],t+1)+"\n"+Array(t+1).join("\t")+"[/ul]")}}return e}};WH.markup.tags.url={allowedClass:WH.markup.CLASS.USER,allowInReplies:true,empty:false,helpText:"[url=https://www.google.com]"+WH.TERMS.link+"[/url]",attr:{unnamed:{req:false,valid:/\S+/},newwindow:{req:false,valid:/^true$/},onclick:{req:false,valid:/[\S ]+/},rel:{req:false,valid:/\S+/},site:{req:false,valid:WH.markup.regex.dataEnv},style:{req:false,valid:/^[^"<>]+$/},tooltip2:{req:false,valid:/\S+/},tooltip:{req:false,valid:/\S+/},guide:{req:false,valid:/^\d+$/},hash:{req:false,valid:/\S+/}},validate:function(e){if(e.onclick&&WH.markup.allow<WH.markup.CLASS.ADMIN){return false}if(e.tooltip&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(e.unnamed&&/^(mailto:|irc:)/i.test(e.unnamed.trim())&&WH.markup.allow<WH.markup.CLASS.STAFF){return false}if(e.unnamed&&/^(javascript:)/i.test(e.unnamed.trim())){return false}if(e.unnamed&&e.unnamed.match(/^\/\/https?:\/\//)){return false}if(e.unnamed&&e.unnamed.match(/^[[\]]/)){return false}if(e.hash&&!e.guide){return false}if(e.unnamed&&e.guide){return false}return true},toNode:function(attr){let url=WH.markup.tags.url.getUrlFromAttr(attr);if(url==null){return document.createDocumentFragment()}let a=WH.ce("a",{href:url});WH.markup.applyCommonAttributes(a,attr);let isExternal=!url.startsWith("#")&&url!=="javascript:"&&WH.markup.isUrlExternal(url);if(isExternal||attr.newwindow){a.target="_blank"}if(attr.rel){a.rel=attr.rel}if(attr.onclick){WH.aE(a,"click",function(code){return function(){eval(code)}}(attr.onclick))}if(attr.tooltip){WH.markup.attachMarkupTooltip(a,attr.tooltip,attr.tooltip2)}return a},fromHtml:function(e){return e.replace(/<a\b[^>]*?href=\"(.+?)\"[\s\S]*?>([\s\S]*?)<\/a>/gi,"[url=$1]$2[/url]")},getUrlFromAttr(e){let t=WH.markup.getDataEnvFromSiteAttr(e.site);if(e.unnamed){return WH.markup.isUrlSafe(e.unnamed,true)?WH.markup.finalizeUrl(e.unnamed,t):undefined}else if(e.guide){let a=WH.Gatherer.get(WH.Types.GUIDE,e.guide);let i=a&&a.url||WH.Entity.getUrl(WH.Types.GUIDE,e.guide,undefined,undefined,t);if(e.hash){i+=`#${e.hash}`}return i}else{return WH.markup.isUrlSafe(e._textContents,true)?WH.markup.finalizeUrl(e._textContents,t):undefined}}};WH.markup.tags.wowheadresponse={block:true,empty:false,rtrim:true,ltrim:true,itrim:true,attr:{unnamed:{req:true,valid:/[\S ]+/},roles:{req:true,valid:/[0-9]+/}},allowedModes:{article:1,quickfacts:1,comment:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.unnamed.trim();if(t.length<=0){return document.createDocumentFragment()}let a=WH.ce("div",{className:"box",dataset:{markupContentTarget:1}});WH.markup.applyCommonAttributes(a,e);if(e.first){a.classList.add("firstmargin")}if(e.last){a.classList.add("last")}var i="comment-role-moderator";if(e.roles&U_GROUP_ADMIN){i="comment-role-admin"}a.classList.add(i);var n=WH.ce("small",{className:"icon-wowhead"});WH.ae(a,n);let s=WH.TERMS.said_format.split("%s");if(s[0]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(s[0])))}var r=WH.ce("b",{className:i});WH.ae(n,r);var o=WH.ce("a",{href:WH.Url.generatePath("/user="+t)},WH.ct(t));WH.ae(r,o);if(s[1]){WH.ae(n,WH.ce("span",{classList:"quote-said-text"},WH.ct(s[1])))}WH.ae(a,WH.ce("div",{className:"pad"}));return a}};WH.markup.tags["<text>"]={empty:true,noHelp:true,allowInReplies:true,toNode:function(){const e=new RegExp("(.*\\.)?("+["allakhazam.com","battle.net","be-imba.hu","blizzard.com","curse.com","elitistjerks.com","eq2interface.com","eqinterface.com","fanbyte.com","guildfans.com","guildwork.com","hearthhead.com","hearthstonetopdecks.com","joystiq.com","lotrointerface.com","mmo-champion.com","mmoui.com","raidbots.com","raider.io","sc2ranks.com","tankspot.com","thottbot.com","torchlightarmory.com","torhead.com","vginterface.com","vindictusdb.com","warcraftlogs.com","worldoflogs.com","worldofwarcraft.com","wow-europe.com","wow-heroes.com","wowhead.com","wowinsider.com","wowinterface.com","wowpedia.org","wowwiki.com","zam.com"].join("|").replace(/\./g,"\\.")+")","i");const t=/\/t?way(?: +([^/;\n\d]+|#\d+))? +(\d+(?:[.,]\d+)?),? +(\d+(?:[.,]\d+)?)(?: +([^/;\n]*[^ /;\n]\b\)?(?!:\/\/)))?/;const a=/(https?:\/\/|www\.)([\/_a-z0-9%?#@\-+~&=;:'|]|\.[a-z0-9\-])+/gi;function i(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let a=JSON.parse(e.dataset.mapPinJson);if(a){t.push([a.x,a.y])}}catch(e){}}));return t}function n(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let a=JSON.parse(e.dataset.mapPinJson);if(a&&a.uiMapId){let e=a.name;if(a.uiMapName){if(e){e=WH.term("parens_format",e,a.uiMapName)}else{e=a.uiMapName}}t.push(WH.Wow.UiMap.generateInGamePinLinkCommand(a.uiMapId,a.x,a.y,e))}}catch(e){}}));return t}function s(e){let t=[];WH.qsa(":scope > span[data-map-pin-json]",e.parentNode).forEach((function(e){try{let a=JSON.parse(e.dataset.mapPinJson);if(a){t.push(WH.Wow.UiMap.generateTomTomCommand([a.x,a.y],{uiMapId:a.uiMapId,uiMapName:a.uiMapName,name:a.name}))}}catch(e){}}));return t}function r(t){let a=t.match("[a-z]+://([a-z0-9.-]+)");return!a||a[1].search(e)===0}function o(){a.lastIndex=0;t.lastIndex=0}return function(e,l){l=l||$.noop;if(e._rawText===" "&&!l.noNbsp){e._rawText=WH.Strings.nbsp}e._rawText=e._rawText.replace(/\\\[/g,"[");e._rawText=e._rawText.replace(/&nbsp;/g,WH.Strings.nbsp).replace(/&ndash;/g,"–").replace(/&mdash;/g,"—");if(l&&l.needsRaw){return WH.ct(e._rawText)}let c=e._rawText.split("\n");let u=document.createDocumentFragment();let d=!(l&&l.noLink);let f;let h=function(e){if(e.index>0){WH.ae(u,WH.ct(f.substr(0,e.index)));f=f.substr(e.index)}let t=WH.markup.finalizeUrl(e[0]);t=t.replace(/^www/,"https://www");if(WH.markup.allow<WH.markup.CLASS.USER&&!r(t)){let e=WH.ce("span",{className:"tip"},WH.ct(WH.TERMS.linkremoved));WH.Tooltip.simple(e,WH.TERMS.linkremoved_tip,"q",{byCursor:true});WH.ae(u,e)}else{let a=WH.ce("a",{href:t});if(WH.markup.isUrlExternal(t)){a.target="_blank"}WH.st(a,e[0]);WH.ae(u,a)}f=f.substr(e[0].length)};let p=function(e){if(e.index>0){WH.ae(u,WH.ct(f.substr(0,e.index)));f=f.substr(e.index)}let t;let a;let r=e[1]&&e[1].match(/^#(\d+)$/);if(r){t=r[1]}else{a=e[1]}let o=e[2].replace(/[.,]/,WH.TERMS.decimal_punct);let l=e[3].replace(/[.,]/,WH.TERMS.decimal_punct);let c=e[4];let d={name:c,x:o,y:l};let h=WH.ce("span",{className:"tip"},WH.ct(e[0]));let p={getAllCoords:i.bind(null,h),getAllInGameMapPins:n.bind(null,h),getAllTomTomCommands:s.bind(null,h),includeTomTom:true};if(t){d.uiMapId=t;p.uiMapId=t}else if(window.g_pageInfo&&g_pageInfo.uiMapId){d.uiMapId=g_pageInfo.uiMapId;p.uiMapId=g_pageInfo.uiMapId}if(a){d.uiMapName=a;p.uiMapName=a}if(c){p.name=c}h.dataset.mapPinJson=JSON.stringify(d);WH.Wow.UiMap.clickToCopyCoordinates(h,[o,l],p);WH.ae(u,h);f=f.substr(e[0].length)};let m;let H;if(!d){for(let e=0,a=c.length;e<a;e++){f=c[e];if(e>0){WH.ae(u,WH.ce("br"))}while(H=t.exec(f)){p(H);o()}if(f.length){WH.ae(u,WH.ct(f))}}}else{for(let e=0,i=c.length;e<i;e++){f=c[e];if(e>0){WH.ae(u,WH.ce("br"))}while(true){m=a.exec(f);H=t.exec(f);if(m&&H){if(H.index<m.index){p(H)}else{h(m)}}else if(m){h(m)}else if(H){p(H)}else{o();break}o()}if(f.length){WH.ae(u,WH.ct(f))}}}return u}}(),toText:function(e){return e._rawText}};WH.markup.tags.achievementpoints={empty:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("span",{className:"moneyachievement tip"},WH.ct(WH.numberFormat(e.unnamed)));WH.markup.applyCommonAttributes(t,e);WH.Tooltip.simple(t,"<b>"+WH.TERMS.achievementpoints_stc+"</b>","q1",{byCursor:true});return t}};WH.markup.tags.anchor={empty:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false,valid:/\S+/}},validate:function(e){if(!e.unnamed&&!e.id){return false}return true},toNode:function(e){if(!e.unnamed&&e.id){e.unnamed=e.id;e.id=null}var t=WH.ce("a",{id:e.unnamed});WH.markup.applyCommonAttributes(t,e);return t}};WH.markup.tags.db={empty:true,attr:{unnamed:{req:true,valid:/^(live|ptr|ptr2|beta|classic|tbc|bc|mop|wod|legion|bfa|shadowlands|sl|d2|di|d4|wrath|wotlk)$/}},toNode:function(e){WH.markup.setDataEnv(e.unnamed);return null},toText:function(e){WH.markup.setDataEnv(e.unnamed);return""}};WH.markup.tags.feedback={empty:true,allowedClass:WH.markup.CLASS.STAFF,attr:{mailto:{req:false,valid:/^true$/i}},toNode:function(e){var t=WH.ce("a",{href:"mailto:"+WH.Feedback.EMAIL_ADDR},WH.ct(WH.Feedback.EMAIL_ADDR));if(!e.mailto){t.href="javascript:";WH.aE(t,"click",(function(){ContactTool.show()}))}var a=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/email.gif)"}},t);return WH.ce("b",{},a)}};WH.markup.tags.forumrules={empty:true,allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=WH.ce("a",{href:WH.Url.generatePath("/forums/topic/2")},WH.ct("forum rules"));var a=WH.ce("span",{className:"icontiny",style:{backgroundImage:"url("+WH.staticUrl+"/images/icons/favicon.gif)"}},t);return WH.ce("b",{},a)}};WH.markup.tags.html={empty:false,allowedClass:WH.markup.CLASS.STAFF,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){let t=e._contents.textContent;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}t=t.replace(/http:\/\/([^\/:@]+\.)?(zamimg|wowhead)\.com\//g,"https://$1$2.com/");let a=WH.ce("div",{innerHTML:t});var i=a.getElementsByTagName("script");while(i.length){i[0].parentNode.replaceChild(WH.ct(i[0].outerHTML),i[0])}var n=document.createDocumentFragment();while(a.hasChildNodes()){n.appendChild(a.firstChild)}WH.markup.tags.html.removeEventAttributes(n);return n},removeEventAttributes:function(e){var t=e.childNodes;for(var a=0;a<t.length;a++){WH.markup.tags.html.removeEventAttributes(t[a])}if(e instanceof Element){var i=/^\s*javascript:/i;var n=e.getAttributeNames();for(var a=0;a<n.length;a++){if(n[a].substr(0,2).toLowerCase()==="on"||i.test(e.getAttribute(n[a]))){e.removeAttribute(n[a])}}}}};WH.markup.tags.markupdoc={empty:true,attr:{tag:{req:false,valid:/[a-z0-9]+/i}},allowedClass:WH.markup.CLASS.STAFF,validate:function(e){if(e.tag&&!WH.markup.tags[e.tag]){return false}return true},toNode:function(e){let t="";if(e.tag){t=WH.markup.tags.markupdoc.generateTagDocs(e.tag)}else{for(var a in WH.markup.tags){if(t!==""){t+='<div class="pad3"></div>'}t+=WH.markup.tags.markupdoc.generateTagDocs(a)}}let i=t;var n=WH.ce("div");n.innerHTML=i;var s=document.createDocumentFragment();while(n.firstChild!=null){s.appendChild(n.removeChild(n.firstChild))}return s},generateTagDocs:function(e){var t=WH.markup.tags[e];if(!t){return""}var a="";a='<div><h3 class="heading-size-3 first">Tag: ['+WH.markup.getEscapedHtml(e)+"]</h3>";a+='<table class="grid">';if(t.attr){a+='<tr><td align="right" width="200">Attributes:</td><td>';for(var i in t.attr){a+='<div style="margin: 5px; display: inline-block"><table><tr><th style="background-color: #242424; font-weight: bolder" colspan="2">';if(i=="unnamed"){a+="Self (["+e+"=???])"}else{a+=i}a+="</th></tr>";a+='<tr><td align="right">Required:</td><td>'+(t.attr[i].req?"Yes":"No")+"</td></tr>";a+='<tr><td align="right">Valid:</td><td>'+(t.attr[i].valid?WH.markup.getEscapedHtml(t.attr[i].valid.toString()):"--")+"</td></tr></table></div>"}a+="</td></tr>"}a+='<tr><td align="right" width="200">Has closing tag:</td><td>'+(t.empty?"No":"Yes")+"</td></tr>";a+='<tr><td align="right">Required group:</td><td>';if(t.allowedClass==WH.markup.CLASS.ADMIN){a+="Administrator"}else if(t.allowedClass==WH.markup.CLASS.STAFF){a+="Staff"}else if(t.allowedClass==WH.markup.CLASS.PREMIUM){a+="Premium"}else if(t.allowedClass&&t.allowedClass!=WH.markup.CLASS.PENDING){a+="Not pending"}else{a+="None"}a+="</td></tr>";if(t.allowedChildren){a+='<tr><td align="right">Allowed children:</td><td>';for(var n in t.allowedChildren){a+=WH.markup.getEscapedHtml(n)+"<br />"}a+="</td></tr>"}if(t.allowedParents){a+='<tr><td align="right">Allowed parents:</td><td>';for(var n in t.allowedParents){a+=WH.markup.getEscapedHtml(n)+"<br />"}a+="</td></tr>"}if(t.presets){a+='<tr><td align="right">Preset values:</td><td><table>';for(var s in t.presets){a+='<tr><td align="right">'+s+"</td><td>"+WH.markup.getEscapedHtml(t.presets[s])+"</td></tr>"}a+="</table></td></tr>"}if(t.trim){a+='<tr><td colspan="2">Trim whitespace</td></tr>'}if(t.ltrim){a+='<tr><td colspan="2">Trim preceding whitespace</td></tr>'}if(t.rtrim){a+='<tr><td colspan="2">Trim following whitespace</td></tr>'}if(t.itrim){a+='<tr><td colspan="2">Trim whitespace around interior content</td></tr>'}if(t.block){a+='<tr><td colspan="2">Automatically remove top padding if not the first item</td></tr>'}a+="</table></div>";return a}};WH.markup.tags.menu={empty:true,trim:true,ltrim:true,rtrim:true,attr:{tab:{req:true,valid:/^[0-9]+$/},path:{req:true,valid:/\S+/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=e.path.split(",");WH.Layout.set({activeTab:e.tab,breadcrumb:t});return null}};WH.markup.tags.random={empty:false,itrim:true,allowedChildren:{randomoption:1},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){var t=[];for(var a=0;a<e._nodes.length;a++){if(e._nodes[a].name=="randomoption"){t.push(e._nodes[a].attr._contents)}}if(t.length==0){return e._contents}return t[Math.floor(Math.random()*t.length)]}};WH.markup.tags.randomoption={empty:false,rtrim:true,ltrim:true,itrim:true,allowedClass:WH.markup.CLASS.STAFF,allowedParents:{random:1},toNode:function(e){return null}};WH.markup.tags.script={ltrim:true,rtrim:true,empty:false,attr:{src:{req:false,valid:/^\S+$/}},allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){if(e.src){$.getScript(e.src,(function(){try{$.globalEval(e._contents.textContent)}catch(e){WH.error("Markup script error:",e)}}))}else{try{$.globalEval(e._contents.textContent)}catch(e){WH.error("Markup script error:",e)}}return null}};WH.markup.tags["set-content-phase"]={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{type:{req:true,valid:/^\d+$/},typeid:{req:true,valid:/^\d+$/},phase:{req:true,valid:/^\d+(\.\d+)?$/}},toNode:function(e){var t=document.createDocumentFragment();var a=WH.ce("span");WH.ae(t,a);var i=WH.ce("a",{href:"javascript:",className:"fa fa-edit",style:{paddingLeft:"0.5em"},dataset:{phase:e.phase}});WH.ae(t,i);WH.aE(i,"click",(function(){var t=i.dataset.phase;if(t==0){t=undefined}WH.Wow.showContentPhasePrompt(e.type,[e.typeid],t,(function(e){i.dataset.phase=e?e:0;WH.st(a,e?e:"??")}))}));return t}};WH.markup.tags.style={ltrim:true,rtrim:true,empty:false,allowedClass:WH.markup.CLASS.ADMIN,allowedChildren:{"<text>":1},rawText:true,invisibleContent:true,toNode:function(e){WH.addCss(e._contents.textContent);return null}};WH.markup.tags["video-ad"]={allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false,value:/^(left|right)$/}},empty:true,trim:true,toNode:function(e){if(!WH.WAS.showAds()){return WH.ce("div")}var t=WH.ce("div",{id:"video-pos-page"});if(e.unnamed){t.className="video-pos-"+e.unnamed}return t}};WH.markup.tags.visitedpage={empty:false,attr:{unnamed:{req:true,valid:/^[0-9]+$/}},allowedClass:WH.markup.CLASS.STAFF,toNode:function(e){$.post("/visited-page",{id:e.unnamed},(function(){AchievementCheck()}));return null}};WH.markup.tags["--"]={empty:true,allowedClass:WH.markup.CLASS.STAFF,trim:true,ltrim:true,rtrim:true,attr:{unnamed:{req:false}},toNode:function(e){return null},toText:function(e){return""}};WH.markup.Tree=function(){const e=WH.Strings;const t={collection:{},currentNode:null,currentOffset:0,guid:e.guid(),nodes:[],postNodes:[]};this.closeTag=function(e){if(WH.markup.tags[e].empty||WH.markup.tags[e].post){return false}if(!t.currentNode){return false}else if(t.currentNode.name===e){if(t.currentNode.nodes.length>0){let e=t.currentNode.nodes.length-1;if(WH.markup.tags[t.currentNode.name].itrim&&t.currentNode.nodes[e].name==="<text>"){let a=t.currentNode.nodes[e];a.attr=WH.markup.utility.rtrimText(a.attr);t.currentNode.nodes[e]=a}}t.currentNode=t.currentNode.parent}else if(WH.markup.tags[t.currentNode.name].allowedChildren&&WH.markup.tags[t.currentNode.name].allowedChildren[e]===undefined){return false}else{let a=function(t){for(let a=t.length-1;a>=0;a--){if(t[a].name===e){return a}}return-1};let i=t.currentNode.parent?a(t.currentNode.parent.nodes):a(t.nodes);if(i===-1){return false}}return true};this.openTag=function(e,a){let i=WH.markup.tags[e];if(e!=="<text>"&&i&&!i.allowedClass){i.allowedClass=WH.markup.CLASS.PENDING}if(!i){return false}else if(i.allowedModes&&i.allowedModes[WH.markup.modes[WH.markup.mode]]===undefined){return false}else if(i.allowedClass&&i.allowedClass>WH.markup.allow){return false}if(WH.markup.mode===WH.markup.MODE.REPLY&&!i.allowInReplies){return false}let n={attr:a,name:e,nodes:[],parent:null};Object.keys(n.attr).forEach((function(e){if(typeof n.attr[e]==="string"){n.attr[e]=n.attr[e].replace(/^http:\/\/([^\/:@]+\.)?(zamimg|wowhead)\.com\//,"https://$1$2.com/")}}));if(t.currentNode){n.parent=t.currentNode}if(i.allowedParents){if(n.parent!=null){if(i.allowedParents[n.parent.name]===undefined){return false}}else if(WH.markup.root===undefined||i.allowedParents[WH.markup.root]===undefined){return false}}if(n.parent&&WH.markup.tags[n.parent.name].allowedChildren&&WH.markup.tags[n.parent.name].allowedChildren[e]===undefined){return false}if(t.currentNode){if(t.currentNode.nodes.length===0&&n.name==="<text>"&&WH.markup.tags[t.currentNode.name].itrim){n.attr=WH.markup.utility.ltrimText(n.attr)}else if(t.currentNode.nodes.length>0){let e=t.currentNode.nodes.length-1;let a=WH.markup.utility.checkSiblingTrim(t.currentNode.nodes[e],n);t.currentNode.nodes[e]=a[0];n=a[1]}if(n.name==="<text>"){if(n.attr._rawText.length>0){t.currentNode.nodes.push(n)}}else{t.currentNode.nodes.push(n)}}else{if(t.nodes.length>0){let e=t.nodes.length-1;let a=WH.markup.utility.checkSiblingTrim(t.nodes[e],n);t.nodes[e]=a[0];n=a[1]}if(n.name==="<text>"){if(n.attr._rawText.length>0){t.nodes.push(n)}}else{t.nodes.push(n)}}if(!i.empty&&!i.post){t.currentNode=n}return true};this.toHtml=function(){let e=WH.ce("div");WH.ae(e,i(t.nodes));return e.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')};this.toNode=function(){t.postNodes=[];for(let e in WH.markup.collectTags){t.collection[e]=[]}i(t.nodes,true);let e=a(t.nodes,0,{});for(let a=0;a<t.postNodes.length;a++){let i=e.querySelector("#postNode-replace-"+a);let n=t.postNodes[a];let s=WH.markup.tags[n.name].postParseNode(n.attr,t.collection);s=WH.markup.assembleDomNode(s);i.parentNode.replaceChild(s,i)}let n=[];Object.entries(WH.markup.disabledEnvironments).forEach((([e,t])=>{if(t){n.push({subdomains:e==="PTR"?/(^|\.)ptr\./:/(^|\.)(?:beta|shadowlands|sl|bfa|legion|wod|mop)\./,pathPrefixes:{PTR:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)ptr\//,PTR2:/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)ptr-2\//}[e]||/^(|\/|(https?:)?\/\/([^\/]*\.)?wowhead\.com\/)beta\//})}}));let s=e.querySelectorAll("a[href]");for(let e=0;e<s.length;e++){let t=s[e];let a=t.href.match(/^http(s)?:\/\/([^\/:@]+\.)?wowhead\.com[\/:]/);if(!a){continue}if(!a[1]){t.href=t.href.replace(/^http:/,"https:")}n.forEach((e=>{let i=a[2]||"";if(e.subdomains.test(i)){t.href=t.href.replace(i,i.replace(e.subdomains,"$1")||"www.")}t.href=t.href.replace(e.pathPrefixes,"$1")}))}return e};function a(e,i,n){let s=document.createDocumentFragment();let r;if(i===0){t.currentOffset=0}for(let o=0;o<e.length;o++){let l=e[o];if(WH.markup.blockTags[l.name]&&i===0&&o===0||l.parent&&WH.markup.blockTags[l.parent.name]&&i>0&&o===0){l.attr.first=true}if(WH.markup.blockTags[l.name]&&o===e.length-1){l.attr.last=true}if(WH.markup.excludeTags[l.name]){n[l.name]=n[l.name]?n[l.name]+1:1}for(let e in n){for(let t in WH.markup.excludeTags[e]){if(WH.markup.excludeTags[e][t][l.name]){l.attr[t]="false"}}}if(WH.markup.collectTags[l.name]){l.offset=t.currentOffset++;t.collection[l.name].push(l)}if(WH.markup.tags[l.name].post){let e=document.createElement("div");e.id="postNode-replace-"+t.postNodes.length;s.appendChild(e);t.postNodes.push(l)}else if(WH.markup.tags[l.name].empty){if(l.parent&&WH.markup.tags[l.parent.name].rawText){try{r=WH.markup.tags[l.name].toNode(l.attr,{needsRaw:true,treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}}else{try{r=WH.markup.tags[l.name].toNode(l.attr,{noLink:l.parent&&l.parent.name==="url",treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}}s.appendChild(WH.markup.assembleDomNode(r))}else{let e=a(l.nodes,i+1,n);l.attr._contents=e;l.attr._nodes=l.nodes;try{r=WH.markup.tags[l.name].toNode(l.attr,{treeGuid:t.guid})}catch(e){r=WH.ce("div",{className:"q10"},WH.ct("Whoops, markup engine error! Tag: "+l.name+" "+e));WH.error(e)}s.appendChild(WH.markup.assembleDomNode(r,e))}if(n[l.name]){n[l.name]--;if(n[l.name]===0){delete n[l.name]}}}return s}function i(e,a){let n=document.createDocumentFragment();for(let s=0;s<e.length;s++){let r=e[s];let o=i(r.nodes,a);if(a){r.attr._textContents=o.textContent}else{r.attr._contents=o}if(r.name==="<text>"){n.appendChild(WH.markup.assembleDomNode(WH.markup.tags[r.name].toNode(r.attr,{noLink:true,noNbsp:true,treeGuid:t.guid})))}else if(WH.markup.tags[r.name].toText){n.appendChild(document.createTextNode(WH.markup.tags[r.name].toText(r.attr)))}if(!WH.markup.tags[r.name].invisibleContent){n.appendChild(o)}}return n}};WH.markup.utility=new function(){this.ltrimText=function(e){e._rawText=e._rawText.trimStart();return e};this.rtrimText=function(e){e._rawText=e._rawText.trimEnd();return e};this.checkSiblingTrim=function(e,t){if(t.name=="<text>"&&(WH.markup.tags[e.name].rtrim||WH.markup.tags[e.name].trim)){t.attr=WH.markup.utility.ltrimText(t.attr)}else if(e.name=="<text>"&&(WH.markup.tags[t.name].ltrim||WH.markup.tags[t.name].trim)){e.attr=WH.markup.utility.rtrimText(e.attr)}return[e,t]}};WH.markup.init();WH.MD5=new function(){function e(e,t){var r=e[0],o=e[1],l=e[2],c=e[3];r=a(r,o,l,c,t[0],7,-680876936);c=a(c,r,o,l,t[1],12,-389564586);l=a(l,c,r,o,t[2],17,606105819);o=a(o,l,c,r,t[3],22,-1044525330);r=a(r,o,l,c,t[4],7,-176418897);c=a(c,r,o,l,t[5],12,1200080426);l=a(l,c,r,o,t[6],17,-1473231341);o=a(o,l,c,r,t[7],22,-45705983);r=a(r,o,l,c,t[8],7,1770035416);c=a(c,r,o,l,t[9],12,-1958414417);l=a(l,c,r,o,t[10],17,-42063);o=a(o,l,c,r,t[11],22,-1990404162);r=a(r,o,l,c,t[12],7,1804603682);c=a(c,r,o,l,t[13],12,-40341101);l=a(l,c,r,o,t[14],17,-1502002290);o=a(o,l,c,r,t[15],22,1236535329);r=i(r,o,l,c,t[1],5,-165796510);c=i(c,r,o,l,t[6],9,-1069501632);l=i(l,c,r,o,t[11],14,643717713);o=i(o,l,c,r,t[0],20,-373897302);r=i(r,o,l,c,t[5],5,-701558691);c=i(c,r,o,l,t[10],9,38016083);l=i(l,c,r,o,t[15],14,-660478335);o=i(o,l,c,r,t[4],20,-405537848);r=i(r,o,l,c,t[9],5,568446438);c=i(c,r,o,l,t[14],9,-1019803690);l=i(l,c,r,o,t[3],14,-187363961);o=i(o,l,c,r,t[8],20,1163531501);r=i(r,o,l,c,t[13],5,-1444681467);c=i(c,r,o,l,t[2],9,-51403784);l=i(l,c,r,o,t[7],14,1735328473);o=i(o,l,c,r,t[12],20,-1926607734);r=n(r,o,l,c,t[5],4,-378558);c=n(c,r,o,l,t[8],11,-2022574463);l=n(l,c,r,o,t[11],16,1839030562);o=n(o,l,c,r,t[14],23,-35309556);r=n(r,o,l,c,t[1],4,-1530992060);c=n(c,r,o,l,t[4],11,1272893353);l=n(l,c,r,o,t[7],16,-155497632);o=n(o,l,c,r,t[10],23,-1094730640);r=n(r,o,l,c,t[13],4,681279174);c=n(c,r,o,l,t[0],11,-358537222);l=n(l,c,r,o,t[3],16,-722521979);o=n(o,l,c,r,t[6],23,76029189);r=n(r,o,l,c,t[9],4,-640364487);c=n(c,r,o,l,t[12],11,-421815835);l=n(l,c,r,o,t[15],16,530742520);o=n(o,l,c,r,t[2],23,-995338651);r=s(r,o,l,c,t[0],6,-198630844);c=s(c,r,o,l,t[7],10,1126891415);l=s(l,c,r,o,t[14],15,-1416354905);o=s(o,l,c,r,t[5],21,-57434055);r=s(r,o,l,c,t[12],6,1700485571);c=s(c,r,o,l,t[3],10,-1894986606);l=s(l,c,r,o,t[10],15,-1051523);o=s(o,l,c,r,t[1],21,-2054922799);r=s(r,o,l,c,t[8],6,1873313359);c=s(c,r,o,l,t[15],10,-30611744);l=s(l,c,r,o,t[6],15,-1560198380);o=s(o,l,c,r,t[13],21,1309151649);r=s(r,o,l,c,t[4],6,-145523070);c=s(c,r,o,l,t[11],10,-1120210379);l=s(l,c,r,o,t[2],15,718787259);o=s(o,l,c,r,t[9],21,-343485551);e[0]=f(r,e[0]);e[1]=f(o,e[1]);e[2]=f(l,e[2]);e[3]=f(c,e[3])}function t(e,t,a,i,n,s){t=f(f(t,e),f(i,s));return f(t<<n|t>>>32-n,a)}function a(e,a,i,n,s,r,o){return t(a&i|~a&n,e,a,s,r,o)}function i(e,a,i,n,s,r,o){return t(a&n|i&~n,e,a,s,r,o)}function n(e,a,i,n,s,r,o){return t(a^i^n,e,a,s,r,o)}function s(e,a,i,n,s,r,o){return t(i^(a|~n),e,a,s,r,o)}function r(t){var a=t.length,i=[1732584193,-271733879,-1732584194,271733878],n;for(n=64;n<=t.length;n+=64){e(i,o(t.substring(n-64,n)))}t=t.substring(n-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<t.length;n++)s[n>>2]|=t.charCodeAt(n)<<(n%4<<3);s[n>>2]|=128<<(n%4<<3);if(n>55){e(i,s);for(n=0;n<16;n++)s[n]=0}s[14]=a*8;e(i,s);return i}function o(e){var t=[],a;for(a=0;a<64;a+=4){t[a>>2]=e.charCodeAt(a)+(e.charCodeAt(a+1)<<8)+(e.charCodeAt(a+2)<<16)+(e.charCodeAt(a+3)<<24)}return t}var l="0123456789abcdef".split("");function c(e){var t="",a=0;for(;a<4;a++)t+=l[e>>a*8+4&15]+l[e>>a*8&15];return t}function u(e){for(var t=0;t<e.length;t++)e[t]=c(e[t]);return e.join("")}function d(e){return u(r(e))}function f(e,t){return e+t&4294967295}if(d("hello")!="5d41402abc4b2a76b9719d911017c592"){function f(e,t){var a=(e&65535)+(t&65535),i=(e>>16)+(t>>16)+(a>>16);return i<<16|a&65535}}this.hash=function(e){return d(e)}};var Menu=new function(){const e=this;const t=WH.Device;const a=WH.DOM;this.CRUMB_DATABASE="0";this.CRUMB_TOOLS="1";const i="menu-item-heading";const n="menu-item-spacer";const s="unlinked";var r=100;var o=333;const l=0;const c=1;const u=2;const d=3;const f=4;this.ITEM_CRUMB=l;this.ITEM_LABEL=c;this.ITEM_URL=u;this.ITEM_SUBMENU=d;this.ITEM_OPTIONS=f;var h=520;var p=4;var m=2;var H=26;var g=6;var W=6;var E=[mn_icons];var _=[{menu:mn_classHalls,paths:[[30]]},{menu:mn_forums,paths:[["classes"]]},{menu:mn_items,paths:[[4,1],[4,2],[4,3],[4,4],[1],[0],[16],[7],[6],[9],[-2,0,"*"],[-2,1,"*"],[-2,2],[-2,16],[-2,4],[-2,5],[-2,6],[-2,7],[-3]]},{menu:mn_spells,paths:[[7],[-17],[-18],[-13],[-16],[-12],[-2],[50],[52],[54],[-3],[-3,"*"],[-7],[11],[9]]},{menu:mn_zones,paths:[[9],["classHalls"]]}];const v={currentMenu:null,divCache:{},menuItemsCache:{},menuOpener:null,nextUniqueId:0,openLinks:{},showingHeaderMenu:false,timer:{hideMenu:null,showMenu:null},visibleMenus:{}};this.add=function(t,i,n,s){n=n||{};if(typeof t==="string"){t=WH.qs(t)}else if(t instanceof jQuery){if(!t.length){WH.error("Tried to add a menu to an empty jQuery object.");return}t=t.get(0)}if(!t){WH.error("Tried to add a menu to an invalid target.");return}if(e.hasMenu(t)){WH.error("A menu has already been attached to this element.",[t.textContent,t.id,t.className].filter(Boolean).join(", "));return}if(n.onShow){i.onShow=n.onShow}if(n.onHide){i.onHide=n.onHide}if(n.padded){i.padded=n.padded}a.setData(t,"menu",i);T(t,n);if(n.showImmediately){if(n.showAtCursor){Q.call(this,s)}else{te.call(this,s)}}};this.addButtons=function(a,i,n){var s=$(a);if(!s.length){return}var r=$('<span class="menu-buttons"></span>');$.each(i,(function(a,s){if(B(s)){return}if(!G(s)){return}var o=$("<a></a>");var l=$("<span></span>",{text:e.getLabel(s,true)}).appendTo(o);e.linkifyItem(s,o);o.data("parentMenu",i).data("menuItem",s);if(s[f]&&s[f].rel){o.attr("rel",s[f].rel)}var c=e.getSubmenu(s);if(c){l.addClass("hassubmenu");if(t.isTouch()){me.add(o.get(0),c)}else{e.add(o,c,{padded:n&&n.padded,showAtElement:n&&n.menusOnClick})}}r.append(o)}));s.append(r)};this.addToSubmenu=function(t,a){var i=e.getSubmenu(t);if(i){i.push(a)}else{t[d]=[a]}};this.createItem=function(t){let a=[];["crumb","label","url","submenu","options"].forEach((function(i){if(t.hasOwnProperty(i)){a[e["ITEM_"+i.toUpperCase()]]=t[i]}}));if(a[l]==null){a[l]=""}return a};this.createHeading=function(t){let a=[];["crumb","label","url","submenu","options"].forEach((function(i){if(t.hasOwnProperty(i)){a[e["ITEM_"+i.toUpperCase()]]=t[i]}}));if(!a[f]){a[f]={}}a[f].heading=true;return a};this.createSpacer=function(){return[null,null,null,null,{spacer:true}]};this.findItem=function(t,a){return e.getFullPath(t,a).pop()};this.getFeaturedNavigationMenu=function(){const t=WH.Wow.PlayerClass;const a=WH.Wow.PlayerClass.Specialization;let i=e.getMenu("featuredNav_"+WH.getDataTreeKey())||[];if(WH.isRetailTree()&&!e.findItem(i,["classes"])){let a=[];const n={[t.DEATH_KNIGHT]:1,[t.MAGE]:2,[t.ROGUE]:3};const s=100;let r=e.getSubmenu(e.findItem(e.getMenu("guides"),"1")).filter((t=>{let a=parseInt(e.getItemCrumb(t));return a>s&&a<2*s}));r.forEach((t=>{let i=e.getSubmenu(t);if(!i){return}let r=parseInt(e.getItemCrumb(t))-s;a.push(e.createHeading({crumb:r,label:e.getLabel(t),options:{column:n[r]}}));i.forEach((t=>{let i=JSON.parse(JSON.stringify(t[f]));i.className="c"+r;a.push(e.createItem({crumb:e.getItemCrumb(t),label:e.getLabel(t),url:e.getItemUrl(t),options:i}))}))}));let o=[];while(o.length<2){let e=Math.floor(Math.random()*12)+1;if(o.indexOf(e)===-1){o.push(e)}}i.unshift(["classes",WH.TERMS.classes,"/classes",a,{className:"header-nav-classes first-"+o[0]+" second-"+o[1],zulNoHref:true}])}return i};this.getFullPath=function(t,a){var i=[];var n=function(a,i){if(!t){return null}var s=L(t,a);if(s!==-1){var r=[];var o=t[s];if(o[f]&&o[f].breadcrumbParent){var l=n(o[f].breadcrumbParent,true);if(l){r.push(l.pop())}}o.parentMenu=t;if(!i){t=e.getSubmenu(o)}r.push(o);return r}return null};for(var s=0;s<a.length;++s){if(!["string","number"].includes(typeof a[s])){WH.error("Breadcrumb path includes an invalid crumb.",a[s],s,a);break}var r=n(a[s]);if(r){for(var o=0,l;l=r[o];o++){i.push(l)}}}return i};this.getItemCrumb=function(e){return e[l]};this.getItemOptions=function(e){if(!e[f]){e[f]={}}return e[f]};this.getItemUrl=function(e){var t=e[u];if(!t){return null}if(e.modifyUrl){t=WH.modifyUrl(t,e.modifyUrl.params,e.modifyUrl.opt,e)}return t};this.getLabel=function(e,t){let a=e[c];if(e[f]){let i=e[f];if(i.generateText){a=i.generateText(e)}if(t===true){if(i.breadcrumb){a=i.breadcrumb}}else{if(typeof i.prefix==="string"){a=i.prefix+a}else if(typeof i.prefix==="object"){let e=i.prefix[0];for(let t in i.prefix.replacements){if(i.prefix.replacements.hasOwnProperty(t)){e=e.replace(t,i.prefix.replacements[t])}}a=e+a}}if(i.replacements){for(let e in i.replacements){if(i.replacements.hasOwnProperty(e)){a=a.replace(e,i.replacements[e])}}}}return a};this.getLabelNote=function(e){return e[f]&&e[f].note};this.getMenu=function(e){if(e===undefined){e="path"}return window["mn_"+e]};this.getOpener=function(){return z()?v.menuOpener:null};this.getSubmenu=function(t){var a=t[d];if(typeof a==="string"){a=e.getMenu(a)}return a&&a.length?a:null};this.hasMenu=e=>!!a.getData(e,"menu");this.hasSubmenuContent=function(t){return U(e.getSubmenu(t))};this.hide=function(e){oe(false);if(t.isTouch()){me.closeAllMenus();return}ee(null,e);V()};this.isHeading=function(e){return B(e)};this.linkifyItem=function(t,a){let i=e.getItemOptions(t);if(i.className){a.addClass(i.className)}if(i.tooltipContent){WH.Tooltip.simple(a[0],i.tooltipContent)}else{if(i.onMouseOver){a.mouseover(i.onMouseOver)}if(i.onMouseOut){a.mouseout(i.onMouseOut)}}if(!t[u]){a.attr("href","javascript:");a.addClass(s);if(i.tooltip){a.attr("href",i.tooltip);a.click(WH.rf)}return false}if(typeof t[u]=="function"){a.attr("href","javascript:");a.click(F);if(i.tooltip){a.attr("href",i.tooltip);a.click(function(e,t){e(t);return false}.bind(null,t[u]))}else{a.click(t[u])}if(i.rel){a.attr("rel",i.rel)}}else{var n=e.getItemUrl(t);a.attr("href",n);if(i.newWindow||WH.isExternalUrl(n)){a.attr("target","_blank")}if(i.rel){a.attr("rel",i.rel)}else if(typeof n==="string"&&(n.indexOf("/guides/")===0||n.indexOf("/guide=")===0||n.indexOf("/guide/")===0)){a.attr("rel","np")}}return true};this.map=function(t,a,i){a.className+=" menu-map";for(var n=0,s;s=t[n];n++){if(s[f]&&s[f].menuMapHide){continue}let t=e.getLabel(s);WH.ae(a,WH.getMajorHeading(typeof s[u]=="string"?'<a href="'+e.getItemUrl(s)+'">'+t+"</a>":t,2));var r=e.getSubmenu(s);if(r instanceof Array){var o=WH.ce("div",{className:"menu-map-section"});let t=null;var l=WH.ce("div",{className:"menu-map-submenu-group"});for(var c=0,d=r.length;c<d;c++){var h=r[c];if(h[f]&&h[f].menuMapHide){continue}if(B(h)){WH.ae(o,l);l=WH.ce("div",{className:"menu-map-submenu-group"});t=e.getLabel(h);WH.ae(o,WH.getMajorHeading(typeof h[u]=="string"?'<a href="'+e.getItemUrl(h)+'">'+t+"</a>":t,3));continue}var p=e.getSubmenu(h);if(i&&i.noEmptySubmenus&&!p){continue}let a=e.getLabel(h);var m=WH.getMajorHeading(typeof h[u]=="string"?'<a href="'+e.getItemUrl(h)+'">'+a+"</a>":a,4);var H=WH.ce("div",{className:"menu-map-submenu"},m);if(a===t){H.setAttribute("data-duplicate-heading","true")}if(p){e.addButtons(H,p,{menusOnClick:true})}WH.ae(l,H)}WH.ae(o,l);WH.ae(a,o)}}};this.modifyUrl=function(e,t,a){var i={params:t,opt:a};pe(e,(function(e){e.modifyUrl=i}));WH.Layout.updateBreadcrumb()};this.prepareForZul=function(e,t){return ie(e,t)};this.render=function(e,t){return se(e,0,true,t)};this.replace=(t,i,n)=>{n=n||{};if(!e.hasMenu(t)){WH.error("This element does not have a menu to replace.",[t.textContent,t.id,t.className].filter(Boolean).join(", "));return}if(n.onShow){i.onShow=n.onShow}if(n.onHide){i.onHide=n.onHide}if(n.padded){i.padded=n.padded}a.setData(t,"menu",i)};this.setItemUrl=function(e,t){e[u]=t};this.setItemOption=function(e,t,a){if(!e[f]){e[f]={}}e[f][t]=a};this.setSubmenu=function(e,t){e[d]=t};this.show=function(e,a){if(t.isTouch()){me.onRootNodeClick.call(a,null,e)}else{oe(WH.closest(a,".header")!==undefined);le(e,a)}};this.showAtCursor=function(e,a){if(t.isTouch()){me.onNodelessClick(e,a);return}v.currentMenu=e;ce(e,a.pageX,a.pageY)};this.sort=function(e,t){if(WH.inArray(e,true,B)!==-1){de(e,t)}else{ue(e,t)}};this.sortGlobalMenus=function(){if(Locale.getId()===LOCALE_ENUS){return}for(var t=0,a=E.length;t<a;t++){e.sort(E[t])}for(var i=0,n=_.length;i<n;i++){fe(_[i].menu,_[i].paths)}};this.updateItem=function(t){var a=t.$a;if(!a){return}var i=e.getItemOptions(t);a.removeClass("checked tinyicon icon");a.css("background-image","");if(t.checked){a.addClass("checked fonticon");a.prepend('<i class="fa fa-check fa-size-s fa-color-white fonticon-icon"/>')}else{var n=false;var s=function(e){switch(typeof e){case"string":return e;break;case"function":var a=e(t);if(typeof a=="string"){return a}break}return false};if(!n&&i.armory){var r=s(i.armory);if(r){n=true;a.addClass("armoryicon");a.css("background-image","url("+r+")")}}if(!n&&i.fontIcon){var o=s(i.fontIcon);if(o){n=true;a.addClass("fonticon");a.prepend('<i class="fa fa-'+o+' fonticon-icon"/>')}}if(!n&&i.tinyIcon){var l=s(i.tinyIcon);if(l){n=true;a.addClass("tinyicon");a.css("background-image","url("+WH.getTinyIconUrl(l)+")")}}if(!n&&i.icon){var c=s(i.icon);if(c){n=true;a.addClass("icon");a.css("background-image","url("+c+")")}}if(!n&&i.socketColor){var u=s(i.socketColor);if(u&&g_file_gems[u]){n=true;a.addClass("socket-"+g_file_gems[u])}}}if(i.np){a.attr("rel","np")}var d=i["class"]||i.className;if(d){a.addClass(d)}if(i.attributes){for(var f in i.attributes){if(i.attributes.hasOwnProperty(f)){a.attr(f,i.attributes[f])}}}};function T(e,a){if(a.noEvents){return}if(t.isTouch()){WH.aE(e,"click",me.onRootNodeClick);return}if(a.showAtCursor){if(a.leftAndRightClick){e.oncontextmenu=WH.rf;WH.aE(e,"click",(function(e){if(e.which===2){return}Q.call(this,e);e.preventDefault()}));WH.aE(e,"mouseup",J.bind(this,Q))}else if(a.rightClick){e.oncontextmenu=WH.rf;WH.aE(e,"mouseup",J.bind(this,Q))}else{WH.aE(e,"click",Q)}}else if(a.showAtElement){if(a.leftAndRightClick){e.oncontextmenu=WH.rf;WH.aE(e,"click",(function(e){if(e.which===2){return}te.call(this,e);e.preventDefault()}));WH.aE(e,"mouseup",J.bind(this,te));WH.aE(e,"mouseleave",ee)}else if(a.rightClick){e.oncontextmenu=WH.rf;WH.aE(e,"mouseup",J.bind(this,te));WH.aE(e,"mouseleave",ee)}else{WH.aE(e,"click",(function(e){if(e.button===1){return}if(this.classList.contains("open")){F();return}te.call(this,e);e.preventDefault()}));WH.aE(e,"mouseleave",ee)}}else{WH.aE(e,"mouseenter",te);WH.aE(e,"mouseleave",ee)}}function b(){let t=e.getMenu();for(let a=t.length-1;a>=0;a--){let i=t[a];if(!e.hasSubmenuContent(i)){if(!e.getItemUrl(i)||e.getItemCrumb(i)===e.CRUMB_DATABASE){t.splice(a,1)}else{e.setSubmenu(i,null)}}}WH.aE(window,"keyup",(e=>{if(e.key==="Escape"){F()}}));WH.aE(document,"bodyAvailable",(()=>{let t=se([e.createItem({label:"ohai",url:"/asdf"})],0,true)[0];t.style.left="-1000px";t.style.top="-1000px";WH.ae(document.body,t);let a=WH.qs(".menu-item",t).offsetHeight;WH.de(t);if(a&&!isNaN(a)&&a!==H){H=a}}))}function S(t){var a=e.getItemOptions(t);if(typeof a.regenerateMenuItem==="function"){WH.cO(t,a.regenerateMenuItem(t))}if(a.checkedUrl&&location.href.match(a.checkedUrl)){t.checked=true}if(typeof a.checkedFunc=="function"){t.checked=a.checkedFunc(t)}}function y(t){if(t.onBeforeShow){t.onBeforeShow(t)}for(var a=0,i=t.length;a<i;a++){if(!(t[a]instanceof Array)){return}var n=e.getItemOptions(t[a]);if(n.onBeforeShow){n.onBeforeShow(t[a])}}}function I(e){while(v.openLinks[e]){v.openLinks[e].classList.remove("open");v.openLinks[e]=null;e++}}function R(e,t,a,i){var n;if(!isNaN(t)&&v.divCache[t]){n=v.divCache[t];n.children().detach();n.css({left:0,top:0});re(n[0],e);if(a.padded&&WH.isRetailTree()){n.addClass("menu-padded")}return n}n=$("<div></div>").data("depth",t).mouseenter(X.bind(null,t)).mouseleave(Z).delegate("a","mouseenter",{depth:t},j).delegate("a","click",K);re(n[0],e);if(a.padded&&WH.isRetailTree()){n.addClass("menu-padded")}if(i!==true&&!isNaN(t)){v.divCache[t]=n}return n}function N(e,t){var a=e.length;var n=$(window).height()-m*2-g;var s=Math.floor(Math.max(0,n)/H);var r=Math.floor(h/H);var o;var l=false;if(a>0){o=e[0].find("a").first();if(r<s&&!o.data("noSoftColumns")){l=true;s=r}}var c=[];var u=-1;if(a>0){if(o.data("column")){e.each((function(){var e=$(this).find("a").first().data("column");if(e){u=e-1}if(!c[u]){c[u]=$("<td/>",{class:"menu-column"})}c[u].append(this)}))}else if(s<a){var d=Math.min(p,Math.ceil(a/s));var f=Math.ceil(a/d);var W=0;var E=a;var _=0;while(E>0){u++;var v=Math.min(E,f);var T=W;var b=T+v;if(l){if(_!=0){b+=_;v+=_;_=0}if(e[b-1]&&e[b-1].hasClass(i)){b--;v--;_=1}if(e[b]&&!e[b].hasClass(i)){if(e[b-2]&&e[b-1]&&e[b]&&e[b-2].hasClass(i)&&!e[b-1].hasClass(i)){if(e[b+1]&&e[b+2]&&!e[b+1].hasClass(i)&&e[b+2].hasClass(i)){b+=2;v+=2}else{b-=2;v-=2;_=2}}if(e[b]&&e[b+1].hasClass(i)){b+=1;v+=1}if(e[b+1]&&e[b+2]&&!e[b+1].hasClass(i)&&e[b+2].hasClass(i)){b+=2;v+=2}}}e.slice(T,b).each((function(){if(!c[u]){c[u]=$("<td/>",{class:"menu-column"})}c[u].append(this)}));W+=v;E-=v}}}if(c.length){var S=WH.ce("div",{className:"menu-outer"});var y=WH.ce("div",{className:"menu-inner"});var I=WH.ce("table",{className:"menu-columns"});var R=WH.ce("tbody");var N=$("<tr/>");WH.ae(S,y);WH.ae(y,I);WH.ae(I,R);for(var w=0,A;A=c[w];w++){N.append(A)}N.appendTo(R);return{columns:c.length,menu:S,padded:t}}var M=$('<div class="menu-outer"></div>');var C=$('<div class="menu-inner"></div>');e.each((function(){C.append(this)}));M.append(C);return{menu:M,padded:t}}function w(t){S(t);var a=$("<div/>",{class:"menu-item"});var r=$("<a/>").appendTo(a);let o=r[0];t.$a=r;r.data("menuItem",t);let l=e.getLabel(t);let c=true;if(t[f]&&t[f].spacer){r.addClass(n);r.addClass(s);c=false}else{if(B(t)){r.addClass(i);r.text(l);c=false}e.linkifyItem(t,r)}e.updateItem(t);if(t[f]){if(t[f].ariaLabel){o.ariaLabel=t[f].ariaLabel}if(t[f].column){r.data("column",t[f].column)}if(t[f].noSoftColumns){r.data("noSoftColumns",t[f].noSoftColumns)}if(t[f].modifyTooltip){r.get(0)._fixTooltip=t[f].modifyTooltip}if(t[f].modifyTooltip2){r.get(0)._fixTooltip2=t[f].modifyTooltip2}if(t[f].extraActions){for(var u=0,d=t[f].extraActions.length;u<d;u++){var h=t[f].extraActions[u];var p=WH.ce("a");if(h.fontIcon){p.classList.add("fa");if(h.fontIcon.indexOf(" ")!==-1){var m=h.fontIcon.split(" ");for(var H=0,g=m.length;H<g;H++){p.classList.add("fa-"+m[H])}}else{p.classList.add("fa-"+h.fontIcon)}}else{p.classList.add("fa");p.classList.add("fa-circle");p.classList.add("fa-size-s")}if(typeof h.url==="string"){p.href=h.url}else if(typeof h.callback==="function"){WH.aE(p,"click",h.callback)}if(typeof h.tooltipText!=="undefined"){WH.Tooltip.simple(p,h.tooltipText,typeof h.tooltipClass!=="undefined"?h.tooltipClass:"q2")}for(var W in h){if(!h.hasOwnProperty(W)){continue}switch(W){case"callback":case"fontIcon":case"tooltipClass":case"tooltipText":case"url":break;default:p.setAttribute(W,h[W])}}a.append(p)}}}if(c){let a;if(typeof l=="object"&&l!=null&&"tagName"in l&&l.tagName.toLowerCase()==="span"){let e;while(e=l.getElementsByTagName("span")[0]){let t=document.createElement("div");t.className=e.className;$.extend(t.style,e.style);t.style.display="inline";let a;while(a=e.firstChild){a.parentNode.removeChild(a);t.appendChild(a)}e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}a=$(l).clone()}else{a=$("<span></span>");a.text(l);let i=e.getLabelNote(t);if(i){a.append(WH.ce("section",{className:"option-label-note"},WH.ct(i)))}}a.appendTo(r);if(e.getSubmenu(t)){a.addClass("hassubmenu")}}return a}function A(e,t){var a=P(e);if(v.menuItemsCache[a]){return v.menuItemsCache[a]}let i;let n=[];$.each(e,(function(e,a){if(!(a instanceof Array)){a=["","Error: Invalid menu item",null,null,{className:"q10"}];WH.error("Trying to render an invalid menu item.",typeof a)}if(!G(a)){return}var s=w(a);if(!t&&B(a)){i=s;return}if(i){n.push(i);i=null}n.push(s)}));var s=$(n);v.menuItemsCache[e]=s;return s}function M(e,t,a){I(0);C(e,0,t,a);q(1)}function C(e,t,a,i,n){if(typeof e=="function"){e=e()}y(e);var s=se(e,t);s.appendTo(document.body);var r=!z(t);v.visibleMenus[t]=s;for(let e=0,a;a=v.visibleMenus[e];e++){a.attr("data-reverse-tier",t-e+1)}let o=t===0?k(s,t,v.showingHeaderMenu,a,i):D(s,t,v.showingHeaderMenu,n);s.css({position:v.showingHeaderMenu?"fixed":"absolute",left:o.x+"px",top:o.y+"px"});var l=WH.createRect(o.x,o.y,s.width(),s.height());WH.WAS.intersect(l,true);s[0].dataset.animateReveal=JSON.stringify(r);if(v.menuOpener){v.menuOpener.dataset.animateReveal=JSON.stringify(r)}s.show()}function O(t,a){t.splice(0,t.length);a.forEach((function(a){if(a[c]){t.push(e.createHeading({crumb:a[l],label:a[c],url:a[u],options:a[f]}))}let i=e.getSubmenu(a);if(i){i.forEach((function(e){t.push(e)}))}}))}function L(e,t){t=t.toString();return e.findIndex((e=>(e[l]==null?"":e[l].toString())===t))}function k(e,t,a,i,n){var s=WH.getViewport();var r=e.width();var o=e.height();var l=r+W;var c=o+g;var u=i!=null&&n!=null;if(u){if(n+c>s.b){n=Math.max(s.t,s.b-c)}}else{let e=WH.getOffset(v.menuOpener,a);i=e.left;n=e.top+v.menuOpener.offsetHeight;if(v.menuOpener.classList.contains("imitation-select")){i-=2}if(!v.menuOpener.closest(".menu-buttons")&&n+c>s.b&&e.top>=c){n=e.top-c}}if(i+l>s.r){i=Math.max(s.l,s.r-l)}return{x:i,y:n}}function D(e,t,a,i){var n=WH.getViewport();var s=e.width();var r=e.height();var o=s+W;var l=r+g;let c=v.openLinks[t-1];let u=WH.getOffset(c,a);var d=u.left+c.offsetWidth-5;var f=u.top-2;if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()){if(WH.Theme.isClassic()&&i){f--}else if(WH.Theme.isThottbot()){f+=2}}if(d+o>n.r){d=Math.max(n.l,u.left-s)}if(f+l>n.b){f=Math.max(n.t,n.b-l)}return{x:d,y:f}}function P(e){if(e.uniqueId==null){e.uniqueId=v.nextUniqueId++}return e.uniqueId}function x(t){var a=e.getItemOptions(t);if(a&&a.requiredAccess&&!WH.User.hasRole(a.requiredAccess)){return false}return true}function U(e){if(!e||!e.length){return false}for(let t=0,a=e.length;t<a;t++){if(!B(e[t])&&G(e[t])){return true}}return false}function F(){oe(false);if(t.isTouch()){me.closeAllMenus();return}if(v.menuOpener){v.menuOpener.classList.remove("open")}q(0)}function q(e){while(v.visibleMenus[e]){v.visibleMenus[e].stop().hide();v.visibleMenus[e]=null;++e}if(!v.visibleMenus[0]){V();WH.WAS.restoreHidden()}}function Y(e){var t=[];var a;if(!B(e[0])){a=[];t.push([0,"",null,a])}$.each(e,(function(e,i){if(B(i)){a=[];t.push([i[l],i[c],i[u],a,i[f]])}else{if(a){a.push(i)}else{t.push(i)}}}));return t}function B(e){return e[l]==null||e[f]&&e[f].heading}function G(t){if(!(t instanceof Array)){return false}if(!x(t)){return false}if(t[f]){if(t[f].hide){return false}if(t[f].requiredTrees&&!t[f].requiredTrees.includes(WH.getDataTree())){return false}if(typeof t[f].condition==="function"){if(!t[f].condition()){return false}}}if(!t.checkingVisibility){var a=e.getSubmenu(t);if(a){t.checkingVisibility=true;var i=U(a);delete t.checkingVisibility;if(!i&&false){return false}}}return true}function z(e){return v.visibleMenus[e||0]!=null}function V(){if(v.currentMenu&&v.currentMenu.onHide){v.currentMenu.onHide.call(v.menuOpener,v.currentMenu)}v.currentMenu=null;v.menuOpener=null}function K(t){var a=$(this);var i=a.data("menuItem");if(!i){return}var n=e.getItemOptions(i);if(n.onClick){n.onClick(t)}}function j(t){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);var a=t.data.depth;I(a);var i=$(this).data("menuItem");if(i){var n=e.getSubmenu(i);if(n){this.classList.add("open");v.openLinks[a]=this;var s=function(e,t,a){var i=WH.closest(a,".menu-item");var n=i?i.matches(":first-child"):false;C(e,t+1,undefined,undefined,n);q(t+2)};if(!z(a+1)){v.timer.showMenu=setTimeout(s.bind(this,n,a,this),r)}else{s(n,a,this)}return}}q(a+1)}function Z(){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);v.timer.hideMenu=setTimeout(F,o)}function X(e,t){clearTimeout(v.timer.hideMenu);var a=!t.target.className;if(!a){var i=t.target.className.split(" ");a=i.indexOf("open")==-1&&i.indexOf("hassubmenu")==-1&&i.indexOf("fonticon-icon")==-1}if(a){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);I(e);q(e+1)}}function Q(t){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);let i=a.getData(this,"menu");oe(WH.closest(this,".header")!==undefined);v.menuOpener=this;v.currentMenu=i;e.showAtCursor(i,t);ae(this,i,t)}function J(e,t){if(t.button===2||t.shiftKey||t.ctrlKey){e.call(this,t)}}function ee(e,t){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);if(z()){if(t===true){F()}else{v.timer.hideMenu=setTimeout(F,o)}}}function te(e){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);let t=function(e){let t=a.getData(this,"menu");oe(WH.closest(this,".header")!==undefined);le(t,this);ae(this,t,e)}.bind(e.currentTarget||e.target,e);if(z()){t()}else{v.timer.showMenu=setTimeout(t,r)}}function ae(e,t,a){if(t.onShow){t.onShow.call(e,t,a)}}function ie(e,t){if(!(e instanceof Array)){return null}var a=[];let i;for(let n=0,s;s=e[n];n++){let e=ne(s,t);if(!e){continue}if(B(s)){i=e;continue}if(i){a.push(i);i=null}a.push(e)}return a}function ne(t,a){var i=t[f]||{};if(i.zulHide){return null}if(t[f]&&t[f].requiredAccess&&!WH.User.hasRole(t[f].requiredAccess)){return null}var n={type:"link"};var s="";if(B(t)){n.heading=true}n.text=e.getLabel(t);if(typeof n.text!="string"){n.text=""}n.name="null";if(t[f]&&t[f].hasOwnProperty("zulName")){n.name=t[f].zulName}if(i.zulNoHref){}else if(typeof i.zulHref=="function"){n.href=i.zulHref}else{switch(typeof t[u]){case"string":n.href=e.getItemUrl(t);break;case"function":n.click=t[u];break}}if(t[f]){if(i.zulGetMobileMenu){if(!n.menu){n.menu={}}n.menu.mobile=i.zulGetMobileMenu}if(i.fontIcon){n.fontIcon=i.fontIcon}if(i.icon){n.imageIcon={url:i.icon,enlargeIcon:true}}if(i.tinyIcon){n.imageIcon={url:WH.getTinyIconUrl(i.tinyIcon),enlargeIcon:true}}if(i.armory){n.imageIcon={url:i.armory,enlargeIcon:true};s=(s?" ":"")+"zul-bar-icon-armory"}if(typeof n.imageIcon=="object"&&typeof n.fontIcon!="undefined"){delete n.fontIcon}if(t.checked){n.checked=true}else if(i.checkedUrl&&location.href.match(i.checkedUrl)){n.checked=true}else if(typeof i.checkedFunc=="function"){n.checked=i.checkedFunc(t)}else if(i.checked){n.checked=true}}var r=e.getSubmenu(t);if(r){if(!n.menu){n.menu={}}n.menu.mobile=ie(r)}if(s){n.className=s}if(a){n.condition=a}else if(i.zulCondition){n.condition=i.zulCondition}return n}function se(e,t,a,i){var n=t===0?e.padded:false;if(!e||e.length===0){e=[["","Error: Menu is empty",null,null,{className:"q10"}]];WH.error("Trying to render an empty menu.")}var s=A(e,i);var r=N(s,n);let o=R(e,t,r,a);o.append(r.menu);return o}function re(e,t){e.className="menu";if(t.classes){for(let a=0,i=t.classes.length;a<i;a++){e.classList.add(t.classes[a])}}}function oe(e){if(v.showingHeaderMenu===e){return}v.showingHeaderMenu=e;document.body.dataset.showingHeaderMenu=JSON.stringify(e)}function le(e,t){if(v.menuOpener){v.menuOpener.classList.remove("open")}v.currentMenu=e;v.menuOpener=t;t.classList.add("open");M(e)}function ce(e,t,a){clearTimeout(v.timer.hideMenu);clearTimeout(v.timer.showMenu);M(e,t,a)}function ue(t,a){if(!(t instanceof Array)){WH.error("Trying to do a menu sort on a non-array.",typeof t,t);return}t.sort(((t,a)=>WH.stringCompare(e.getLabel(t),e.getLabel(a))));if(a){for(var i=0,n;n=t[i];i++){var s=e.getSubmenu(n);if(s){e.sort(s,a)}}}}function de(t,a){let i=Y(t);$.each(i,(function(t,i){var i=e.getSubmenu(i);if(i){ue(i,a)}}));O(t,i)}function fe(t,a){if(t.length===0){return}$.each(a,(function(i,n){var s;if(n[n.length-1]==="*"){if(n.length>1){var r=e.findItem(t,n.slice(0,n.length-1));s=e.getSubmenu(r)}else{s=t}if(s instanceof Array){for(var o=0,l;l=s[o];o++){var c=e.getSubmenu(l);if(c){e.sort(c)}}}else{WH.error("Could not find submenus to sort.",t,a)}}else{s=e.findItem(t,n);if(s){var c=e.getSubmenu(s);if(c){e.sort(c)}}}}))}function he(e,t){$.each(e,(function(e,a){pe(a,t)}))}function pe(t,a){a(t);var i=e.getSubmenu(t);if(i){he(i,a)}}var me=new function(){var t={container:null,containerArrow:null,currentMenu:null,menuOpener:null,path:[]};this.add=function(e,t){if(a.getData(e,"menu")){WH.error("A touch menu has already been attached to this element.",e.textContent);return}a.setData(e,"menu",t);WH.aE(e,"click",me.onRootNodeClick)};this.closeAllMenus=function(){$(".header-nav dt > a.active").removeClass("active");$("#header-nav-subnav").removeClass("touch-menu").empty();if(t.container){t.container.empty().css({display:"none"})}t.currentMenu=null;t.path=[];t.containerArrow=null;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active")}t.menuOpener=null;V()};this.onNodelessClick=function(e,a){v.currentMenu=e;v.menuOpener=null;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active");t.menuOpener=null}t.currentMenu=e;oe(false);u(e,{atPosition:[a.pageX,a.pageY+5]});ae(null,e,a);if(a){a.preventDefault();a.stopPropagation()}};this.onRootNodeClick=function(e,i){var n=$(this);if(this.classList.contains("active")||this.classList.contains("touch-menu-active")){me.closeAllMenus();if(e){e.preventDefault();e.stopPropagation()}return}var s=n.data("menuItem");oe(WH.closest(this,".header")!==undefined);if(!i){i=a.getData(this,"menu")}if(typeof i==="function"){i=i()}v.currentMenu=i;v.menuOpener=this;if(t.menuOpener){t.menuOpener.removeClass("touch-menu-active");t.menuOpener=null}if(this.parentNode.tagName==="DT"){me.closeAllMenus();this.classList.add("active");t.currentMenu=null;t.path=[s[l]];u(i)}else{t.menuOpener=n;t.menuOpener.addClass("touch-menu-active");t.currentMenu=i;t.path=s?[s[l]]:[null];u(i,{atElement:n})}ae(this,i,e);if(e){e.preventDefault();e.stopPropagation()}};function i(a,i,n){let s=a.menu||e.getMenu();var r,o,c,u;if(n){for(c in t.path){r=t.path[c];for(u in s){o=s[u];if(o[l]===r){s=e.getSubmenu(o);break}}}t.path=t.path.concat(i)}var f,h,p;for(c in i){r=i[c];f=null;for(u in s){o=s[u];if(o[l]===r){f=o;break}}if(!f){break}h=WH.ce("li");p=WH.ce("a");p.href="javascript:";e.linkifyItem(f,$(p));p.innerHTML=e.getLabel(f,true);p.onclick=d;WH.ae(h,p);WH.ae(a,h)}}function n(e,t){var a=null,i;for(var n in t){i=t[n];if(!G(i)){continue}if(B(i)){s(e,i);a=r(e);continue}if(!a){a=r(e)}WH.ae(a,o(i))}}function s(t,a){let i=WH.ce("a");let n=$(i);a.$a=n;n.data("menuItem",a);e.linkifyItem(a,n);e.updateItem(a);n.text(e.getLabel(a));WH.ae(t,WH.getMajorHeading(n.get(0),2))}function r(e){var t=WH.ce("ul");WH.ae(e,t);return t}function o(t){w(t);S(t);var a=$("<a></a>");t.$a=a;a.data("menuItem",t);var i=e.linkifyItem(t,a);e.updateItem(t);var n;var s=e.getLabel(t),r,o,l;if(typeof s=="object"&&"tagName"in s&&s.tagName.toLowerCase()=="span"){while(r=s.getElementsByTagName("span")[0]){o=document.createElement("div");o.className=r.className;$.extend(o.style,r.style);o.style.display="inline";while(l=r.firstChild){l.parentNode.removeChild(l);o.appendChild(l)}r.parentNode.insertBefore(o,r);r.parentNode.removeChild(r)}n=$(s)}else{n=$("<span></span>");n.text(e.getLabel(t))}n.appendTo(a);var u=WH.ce("li");a.appendTo(u);if(e.getSubmenu(t)){if(i){a.addClass("has-sub");n.addClass("has-sub");var d=WH.ce("a");d.className="view-sub";d.href="javascript:";d.onclick=c;$(d).data("menuItem",t);WH.ae(u,d)}else{a.addClass("only-sub").data("menuItem",t).click(c);n.addClass("only-sub")}}return u}function c(){var a=$(this).data("menuItem");var n=$(".touch-menu-breadcrumb");if(n.length){i(n.get(0),[a[l]],true)}else{t.path.push(null)}f(e.getSubmenu(a),{animate:this})}function u(a,n){if(!n){n={}}var s;if(n.atElement||n.atPosition){var r=false;if(!t.container){t.container=$("<div/>",{class:"floating-touch-menu-container",css:{display:"none"}});t.container.appendTo("body")}else{var o=t.container.offset();r=o.top}t.container.empty();s=$("<div/>",{class:"floating-touch-menu"});t.containerArrow=$("<div/>",{class:"floating-touch-menu-arrow"});s.append(t.containerArrow).appendTo(t.container);var l=$("<a/>",{class:"floating-touch-menu-closer"});l.click(me.closeAllMenus);t.container.append(l);var c=n.atElement?n.atElement.offset():{left:n.atPosition[0],top:n.atPosition[1]};var u=c.top;if(n.atElement){u+=n.atElement.outerHeight()}var d=parseInt(u+7);var h=d!=r;t.container.css({display:"block",top:(h?d-10:d)+"px"});var p=c.left;if(n.atElement){p+=n.atElement.outerWidth()/2}t.containerArrow.css({display:"block",left:parseInt(p-10)+"px"});if(h){t.container.css({opacity:"0"});setTimeout((function(){t.container.animate({opacity:"1",top:"+=10px"})}),0)}}else{t.container=null;t.containerArrow=null;s=$("#header-nav-subnav");if(!s.length){s=$("<div/>",{class:"header-nav-subnav",id:"header-nav-subnav"});s.insertAfter(".header-nav")}s.empty()}var m=false;if(!n.atElement&&!n.atPosition||n.atElement&&n.atElement.data("menuItem")){m=true}if(m){if(t.container){t.container.addClass("has-breadcrumb")}var H=WH.ce("ul");H.className="touch-menu-breadcrumb";if(n.atElement){var g=$(n.atElement);if(g.data("parentMenu")){H.menu=$(n.atElement).data("parentMenu")}else if(g.html()){H.menu=[g[0].whMenuItem||e.createItem({crumb:0,label:g.html(),submenu:a})]}}i(H,t.path)}else if(t.container){t.container.removeClass("has-breadcrumb")}if(t.container){if(n.atElement&&n.atElement.parents("div.breadcrumb").length){t.container.addClass("from-breadcrumb")}else{t.container.removeClass("from-breadcrumb")}}var W=WH.ce("div");W.className="touch-menu-items";W.style.left="0%";f(a,{target:W});var E=WH.ce("div");E.className="touch-menu-items-wrapper";WH.ae(E,W);if(m){s.append(H)}s.append(E).attr("class","touch-menu")}function d(){var a=$(this).parent();if(a.is(":last-child")){return true}var i=a.index();let n=e.getMenu();for(var s=0;s<=i;s++){for(var r in n){if(n[r][l]===t.path[s]){n=e.getSubmenu(n[r]);break}}}a.nextAll().remove();f(n,{reverse:t.path.length-i-1,targetPathIndex:i});t.path=t.path.slice(0,i+1);return false}function f(e,a){if(a.animate){var i=$(".touch-menu-items");$(a.animate).parent().addClass("chosen");i.addClass("chosen");setTimeout((function(){var a=WH.ce("div");a.className="touch-menu-items";var s=(t.path.length-2)*-10+2;a.style.left=s+"%";n(a,e);var r=$(a);var o=i.last();o.after(r);var l=o.height();i.each((function(){var e=$(this);if(e.data("height")){e.css({height:"1px"}).animate({left:"-=12%"})}else{e.data("height",e.height()).css("height",e.height()+"px").animate({left:"-=12%",height:"1px"})}}));var c=r.height();r.css("height",l+"px").animate({left:"-=12%",height:c+"px"})}),100)}else if(a.reverse){var s=$(".touch-menu-items");var r=$(s.get(a.targetPathIndex));var o=a.reverse*12;var l=s.last();r.css({height:l.height()+"px"}).animate({left:"+="+o+"%",height:r.data("height")+"px"},{complete:function(){$(this).css("height","")}});l.css({height:"1px"});s.not(r).animate({left:"+="+o+"%"},{complete:function(){r.removeClass("chosen");$(".chosen",r).removeClass("chosen");r.nextAll().stop().remove()}})}else if(a.target){$(a.target).empty();n(a.target,e)}}};this.addTouch=me.add;b()};WH.ModelViewer=new function(){const e=this;const t=[1819228,2425846,2046439];const a={screenshotsAllowed:false};this.canTakeScreenshots=function(){return!!a.screenshotsAllowed};function i(){a.screenshotsAllowed=(g_user.roles&U_GROUP_STAFF)>0||t.includes(g_user.id)}i()};WH.Notifications=new function(){const e=this;const t=WH.LocalStorage;this.GA_ACTION_GENERAL="General";this.GA_ACTION_DELIVERY_WEB_PUSH="Web Push Delivery Method";this.GA_ACTION_EVENT_NEWS_PUBLISHED="News Published Events";this.GA_CATEGORY="Notifications";const a="notifications-dialog";const i=1;const n=2;const s=3;const r=4;const o=5;const l=6;const c=7;const u=8;const d=9;const f=10;const h=11;const p={[i]:"allNewsPosts",[n]:"classicWowNewsOnly",[s]:"nonClassicNewsOnly",[r]:"devNewsOnly",[o]:"otherGamesOnly",[l]:"diabloNews_stc",[c]:"classicWowNewsOnly",[u]:"tbcWowNews_stc",[d]:"diablo2News_stc",[f]:"diabloImmortalNews_stc",[h]:"diablo4News_stc"};const m=[i,n,s,r,o,l,c,u,d,f,h];const H="/js-local/WH/ServiceWorkers/Notifications/WebPush.js";const g={newSubInfo:null,postSubscriptionCallback:null};this.browserSupportsNotifications=function(){return!!(window.Promise&&navigator.serviceWorker&&window.PushManager)};this.getNewsGroupsOptions=function(e,t){let a=document.createDocumentFragment();for(let i=0;i<m.length;i++){let n=m[i];let s=t.indexOf(n)!==-1;let r=WH.ce("input",{name:"newsGroups["+e+"]["+n+"]",type:"checkbox",checked:s});r.dataset.subId=e.toString();r.dataset.group=n.toString();WH.aE(r,"click",v.bind(null,e));if(i!==0){WH.ae(a,WH.ce("br"))}let o=WH.ce("label",undefined,r);WH.ae(o,WH.ct(WH.TERMS[p[n]]));WH.ae(a,o)}return a};this.isBrowserDenied=function(){return Notification.permission==="denied"};this.getNewSubInfo=function(){return g.newSubInfo};this.getSubscription=function(){return navigator.serviceWorker.getRegistrations().then((function(e){for(let t=0;t<e.length;t++){let a=e[t];WH.debug(a,new RegExp(H));if(a.active.scriptURL.match(new RegExp(H))){return a.pushManager.getSubscription()}}return null}))};this.enableNewsNotifications=function(){y()};this.setPostSubscriptionCallback=function(e){g.postSubscriptionCallback=e};this.showSubscriptionListError=function(){R("subscription-list-error",WH.TERMS.notificationsSubscriptionListFailed_tip)};function W(e){let t="."+a+"-buttons";let i=WH.qsa(t+" .btn");for(let e=0;e<i.length;e++){i[e].disabled=true}let n=WH.qs(t+"-"+e);if(n){n.classList.add("working")}}function E(){t.remove(t.KEY_NOTIFICATIONS_ERROR_SHOWN)}function _(){WH.de("."+a)}function v(e,t){if(t.target.checked===false){return}let a=WH.qsa('input[data-sub-id="'+e+'"]');let n=parseInt(t.target.dataset.group)===i;for(let e=0;e<a.length;e++){let t=parseInt(a[e].dataset.group);if(n&&t!==i){a[e].checked=false}else if(!n&&t===i){a[e].checked=false}}}function T(){if(WH.PageMeta.page==="account"){WH.debug("Notifications onboarding disabled on this page (legacy mechanism).");return}if(WH.getPageData("notifications.disable-onboarding")){WH.debug("Notifications onboarding disabled on this page.");return}if(!t.isSupported()){WH.debug("This browser does not support local storage.");return}if(!e.browserSupportsNotifications()){WH.debug("This browser does not support notifications.");return}if(WH.Notifications.Onboarding.isComplete()){WH.debug("Notifications onboarding already complete.");return}if(!window.Notification||Notification.permission==="denied"){WH.debug("Stage 2 is denied.");WH.Notifications.Onboarding.setComplete();return}if(WH.Notifications.Onboarding.isStage1Denied()){WH.debug("Stage 1 is denied.");return}if(WH.Notifications.Onboarding.isStage1Granted()){WH.debug("Stage 1 is granted.");I();return}M()}function b(){WH.debug("Sleeping stage 1.");WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Temporarily closed notifications request");_();WH.Notifications.Onboarding.stage1Sleep()}function S(){WH.debug("Denying stage 1.");WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Declined notifications request");_();WH.Notifications.Onboarding.stage1Deny();WH.Notifications.Onboarding.setComplete()}function y(t){WH.debug("Granting stage 1.");E();WH.Notifications.Onboarding.stage1Grant();if(t===true){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Accepted notifications request");W("accept");if(WH.getDataEnv()!==WH.dataEnv.MAIN||Locale.getId()!==LOCALE_ENUS){WH.Notifications.Onboarding.setComplete();let e=WH.Url.generate("/notifications/settings",{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS});if(Locale.getId()!==LOCALE_ENUS){e+="?locale="+Locale.getId()}let t=WH.ce("form",{action:e,method:"POST"});let a=WH.ce("input",{type:"hidden",name:"accept",value:"1"});WH.ae(t,a);WH.ae(document.body,t);t.submit();return}}I()}function I(){var t=false;e.getSubscription().then((function(e){t=e===null;return navigator.serviceWorker.register(H)})).then((function(e){let a=e.installing||e.waiting||e.active;if(a){if(a.state==="activated"){O(e,t)}else{a.addEventListener("statechange",(function(a){if(a.target.state==="activated"){O(e,t)}}))}}}))["catch"]((function(t){_();WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to register service worker");WH.error("Could not register push notifications service worker.",t);C()}))}function R(t,i){WH.debug("show message",t,i);_();let n=WH.ce("div",{className:a});n.dataset.dialog=t;let s=WH.ce("div",{className:a+"-message"},WH.ct(i));WH.ae(n,s);let r=WH.ce("div",{className:a+"-buttons"});WH.ae(n,r);WH.ae(r,WH.ce("button",{className:"btn btn-site "+a+"-buttons-close",onclick:function(){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Closed "+t+"message");_()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,n)}function N(t){WH.debug("Saving subscription...");return $.ajax({url:WH.Url.generatePath("/notifications/subscribe"),method:"POST",type:"json",data:{subscription:JSON.parse(JSON.stringify(t)),platform:window.navigator.platform,userAgent:window.navigator.userAgent},success:function(t){WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Saved push subscription on backend");WH.debug("Save successful.");g.newSubInfo=t;WH.Notifications.Onboarding.setComplete()}})}function w(e,t){$.ajax({url:WH.Url.generatePath("/notifications/save-subscription-settings"),method:"post",data:{id:g.newSubInfo.id,endpointUrl:g.newSubInfo.endpoint,name:e,newsGroups:t},complete:function(){WH.debug("Saved the sub name as",e);_();g.newSubInfo.name=e;g.newSubInfo.groups=t;L()}})}function A(){WH.debug("Showing ask-for-name popup");WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Requesting device name after subscribing");_();let t=WH.ce("div",{className:a});t.dataset.dialog="ask-for-name";let n=WH.TERMS.notificationsDeviceName_tip;let s=WH.ce("div",{className:a+"-message"},WH.ct(n));WH.ae(t,s);let r=WH.ce("div",{className:a+"-form"});WH.ae(t,r);let o=WH.ce("input",{name:"name",placeholder:WH.TERMS.name,type:"text"});WH.ae(r,o);let l=WH.ce("div",{style:{verticalAlign:"top"}});WH.ae(l,WH.ct(WH.TERMS.newsGroup+WH.TERMS.colon_punct));WH.ae(l,WH.ce("br"));WH.ae(l,e.getNewsGroupsOptions(0,[i]));WH.ae(r,l);let c=WH.ce("div",{className:a+"-buttons"});WH.ae(t,c);let u=function(){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Saved device name after subscribing");let t=[];let a=WH.qsa('input[name*="newsGroups"]',l);for(let e=0;e<a.length;e++){let i=a[e];if(i.checked){t.push(i.dataset.group)}}w(o.value,t);W("save")};WH.aE(o,"keydown",(function(e){if(e.key==="Enter"){u()}}));let d=WH.ce("button",{className:"btn btn-site "+a+"-buttons-save",onclick:u,type:"button"},WH.ct(WH.TERMS.save));WH.ae(c,d);WH.ae(c,WH.ce("button",{className:"btn "+a+"-buttons-close",onclick:function(){WH.Track.interactiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Closed device settings dialog after news sub");_();L()},type:"button"},WH.ct(WH.TERMS.close)));WH.ae(document.body,t);o.focus()}function M(){if(WH.Notifications.Onboarding.isStage1Sleeping()){WH.debug("Stage 1: sleeping");return}WH.debug("Showing stage1 popup");WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_EVENT_NEWS_PUBLISHED,"Showing notifications request to user");let t=WH.ce("div",{className:a});t.dataset.dialog="stage-1";let i=WH.ce("div",{className:a+"-message"},WH.ct(WH.TERMS.enableNewsNotifications_tip));WH.ae(t,i);let n=WH.ce("div",{className:a+"-buttons"});WH.ae(t,n);let s=y.bind(null,true);WH.ae(n,WH.ce("button",{className:a+"-buttons-accept btn btn-site",onclick:s,type:"button"},WH.ct(WH.TERMS.accept)));WH.ae(n,WH.ce("button",{className:a+"-buttons-decline btn",onclick:S,type:"button"},WH.ct(WH.TERMS.decline)));WH.ae(n,WH.ce("button",{className:a+"-buttons-maybe-later btn",onclick:b,type:"button"},WH.ct(WH.TERMS.maybeLater)));WH.ae(document.body,t)}function C(){if(t.get(t.KEY_NOTIFICATIONS_ERROR_SHOWN)){return}R("subscription-error",WH.TERMS.notificationsSubscriptionFailed_tip);t.set(t.KEY_NOTIFICATIONS_ERROR_SHOWN,true)}function O(t,a){WH.debug("Subscribing with reg:",t);t.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:WH.getPageData("notifications.public-key")}).then((function(e){if(!e){throw"Did not find subscription"}WH.debug("Got subscription:",e,JSON.stringify(e));return N(e)})).then((function(e){_();if(e&&WH.User.isLoggedIn()&&a){A()}else{L()}}))["catch"]((function(t){_();WH.Track.nonInteractiveEvent(e.GA_CATEGORY,e.GA_ACTION_DELIVERY_WEB_PUSH,"Failed to subscribe");WH.error("Could not subscribe user to push notifications.",t);C()}))}function L(){if(g.postSubscriptionCallback){g.postSubscriptionCallback()}}WH.onLoad(T)};WH.Notifications.Onboarding=new function(){const e=WH.LocalStorage;const t={complete:false,stage1SleepTime:0};const a="denied";const i="granted";this.isComplete=function(){if(WH.getCookies("notifications")==="1"||n().complete){WH.debug("Onboarding already complete, so setting both cookie and LS.");this.setComplete()}return n().complete};this.isStage1Denied=function(){return n().stage1Status===a};this.isStage1Granted=function(){return n().stage1Status===i};this.isStage1Sleeping=function(){return n().stage1SleepTime>WH.Time.unix()};this.setComplete=function(){WH.debug("Marking onboarding complete.");let e=n();e.complete=true;s(e);if(!WH.getCookies("notifications")){WH.setCookie("notifications",3650,"1","/",".wowhead.com")}};this.stage1Deny=function(){let e=n();e.stage1Status=a;s(e)};this.stage1Grant=function(){let e=n();e.stage1Status=i;s(e)};this.stage1Sleep=function(){let e=n();e.stage1SleepTime=WH.Time.unix()+WH.Time.SEC_DAY*3;s(e)};this.stage1Wake=function(){let e=n();e.stage1SleepTime=0;s(e)};function n(){return e.get(e.KEY_NOTIFICATIONS_ONBOARDING)||t}function s(t){e.set(e.KEY_NOTIFICATIONS_ONBOARDING,t)}};WH.Page=new function(){this.init=function(){for(let e in WH.Page){if(WH.Page.hasOwnProperty(e)&&WH.Page[e]._init){WH.Page[e]._init()}}};this.commentsLocked=function(){return e().commentsLocked===true};this.getId=function(){return e().entityId};this.getType=function(){return e().entityType};function e(){return WH.getPageData("page.info")||{}}};WH.Paperdoll=new function(){this.BONUS_INDEX_START=11;this.EQUIPSET_MAX_BONUSES=16;this.TIMEWALKER_LEVEL_INDEX=28};WH.convertRawItemDataForPaperdoll=function(e){var t={};t.slotId=e[0];t.itemId=e[1];t.transmogId=e[9];t.hidden=e[10];t.rawBonuses=e.slice(WH.Paperdoll.BONUS_INDEX_START,WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES);t.bonuses=[];for(var a in t.rawBonuses){if(t.rawBonuses.hasOwnProperty(a)&&t.rawBonuses[a]){t.bonuses.push(t.rawBonuses[a])}}return t};WH.convertPaperdollItemDataToRaw=function(e){var t=[];for(var a=0;a<WH.Paperdoll.BONUS_INDEX_START+WH.Paperdoll.EQUIPSET_MAX_BONUSES;a++){t[a]=0}t[0]=e.slotId;t[1]=e.itemId;t[9]=e.transmogId?e.transmogId:0;t[10]=e.hidden?e.hidden:0;t[WH.Paperdoll.BONUS_INDEX_START]=e.itemBonus?e.itemBonus:0;return t};var PoundChecker=new function(){var e=null;var t=null;var a=1e3;var i=function(){if(!t){PoundChecker.stop();return}if(location.hash)t()};this.start=function(n,s){if(t){if(WH.isDev())alert("Multiple pound checkers are bad, mmkay?");return}t=n;if(s)a=s;e=setInterval(i,a)};this.stop=function(){clearInterval(e);e=t=null;a=1e3};this.pause=function(){clearInterval(e)};this.resume=function(){if(t)e=setInterval(t,a)}};WH.Profiler=new function(){const e=this;this.create=function(t,a,i,n,s){if(!t||typeof t!=="string"||!a||typeof a!=="string"||!i||typeof i!=="string"){if(n===true){alert(WH.TERMS.filloutdetails_tip)}if(s){return}(new Dialog).show("fetchlist",{data:{region:t,realm:a,character:i},onSubmit:function(t){e.create(t.region,t.realm,t.character,true,false);return false}});return}location.href=WH.Url.generatePath("/list/"+WH.Strings.slug(t+"-"+a+"-"+i,true))};this.getAvatarUrl=function(e){if(e.region){if(e.thumbnail){return WH.BlizzardApi.getCharacterThumbnailUrl(e.region,e.thumbnail)}else if(e.race&&(e.gender===0||e.gender===1)){return"https://"+e.region.toLowerCase()+".battle.net/wow/static/images/2d/avatar/"+e.race+"-"+e.gender+".jpg"}}return null};this.getFavorite=function(){var e=null;if(g_user.lists instanceof Array){for(var t=0,a=g_user.lists.length;t<a;t++){if(g_user.lists[t].pinned&&(e===null||new Date(g_user.lists[t].updated)>new Date(e.updated))){e=g_user.lists[t]}}}return e};this.getMenuItem=function(e,t){var a={className:e.mode!=1||e.armory&&!e.errcode?"listmanager-mode"+e.mode:"q10"};if(t&&e.region){var i=WH.Profiler.getAvatarUrl(e);if(i){a.armory=i}}if(!a.armory&&e.mode==1&&e.pinned){a.fontIcon="thumb-tack"}return[e.id,e.name,WH.Profiler.getPath(e),null,a]};this.getPath=function(e){return WH.Url.generatePath("/list="+e.id+(e.url?"/"+e.url:""))};function t(){Menu.setItemUrl(Menu.findItem(Menu.getMenu("lists"),[101]),e.create)}t()};function li_onSaveTab(xhr,opt){var text=xhr.responseText;if(text.charAt(0)!="{"||text.charAt(text.length-1)!="}"){return}var list=null;try{list=JSON&&JSON.parse(text)||eval(text)}catch(e){return}if(!list||!list.id){return}return list}function li_getCurrentUserList(e){if(g_user.lists&&g_user.lists.length){for(var t in g_user.lists){if(g_user.lists[t].id==e){return g_user.lists[t]}}}return null}function li_getListStatus(id,onSuccess){new Ajax("/list&status="+id+"&t="+Math.random(),{method:"POST",onSuccess:function(xhr,opt){var response=eval(xhr.response)[0];if(!response.id)return;li_setButtonStatus(WH.ge("list-status"),response);if(response.refresh){setTimeout(li_getListStatus,response.refresh,id,onSuccess);return}if(response.status==3&&onSuccess)onSuccess()}})}function li_setButtonStatus(e,t){var a=t.statusText;var i=$("#list-delete");i.hide();if(t.errcode>0){a=WH.term("parens_format",t.errorText,"#"+t.errcode);i.show()}var n="";if(t.status==1||t.status==2){e.blur();n=" fa-spin";if(t.position===0){a+=WH.TERMS.colon_punct+WH.TERMS.nextInLine}else{a+=WH.TERMS.colon_punct+WH.sprintf(WH.TERMS.inline_format,WH.numberFormat(t.position))}}if(e){var s=" btn-";switch(t.status){case 1:case 2:s+="warning";break;case 3:s+="success";break;case 4:s+="danger";break;case 0:default:s+="primary"}e.className=e.className.replace(/ +btn-[^ ]+\b/,s).replace(/( fa-spin)?( +status-[^ ]+\b)?/,n+" status-"+t.status);e.innerHTML=a;if(t.errcode==104){WH.ae(e,WH.ce("div",{style:{padding:"1em",textAlign:"left"}},WH.BlizzardApi.getNotFoundMessage()))}}}function li_updateRealmSelect(e,t){WH.ee(t);var a=WH.Wow.Realm.getAll();if(!a){WH.ae(t,WH.ce("option",{},WH.ct(WH.TERMS.loading_ellipsis)));a={};WH.Wow.Realm.fetchData(li_updateRealmSelect.bind(null,e,t))}WH.ae(t,WH.ce("option"));if(!a[e]){return}var i=[];for(var n in a[e]){if(!a[e].hasOwnProperty(n)){continue}i.push(a[e][n])}i.sort((function(e,t){return e.name.localeCompare(t.name)}));for(var s,r=0;s=i[r];r++){if(s.name.indexOf(s.name_enus)>=0){continue}var o=WH.ce("option");o.value=s.name_enus;WH.st(o,s.name);WH.ae(t,o)}i.sort((function(e,t){return e.name_enus.localeCompare(t.name_enus)}));for(var s,r=0;s=i[r];r++){var o=WH.ce("option");o.value=s.name_enus;WH.st(o,s.name_enus);WH.ae(t,o)}}Dialog.templates.createlist={title:WH.TERMS.createnewlist,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"name",label:WH.TERMS.name,required:1,type:"text"}]};Dialog.templates.fetchlist={title:WH.TERMS.lookupblizzardbattlenetprofile,width:400,buttons:[["check",WH.TERMS.ok],["x",WH.TERMS.cancel]],fields:[{id:"region",label:WH.TERMS.region,required:1,type:"select",options:{US:"US",EU:"EU",KR:"KR",TW:"TW"},compute:function(e,t,a,i,n,s){e.id="dialog-region";$(e).change((function(){li_updateRealmSelect($(this).val(),$("#dialog-realm").get(0))}))}},{id:"realm",label:WH.TERMS.realm,required:1,type:"select",options:[],compute:function(e,t,a,i,n,s){e.id="dialog-realm";li_updateRealmSelect($("#dialog-region").val(),e)}},{id:"character",label:WH.TERMS.character,required:1,type:"text"}]};var ProgressBar=function(e){this.opts={text:"",hoverText:"",color:"rep6",width:0,progress:0};this.elements={text:null,hoverText:null,textContainer:null,progress:null,container:null};WH.cO(this.opts,e);this.build()};ProgressBar.prototype.build=function(){var e=$("<a/>",{class:"progressbar",href:"javascript:"});if(this.opts.width>0)e.css("width",this.opts.width+"px");else e.css("width","auto");var t=$("<div/>",{class:"progressbar-text"});if(this.opts.text){this.elements.text=$("<del/>",{text:this.opts.text});t.append(this.elements.text)}if(this.opts.hoverText){this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});t.append(this.elements.hoverText)}e.append(t);var a=$("<div/>",{class:"progressbar-"+this.opts.color,css:{width:this.opts.progress+"%"},text:WH.Strings.nbsp});e.append(a);if(this.opts.text)t.append($("<div/>",{class:"progressbar-text progressbar-hidden",text:this.opts.text}));this.elements.container=e;this.elements.progress=a;this.elements.textContainer=t;return e};ProgressBar.prototype.setText=function(e){this.opts.text=e;if(this.elements.text)this.elements.text.text(this.opts.text);else{this.elements.text=$("<del/>",{text:this.opts.text});if(this.opts.hoverText)this.opts.hoverText.before(this.elements.text);else this.elements.textContainer.append(this.elements.text)}};ProgressBar.prototype.setHoverText=function(e){this.opts.hoverText=e;if(this.elements.hoverText)this.elements.hoverText.text(this.opts.hoverText);else{this.elements.hoverText=$("<ins/>",{text:this.opts.hoverText});this.elements.textContainer.append(this.elements.hoverText)}};ProgressBar.prototype.setProgress=function(e){this.opts.progress=e;this.elements.progress.css("width",this.opts.progress+"%")};ProgressBar.prototype.setWidth=function(e){this.opts.width=e;if(this.opts.width>0)this.elements.container.css("width",this.opts.width+"px");else this.elements.container.css("width","auto")};ProgressBar.prototype.getText=function(){return this.opts.text};ProgressBar.prototype.getHoverText=function(){return this.opts.hoverText};ProgressBar.prototype.getWidth=function(){return this.opts.width};ProgressBar.prototype.getContainer=function(){return this.elements.container};WH.Raidbots=new function(){this.createForm=function(i){var n=WH.ce("form",{action:"https://www.raidbots.com/simbot/"+i,method:"get",className:"raidbots-form"});var s=WH.ce("select",{name:"region"});WH.ae(s,e(WH.TERMS.region));var r=WH.ce("select",{name:"realm"});WH.ae(r,e(WH.TERMS.realm));WH.ae(r,e(WH.TERMS.selectRegion_tip,false));WH.aE(s,"change",t.bind(this,r,s));var o=WH.ce("input",{type:"text",name:"name",placeholder:WH.TERMS.characterName,required:true});WH.aE(r,"change",(function(){o.focus()}));var l=WH.ce("button",{className:"fa fa-external-link",type:"submit"});WH.st(l,WH.TERMS.submit);WH.ae(n,s);WH.ae(n,r);WH.ae(n,o);WH.ae(n,l);WH.Wow.Realm.fetchData(a.bind(this,s,r));return n};function e(e,t){var a=WH.ce("option",{disabled:true,selected:typeof t==="boolean"?t:true,required:true});WH.st(a,e);return a}function t(a,i,n){var s=WH.Wow.Realm.getAll();if(!s){WH.Wow.Realm.fetchData(t.bind(this,a,i));return}WH.ee(a);var r=i.options&&i.options[i.selectedIndex]?i.options[i.selectedIndex].value:null;if(r===null){WH.ae(a,e("Invalid region",false));return}if(!s[r]){WH.ae(a,e("No realms found for that region ("+r+")",false));return}WH.ae(a,e(WH.Strings.sprintf(WH.TERMS.realms_format,r)));var o=[];for(var l in s[r]){if(s[r].hasOwnProperty(l)&&s[r][l]){o.push(s[r][l])}}o.sort((function(e,t){return e.name.localeCompare(t.name)}));for(var c=0,u=o.length;c<u;c++){var d=o[c];var f=WH.ce("option",{value:d.slug});WH.st(f,d.name);WH.ae(a,f)}if(typeof n==="undefined"||n){a.focus()}}function a(i,n){var s=WH.Wow.Realm.getAll();if(!s){WH.Wow.Realm.fetchData(a.bind(this,i,n));return}WH.ee(i);WH.ae(i,e(WH.TERMS.region));var r=[];for(var o in s){r.push(o)}r.sort();for(var l=0,c=r.length;l<c;l++){var u=WH.ce("option",{value:r[l],selected:r[l].toUpperCase()==="US"});WH.st(u,r[l]);WH.ae(i,u)}t(n,i,false)}};WH.Responsive=new function(){const e=this;const t=WH.Device;this.BREAKPOINTS={MOBILE_MODE:767};this.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT=768;this.SIDEBAR_REMOVAL_BREAKPOINT=1200;const a={height:250,width:970};const i={height:90,width:728};const n={height:250,width:300};const s=1340;const r=1098;const o=768;const l=370;const c={testCount:0};this.adjustByScrollSize=function(e,t,a,i){const n=0;const s=Number.MAX_SAFE_INTEGER;const r=1;const o=2;let l=n;let c=s;let u=i?"clientHeight":"clientWidth";let d=i?"scrollHeight":"scrollWidth";let f;let h;let p=()=>h=h||requestAnimationFrame((()=>{h=null;let i=e[u];if(i<=l){if(f!==r){t();f=r}return}if(f!==o){a();f=o}if(i>=c){return}if(e[d]>i){t();f=r;l=i}else{c=Math.min(c,i)}}));let m=()=>{WH.aE(e,"resize",p);WH.qsa(":scope > *",e).forEach((e=>WH.aE(e,"resize",(()=>{l=n;c=s;p()}))));p()};if(document.fonts.status==="loaded"){m()}else{document.fonts.ready.then(m)}};this.initPrimis=()=>{u.initPrimis()};this.setFloating=e=>{u.setFloating(e)};this.test=()=>{c.testCount++;d.test();u.test();f.test()};var u=new function(){const e=this;var t=["db-action-buttons"];var a=["announcement","infobox-original-position","lntlwentlsdn35"];const i={elements:{bodyPosition:undefined,container:undefined,pagePosition:undefined,staticPosition:undefined},allowFloating:true,floating:false,primisPlayer:undefined,vidazooWidget:undefined};this.initPrimis=()=>{WH.aE(window,"readyConfigPlayerApi",(function(e){e.detail.setConfig({floatInitialStatus:"disable"})}));WH.aE(window,"primisPlayerInit",(function(e){if(e.detail.playerApiId==="wowheadPrimisPlayer"){i.primisPlayer=e.detail}}))};this.setFloating=e=>{if(WH.Url.getPathCommand()==="/ads"){console.debug("Setting floating to:",e)}i.floating=e;if(window.aclreFloatingModeToggle){window.aclreFloatingModeToggle(e)}if(window.connatix_api){if(e){window.connatix_api.enableFloatingMode()}else{window.connatix_api.disableFloatingMode()}}l(e);if(i.primisPlayer){i.primisPlayer.float(e?"enable":"disable")}};this.test=function(){if(!WH.WAS.showAds()){return}if(!i.elements.container){if(i.elements.container===false){return}i.elements.container=WH.ge("video-pos-inner");if(!i.elements.container){return}}if(!i.elements.staticPosition){i.elements.staticPosition=WH.ge("video-pos-static")}if(i.elements.pagePosition==null){i.elements.pagePosition=WH.ge("video-pos-page");if(i.elements.pagePosition){if(i.elements.staticPosition){WH.de(i.elements.staticPosition)}if(i.elements.bodyPosition){WH.de(i.elements.bodyPosition)}i.elements.staticPosition=i.elements.pagePosition;i.elements.bodyPosition=i.elements.pagePosition}else if(document.readyState==="complete"){i.elements.pagePosition=false}}n();if(!i.elements.bodyPosition&&!i.elements.staticPosition){return}var t=i.elements.container.parentNode.id;let a;if(!i.responsiveAdRow){i.responsiveAdRow=WH.qs("#main > .blocks")}let s=i.responsiveAdRow.getBoundingClientRect().width<=o?i.elements.bodyPosition:i.elements.pagePosition||i.elements.staticPosition;if(s){let e=!i.allowFloating;if(!e){let t=document.documentElement.scrollTop;let a=s.getBoundingClientRect().top+t;e=t<a}if(e){a=s}}let r=!a;if(i.floating!==r){e.setFloating(r)}if(a&&t!==a.id){WH.ae(a,i.elements.container);if(window.aclrePlayerMoved){aclrePlayerMoved()}}};function n(){if(i.elements.bodyPosition){return}if(i.elements.bodyPosition=WH.ge("video-pos-body")){return}var e=WH.ge("main-contents");if(!e){return}var t=s(e);if(!t){return}i.elements.bodyPosition=WH.ce("div",{id:"video-pos-body"});t.parentNode.insertBefore(i.elements.bodyPosition,t.nextSibling);WH.WAS.logFallbackPosition()}function s(e){e:for(var i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];if(!n||n.nodeType!==Node.ELEMENT_NODE||n.tagName==="SCRIPT"||n.tagName==="NOSCRIPT"){continue}if(n.id){for(var r=a.length,o=0;o<r;o++){if(n.id.indexOf(a[o])===0){continue e}}}if(n.className){for(var l=t.length,c=0;c<l;c++){if(n.className.match(new RegExp("\\b"+t[c]+"\\b"))){continue e}}}if(!$(n).is(":visible")){continue}if(i+1===e.childNodes.length){break}if(n.classList.contains("text")){return s(n)}return n}return null}function r(){WH.aE(window,"vidazooWidgetReady",(e=>{i.vidazooWidget=e.detail;i.vidazooWidget.on("closeClick",(()=>i.allowFloating=false));l(i.floating)}))}function l(e){if(!i.vidazooWidget){return}if(WH.Url.removePathPrefixes(location.pathname)==="/ads"){WH.debug("Setting vidazoo float to:",e)}if(e){i.vidazooWidget.enableFloat()}else{i.vidazooWidget.disableFloat()}}r()};var d=new function(){var a;this.test=function(){if(!a&&(document.readyState!=="complete"||c.testCount<5)){a=WH.ge("infobox-alternate-position")}var e=$(".infobox");i(e);n(e)};function i(t){if(!a||!t.length){return}var i=t.closest(".interior-sidebar");if(i.length){if(window.innerWidth<e.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){i.appendTo(a)}else if(!i.parent().hasClass("interior-sidebar-parent")){$(".interior-sidebar-parent").prepend(i)}}else{if(window.innerWidth<=e.INTERIOR_SIDEBAR_REMOVAL_BREAKPOINT){t.appendTo(a)}else if(t.parent().attr("id")!=="infobox-original-position"){$("#infobox-original-position").append(t)}}}function n(e){let a=window.innerWidth-54;if(!t.isTouch()){a-=20}$(".icon-db-link div",e).each((function(){this.style.width="auto";window.requestAnimationFrame(function(){this.style.width=Math.min(a,this.parentNode.offsetWidth)+"px"}.bind(this))}))}};let f=new function(){const e={currentAdBreakpoint:undefined};this.test=function(){if(!WH.WAS.showAds()){return}if(!e.currentAdBreakpoint){t();c()}else{let a=e.currentAdBreakpoint;t();if(a!==e.currentAdBreakpoint){c()}}};let t=function(){if(!e.responsiveAdRow){e.responsiveAdRow=WH.qs("#main > .blocks")}let t=e.responsiveAdRow.getBoundingClientRect().width;let i=t;let n=WH.WAS.hasVideo();if(!n){t+=l}if(i<=o){e.currentAdBreakpoint=o}else if(t<r){e.currentAdBreakpoint=r}else if(t<s){e.currentAdBreakpoint=s}else{e.currentAdBreakpoint=s+1}if(e.currentAdBreakpoint<=s&&t>=a.width&&n&&WH.WAS.isSkinned()){WH.WAS.removeVideo(false);e.currentAdBreakpoint=s+1}};let c=function(){if(e.currentAdBreakpoint===o){WH.WAS.remove("responsive");WH.de(WH.qs("#main > .blocks"));return}let t=WH.qs(".block-pair",e.responsiveAdRow);let l;if(e.currentAdBreakpoint===r){l=n}else if(e.currentAdBreakpoint===s){l=i}else{l=a}e.responsiveAdRow.dataset.zafMaxDimensions=`${l.width}x${l.height}`;WH.WAS.assign("responsive",t,l)}};$(window).scroll(u.test)};$(window).resize(WH.Responsive.test);WH.Screenshots=new function(){const e=WH.User;const t=this;this.ROLE_GALLERY_ADMIN=e.ROLE_ADMIN|e.ROLE_BUREAU|e.ROLE_SALES_AGENT|e.ROLE_BLOGGER|e.ROLE_EDITOR|e.ROLE_VIDEO;const a=Object.seal({warnedAboutStaffOnlyScreenshots:false});this.showStaffOnlyWarning=function(){if(!e.hasRole(t.ROLE_GALLERY_ADMIN)||a.warnedAboutStaffOnlyScreenshots){return}const i=WH.Admin.Debug;i.warn(i.TYPE_MESSAGE,"Markup on this page contains staff-only screenshots which the public cannot see.");a.warnedAboutStaffOnlyScreenshots=true}};function ss_submitAScreenshot(){tabsContribute.focus(1)}function ss_validateForm(e){if(!e.elements["screenshotfile"].value.length){alert(WH.TERMS.selectscreenshot_tip);return false}return true}function ss_appendSticky(){let e=WH.ge("infobox-sticky-ss");if(!e){return}let t=WH.inArray(lv_screenshots,1,(function(e){return e.sticky}));if(t<0&&lv_screenshots.length){t=0;for(let e=1;e<lv_screenshots.length;e++){if(Date.parse(lv_screenshots[e].date)>Date.parse(lv_screenshots[t].date)){t=e}}}if(t!=-1){e.className="has-thumb";let a=lv_screenshots[t];let i=WH.ce("a");i.href="#screenshots:id="+a.id;i.onclick=function(e){ScreenshotViewer.show({screenshots:lv_screenshots,pos:t});return WH.rfWithoutControlKey(e)};let n=[300,300];let s=WH.ce("img");let r=Math.min(n[0]/a.width,n[1]/a.height);s.src=WH.getScreenshotUrl(a.id,"small",{imageType:a.imageType});s.width=Math.round(r*a.width);s.height=Math.round(r*a.height);s.className="border";WH.ae(i,s);WH.ae(e,i);$("#infobox-screenshots").append(" ("+lv_screenshots.length+")").wrapInner($('<a href="#screenshots"></a>').click((function(){tabsRelated.focus(tabsRelated.getTabById("screenshots"));return false})))}else{let t=WH.ce("div");let a=WH.ce("a",{href:"javascript:"},WH.ct(WH.TERMS.submitone_stc));if(!g_user.id){a.href=WH.Url.generatePath(WH.Url.getLoginPath())}t.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,a.outerHTML);if(g_user.id>0){a=t.querySelector("a");WH.aE(a,"click",(function(){ss_submitAScreenshot()}))}WH.ae(e,t);let i=WH.Wow.ModelViewer.getModelScreenshotUrl();if(i){let t=WH.ce("img",{src:i,width:300,height:300,className:"border",style:{display:"none"},id:"sticky-screenshot-model-substitute"});WH.aE(t,"load",(function(){t.style.display="";e.classList.add("has-thumb-substitute")}));WH.aE(t,"error",(function(){t.style.display="none";e.classList.remove("has-thumb-substitute")}));WH.ae(e,t)}}ss_appendSticky=function(){}}var g_screenshots={};window.ScreenshotViewer=new function(){const e=WH.Device;const t=WH.DOM;const a=170-Lightbox.BLEED_SIZE;const i=20;const n=50;var s,r,o,l,c,u,d,f=0,h,p,m,H,g,W,E,_,v,T,b,S,y,I="screenshots";function R(e){var t=s[e],a="#"+I;if(f==0)a+=t?":id="+t.id:"";else a+=":"+h+":"+(t?e+1:e+.5);return a}function N(e){var t="";if(typeof g_gathered_types=="object"&&g_gathered_types[e.type]&&g_gathered_types[e.type][e.typeId]&&g_gathered_types[e.type][e.typeId]["name_"+Locale.getName()]){t=g_gathered_types[e.type][e.typeId]["name_"+Locale.getName()]}else if(typeof g_pageInfo=="object"&&g_pageInfo.type&&g_pageInfo.typeId&&g_pageInfo.name){t=g_pageInfo.name}if(e.caption){if(t){t+=WH.TERMS.hyphen_punct+e.caption}else{t=e.caption}}return t}function w(t){clearTimeout(y);U();if(t&&!u&&window.innerHeight>p.offsetHeight+Lightbox.BLEED_SIZE){return}p.style.visibility="hidden";var a=s[r];var i=N(a);var n=a.url||WH.getScreenshotUrl(a.id,"normal",{description:i,imageType:a.imageType,staffOnly:a.staffOnly});var d='<img src="'+n+'"'+' width="'+l+'"'+' height="'+c+'"'+">";H.innerHTML=d+'<div class="screenshotviewer-image-inner" style="padding-top:'+c/l*100+'%"></div>';if(!t){WH.Track.interactiveEvent("Screenshots","Show",a.id+(a.caption&&a.caption.length?" ("+a.caption+")":""));if(a.url){_.href=n;_.style.display="block"}else{_.href=WH.getScreenshotUrl(a.id,"normal",{description:i,imageType:a.imageType,staffOnly:a.staffOnly});_.style.display="block"}if(!a.user&&typeof g_pageInfo=="object")a.user=g_pageInfo.username;var f=a.date&&a.user,h=s.length>1;if(f){var m=new Date(a.date),b=(WH.getServerTime()-m)/1e3;var S=v.firstChild.childNodes[1];S.href=WH.Url.generatePath("/user="+a.user);S.innerHTML=a.user;var I=v.firstChild.childNodes[3];WH.ee(I);I.removeAttribute("class");I.removeAttribute("title");WH.formatDate(I,b,m);v.firstChild.title=WH.TERMS.from+a.user+" "+WH.formatDate(null,b,m);v.firstChild.style.display=""}else v.firstChild.style.display="none";var I=v.childNodes[1];WH.ee(I);if(a.user){if(f)WH.ae(I,WH.ct(" "+WH.TERMS.dash_punct+" "));var S=WH.ce("a");S.href="javascript:";S.onclick=ContactTool.show.bind(ContactTool,{mode:3,screenshot:a});S.className="fa fa-exclamation-triangle fa-size-s";WH.Tooltip.simple(S,WH.TERMS.reportingoptions_tip,"q2");WH.ae(S,WH.ct(WH.TERMS.report));WH.ae(I,S)}I=v.childNodes[2];if(h){var w="";if(a.user)w=WH.TERMS.dash_punct;if(r%1!=0){w+=WH.sprintf(WH.TERMS.advertisementbetweenimages_tip,r+.5,r+1.5,s.length)}else{w+=r+1+WH.TERMS.of_lc+s.length}I.innerHTML=w;I.style.display=""}else I.style.display="none";v.style.display=f||h?"":"none";if(Locale.getId()!=LOCALE_ENUS&&a.caption)a.caption="";var M=a.caption!=null&&a.caption.length;var C=a.subject!=null&&a.subject.length&&a.type&&a.typeId;if(M||C){d="";if(C){var O=WH.ce("div");WH.ae(O,WH.ct(WH.Types.getUpperSingular(a.type)+WH.TERMS.colon_punct));WH.ae(O,WH.ce("a",{href:WH.Entity.getUrl(a.type,a.typeId)},WH.ct(a.subject)));d+=O.innerHTML}var L=document.createDocumentFragment();if(M){if(C){d+=WH.TERMS.dash_punct}L=a.noMarkup?document.createTextNode(a.caption):WH.markup.getDomFragment(a.caption,{mode:WH.markup.MODE.SIGNATURE})}$(T).html(d).append(L);T.style.display=""}else T.style.display="none";if(s.length>1){W.href=R(A(-1));E.href=R(A(1));W.style.display=E.style.display=""}else{W.style.display=E.style.display="none"}if(r!==o||e.isTouch()){g.style.display="none"}location.replace(R(r))}Lightbox.reveal();p.style.visibility="visible"}function A(e){var t=r;t+=e;if(t<0)t=s.length-1;else if(t>=s.length)t=0;return t}function M(e){r=A(e);D();return false}function C(e){switch(e.keyCode){case 37:M(-1);break;case 39:M(1);break}}function O(){w(1)}function L(){P();if(s.length>1)WH.dE(document,"keyup",C);if(d&&f==0){if(d.indexOf(":id=")!=-1)d="#"+I;WH.setHash(d)}else WH.clearHash()}function k(e,t,a){if(typeof a.screenshots=="string"){s=g_screenshots[a.screenshots];f=1;h=a.screenshots}else{s=a.screenshots;f=0;h=null}p=e;r=0;if(a.pos&&a.pos>=0&&a.pos<s.length)r=a.pos;o=r;if(t){e.className+=" has-lightbox-caption screenshotviewer";m=WH.ce("div");m.className="lightbox-content screenshotviewer-screen";g=WH.ce("div");g.className="screenshotviewer-keystip";g.innerHTML=WH.TERMS.sceenshotviewerkeys_tip;WH.ae(e,g);var i=WH.ce("div");var n=WH.ce("div");i.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";n.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";W=WH.ce("a",{ariaLabel:WH.TERMS.previous,className:"screenshotviewer-prev",dataset:{disableWowheadTooltip:"true"},href:"javascript:"});E=WH.ce("a",{ariaLabel:WH.TERMS.next,className:"screenshotviewer-next",dataset:{disableWowheadTooltip:"true"},href:"javascript:"});var l=WH.ce("span");l.className="fa fa-chevron-left";WH.ae(W,l);l=WH.ce("span");l.className="fa fa-chevron-right";WH.ae(E,l);WH.aE(W,"click",M.bind(W,-1));WH.aE(W,"tap",M.bind(W,-1));WH.aE(E,"click",M.bind(E,1));WH.aE(E,"tap",M.bind(E,1));WH.ae(i,W);WH.ae(n,E);WH.ae(m,i);WH.ae(m,n);H=WH.ce("div",{className:"screenshotviewer-image",innerHTML:'<div class="screenshotviewer-image-inner"></div>'});WH.ae(m,H);WH.ae(e,m);var c=WH.ce("a");c.className="dialog-option fa fa-times";c.href="javascript:";c.onclick=Lightbox.hide;WH.ae(c,WH.ct(WH.TERMS.close));WH.ae(e,c);_=WH.ce("a");_.className="dialog-option fa fa-external-link";_.href="javascript:";_.target="_blank";WH.ae(_,WH.ct(WH.TERMS.original));WH.ae(e,_);var u=WH.ce("div",{className:"lightbox-caption"});v=WH.ce("div");v.className="screenshotviewer-from";var b=WH.ce("span");WH.ae(b,WH.ct(WH.TERMS.from));WH.ae(b,WH.ce("a"));WH.ae(b,WH.ct(" "));WH.ae(b,WH.ce("span"));WH.ae(v,b);WH.ae(v,WH.ce("span"));WH.ae(v,WH.ce("span"));WH.ae(u,v);T=WH.ce("div");T.className="screenshotviewer-caption";WH.ae(u,T);WH.ae(e,u)}d=location.hash;if(s.length>1)WH.aE(document,"keyup",C);D()}function D(){var e=s[r];if(e&&(!e.width||!e.height)){if(b){b.onload=null;b.onerror=null}else{p.className="";S=[];while(p.firstChild){S.push(p.firstChild);WH.de(p.firstChild)}}clearTimeout(y);y=setTimeout((function(){e.width=126;e.height=22;U();e.width=null;e.height=null;var t=WH.ce("div");t.className="screenshotviewer-loading";var a=WH.ce("img");a.src=WH.staticUrl+"/images/ui/misc/progress-anim.gif";a.width=126;a.height=22;WH.ae(t,a);WH.ae(p,t);Lightbox.reveal();p.style.visiblity="visible"}),150);b=new Image;b.onload=function(e,t){clearTimeout(t);e.width=this.width;e.height=this.height;b=null;x();w()}.bind(b,e,y);b.onerror=function(e){clearTimeout(e);b=null;Lightbox.hide();x()}.bind(b,y);b.src=e.url||WH.getScreenshotUrl(e.id,"normal",{description:N(e),imageType:e.imageType,staffOnly:e.staffOnly})}else w()}function P(){if(!b)return;b.onload=null;b.onerror=null;b=null;x()}function x(){if(!S)return;WH.ee(p);p.className="lightbox-frame has-lightbox-caption screenshotviewer";for(var e=0;e<S.length;++e)WH.ae(p,S[e]);S=null}function U(){let e=s[r];l=e.width;c=e.height;let o=l;let d=window.innerWidth-Lightbox.BLEED_SIZE-a-i;let f=Math.min(l,d);u=false;if(f<l){u=true;o=f}let h=f*(c/l);let p=h+Lightbox.BLEED_SIZE+n;if(p>window.innerHeight){u=true;let e=window.innerHeight-Lightbox.BLEED_SIZE-n-10;o=e*(l/c)}Lightbox.setSize(Math.floor(o+i));t.setRelativeHeight(WH.qs(".screenshotviewer-image-inner",H),l,c)}this.getScreenshotDescription=function(e){return N(e)};this.checkPound=function(){if(location.hash&&location.hash.indexOf("#"+I)==0){if(!g_listviews[I]){var e=location.hash.split(":");if(e.length==3){var t=g_screenshots[e[1]],a=parseInt(e[2]);if(t&&a>=1&&a<=t.length){ScreenshotViewer.show({screenshots:e[1],pos:a-1,hashname:I})}}}}};this.show=function(e){if("hashname"in e){I=e.hashname;delete e.hashname}Lightbox.show("screenshotviewer",{onShow:k,onHide:L,onResize:O},e)};$(document).ready(this.checkPound)};WH.Seo=new function(){const e={[WH.dataEnv.MAIN]:"live",[WH.dataEnv.PTR]:"ptr",[WH.dataEnv.PTR2]:"ptr",[WH.dataEnv.BETA]:"beta",[WH.dataEnv.CLASSIC]:"classic",[WH.dataEnv.TBC]:"tbcClassic",[WH.dataEnv.D2]:"diablo2",[WH.dataEnv.DI]:"diabloImmortal",[WH.dataEnv.WRATH]:"wrathClassic_short",[WH.dataEnv.D4]:"diablo4_seo"};this.addJsonLdBreadcrumb=function(e){var t=WH.Url.getCanonicalPath().replace(/[?&].*$/,"");var a=false;var i={"@context":"http://schema.org","@type":"BreadcrumbList",itemListElement:[]};var n=function(e,n){var s={"@type":"ListItem",position:e+1,item:{name:n.name}};if(n.url){s.item["@id"]=n.url;if(WH.Url.getPathFromUrl(n.url).indexOf(t)>=0){a=true}}if(n.image){s.item.image=WH.ensureUrlProtocol(n.image)}i.itemListElement.push(s)};for(var s=0,r=e.length;s<r;s++){n(s,e[s])}var o=WH.ge("json-ld-breadcrumbs");if(o){WH.de(o)}if(i.itemListElement.length){if(!a){var l=window.g_pageInfo?g_pageInfo.name:undefined;if(!l){var c=WH.qsa(".heading-size-1");if(c.length===1){l=c[0].textContent}}if(l){n(s,{name:l,url:WH.Url.getCanonical(),image:undefined})}}WH.ae(document.head,WH.ce("script",{id:"json-ld-breadcrumbs",text:JSON.stringify(i),type:"application/ld+json"}))}};this.getDataEnvName=t=>WH.TERMS[e[t]];this.slugId=function(e,t){let a=WH.Strings.slug(t);return(a?a+"-":"")+e.toString()};function t(){var e=WH.qsa('script[type="application/ld+json"]')||[];for(var t=0,a=e.length;t<a;t++){try{var i=JSON.parse(e[t].textContent)}catch(e){continue}if(i.mainEntityOfPage&&i.image&&i.image.url){return i.image.url}}return undefined}function a(){if(!WH.User.hasRole(U_GROUP_ADMIN|U_GROUP_BLOGGER|U_GROUP_EDITOR)&&WH.User.getId()!==1788274&&!WH.isDev()){return}if(WH.PageMeta.skipSeoValidation){return}WH.onLoad(i)}function i(){if(!document.title){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No page title!")}$((function(){setTimeout((function(){if(!WH.PageMeta.skipSeoHeadingValidation&&!WH.qs("h1")){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No H1!")}}),1e3)}));var e=$('meta[name="description"]').attr("content");if(e){var t='[span class="q0"]SEO Description:[/span] '+e.replace("[","\\[");var a=false;if(e.length<130){t+=' [span class="q0"](short)[/span]';a=true}else if(e.length>160){t+=' [span class="q0"](long)[/span]';a=true}if(WH.Strings.hasReplacementValues(e)){WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,t,true)}else if(a){WH.Admin.Debug.warn(WH.Admin.Debug.TYPE_SEO,t,true)}}else{WH.Admin.Debug.error(WH.Admin.Debug.TYPE_SEO,"No SEO description!")}}requestAnimationFrame(a)};WH.ShareServices=new function(){const e=this;this.getShareServices=function(e,a){let i=[];let n=["vkontakte","twitter","facebook","reddit","permalink"];for(let s=0,r=n.length;s<r;s++){let r=n[s];if(r==="vkontakte"&&Locale.getId()!==LOCALE_RURU){continue}let o=WH.ShareServices.getShareUrl(r,e,a);if(o===""){continue}i.push({type:r,name:WH.TERMS[r],url:o,fontIcon:t(r)})}return i};this.getShareUrl=function(e,t,a){let i=encodeURIComponent(t);switch(e){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u="+i;case"reddit":if(a===undefined){return""}return"//www.reddit.com/r/"+a+"/submit?url="+i;case"twitter":return"https://twitter.com/intent/tweet?text=%20"+i+"%20via%20@Wowhead";case"vk":return"https://vk.com/share.php?url="+i;case"permalink":return t}WH.error("Tried to get the URL to share to an unknown service.",e);return""};this.getSubredditByGame=e=>{switch(e){case WH.Game.D2:return"diablo2";case WH.Game.DI:return"DiabloImmortal";case WH.Game.D4:return"diablo4";default:return"wow"}};this.getSubredditByNewsType=function(e){switch(e){case 14:return"diablo2";case 15:return"DiabloImmortal";case 6:case 16:return"diablo4";case 7:return"overwatch";case 11:return"hearthstone";case 12:return"heroesofthestorm";case 13:return"starcraft";case 1:case 2:case 3:case 4:case 5:case 8:case 9:case 10:case 17:case 20:return"wow";case 18:return"warcraftrumble";default:return null}};function t(e){return{vkontakte:"vk",reddit:"reddit-alien",permalink:"link"}[e]||e}};var ShowOnMap=function(e,t,a){const i=this;i.data=e;i.currentPath=[];if(t==null)t=myMapper;i.mapper=t;i._legend=null;i._legendLabel=null;i._legendContents=null;i._legendHorde=null;i._legendAlliance=null;i._menu=[];i._trackingIcons=[];i._controlsdiv=a?$(typeof a=="string"?"#"+a:a):$("#lenrlkn4");i.construct()};ShowOnMap.prototype.onExpand=function(){this.expanded=true;location.replace(this.pound+".map")};ShowOnMap.prototype.onCollapse=function(){this.expanded=false;var e=WH.getHash();if(e.indexOf("#show")==0&&e.indexOf(".map")>0){this.pound=e.substr(0,e.indexOf(".map"));location.replace(this.pound)}};ShowOnMap.prototype.construct=function(){if(!this.data)return;var e=this._controlsdiv;var t=function(e,t){return WH.stringCompare(e[1],t[1])};var a=[];var i=[];for(var n in this.data){if(this.data[n].length===undefined){var s=[];var r=[];var o={};var l=this.data[n];for(var c in l){var u=false;for(var d=0,f=l[c].length;d<f;++d){if(l[c][d].paths){u=true;break}}var h=WH.Strings.slug(c);if(l[c][0].name_enus!==undefined){h=WH.Strings.slug(l[c][0].name_enus)}var p={};var m={};var H=[h];var g=ShowOnMap.combinePins(l[c],false,u);var W=g[0];var E=g[1];var _=0;for(var d=0;d<W.length;++d){var v=W[d];var T=ShowOnMap.buildTooltip(v.list);var b=T[2];var S=null;if(b=="javascript:")S=T[3];if(v.list.length==1){b=WH.Types.getDetailPageName(v.list[0].type)&&v.list[0].id?WH.Entity.getUrl(v.list[0].type,v.list[0].id):""}if(n=="rare"||n=="herb"||n=="vein")T[1]=s.length+1;if(p[v.level]==undefined)p[v.level]=[];p[v.level].push([v.coord[0],v.coord[1],{url:b,label:T[0],menu:S,type:T[1],lines:v.list[0].paths}]);_++}if(_>0){var b=WH.Types.getDetailPageName(l[c][0].type)&&l[c][0].id?WH.Entity.getUrl(l[c][0].type,l[c][0].id):"";m[s.length+1]=[c,b];H.push(c+WH.sprintf(WH.TERMS._paren,E));H.push(this.showStuff.bind(this,p,[n,h],m));s.push(H);for(var y in p){if(r[y])r[y]=r[y].concat(p[y]);else r[y]=p[y]}o[s.length]=[c,b]}}if(s.length>0){s.sort(t);var H=[n,ShowOnMap.getPinTypeName(n),this.showStuff.bind(this,r,[n],o),s];this._menu.push(H);var I=[[null,ShowOnMap.getPinTypeName(n)],["all",WH.TERMS.all,H[2]]];for(x=0;x<s.length;x++)I.push(s[x]);this._trackingIcons.push([n,undefined,o,I])}}else{if(this.data[n].length==0)continue;var u=false;for(var d=0,f=this.data[n].length;d<f;++d){if(this.data[n][d].paths){u=true;break}}var H=[n];var p={};var R={},N={};var w={},A={};var m={};var M={};var C={};var g=ShowOnMap.combinePins(this.data[n],false,u);var E=g[1];var _=0,O=0,L=0,k=0,D=0;var P=function(e,t){for(var a=0;a<t.length;++a){var i=t[a];var s=e;i.list.key=n;var r=ShowOnMap.buildTooltip(i.list,e=="hordedailyquests"||e=="alliancedailyquests"?true:false);var o=r[2];var l=null;if(o=="javascript:")l=r[3];if(i.list.length==1)o=WH.Types.getDetailPageName(i.list[0].type)&&i.list[0].id?WH.Entity.getUrl(i.list[0].type,i.list[0].id):"";var c=[i.coord[0],i.coord[1],{url:o,label:r[0],menu:l,type:r[1],lines:i.list[0].paths}];if(p[i.level]==undefined){p[i.level]=[];R[i.level]=[];N[i.level]=[];w[i.level]=[];A[i.level]=[]}if(i.list[0].mapicon){c[2].mapicon=i.list[0].mapicon}if(s!="mailbox"&&s!="vignettes"&&s!="rare"&&s!="spirithealer"&&s!="book"&&s!="forge"&&s!="treasure"&&s!="anvil"&&s!="hordequests"&&s!="alliancequests"&&s!="hordedailyquests"&&s!="alliancedailyquests"&&s!="boss"){if(r[1]==2||r[1]==0){if(r[1]==2)M[2]=[WH.TERMS.horde,null];else M[0]=[WH.TERMS.neutral,null];R[i.level].push(c);O++}if(r[1]==3||r[1]==0){if(r[1]==3)C[3]=[WH.TERMS.alliance,null];else C[0]=[WH.TERMS.neutral,null];w[i.level].push(c);k++}}else if(s=="hordequests"){s="quest";if(r[1]==2)M[2]=[WH.TERMS.horde,null];else M[0]=[WH.TERMS.neutral,null];R[i.level].push(c);O++}else if(s=="hordedailyquests"){s="daily";if(r[1]==2)M[2]=[WH.TERMS.horde,null];else M[0]=[WH.TERMS.neutral,null];N[i.level].push(c);L++}else if(s=="alliancequests"){s="quest";if(r[1]==3)C[3]=[WH.TERMS.alliance,null];else C[0]=[WH.TERMS.neutral,null];w[i.level].push(c);k++}else if(s=="alliancedailyquests"){s="daily";if(r[1]==3)C[3]=[WH.TERMS.alliance,null];else C[0]=[WH.TERMS.neutral,null];A[i.level].push(c);D++}else{p[i.level].push(c);_++}}return s};var U=P(n,g[0]);if(n=="alliancequests"){var F=ShowOnMap.combinePins(this.data[n],true);if(F[1]>0)P("alliancedailyquests",F[0])}else if(n=="hordequests"){var q=ShowOnMap.combinePins(this.data[n],true);if(q[1]>0)P("hordedailyquests",q[0])}if(U=="rare")E=this.data[U].length;else if(U=="forge"||U=="anvil"||U=="treasure"||U=="mailbox")E=g[0].length;if(_>0){var H=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,E),this.showStuff.bind(this,p,[U],m)];this._menu.push(H);this._trackingIcons.push([U,p,m])}if(O>0){var H=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,O),this.showStuff.bind(this,R,["horde",U],M),null];if(U=="quest"){H.push({tinyIcon:"quest_start"});if(L>0){i.push(H);H=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,L),this.showStuff.bind(this,N,["horde","daily"],M),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",N,M])}}i.push(H);this._trackingIcons.push([U,R,M])}if(k>0){var H=[U,ShowOnMap.getPinTypeName(U)+WH.sprintf(WH.TERMS._paren,k),this.showStuff.bind(this,w,["alliance",U],C),null];if(U=="quest"){H.push({tinyIcon:"quest_start"});if(D>0){a.push(H);H=["daily",WH.TERMS.questgiversdaily+WH.sprintf(WH.TERMS._paren,D),this.showStuff.bind(this,A,["alliance","daily"],C),null,{tinyIcon:"quest_start_daily"}];this._trackingIcons.push(["daily",A,C])}}a.push(H);this._trackingIcons.push([U,w,C])}}}a.sort(t);i.sort(t);this._menu.sort(t);if(i.length>0)this._menu.unshift(["horde",WH.TERMS.horde,"",i,{tinyIcon:"side_horde"}]);if(a.length>0)this._menu.unshift(["alliance",WH.TERMS.alliance,"",a,{tinyIcon:"side_alliance"}]);var Y=[-1,WH.TERMS.nothing,this.showStuff.bind(this,[],[-1],{})];Y.checked=true;this._menu.push(Y);var B=WH.createButton(WH.TERMS.showonmap_ellipsis,null,{class:"mapper-som-button fa fa-search"});Menu.add(B,this._menu,{showAtElement:true});e.append(B);var G;if(!this._legend){this._legend=$("<div/>",{class:"mapper-legend",css:{display:"none"}});var z=$("<div/>",{class:"mapper-legend-container"});this._legendLabel=WH.ce("b",undefined,WH.ct(WH.TERMS.symbolLegend));z.append(this._legendLabel);this._legendContents=$("<div/>",{css:{float:"right"}});z.append(this._legendContents);var G=$("<div/>",{css:{clear:"right"}});z.append(G);this._legend.append(z)}e.append(this._legend);G=$("<div/>",{css:{clear:"left"}});e.append(G);this.setTrackingIcons();var V=[];var K=WH.getHash();if(K.indexOf("#show:")!=-1){V=K.split(".")}else if(this.data.instance){V.push("#show:boss")}if(V.length>0){if(V.length==2&&V[1]=="map"){this.expanded=true;this.mapper.toggleZoom()}var j=V[0].split(":");if(j.length<2)return;var Z=this._menu;for(var d=1;d<j.length;++d){var X=j.length-1;for(var c=0;c<Z.length;++c){if(Z[c][0]==j[d]){if(Z[c][3]&&d<X)Z=Z[c][3];else Z=Z[c];break}}}if(Z&&Z[2]&&jQuery.isFunction(Z[2]))Z[2]()}};ShowOnMap.prototype.setTrackingIcons=function(){var e=this.mapper.parent;var t={repair:"repair",auctioneer:"auctioneer",banker:"banker",battlemaster:"battlemaster",innkeeper:"inn",guildmaster:"guild",stablemaster:"stablemaster",flightmaster:"flightmaster",trainer:"trainer-profession",vendor:"vendor-food",quest:"quest",daily:"daily",anvil:"blacksmithing",herb:"herbalism",vein:"mining",book:"trainer-class",forge:"smelting",spirithealer:"spirithealer",boss:"boss",rare:"hostile-npc",vignettes:"resource",treasure:"treasure",mailbox:"mailbox"};var a=[{name:WH.Types.getUpperPlural(WH.Types.NPC),icons:["repair","auctioneer","banker","battlemaster","innkeeper","guildmaster","stablemaster","flightmaster","trainer","vendor","spirithealer","boss","rare"],elements:[]},{name:WH.Types.getUpperPlural(WH.Types.QUEST),icons:["quest","daily"],elements:[]},{name:WH.GlobalStrings.TRADE_SKILLS,icons:["anvil","herb","vein","book","forge"],elements:[]},{name:WH.TERMS.loot,icons:["vignettes","treasure"],elements:[]},{name:WH.TERMS.other,icons:["mailbox"],elements:[]}];var i=this._trackingIcons;i.sort((function(e,t){return WH.stringCompare(e[0],t[0])}));for(var n=1;n<i.length;n++){if(i[n][0]==i[n-1][0]){var s={};for(var r in i[n][1]){if(!i[n][1].hasOwnProperty(r))continue;s[r]=i[n][1][r]}for(r in i[n-1][1]){if(!i[n-1][1].hasOwnProperty(r))continue;if(!s.hasOwnProperty(r))s[r]=i[n-1][1][r];else s[r]=s[r].concat(i[n-1][1][r])}i[n-1][1]=s;var o={};for(var l in i[n][2]){if(!i[n][2].hasOwnProperty(l))continue;o[l]=i[n][2][l]}for(l in i[n-1][2]){if(!i[n-1][2].hasOwnProperty(l))continue;o[l]=i[n-1][2][l]}i[n-1][2]=o;i.splice(n--,1)}}i.sort((function(e,t){return WH.stringCompare(ShowOnMap.getPinTypeName(e[0]),ShowOnMap.getPinTypeName(t[0]))}));var c=WH.ce("div",{className:"mapper-legend-icons"});for(var u=0,d;d=i[u];u++){if(!t.hasOwnProperty(d[0]))continue;var f=WH.ce("div");f.className="mapper-legend-icon "+t[d[0]];f.setAttribute("data-legend-icon",d[0]);f.onmousedown=WH.rf;if(d[1]){var h=[d[0]];if(d[0]!="vignettes"&&d[0]!="treasure"){h.splice(0,0,-2)}WH.aE(f,"click",this.showStuff.bind(this,d[1],h,d[2],f))}if(d[3]){Menu.add(f,d[3],{showAtElement:true})}WH.Tooltip.simpleNonTouch(f,ShowOnMap.getPinTypeName(d[0]));var p=false;for(var m=0,H;H=a[m];m++){if(H.icons.indexOf(d[0])>-1){p=true;a[m].elements.push(f);break}}if(!p){WH.error("Could not find group for map icon.",d[0])}}for(var g=0,W;W=a[g];g++){if(W.elements.length){var E=WH.ce("div",{className:"mapper-legend-icons-group"});var _=WH.ce("div",{className:"mapper-legend-icons-heading",innerHTML:W.name});var v=WH.ce("div",{className:"mapper-legend-icons-icons"});if(W.style){for(var T in W.style){if(W.style.hasOwnProperty(T)){E.style[T]=W.style[T]}}}for(var b=0,S;S=W.elements[b];b++){WH.ae(v,S)}WH.ae(E,_);WH.ae(E,v);WH.ae(c,E)}}var y=WH.ce("div",{className:"mapper-legend-icons-tip",innerHTML:WH.TERMS.clickicontoshowonmap_tip});$("> span:first-child",this.mapper.parent).append(y);WH.ae(e,c);e.className+=" mapper-autoheight"};ShowOnMap.prototype.setLegend=function(e){this._legendContents.empty();var t=$("<div/>");var a=0;for(var i in e){var n=$("<span/>",{class:"mapper-pin mapper-pin-"+i+" mapper-legend-pin"});if(e[i][1]){var s=$("<a/>",{href:e[i][1],text:e[i][0]});n.append(s)}else n.text(e[i][0]);t.append(n);if(++a%4==0)t.append($("<br/>"))}this._legendContents.append(t)};ShowOnMap.prototype.showStuff=function(e,t,a){if(WH.isEqualSimpleObject(t,this.currentPath)){this.showStuff.call(this,[],[-1],{});return}Menu.hide();var i=false;for(var n=0,s;s=t[n];n++){if(typeof s!="string"){continue}var r=$('[data-legend-icon="'+s+'"]');if(r.length){r.parents(".mapper-legend-icons").find(".mapper-legend-icon").removeClass("active");r.addClass("active");i=true;break}}if(!i){$(".mapper-legend-icon",this.mapper.parent).removeClass("active")}var o={coords:e,preservelevel:true};if(typeof g_pageInfo!="undefined"&&g_pageInfo.hasOwnProperty("id"))o.zone=g_pageInfo.id;this.mapper.update(o);this.setLegend(a);this.checkMenu(t);this.currentPath=t;if(t.length==1&&t[0]==-1||t[0]==-2){this.pound="";WH.clearHash();return}this.pound="#show:"+t.join(":");if(this.pound!="#show:boss")location.replace(this.pound+(this.expanded?".map":""))};ShowOnMap.prototype.clearChecks=function(e){for(var t=0;t<e.length;++t){e[t].checked=false;if(e[t][3]&&e[t][3].length>0)this.clearChecks(e[t][3])}this._legend.hide()};ShowOnMap.prototype.checkMenu=function(e){this.clearChecks(this._menu);if(e[0]!=-1)this._legend.show();else this._legend.hide();var t=this._menu;var a=[];for(var i=0;i<e.length;++i){for(var n=0;n<t.length;++n){if(t[n][0]==e[i]){t[n].checked=true;a.push([t[n][0],t[n][1]]);t=t[n][3];break}}}if(e[0]==-2){a.push([e[1],ShowOnMap.getPinTypeName(e[1])])}var s=a.length-1;var r="";var o={rare:true,herb:true,vein:true};for(var i=0;i<a.length;++i){if(i>0&&o[a[0][0]]){var l=$("span",this._legendContents);l.removeClass("mapper-legend-pin");l.append($("<b/>",{text:" "+a[i][1].substr(a[i][1].lastIndexOf("("))}))}else{if(i==s)r+="<span>";else r+='<span class="breadcrumb-arrow">';r+=a[i][1]+"</span>"}}this._legendLabel.innerHTML=r};ShowOnMap.combinePins=function(e,t,a){var i={};var n=null,s=null;var r,o;var l=0;var c=function(e,t){var a=Math.floor(e[0]);var n=Math.floor(e[1]);if(!t){if(a%2==1)a+=1;if(n%2==1)n+=1}if(i[a]===undefined)i[a]={};if(i[a][n]===undefined)i[a][n]=[];return[a,n]};for(var u=0;u<e.length;++u){var d=e[u];if(t){if(!d.quests)continue;var f=true;for(var h=0;h<d.quests.length;++h){if(d.quests[h].daily){f=false;break}}if(f)continue}else if(a&&d.id!=0){n=c([d.id,0],true);r=n[0];o=n[1];var p=WH.dO(d);p.coord=d.coords[0];i[r][o].push(p);l++;continue}if(d.point=="start"||d.point=="end"){n=c(d.coord);r=n[0];o=n[1];if(i[r][o].length>3){var m=i[r][o];i[r][o]=[];for(var H=0;H<m.length;++H){s=c(m[H].coord,true);i[s[0]][s[1]].push(m[H])}}i[r][o].push(d);l++}else{for(var g=0;g<d.coords.length;++g){n=c(d.coords[g]);r=n[0];o=n[1];var p=WH.dO(d);p.coord=d.coords[g];if(i[r][o].length>3){var m=i[r][o];i[r][o]=[];for(var H=0;H<m.length;++H){s=c(m[H].coord,true);i[s[0]][s[1]].push(m[H])}}i[r][o].push(p);l++}}}var W=[];for(r in i)for(o in i[r])W.push({coord:[i[r][o][0].coord[0],i[r][o][0].coord[1]],level:i[r][o][0].level,list:i[r][o]});return[W,l]};ShowOnMap.buildTooltip=function(e,t){var a="";var i="";var n=[];var s=-1;var r={};var o=0;var l={};var c=1;for(var u=0;u<e.length;++u){var d=e[u];i=WH.Types.getDetailPageName(d.type)&&d.id?WH.Entity.getUrl(d.type,d.id):"";var f=i+d.item;var h=i+d.point;if(!r[f]){r[f]={url:i,obj:d,coords:[d.coord],all:[d]};o++}else{if(!l[h])r[f].all.push(d);r[f].coords.push(d.coord)}l[h]=1}var u=0;for(var f in r){var i=r[f].url;var p=r[f].all;var d=r[f].obj;var m=r[f].coords;if(u>0)a+="<br />";n.push([u++,d.name,i]);c=d.type;if(!d.point){if(d.reacthorde==1&&d.reactalliance<1||d.side==2){if(s==2||s==-1)s=2;else s=0}else if(d.reactalliance==1&&d.reacthorde<1||d.side==1){if(s==3||s==-1)s=3;else s=0}else s=0}a+='<b class="q'+(s==2?" icon-horde":"")+(s==3?" icon-alliance":"")+'">'+d.name+"</b>";if(m.length>0)a+=" ("+m[0][0]+", "+m[0][1]+")<br />";if(d.quests){if(d.quests.length>1)a+=WH.TERMS.starsthefollowingquests_colon;else a+=WH.TERMS.startsthefollowingquest_colon;a+='<div class="indent">';for(var H=0;H<d.quests.length;++H){var g=d.quests[H];if(t&&!g.daily)continue;a+='<span class="q0">['+g.level+"]</span> "+g.name+(g.series&&!g.first?'<sup style="font-size: 8px">(*)</sup>':"")+(g.category<0&&WH.Wow.Quest.getCategoryName(g.category)?' <i class="q0">'+WH.Wow.Quest.getCategoryName(g.category)+"</i>":"")+"<br />"}a+="</div>"}else if(d.description)a+=d.description+"<br />";else if(d.point){for(var u=0;u<p.length;++u){var W=p[u];switch(W.point){case"start":a+=WH.TERMS.startsthequest_stc+"<br />";if(s=="end")s="startend";else if(s!="startend")s="start";break;case"end":a+=WH.TERMS.endsthequest_stc+"<br />";if(s=="start")s="startend";else if(s!="startend")s="end";break;case"sourcestart":a+=WH.TERMS.sourceofqueststart_colon+"<br />";a+='<div class="indent">'+W.item+"</div>";if(s=="end")s="startend";else if(s!="startend")s="start";break;case"sourceend":a+=WH.TERMS.sourceofquestend_colon+"<br />";a+='<div class="indent">'+W.item+"</div>";if(s=="start")s="startend";else if(s!="startend")s="end";break;case"requirement":a+=WH.TERMS.objectiveofthequest_stc+"<br />";if(s==-1)s=W.objective;break;case"sourcerequirement":a+=WH.TERMS.sourceofaquestobjective_colon+"<br />";a+='<div class="indent">'+W.item+"</div>";if(s==-1)s=W.objective;break}}}}a+='<div class="q2">';if(e.length==1)a+=e[0].type==1&&e[0].id!=0?WH.TERMS.clicktoviewthisnpc_stc:e[0].type==2&&e[0].id!=0?WH.TERMS.clicktoviewthisobject_stc:"";else if(o==1)a+=c==1&&d.id!=0?WH.TERMS.clicktoviewthisnpc_stc:c==2&&d.id!=0?WH.TERMS.clicktoviewthisobject_stc:"";else a+="<br />"+WH.TERMS.clicktoview_ellipsis;a+="</div>";var E=[];E.push(a);E.push(s);if(e.length==1||o==1){E.push(i);E.push(null)}else{E.push("javascript:");E.push(n)}return E};ShowOnMap.getPinTypeName=function(e){let t=ShowOnMap.getPinTypeName;return(t.nameMap=t.nameMap||WH.getPageData("maps.showOnMap.typeNames")||{})[e]||e};WH.SiteAchievement=new function(){const e=1;const t=2;const a=3;const i={};i[e]=WH.TERMS.copper;i[t]=WH.TERMS.silver;i[a]=WH.TERMS.gold;this.getQualityName=function(e){return i[e]}};(function(e){var t=3;var a=new Array;var i=2650;var n=e("<audio />").get(0),s=WH.staticUrl+"/sfx/wsa.wav",r=1,o=0,l=3,c;function u(t,a){if(a<=0){if(t==true||t=="true"){e("#wsa-overflow").fadeOut(1e3,(function(){e("#wsa-overflow").remove();r=1}))}else{e("#wsa-overflow").remove();r=1}clearInterval(c)}return a-1}function d(e,t,a){var i=new Date;i.setDate(i.getDate()+a);var n=escape(t)+(a==null?"":"; expires="+i.toUTCString());document.cookie=e+"="+n}function f(e){var t,a,i,n=document.cookie.split(";");for(t=0;t<n.length;t++){a=n[t].substr(0,n[t].indexOf("="));i=n[t].substr(n[t].indexOf("=")+1);a=a.replace(/^\s+|\s+$/g,"");if(a==e)return unescape(i)}}function h(){for(key in a)clearTimeout(a[key])}e((function(){e("body").delegate(".wsa-vol","click",(function(){e(this).toggleClass("alt");if(e(this).hasClass("alt")==true){e.post("/account=setsound",{muted:1})}else{e.post("/account=setsound",{muted:0})}})).delegate(".wsa-notification","mouseover mouseout",(function(t){if(t.type=="mouseover"){h();e(".wsa-notification").stop();e(this).css("z-index",15e5);if(e(this).attr("data-animated")=="true"){e(".wsa-notification").fadeTo(100,1)}}else{e(this).css("z-index",999999);if(e(this).attr("data-persistent")!="true"){e(".wsa-notification").each((function(t,i){var n=e(this).attr("id");if(e(this).attr("data-animated")=="true"){a[n]=setTimeout("$('#"+n+"').fadeOut(3000,function(){ $('#"+n+"').remove(); })",1e3)}else{a[n]=setTimeout("$('#"+n+"').remove()",3e3)}}))}}})).delegate(".wsa-notification","click",(function(t){if(!(e(t.target).is("a")||e(t.target).hasClass("wsa-vol"))){e(this).remove()}}))}));e.fn.wsaNotification=function(d){var f={caption:"??? No name",rank:1,href:WH.Url.generatePath("/user#achievements"),animate:true,playsfx:true,desc:"",persist:false};var d=e.extend(f,d);var h=e("body").children("#wsa-overflow").length;var p=e("body").children(".wsa-notification").length;if(p<t&&h==0){var m=new Date,m="wsan"+m.getTime();if(p!=o%t)o=0;var H=!d.playsfx;var g=d.rank==0?WH.TERMS.newprivilege:WH.sprintf(WH.TERMS.achievementunlocked_format,WH.SiteAchievement.getQualityName(d.rank));var W='<div class="wsa-notification" data-animated="'+d.animate+'" data-persistent="'+d.persist+'" style="bottom: '+(o%t*125+15).toString()+'px" id="'+m+'"><em></em><ins></ins><span class="wsar'+d.rank+'"></span><div><var><i>'+g+'</i><a title="'+d.desc+'" href="'+d.href+'">'+WH.TERMS.viewdetails+" &rarr;</a></var>"+WH.getImitationHeading(d.caption,2).outerHTML+"</div>"+'<div class="wsa-vol'+(H?" alt":"")+'"></div>'+"</div>";e("body").prepend(W);if(d.playsfx==true||d.playsfx=="true"){if(!e(n).attr("src"))e(n).attr("src",s);if(n.play){n.play()}else{e(".wsa-sound").remove();e("body").append('<embed class="wsa-sound" src="'+s+'" autostart="true" hidden="true" loop="false" />')}}if(d.animate==true||d.animate=="true"){e("#"+m+" em").css("filter","");e("#"+m+" em").fadeOut(750,(function(){e("#"+m+" em").remove()}));e("#"+m+" ins").delay(250).animate({marginLeft:"355px",opacity:0},750,(function(){e(this).remove();if(!d.persist)a[m]=setTimeout("$('#"+m+"').fadeOut(3000,function(){ $('#"+m+"').remove(); })",i)}))}else{e("#"+m+" em").remove();e("#"+m+" ins").remove();if(!d.persist)a[m]=setTimeout("$('#"+m+"').remove()",i+1e3)}o++}else{var W='<div class="wsa-overflow" id="wsa-overflow" style="bottom: 0px"><a href="'+WH.Strings.escapeHtml(WH.Url.generatePath("/user"))+'">'+WH.sprintf(WH.TERMS.wsamore_format,1)+"</a></div>";if(h==0){e("body").prepend(W);l=3;if(d.animate==true||d.animate=="true")e("#wsa-overflow").slideDown();else e("#wsa-overflow").show();c=setInterval((function(){l=u(d.animate,l)}),1e3)}else{l=3;r++;e("#wsa-overflow b").text(r)}}}})(jQuery);function AchievementCheck(){$.ajax({cache:false,url:WH.Url.generatePath("/ajax-achievement-check"),type:"POST",success:function(e){if(e&&e.length){for(var t=0;t<e.length;t++){$().wsaNotification(e[t])}}}})}var Slider=new function(){const e=this;var t;var a;var i;function n(e){a=this;t=WH.getCursorPos(e);WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);return false}function s(e){if(!t||!a){return}var i=WH.getCursorPos(e);var n=i.x-t.x;var s=u(a,a._pos+n);var r=f(a);if(r&&a.elements.input){a.elements.input.value=r.value}if(!s){t=i}if(a.onMove){a.onMove(e,a,r)}}function r(e){if(a.onMove){a.onMove(e,a,f(a))}a=null;t=null;WH.dE(document,"mousemove",s);WH.dE(document,"mouseup",r);return false}function o(e,i){a=e;t=WH.getCursorPos(i);var n=WH.ac(a.parentNode);var o=Math.floor(p(a)/2);u(a,t.x-n.x-o);var l=f(a);if(l&&a.elements.input){a.elements.input.value=l.value}if(a.onMove){a.onMove(i,a,l)}WH.aE(document,"mousemove",s);WH.aE(document,"mouseup",r);return false}function l(e,t){if(i){clearTimeout(i)}if(t.type==="change"||t.type==="keypress"&&t.which===13){c(e,t)}else{i=setTimeout(c.bind(0,e,t),1e3)}}function c(e,t){let a=e.elements.input.value;let i=f(e);if(isNaN(a)){a=i.value}if(a>e._max){a=e._max}if(a<e._min){a=e._min}Slider.setValue(e,a);if(e.onMove){e.onMove(t,e,f(e))}}function u(e,t,a){let i=false;let n=d(e);if(t<0){t=0;i=true}else if(t>n){t=n;i=true}let s=p(e);if(!s&&typeof a==="number"){a=Math.min(Math.max(a,0),100)}else{a=parseFloat(t)/n;a-=s/h(e)*a;a*=100}e.elements.trackBarProgress.style.width=a+"%";e.style.left=a+"%";e._pos=t;return i}function d(e){return h(e)-p(e)}function f(e){var t=e._pos/d(e);var a=Math.round(t*(e._max-e._min)+e._min);var i=[t,a];i.percent=t;i.value=a;return i}function h(e){if(e._tsz>0){return e._tsz}return e.elements.track.offsetWidth}function p(e){return typeof e._hsz==="number"?e._hsz:e.offsetWidth}this.getInput=function(e){return e.elements.input};this.getPercent=function(e){return f(e).percent};this.getValue=function(e){return f(e).value};this.setMax=function(e,t){e._max=t;if(e.elements.maxLabel){WH.st(e.elements.maxLabel,t)}Slider.setValue(e,f(e).value)};this.setValue=function(e,t,a){if(t<e._min){t=e._min}else if(t>e._max&&a!==true){t=e._max}if(t>e._max){e.elements.container.classList.add("exceeded-max")}else{e.elements.container.classList.remove("exceeded-max")}if(e.elements.input){e.elements.input.value=t}let i=(t-e._min)/(e._max-e._min);u(e,d(e)*i,100*i)};this.setValueDisplay=function(e,t,a){if(!e.elements.values){WH.error("Can't set the slider value display, this slider doesn't support labels.",t,e);return}if(a){e.elements.values.dataset.completion=`${a}`}else{delete e.elements.values.dataset.completion}WH.ee(e.elements.values);WH.st(e.elements.values,t)};this.setSize=function(e,t){var a=f(e);var i=d(e);e.elements.container.style.width=t+"px";if(i!==d(e)){this.setValue(e,a.value)}};this.setTitle=function(e,t){if(!e.elements.labels){WH.error("Can't set the slider title, this slider doesn't support labels.",t,e);return}if(!e.elements.title){e.elements.title=WH.ce("span",{className:"slider-labels-title"});WH.aef(e.elements.labels,e.elements.title)}WH.ee(e.elements.title);WH.st(e.elements.title,t)};this.init=function(t,a){t.classList.add("slider");t.dataset.track=a.remaining?"remaining":"progress";let i=WH.ce("div",{className:"slider-track-handle",onmousedown:n});let s=WH.ce("div",{className:"slider-track",onmousedown:o.bind(0,i)});let r=WH.ce("div",{className:"slider-track-bar"});let c=WH.ce("div",{className:"slider-track-bar-progress"});WH.ae(t,s);WH.ae(s,i);WH.ae(s,r);WH.ae(r,c);i.elements={container:t,input:undefined,labels:undefined,maxLabel:undefined,title:undefined,track:s,trackBarProgress:c,values:undefined};i._min=1;i._max=100;i._pos=0;i._tsz=0;i._hsz=null;if(a!=null){if(a.minValue||a.minValue===0){i._min=a.minValue}if(a.maxValue){i._max=a.maxValue}if(a.onMove){i.onMove=a.onMove}if(a.trackSize){i._tsz=a.trackSize}if(typeof a.handleSize==="number"){i._hsz=a.handleSize}if(a.editable===false){t.classList.add("not-editable");i._hsz=0}if(a.hasOwnProperty("value")){e.setValue(i,a.value,true)}if(a.showLabels!==false){t.classList.add("has-labels");i.elements.labels=WH.ce("div",{className:"slider-labels"});WH.ae(t,i.elements.labels);i.elements.values=WH.ce("span",{className:"slider-labels-values"});WH.ae(i.elements.labels,i.elements.values);let n;if(a.valueDisplay!==undefined){e.setValueDisplay(i,a.valueDisplay);n=function(){}}else{let e=WH.ce("span",{className:"slider-labels-values-sizer"});WH.ae(i.elements.values,e);if(i._min!==1){let e=WH.ce("span",{className:"slider-labels-values-min"},WH.ct(WH.TERMS.minimum_abbrev+WH.TERMS.colon_punct+i._min));WH.ae(i.elements.values,e)}i.elements.input=WH.ce("input",{className:"slider-labels-values-input",value:a.hasOwnProperty("value")?a.value:i._max,type:"text"});if(a.editable===false){i.elements.input.disabled=true}WH.ae(i.elements.values,i.elements.input);i.elements.maxLabel=WH.ce("span",{className:"slider-labels-values-max"},WH.ct(i._max));WH.ae(i.elements.values,i.elements.maxLabel);n=function(){WH.st(e,i.elements.input.value);window.requestAnimationFrame((function(){i.elements.input.style.width=(e.offsetWidth||20)+"px"}))}}if(typeof a.title==="string"){e.setTitle(i,a.title)}n();$(i.elements.input).bind("focus",(function(){this.parentNode.classList.add("input-focused")})).bind("blur",(function(){this.parentNode.classList.remove("input-focused")})).bind("change",n).bind("click",(function(){this.select()})).bind("keypress",(function(e){let t=[];let a=e.which;for(let e=48;e<58;e++){t.push(e)}if(!(WH.inArray(t,a)>=0)&&a!==13){e.preventDefault()}n()})).bind("keyup keydown change",(function(e){l(i,e);if(e.which===13||e.which===27){this.blur()}n()}))}}return i}};WH.StatusWidget=function(e,t){const a=this;const i=["remaining","title","value","valueDisplay"];const n={elements:{container:undefined,info:undefined},slider:undefined,updateFunction:undefined};this.getElement=function(e){if(!n.elements.hasOwnProperty(e)){WH.error("Status widget element not found.",e)}return n.elements[e]};this.update=function(){if(n.updateFunction){n.updateFunction(n.slider,this)}};function s(e,t){n.elements.container=e;n.updateFunction=t.updateFunction;n.elements.container.classList.add("status-widget");let s={editable:false,maxValue:t.hasOwnProperty("maxValue")?t.maxValue:100,minValue:t.hasOwnProperty("minValue")?t.minValue:1};for(let e=0,a;a=i[e];e++){if(t.hasOwnProperty(a)){s[a]=t[a]}}let r=WH.ce("div",{className:"status-widget-slider"});WH.ae(n.elements.container,r);n.slider=Slider.init(r,s);n.elements.info=WH.ce("div",{className:"status-widget-info"});WH.ae(n.elements.container,n.elements.info);if(typeof t.updateFunction==="function"){if(typeof t.updateInterval==="number"){setInterval(a.update,t.updateInterval)}requestAnimationFrame(a.update)}}s.apply(this,arguments)};WH.Strings=new function(){const e=this;this.laquo="«";this.lsaquo="‹";this.nbsp=" ";this.ndash="–";this.raquo="»";this.rsaquo="›";this.shy="­";this.zwnj="‌";const t=80;const a={guidIndex:0,guidPrefix:undefined};this.camelKebab=function(e){return/(?=[A-Z])/[Symbol.split](e).map((function(e){return e.toLowerCase()})).join("-")};this.escapeHtml=function(e){return WH.ce("div",{},WH.ct(e)).innerHTML};this.escapeRegExp=function(e){return e.replace(/[\s\S]/g,(function(e){let t=e.charCodeAt(0).toString(16);let a=t.length>2;return"\\"+(a?"u":"x")+("0000"+t).slice(a?-4:-2)}))};this.formatNumber=function(e,t,a,i){a=a||0;i=i||a;var n=WH.Strings.formatNumber.supportsOptions;if(n===undefined){n=WH.Strings.formatNumber.supportsOptions=!!(typeof Intl=="object"&&Intl&&typeof Intl.NumberFormat=="function")}var s=e;if(!e instanceof Number){e=new Number(e)}if(isNaN(e)){WH.error("Tried to convert an invalid number",s);e=0}let r=function(e){return e.replace("-",/[1-9]/.test(e)?"-":"")};if(!n){if(t){e*=100}return r(e.toFixed(i)+(t?"%":""))}return r(e.toLocaleString(undefined,{style:t?"percent":"decimal",useGrouping:true,minimumFractionDigits:a,maximumFractionDigits:i}))};this.guid=function(){if(!a.guidPrefix){a.guidPrefix=["wowhead-guid",Date.now(),WH.getServerTime().valueOf(),e.hashCode(location.href),""].join("-")}return a.guidPrefix+a.guidIndex++};this.hashCode=function(e){let t=0;for(let a=0;a<e.length;a++){t=(t<<5)-t+e.charCodeAt(a);t|=0}return t};this.hasReplacementValues=function(e){return!!e.match(/(%[sd]|%\d+\$s|\$\d)/)};this.renderBlizzardUiEscapedString=function(e,t={}){let a=document.createDocumentFragment();e=e.replace(/\|{2,}/g,"|");let i=-1;while(e.length){if(e.length===i){WH.error("Could not process Blizzard UI text: "+e);break}i=e.length;let n=e.indexOf("|");if(n<0){WH.ae(a,WH.ct(e));e="";continue}let s="";if(n>0){WH.ae(a,WH.ct(s=e.substr(0,n)));e=e.substr(n)}let r=false;e=r?e:e.replace(/^\|n/,(()=>{r=true;WH.ae(a,WH.ce("br"));return""}));e=r?e:e.replace(/^\|\|/,(()=>{r=true;WH.ae(a,WH.ct("|"));return""}));e=r?e:e.replace(/\|cn([^:]+):([\w\W]*?)\|r/,((e,i,n)=>{r=true;let s=t[i];if(s){WH.ae(a,WH.ce("span",{style:{color:"#"+s}},WH.ct(n)))}else{WH.ae(a,WH.ct(n))}return""}));e=r?e:e.replace(/\|c[0-9A-Fa-f]{2}([0-9A-Fa-f]{6})([\w\W]*?)\|r/,((e,t,i)=>{r=true;WH.ae(a,WH.ce("span",{style:{color:"#"+t}},WH.ct(i)));return""}));e=r?e:e.replace(/^\|T[\w\W]+?\|t/,(()=>{r=true;return""}));e=r?e:e.replace(/^\|A:([^:]+):([\d.]+):([\d.]+)(?::([\d.]+):([\d.]+)(?::(\d+):(\d+):(\d+))?)?\|a/,((e,t,i,n,s,o,l,c,u)=>{r=true;let d=WH.ce("img",{alt:t,src:WH.Wow.getTextureAtlasMemberUrl(t),style:{verticalAlign:"bottom"}});if(l!=null){d.style.filter=WH.DOM.getColorFilter(parseInt(l)/255,parseInt(c)/255,parseInt(u)/255)}i=parseFloat(i);n=parseFloat(n);let f=2;if(i===0){if(n===0){d.style.width=f+"ex";d.style.height=f+"ex"}else{d.style.width=f*n+"ex";d.style.height=f+"ex"}}else{if(n===0){d.style.width=f+"ex";d.style.height=i+"px"}else{d.style.width=n+"px";d.style.height=i+"px"}}WH.ae(a,d);return""}));e=r?e:e.replace(/^\|1([^;]*);([^;]*);/,((e,t,i)=>{r=true;WH.ae(a,WH.ct(/[01]\s*$/.test(s)?t:i));return""}));e=r?e:e.replace(/^\|4([^:;]*):([^:;]*)(?::([^:;]*))?;/,((e,t,i,n)=>{r=true;let o=parseInt((s.match(/(\d+)\s*$/)||["0","0"])[1]);WH.ae(a,WH.ct(o===1?t:i));return""}));e=r?e:e.replace(/^\|2\s*(.)/,((e,t)=>{r=true;if(["a","e","i","o","u"].includes(t.toLowerCase())){WH.ae(a,WH.ct("d'"))}else{WH.ae(a,WH.ct("de "))}return t}));if(!r){WH.ae(a,WH.ct("|"));e=e.substr(1)}}return a};this.slug=function(a,i,n){if(typeof a!=="string"){WH.error("Tried to convert a variable of type "+typeof a+" to kebab case.",a);return""}var s=WH.ce("textarea");s.innerHTML=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");a=s.value;a=a.replace(new RegExp(e.shy,"g"),"");if(Locale.exists(n)||Locale.isLocaleName(n)){if(n===LOCALE_ENUS||n===Locale.getName(LOCALE_ENUS)){a=a.replace(" & "," and ")}else{a=a.replace(WH.TERMS.wordspace_punct+WH.TERMS.ampersand_punct+WH.TERMS.wordspace_punct,WH.TERMS.wordspace_punct+WH.TERMS.and_lc+WH.TERMS.wordspace_punct)}}a=a.replace(/%\w|['#]|^\s*|\s*$/g,"");if(i){a=a.replace(/ \/ |_|[^\u00C0-\u1FFF\u2C00-\uD7FF\w]+/g,"-")}else{a=WH.removeAccents(a).replace(/ \/ |_|[^a-z0-9]/gi,"-")}a=a.toLocaleLowerCase();a=a.replace(/-{2,}/g,"-");a=a.replace(/^-+|-+$/g,"");if(a.length>t){let e=a.substr(t,1)==="-";a=a.substr(0,t);let i;if(!e&&(i=a.lastIndexOf("-"))!==-1){a=a.substr(0,i)}}return a};this.sprintf=function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(e){return a(n(e),arguments)}function a(a,i){var n=1,s=a.length,r,o="",l,c,u,d,f,h,p,m;for(l=0;l<s;l++){if(typeof a[l]==="string"){o+=a[l]}else if(typeof a[l]==="object"){u=a[l];if(u.keys){r=i[n];for(c=0;c<u.keys.length;c++){if(r==undefined){throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',u.keys[c],u.keys[c-1]))}r=r[u.keys[c]]}}else if(u.param_no){r=i[u.param_no]}else{r=i[n++]}if(e.not_type.test(u.type)&&e.not_primitive.test(u.type)&&r instanceof Function){r=r()}if(e.numeric_arg.test(u.type)&&(typeof r!=="number"&&isNaN(r))){throw new TypeError(t("[sprintf] expecting number but found %T",r))}if(e.number.test(u.type)){p=r>=0}switch(u.type){case"b":r=parseInt(r,10).toString(2);break;case"c":r=String.fromCharCode(parseInt(r,10));break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,u.width?parseInt(u.width):0);break;case"e":r=u.precision?parseFloat(r).toExponential(u.precision):parseFloat(r).toExponential();break;case"f":r=u.precision?parseFloat(r).toFixed(u.precision):parseFloat(r);break;case"g":r=u.precision?String(Number(r.toPrecision(u.precision))):parseFloat(r);break;case"o":r=(parseInt(r,10)>>>0).toString(8);break;case"s":r=String(r);r=u.precision?r.substring(0,u.precision):r;break;case"t":r=String(!!r);r=u.precision?r.substring(0,u.precision):r;break;case"T":r=Object.prototype.toString.call(r).slice(8,-1).toLowerCase();r=u.precision?r.substring(0,u.precision):r;break;case"u":r=parseInt(r,10)>>>0;break;case"v":r=r.valueOf();r=u.precision?r.substring(0,u.precision):r;break;case"x":r=(parseInt(r,10)>>>0).toString(16);break;case"X":r=(parseInt(r,10)>>>0).toString(16).toUpperCase();break}if(e.json.test(u.type)){o+=r}else{if(e.number.test(u.type)&&(!p||u.sign)){m=p?"+":"-";r=r.toString().replace(e.sign,"")}else{m=""}f=u.pad_char?u.pad_char==="0"?"0":u.pad_char.charAt(1):" ";h=u.width-(m+r).length;d=u.width?h>0?f.repeat(h):"":"";o+=u.align?m+r+d:f==="0"?m+d+r:d+m+r}}}return o}var i=Object.create(null);function n(t){if(i[t]){return i[t]}var a=t,n,s=[],r=0;while(a){if((n=e.text.exec(a))!==null){s.push(n[0])}else if((n=e.modulo.exec(a))!==null){s.push("%")}else if((n=e.placeholder.exec(a))!==null){if(n[2]){r|=1;var o=[],l=n[2],c=[];if((c=e.key.exec(l))!==null){o.push(c[1]);while((l=l.substring(c[0].length))!==""){if((c=e.key_access.exec(l))!==null){o.push(c[1])}else if((c=e.index_access.exec(l))!==null){o.push(c[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=o}else{r|=2}if(r===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}s.push({placeholder:n[0],param_no:n[1],keys:n[2],sign:n[3],pad_char:n[4],align:n[5],width:n[6],precision:n[7],type:n[8]})}else{throw new SyntaxError("[sprintf] unexpected placeholder")}a=a.substring(n[0].length)}return i[t]=s}return t}();this.toFixedTrimmed=function(e,t){return e.toFixed(t).replace(/\D?0*$/,"")};this.unescapeHtml=function(e){let t={"&gt;":">","&lt;":"<","&amp;":"&","&apos;":"'","&quot;":'"'};let a;return e.replace(/&(?:(?:#\d+)|(?:#x[0-9a-f]+)|[a-z]+);/gi,(function(e){if(t.hasOwnProperty(e)){return t[e]}a=a||new DOMParser;return t[e]=a.parseFromString(e,"text/html").documentElement.textContent}))};this.vsprintf=function(e,t){return this.sprintf.apply(null,[e].concat(t||[]))}};WH.Switcher=function(e,t,a){const i="active";const n="inactive";const s={elements:{container:undefined,indicator:undefined},toggleable:false};this.activateChoice=function(e){let t=WH.qs('.switcher-choice[data-switcher-id="'+e+'"]',s.elements.container);if(t){t.click()}else{WH.error("Could not find switcher choice with ID "+e)}};this.setChoiceLabel=function(e,t){let a=WH.qs('.switcher-choice[data-switcher-id="'+e+'"]',s.elements.container);if(a){if(typeof t==="string"){WH.st(a,t)}else{WH.ee(a);WH.ae(a,t)}}else{WH.error("Could not find switcher choice with ID "+e)}};function r(e){let t=WH.ce("a",{className:"switcher-choice",dataset:{state:e.active?i:n}},WH.ct(e.name));WH.ae(s.elements.container,t);if(e.id){t.dataset.switcherId=e.id}if(e.active){c(t)}WH.aE(t,"click",l.bind(t,e));WH.preventSelectStart(t);WH.onMutate(t,(function(){if(this.dataset.state===i){c(this)}}));if(e.nonTouchTooltip){WH.Tooltip.simpleNonTouch(t,e.nonTouchTooltip)}else if(e.tooltip){WH.Tooltip.simple(t,e.tooltip)}}function o(e,t,a){a=a||{};if(a.toggleable){s.toggleable=true}s.elements.container=e;s.elements.container.classList.add("switcher");s.elements.indicator=WH.ce("div",{className:"switcher-indicator"});WH.ae(s.elements.container,s.elements.indicator);for(let e=0,a;a=t[e];e++){r(a)}WH.aE(window,"resize",(function(){let e=WH.qs('.switcher-choice[data-state="active"]',s.elements.container);if(e){c(e)}}))}function l(e,t){let a=s.toggleable&&this.dataset.state===i?n:i;WH.setData('.switcher-choice[data-state="active"]',"state",n,this.parentNode);this.dataset.state=a;c(this,true);if(e.onChange){e.onChange.apply(this,arguments)}}function c(e,t){let a=e.parentNode;if(!a){WH.error("Cannot update switcher indicator position, no switcher choice parent found.",e);return}if(t!==true){s.elements.indicator.style.transition="none"}if(e.dataset.state===i){let t=a.offsetHeight-(e.offsetTop+e.offsetHeight);s.elements.indicator.style.bottom=t+"px";s.elements.indicator.style.left=e.offsetLeft+"px";s.elements.indicator.style.width=e.getBoundingClientRect().width+"px"}else{s.elements.indicator.style.bottom="";s.elements.indicator.style.left="";s.elements.indicator.style.width=""}if(t!==true){requestAnimationFrame((function(){requestAnimationFrame((function(){s.elements.indicator.style.transition=""}))}))}}o.apply(this,arguments)};function Tabs(e){WH.cO(this,e);if(this.parent){this.parent=WH.ge(this.parent)}if(!this.parent){WH.error("Tabs cannot be created without a parent.");return}this.selectedTab=-1;this.ul=null;this.tabs=[];this.nShows=0;if(this.maxRows==null&&window.innerWidth<768){this.maxRows=4}if(this.poundable==null)this.poundable=1;this.poundedTab=null;if(this.onLoad==null)this.onLoad=Tabs.onLoad.bind(this);if(this.onShow==null)this.onShow=Tabs.onShow.bind(this);if(this.onHide)this.onHide=this.onHide.bind(this);this.trackClick=Tabs.trackClick.bind(this);if(e.tabs instanceof Array){for(var t=0,a=e.tabs.length;t<a;t++){this.add(e.tabs[t].name,e.tabs[t].options)}this.flush()}}Tabs.prototype={add:function(e,t){let a;let i=this.tabs.length;a={caption:e,index:i,owner:this};WH.cO(a,t);this.tabs.push(a);if(this.ul){let e=this.createTab(a);WH.ae(this.ul,e)}return i},hide:function(e,t){if(this.tabs[e]){var a=this.selectedTab;if(e==0&&a==-1)this.poundedTab=this.selectedTab=a=0;if(e!=this.poundedTab)this.selectedTab=-1;this.tabs[e].hidden=!t;this.flush();if(!t&&e==a){this.selectedTab=a;for(var i=0,n=this.tabs.length;i<n;++i){if(i!=e&&!this.tabs[i].hidden)return this.show(i,1)}}}},markFirstTabInRow:function(){let e=null;if(this.tabs){this.tabs.some((t=>{if(!t.element){return true}if(e===null){e=t.element.getBoundingClientRect().left}t.element.dataset.firstInRow=JSON.stringify(t.element.getBoundingClientRect().left===e)}))}},unlock:function(e,t){if(this.tabs[e]){this.tabs[e].locked=t;let a=WH.gE(this.ul,"a");$(".fa-lock",a[e]).remove();if(t){$("div, b",a[e]).prepend('<span class="fa fa-lock" />')}let i=location.hash.substr(1).split(";")[0];if(this.tabs[e].id==i){this.show(e,1)}}},focus:function(e){if(e<0)e=this.tabs.length+e;this.forceScroll=1;WH.gE(this.ul,"a")[e].onclick({},true);this.forceScroll=null},show:function(e,t,a){const i=WH.DOM;var n;if(isNaN(e)||e<0)e=0;else if(e>=this.tabs.length)e=this.tabs.length-1;if(t==null&&e==this.selectedTab||this.tabs[e].hidden)return;if(this.tabs[e].locked)return this.onShow(this.tabs[e],this.tabs[this.selectedTab]);if(this.selectedTab!=-1){n=this.tabs[this.selectedTab];if(this.onHide&&!this.onHide(n))return;if(n.onHide&&!n.onHide())return}++this.nShows;let s=WH.gE(this.ul,"a");if(this.selectedTab!==-1){s[this.selectedTab].parentNode.dataset.selected=""}s[e].parentNode.dataset.selected="true";let r=i.getData(s[e].parentNode,"tabSettings");if(this.maxRows||r.collapsed){var o=function(e){var t=$(e).parent().siblings(".tab-responsive-list");if(t.length){if(e.parentNode.getAttribute("data-responsive-hidden")=="true"){$("a",t).addClass("selected");$("div, b",t).html(this.getMoreTabName(true,$("b",e).html()))}else{$("a",t).removeClass("selected");$("div, b",t).html(this.getMoreTabName(true))}}};if(a){setTimeout(o.bind(this,s[e]),250)}else{o.call(this,s[e])}}n=this.tabs[e];if(n.onLoad){n.onLoad();n.onLoad=null}this.onShow(this.tabs[e],this.tabs[this.selectedTab]);if(n.onShow)n.onShow(this.tabs[this.selectedTab]);this.selectedTab=e;window.dispatchEvent(new CustomEvent("scroll"))},flush:function(e){var t;var a=WH.ce("div");a.className="tabs-container";var i="ul";this.ul=WH.ce(i);this.ul.className="tabs";WH.ae(a,this.ul);for(var n=0;n<this.tabs.length;++n){var s=this.tabs[n];s.element=this.createTab(s);WH.ae(this.ul,s.element)}WH.ee(this.parent);WH.ae(this.parent,a);if(isNaN(e)){let t=false;let a;this.tabs.some((e=>{if(e.collapsed){t=true}else if(isNaN(a)){a=e.index}return t&&!isNaN(a)}));if(t){e=a}}if(this.onLoad){let t=this.onLoad();if(t!=null){this.poundedTab=e=t}}this.show(e,null,true);this.collapseExtraTabs();WH.aE(window,"resize",this.markFirstTabInRow.bind(this));this.markFirstTabInRow();setTimeout(this.markFirstTabInRow.bind(this),.5*WH.Time.MS_SEC)},createTab:function(e){const t=WH.DOM;var a,i,n;a=WH.ce("li");t.setData(a,"tabSettings",e);i=WH.ce("b");var s=WH.ce("a");s.rel=e.rel||"np";if(e.className){a.className=e.className}if(e.hidden){a.style.display="none"}if(this.poundable&&!e.noPound){s.href="#"+e.id}else{s.href="javascript:"}if(e.menu){Menu.add(s,e.menu,{showAtElement:true,onShow:e.onShowMenu,onHide:e.onHideMenu})}else{s.onclick=Tabs.onClick.bind(e,s)}var r=WH.ce("div");if(e.locked){n=WH.ce("span",{className:"fa fa-lock"});WH.ae(r,n)}else if(e.icon){n=WH.ce("span",{className:"icontiny"});n.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+e.icon.toLowerCase()+".gif)";WH.ae(r,n)}else if(e.image){n=WH.ce("img");$.extend(n,e.image);WH.ae(r,n)}else if(e.fontIcon){n=WH.ce("i",{className:"fa fa-"+e.fontIcon});WH.ae(r,n)}if(e.tooltip){s.onmouseover=function(e,t){WH.Tooltip.showAtCursor(t,e,"q")}.bind(s,e.tooltip);s.onmousemove=WH.Tooltip.cursorUpdate;s.onmouseout=WH.Tooltip.hide}if(e["class"]){r.className=e["class"]}WH.ae(r,WH.ct(e.caption));WH.ae(s,r);if(e.locked){n=WH.ce("span",{className:"fa fa-lock"});WH.ae(i,n)}else if(e.icon){n=WH.ce("span",{className:"icontiny"});n.style.backgroundImage="url("+WH.staticUrl+"/images/wow/icons/tiny/"+e.icon.toLowerCase()+".gif)";WH.ae(i,n)}else if(e.image){n=WH.ce("img");$.extend(n,e.image);WH.ae(i,n)}else if(e.fontIcon){n=WH.ce("i",{className:"fa fa-"+e.fontIcon});WH.ae(i,n)}WH.ae(i,WH.ct(e.caption));WH.ae(s,i);WH.ae(a,s);s.tabSettings=e;return a},collapseExtraTabs:function(){const e=this;const t=WH.DOM;let a=e.tabs.some((e=>e.collapsed));if(!e.maxRows&&!a){return}const i=1;let n=e.maxRows||Number.MAX_SAFE_INTEGER;let s=WH.qs(":scope > li:first-child",e.ul);let r=getComputedStyle(s);let o=s.getBoundingClientRect().height+parseFloat(r.marginTop)+parseFloat(r.marginBottom);if(!(a||e.ul.getBoundingClientRect().height-i>o*n)){return}let l=WH.qsa(":scope > li",e.ul);let c=[];let u=[];if(a){l.forEach((e=>{if(t.getData(e,"tabSettings").collapsed){u.push(e)}}))}else{l.forEach((e=>{if(e.offsetTop-i>o*n-o){u.push(e)}else{c.push(e);while(c.length>2){c.shift()}}}))}while(u.length>0&&c.length>0){u.unshift(c.pop())}let d=[];u.forEach((a=>{a.dataset.responsiveHidden="true";let i=t.getData(a,"tabSettings");d.push(Menu.createItem({label:i.caption,url:()=>{WH.qs("a",a).click();if(window.innerWidth<768){WH.scrollTo(e.ul,{animated:true,asNeeded:true})}},options:{checkedFunc:()=>e.selectedTab===i.index}}))}));e.add(e.getMoreTabName(false),{className:"tab-responsive-list",fontIcon:"bars",menu:d,onShowMenu:()=>e.currentTabContents.classList.add("tab-fade"),onHideMenu:()=>e.currentTabContents.classList.remove("tab-fade"),noPound:false})},getMoreTabName:function(e,t){var a=e?'<i class="fa fa-bars"></i>':"";if(t){a+=" &ndash; "+t}return a},setTabIcon:function(e,t){let a=WH.gE(this.ul,"a")[e];a.tabSettings.icon=t;WH.qs("span.icontiny",a).style.backgroundImage='url("'+WH.Icon.getIconUrl(t,WH.Icon.TINY)+'")'},setTabName:function(e,t){this.tabs[e].caption=t;var a=WH.gE(this.ul,"a");WH.setTextNodes(a[e],t)},setTabPound:function(e,t){if(!this.poundable){return}let a=WH.gE(this.ul,"a");a[e].href="#"+this.tabs[e].id+(t?";"+t:"")},setTabTooltip:function(e,t){this.tabs[e].tooltip=t;var a=WH.gE(this.ul,"a");if(t==null)a[e].onmouseover=a[e].onmousemove=a[e].onmouseout=null;else{a[e].onmouseover=function(e){WH.Tooltip.showAtCursor(e,t,"q2")};a[e].onmousemove=WH.Tooltip.cursorUpdate;a[e].onmouseout=WH.Tooltip.hide}},getSelectedTab:function(){return this.selectedTab},getTabById:function(e){for(var t=0,a=this.tabs.length;t<a;++t){if(this.tabs[t].id==e)return t}}};Tabs.onClick=function(e,t,a){if(a==null&&this.index==this.owner.selectedTab)return;var i=WH.rfWithoutControlKey(t);if(i==null)return;Menu.hide();this.owner.show(this.index,a);if(this.owner.poundable&&!this.locked){let t=e.href.indexOf("#");if(t!==-1){let a=e.href.substr(t);if(location.hash.indexOf(a)!==0){location.replace(a)}}}return i};Tabs.onLoad=function(){if(!this.poundable||!location.hash.length){return}let e=location.hash.substr(1).split(/[;:]/)[0];if(e){for(let t=0,a;a=this.tabs[t];t++){if(a.id===e&&!a.locked){return t}}}};Tabs.onShow=function(e,t){if(e.hidden||e.locked)return;if(t)WH.ge("tab-"+t.id).style.display="none";if(this.poundedTab!=null||t)this.trackClick(e);var a=WH.ge("tab-"+e.id);a.style.display="";this.currentTabContents=a;WH.Tools.Bloodmallet.updateChartsSizes(a);if((this.nShows===1&&typeof this.poundedTab==="number"&&this.poundedTab>=0||this.forceScroll)&&!this.noScroll){setTimeout((()=>{let e=(location.hash.split(Listview.HASH_DELIMITER)[0]||"").slice(1);let t=e&&WH.ge(e);if(!t){t=this.parent}else if(!a.contains(t)){WH.error("Hash-specified element conflicts with tab contents.");t=this.parent}WH.scrollTo(t,{animated:!WH.pageWasReloaded()})}),100)}};Tabs.trackClick=function(e){if(!this.trackable||e.tracked){return}WH.Track.interactiveEvent("Tab Click","Page: "+this.trackable,"Tab: "+e.id);e.tracked=1};WH.Theme=new function(){const e=this;const t=WH.Layout;this.THEME_CLASSIC="classic";this.THEME_IMMORTAL="immortal";this.THEME_STANDARD="standard";this.THEME_THOTTBOT="thottbot";this.TYPE_CLASSIC="classic";this.TYPE_STANDARD="standard";const a=[this.THEME_THOTTBOT];const i={[this.THEME_STANDARD]:this.TYPE_STANDARD,[this.THEME_CLASSIC]:this.TYPE_CLASSIC,[this.THEME_THOTTBOT]:this.TYPE_CLASSIC,[this.THEME_IMMORTAL]:this.TYPE_STANDARD};const n={[WH.dataTree.RETAIL]:[this.THEME_STANDARD],[WH.dataTree.CLASSIC]:[this.THEME_CLASSIC,this.THEME_THOTTBOT],[WH.dataTree.TBC]:[this.THEME_CLASSIC,this.THEME_THOTTBOT],[WH.dataTree.WRATH]:[this.THEME_CLASSIC,this.THEME_THOTTBOT],[WH.dataTree.D2]:[this.THEME_STANDARD],[WH.dataTree.DI]:[this.THEME_IMMORTAL],[WH.dataTree.D4]:[this.THEME_IMMORTAL]};this.getFaviconUrl=()=>{let a=e.getTheme();let i=a===e.THEME_THOTTBOT?a:WH.getDataTreeKey();return t.getFaviconUrl(i,16)};this.getTheme=function(){return WH.PageMeta.theme||e.THEME_STANDARD};this.getThemePath=function(){return e.getTheme()+"/"};this.getThemes=function(){return n[WH.getDataTree()]||[]};this.getThemeType=function(){return i[e.getTheme()]};this.isClassic=function(){return e.getTheme()===e.THEME_CLASSIC};this.isClassicType=function(){return e.getThemeType()===e.TYPE_CLASSIC};this.isDark=function(){return!a.includes(e.getTheme())};this.isStandard=function(){return e.getTheme()===e.THEME_STANDARD};this.isStandardType=function(){return e.getThemeType()===e.TYPE_STANDARD};this.isThottbot=function(){return e.getTheme()===e.THEME_THOTTBOT};this.set=function(t){if(e.getThemes().indexOf(t)<0){alert(WH.TERMS.invalidOption);WH.error("Tried to set an invalid theme:",t);return}WH.User.saveOption("theme",t,(function(){window.location=window.location.href}))}};WH.Tools=new function(){const e={cta:{},includedCss:[]};this.createMountCollectionTrackerCta=function(){return e.cta.mountTracker=e.cta.mountTracker||t("mount",WH.TERMS.mountCollectionTracker,"/mount-collection-tracker")};this.createBattlePetCollectionTrackerCta=function(){return e.cta.battlePetTracker=e.cta.battlePetTracker||t("pet",WH.TERMS.battlePetCollectionTracker,"/battle-pet-collection-tracker")};this.createToyCollectionTrackerCta=function(){return e.cta.toyTracker=e.cta.toyTracker||t("toy",WH.TERMS.toyCollectionTracker,"/toy-collection-tracker")};function t(e,t,i){a("collection-tracker-cta");var n=WH.ce("div",{className:"collection-tracker-cta"});n.setAttribute("data-type",e);var s=WH.ce("div",{className:"collection-tracker-cta-name"});WH.st(s,t);WH.ae(n,s);var r=WH.ce("div",{className:"collection-tracker-cta-name-all-new"});WH.st(r,WH.TERMS.allNew_tip);WH.aef(s,r);var o=WH.createButton(WH.TERMS.collectionCta_button);WH.ae(n,o);WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-primary"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-left"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-center"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-right"}));WH.ae(n,WH.ce("span",{className:"collection-tracker-cta-gradient"}));WH.ae(n,WH.ce("a",{className:"collection-tracker-cta-cover",href:i}));return n}function a(t){if(e.includedCss.includes(t)){return}let a=WH.staticUrl+"/css/"+WH.Theme.getThemePath()+"tools/partials/"+t+".css";if(WH.PageMeta.scriptVersionQueryString){a+="?"+WH.PageMeta.scriptVersionQueryString}WH.ae(document.head,WH.ce("link",{rel:"stylesheet",type:"text/css",href:a}))}};WH.Track=new function(){const e={scriptAdded:undefined};var t={adsBlocked:3,adsUnblocked:4,loggedInUserIsPremium:2,userIsLoggedIn:1,userShouldSeeAds:5};var a=false;var i=1e4;var n=10;this.addClickEvents=function(e,t,a){if(!t||!t.actions||!t.category){if(WH.isDev()){WH.log("Tried to add analytics event without appropriate parameters.");WH.log(e);WH.log(t)}return}var i=t.category;var n=WH.gE(e,"a");for(var r=0,o;o=n[r];r++){var l="Follow link";for(var c in t.actions){if(t.actions.hasOwnProperty(c)&&t.actions[c]&&t.actions[c](o)){l=c;break}}var u=(a?a+"-":"")+s(o);$(o).click(WH.Track.interactiveEvent.bind(null,i,l,u))}};this.gaInit=function(i){if(!e.scriptAdded){(function(e,t,a,i,n,s,r){e["GoogleAnalyticsObject"]=n;e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date;s=t.createElement(a),r=t.getElementsByTagName(a)[0];s.async=1;s.src=i;r.parentNode.insertBefore(s,r)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");let t=()=>{let e=document.createElement("script");e.async=true;e.src="https://www.googletagmanager.com/gtag/js?id=G-1G60NXCNZF";document.body.appendChild(e)};if(document.body){t()}else{WH.aE(document,"bodyAvailable",t)}window.dataLayer=window.dataLayer||[];window.gtag=function(){dataLayer.push(arguments)};gtag("js",new Date);gtag("config","G-1G60NXCNZF");e.scriptAdded=true}if(!window.ga||!ga.create){if(!i){i=1}if(i>100){return}setTimeout(WH.Track.gaInit.bind(WH.Track,i+1),i*9);return}ga("create","UA-574613-1","wowhead.com");r(t.userShouldSeeAds,WH.WAS.showAds());r(t.userIsLoggedIn,WH.User.isLoggedIn());if(WH.User.isLoggedIn()){r(t.loggedInUserIsPremium,WH.User.isPremium())}if(WH.WAS.showAds()){var n=WH.ce("ins",{className:"AdSense",style:{display:"block",height:"1px",position:"absolute",top:"-1px"}});document.body.appendChild(n);r(t.adsBlocked,!n.clientHeight);document.body.removeChild(n)}ga("set","anonymizeIp",true);ga("send","pageview");a=true};this.interactiveEvent=function(e,t,a,i){l(e,t,a,i)};this.linkClick=function(e,t,i){if(!a){return}if(typeof t=="function"){t=t(e)}if(typeof i=="function"){i=i(e)}WH.debug("Track Click:",t,i,e.href);ga("send","event",t,"click",i,e.href,{transport:"beacon"});if(i&&i.indexOf("News - View Article")==0){ga("send","event","News","View full version",WH.News.getSubjectFromChild(e),{nonInteraction:1,transport:"beacon"})}};this.nonInteractiveEvent=function(e,t,a,i){l(e,t,a,i,true)};this.setLinkClickEvent=function(e,t,a){if(!e.href||e.href.indexOf("javascript:")===0){return}WH.aE(e,"click",WH.Track.linkClick.bind(null,e,t,a))};function s(e){var t="unknown";var a=WH.getFirstTextContent(e);if(a){t=WH.Strings.slug(a)}else if(e.title){t=WH.Strings.slug(e.title)}else if(e.id){t=WH.Strings.slug(e.id)}return t}function r(e,t){ga("set","dimension"+e,t)}function o(){var e={"database-logo":{category:"Homepage Logo",actions:{"Click image":function(e){return true}}}};for(var t in e){var a=WH.ge(t);if(a){WH.Track.addClickEvents(a,e[t])}}}function l(e,t,s,r,o,c){var u=WH.debug.bind(null,"Track Event:",e,t,s,r,o,c);if(!c){u()}if(!a){if(WH.isDev()){return}if(!c){c=0}c++;if(c*n>i){return}setTimeout(l.bind(null,e,t,s,r,o,c),n);return}if(c){u()}if(typeof o==="boolean"){ga("send","event",e,t,s,r,{nonInteraction:o?1:0})}else{ga("send","event",e,t,s,r)}}$(o)};WH.Twitter=new function(){const e=WH.DOM;const t=Object.seal({loadedScript:false,loadingQueue:[]});this.renderTweet=function(t,a){i((()=>e.onBodyAdd(a,(()=>{a.dataset.loading="true";let e=WH.ce("span",{className:"twitter-tweet-loading fa fa-circle-o-notch fa-spin fa-fw q0"});WH.aef(a,e);let i={};if(WH.Theme.isDark()){i.theme="dark"}twttr.widgets.createTweet(t,a,i).then((t=>{e.parentNode.removeChild(e);if(t){a.dataset.loading="false"}else{delete a.dataset.loading}})).catch((()=>{delete a.dataset.loading;e.parentNode.removeChild(e)}))}))))};function a(){let a=e.addScriptOnce("https://platform.twitter.com/widgets.js",{type:"text/javascript"});if(a){WH.aE(a,"load",(function(){t.loadedScript=true;while(t.loadingQueue.length){t.loadingQueue.shift()()}}))}}function i(e){if(t.loadedScript){window.requestAnimationFrame(e)}else{t.loadingQueue.push(e);a()}}};WH.Url=new function(){const e=this;const t=WH.Game;const a=WH.getPageData("url.alternatePathCommands")||{};const i="wowhead.com";const n="nether";const s="skyhold";this.addGet=function(e,t,a){if(e instanceof Location){e=""+e}if(typeof e!=="string"){WH.error("Tried to add a get arg to a non-string!",e,t,a);return e}if(e.substr(-12)==="wowhead.com/"){e+="home"}var i=t+"\\b(=*[^&]+)?";if(e.indexOf("?"+t)>-1){e=e.replace(new RegExp("\\?"+i),"")}if(e.indexOf("&"+t)>-1){e=e.replace(new RegExp("&"+i),"")}return e+(e.indexOf("?")===-1&&e.indexOf("&")===-1?"?":"&")+t+(a?"="+a:"")};this.addMaxSizeParams=function(t,a){let i=/^https?:\/\/wow\.zamimg\.com/.test(t);i|=t.substr(0,WH.staticUrl.length)===WH.staticUrl;if(!i){return t}if(/^https?:\/\/[^\/]+\/modelviewer\//.test(t)){return t}let n=WH.PageMeta.staticResizing||{limit:600,throttle:{start:600,percent:0}};let s=r(t);let o=e.parseQueryString(t);let l=function(e){e=e.toLowerCase();for(let t in o){if(!o.hasOwnProperty(t)){continue}if(t.toLowerCase()===e){return t}}};let c=Math.max(1,Math.ceil((window.devicePixelRatio||1)*2)/2);let u=false;let d=false;["width","height"].forEach((function(e){if(!a[e]){return}let t=/^(\d+)(?:px)?$/.exec(a[e]);if(t===null){return}let i=Math.ceil(parseInt(t[1])*c);if(i>n.limit){return}if(s[e]&&i>=s[e]){return}d=d||i>n.throttle.start;let r="max"+e.substr(0,1).toUpperCase()+e.substr(1);r=l(r)||r;let f=o[r];if(f){if(/\D/.test(f)){return}f=parseInt(f)}if(f>i){return}u=true;o[r]=i}));if(!u){return t}if(d){if(parseInt(WH.MD5.hash(t).substr(-2),16)/255>n.throttle.percent/100){return t}}let f="";{let e=t.indexOf("#");if(e>=0){f=t.substr(e);t=t.substr(0,e)}}{let e=t.indexOf("?");if(e>=0){t=t.substr(0,e)}}let h=e.buildQuery(o);return t+"?"+h+f};this.buildQuery=function(e){let t=[];let a=Object.keys(e);a.sort((function(e,t){return e.localeCompare(t)}));for(let i,n=0;i=a[n];n++){if(!e.hasOwnProperty(i)){continue}if(e[i]===""){t.push(i)}else{t.push(i+"="+encodeURIComponent(e[i]).replace(/%3a/gi,":"))}}return t.join("&")};this.ensurePathSlash=function(e){if(e.substr(0,1)!=="/"){e="/"+e}return e};this.generate=function(t,a){a=a||{};let n,s;if(a.production){n=`www.${i}`;s="https:"}else{n=location.hostname;s=location.protocol}return s+"//"+n+e.generatePath(t,a.dataEnv,a.locale)};this.generateAnonymous=function(t,a){t=e.ensurePathSlash(t);let i=a?"?"+e.buildQuery(a):"";return`${location.protocol}//${n}.${WH.PageMeta.envDomain}${t}${i}`};this.generatePath=function(t,a,i){a=a||WH.getDataEnv();i=typeof i==="number"?i:Locale.getId();let n=Locale.getDataEnvForcedLocale(a);if(n!=null){i=n}if(t!==""){t=e.removePathPrefixes(t)}let s=[];let r=WH.Game.getSelectorByDataEnv(a);if(r){s.push(r)}let o=Locale.getSelector(i);if(o){s.push(o)}t=t.replace(/^\/+|\/+$/,"");if(t){s.push(t)}return"/"+s.join("/")};this.generatePrivate=t=>{t=e.ensurePathSlash(t);return`${location.protocol}//${s}.${WH.PageMeta.envDomain}${t}`};this.getAlternatePathCommand=(e,t)=>a[e]?.[t];this.getCanonical=function(){var e=WH.qs('link[rel="canonical"]');if(!e){return location.protocol+"//"+location.host+location.pathname+(location.search||"")}return e.href};this.getCanonicalPath=function(){var t=WH.qs('link[rel="canonical"]');if(!t){return location.pathname+(location.search||"")}return e.getPathFromUrl(t.href,true)};this.getDataPageUrl=function(t,a){let i=WH.getPageData("url.dataPageVersions")||{};let s=Locale.getId();a=a||WH.getDataEnv();let r=["dv="+i[t]||0,"db="+encodeURIComponent(WH.getDataCacheVersion(a)).replace(/%3a/gi,":")].join("&");let o=WH.isDataEnvRestricted(a)?WH.PageMeta.envDomain:`${n}.${WH.PageMeta.envDomain}`;let l=e.generatePath(`/data/${t}`,a,s);return`${location.protocol}//${o}${l}?${r}`};this.getLoginPath=function(t){let a="/account=signin";t=(t??location.pathname+location.search).replace(/^\//,"");if(t&&t.startsWith("account=signin")){t=WH.getGets().next||""}if(t){a+="?next="+encodeURIComponent(t)}return e.generatePath(a)};this.getModifiedPageQuery=function(e){let t=location.pathname;let a=location.search;let i=location.hash;if(!a){if(t.indexOf("&")>=0){a="?"+t.substr(t.indexOf("&")+1);t=t.substr(0,t.indexOf("&"))}}let n=WH.parseQueryString(a);e(n);let s=t;if(Object.keys(n).length){s+="?"+WH.Url.buildQuery(n)}s+=i;return s};this.getPathCommand=()=>e.removePathPrefixes(window.location.pathname);this.getPathFromUrl=function(e,t){if(t===true){return e.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^#]+).*$/,"/$1")}return e.replace(/^(?:(?:https?:)?\/\/[^/]+)?\/?([^?&#]+).*$/,"/$1")};this.getRegistrationPath=function(){return e.generatePath("/account=signup")};this.hasPathPrefixes=function(e){if(e.startsWith("/")){e=e.substr(1)}let t=e.replace(/^([^/?&]*)?([/?&].*)?$/,"$1");return WH.Game.getAllSelectors().includes(t)||Locale.getPathSelectors().includes(t)};this.parsePathPrefixes=function(e){let a={};let i=e.replace(/[?&#].*/,"").replace(/^\//,"").split("/");let n=t.getDataEnvBySelector(i[0]);if(n){a.dataEnv=n;i.shift()}let s=Locale.getBySelector(i[0]);if(s){a.locale=s}return a};this.isRelative=function(e){return!e.startsWith("mailto:")&&!/^(https?:)?\/\//.test(e)};this.parseQueryString=function(e){let t;if((t=e.indexOf("#"))>=0){e=e.substr(0,t)}t=e.indexOf("?");if(t<0){return{}}return WH.parseQueryString(e.substr(t+1))};this.pushHistory=function(t){if(!/^https?:/.test(t)){t=e.generatePath(t)}history.pushState({},"",t)};this.removePathPrefixes=function(a){let i=a.match(/^([^?&]*)?([?&].*)?$/);if(!i){WH.error("Could not parse path when attempting to remove path prefixes.",a);return e.ensurePathSlash(a)}if(i[1].startsWith("/")){i[1]=i[1].substr(1)}let n=i[1].split(/[/?&]/);if(t.getAllSelectors().includes(n[0])){n.shift()}if(Locale.getPathSelectors().includes(n[0])){n.shift()}return"/"+n.join("/")+(i[2]||"")};this.replaceHistory=function(t){if(!/^https?:/.test(t)){t=e.generatePath(t)}history.replaceState({},"",t)};this.replacePageQuery=function(t){let a=e.getModifiedPageQuery(t);if(a){history.replaceState({},"",a)}};function r(e){let t;if(t=e.match(/\/uploads\/blog\/(images|thumbs)\/(\d+)/)){let e=g_blogimages[t[2]];switch(t[1]){case"thumbs":return e?{width:e.thumbwidth,height:e.thumbheight}:{width:200,height:200};case"images":return e?{width:e.width,height:e.height}:{}}return{}}if(t=e.match(/\/uploads\/screenshots\/(normal|resized|small|thumb)\/(\d+)/)){let e=WH.Gatherer.get(WH.Types.GATHERER_SCREENSHOT,t[2]);let a;let i;switch(t[1]){case"normal":return e?{width:e.width,height:e.height}:{};case"resized":a=772;i=618;break;case"small":a=300;i=300;break;case"thumb":a=150;i=150;break}if(!a||!i){return{}}if(!e){return{width:a,height:i}}let n=e.width/e.height;let s=Math.min(a,e.width);let r=Math.round(s/n);if(r>i){r=i;s=Math.round(r*n)}return{width:s,height:r}}if(t=e.match(/\/uploads\/guide\/images\/(\d+)/)){let e=WH.Gatherer.get(WH.Types.GATHERER_GUIDE_IMAGE,t[1]);return e?{width:e.width,height:e.height}:{}}return{}}};WH.UserAgent=new function(){var e=["ahrefsbot","baiduspider","bingbot","bitdiscovery","blexbot","comscore.com/web-crawler","dotbot","duckduckbot","exabot","garlikcrawler","getintent","googlebot","ia_archiver","mail.ru_bot","mauibot","mediapartners-google","megaindex.com/crawler","mj12bot","naver.me/spd","petalbot","piplbot","protopage","rogerbot","semrushbot","sogou.com/docs/","viglink","weborama","yahoo! slurp","yandexbot","yandexmobilebot"];this.isWebCrawler=function(){var t=navigator.userAgent;if(!t){return false}t=t.toLowerCase();for(var a=0,i=e.length;a<i;a++){if(t.indexOf(e[a])!==-1){return true}}return false}};var vi_thumbnails={1:"//i3.ytimg.com/vi/$1/default.jpg"};var vi_siteurls={1:"https://www.youtube.com/watch?v=$1",2:"https://nether.wowhead.com/video-stream/$1"};var vi_sitevalidation=[/https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([^& ]{11})/i,/https?:\/\/(?:www\.)?youtu\.be\/([^& ]{11})/i];function vi_submitAVideo(){tabsContribute.focus(2)}function vi_validateForm(e){if(!e.elements["videourl"].value.length){alert(WH.TERMS.errorvideo_tip);return false}var t=false;for(var a in vi_sitevalidation){if(!vi_sitevalidation.hasOwnProperty(a)){continue}if(e.elements["videourl"].value.match(vi_sitevalidation[a])){t=true;break}}if(!t){alert(WH.TERMS.errorvideo_tip);return false}return true}function vi_appendSticky(){var e=WH.ge("infobox-sticky-vi");if(!e)return;var t=g_pageInfo.type;var a=g_pageInfo.typeId;var i=WH.inArray(lv_videos,1,(function(e){return e.sticky}));if(i!=-1){e.className="has-thumb";var n=lv_videos[i];var s=WH.ce("a");s.href="#videos:id="+n.id;s.onclick=function(e){VideoViewer.show({videos:lv_videos,pos:i});return WH.rfWithoutControlKey(e)};var r=WH.ce("img");r.src=WH.sprintf(vi_thumbnails[n.videoType].replace(/\/default\.jpg/,"/mqdefault.jpg"),n.videoId);r.className="border";WH.ae(s,r);WH.ae(e,s);var o=$("#infobox-videos");if(!o)o=$("th",$(e).parents().prev("tr"));o.append(" ("+lv_videos.length+")").wrapInner($('<a href="#videos"></a>').click((function(){tabsRelated.focus(tabsRelated.getTabById("videos"));return false})))}else if(g_user){var s;if(g_user.id>0)s='<a href="javascript:" onclick="vi_submitAVideo(); return false">';else s='<a href="'+WH.Strings.escapeHtml(WH.Url.generatePath(WH.Url.getLoginPath()))+'">';e.innerHTML=WH.sprintf(WH.TERMS.noneyet_format,s+WH.TERMS.suggestone_stc+"</a>")}else{$("#infobox-videos,#infobox-sticky-vi").closest("td, th").css("display","none")}vi_appendSticky=function(){}}var g_videos={};window.VideoViewer=new function(){const e=170-Lightbox.BLEED_SIZE;const t=20;const a=50;var i,n,s,r,o,l,c=0,u,d,f,h,p,m,H,g,W,E;function _(e){var t=i[e],a="#videos:";if(c==0)a+="id="+t.id;else a+=u+":"+(e+1);return a}function v(e){w();if(e&&o==1&&WH.getWindowSize().h>d.offsetHeight)return;d.style.visibility="hidden";var t=i[n];if(!e){var a=t.caption!=null&&t.caption.length;WH.Track.interactiveEvent("Videos","Show",t.id+(a?" ("+t.caption+")":""));g.href=WH.sprintf(vi_siteurls[t.videoType],t.videoId);switch(t.videoType){case 1:$(h).empty().append(WH.markup.getDomFragment("[youtube="+t.videoId+" width="+s+" height="+r+"]"));break;case 2:WH.ee(h);WH.ae(h,WH.ce("video",{controls:true,width:s,height:r},WH.ce("source",{src:WH.Url.generateAnonymous("/video-stream/"+t.id+"-"+t.videoId,{dataEnv:WH.dataEnv.MAIN,locale:LOCALE_ENUS})})));g.href=WH.sprintf(vi_siteurls[t.videoType],t.id+"-"+t.videoId);break}if(!t.user&&typeof g_pageInfo=="object")t.user=g_pageInfo.username;var l=t.date&&t.user,c=i.length>1;if(l){var u=new Date(t.date),f=(WH.getServerTime()-u)/1e3;var v=W.firstChild.childNodes[1];v.href=WH.Url.generatePath("/user="+t.user);v.innerHTML=t.user;var b=W.firstChild.childNodes[3];WH.ee(b);WH.formatDate(b,f,u);W.firstChild.style.display=""}else W.firstChild.style.display="none";var b=W.childNodes[1];WH.ee(b);b=W.childNodes[2];if(c){var S="";if(t.user)S=WH.TERMS.dash_punct;S+=n+1+WH.TERMS.of_lc+i.length;b.innerHTML=S;b.style.display=""}else b.style.display="none";W.style.display=l||c?"":"none";var y=t.subject!=null&&t.subject.length&&t.type&&t.typeId;if(a||y){var I="";if(y){var R=WH.ce("div");WH.ae(R,WH.ct(WH.Types.getUpperSingular(t.type)+WH.TERMS.colon_punct));WH.ae(R,WH.ce("a",{href:WH.Entity.getUrl(t.type,t.typeId)},WH.ct(t.subject)));I+=R.innerHTML}var N=document.createDocumentFragment();if(a){if(y){I+=WH.TERMS.dash_punct}N=t.noMarkup?document.createTextNode(t.caption):WH.markup.getDomFragment(t.caption,{mode:WH.markup.MODE.SIGNATURE})}$(E).html(I).append(N);E.style.display=""}else E.style.display="none";if(i.length>1){p.href=_(T(-1));m.href=_(T(1));p.style.display=m.style.display="";H.style.display="none"}else{p.style.display=m.style.display="none";H.style.display=""}location.replace(_(n))}else $("object, embed",h).each((function(){this.width=s;this.height=r}));Lightbox.reveal();d.style.visibility="visible"}function T(e){var t=n;t+=e;if(t<0)t=i.length-1;else if(t>=i.length)t=0;return t}function b(){n=T(-1);v();return false}function S(){n=T(1);v();return false}function y(e){switch(e.keyCode){case 37:b();break;case 39:S();break}}function I(){v(1)}function R(){WH.ee(h);if(i.length>1)WH.dE(document,"keyup",y);if(l&&c==0){if(l.indexOf(":id=")!=-1)l="#videos";WH.setHash(l)}else WH.clearHash()}function N(e,t,a){if(typeof a.videos=="string"){i=g_videos[a.videos];c=1;u=a.videos}else{i=a.videos;c=0;u=null}d=e;n=0;if(a.pos&&a.pos>=0&&a.pos<i.length)n=a.pos;if(t){e.className+=" has-lightbox-caption screenshotviewer";f=WH.ce("div");f.className="lightbox-content screenshotviewer-screen";var s=WH.ce("div");var r=WH.ce("div");s.className="screenshotviewer-page-wrapper screenshotviewer-prev-wrapper";r.className="screenshotviewer-page-wrapper screenshotviewer-next-wrapper";p=WH.ce("a");m=WH.ce("a");p.className="screenshotviewer-prev";m.className="screenshotviewer-next";p.href="javascript:";m.href="javascript:";var o=WH.ce("span");o.className="fa fa-chevron-left";WH.ae(p,o);o=WH.ce("span");o.className="fa fa-chevron-right";WH.ae(m,o);p.onclick=b;m.onclick=S;H=WH.ce("a");H.className="screenshotviewer-cover";H.href="javascript:";H.onclick=Lightbox.hide;var _=WH.ce("span");var T=WH.ce("b");WH.ae(T,WH.ct(WH.TERMS.close));WH.ae(_,T);WH.ae(H,_);WH.ae(s,p);WH.ae(r,m);WH.ae(f,s);WH.ae(f,r);WH.ae(f,H);h=WH.ce("div",{className:"screenshotviewer-image"});WH.ae(f,h);WH.ae(e,f);var I=WH.ce("a");I.className="dialog-option fa fa-times";I.href="javascript:";I.onclick=Lightbox.hide;WH.ae(I,WH.ct(WH.TERMS.close));WH.ae(e,I);g=WH.ce("a");g.className="dialog-option fa fa-external-link";g.href="javascript:";g.target="_blank";WH.ae(g,WH.ct(WH.TERMS.original));WH.ae(e,g);var R=WH.ce("div",{className:"lightbox-caption"});W=WH.ce("div");W.className="screenshotviewer-from";var N=WH.ce("span");WH.ae(N,WH.ct(WH.TERMS.from));WH.ae(N,WH.ce("a"));WH.ae(N,WH.ct(" "));WH.ae(N,WH.ce("span"));WH.ae(W,N);WH.ae(W,WH.ce("span"));WH.ae(W,WH.ce("span"));WH.ae(R,W);E=WH.ce("div");E.className="screenshotviewer-caption";WH.ae(R,E);WH.ae(e,R)}l=location.hash;if(i.length>1)WH.aE(document,"keyup",y);v()}function w(){s=Math.floor(window.innerWidth-Lightbox.BLEED_SIZE-e-t);r=Math.floor(s*(9/16));let i=r+Lightbox.BLEED_SIZE+a;if(i>window.innerHeight){r=Math.floor(window.innerHeight-Lightbox.BLEED_SIZE-a);s=Math.floor(r*(16/9))}Lightbox.setSize(s+t)}this.checkPound=function(){if(location.hash&&location.hash.indexOf("#videos")==0){if(!g_listviews["videos"]){var e=location.hash.split(":");if(e.length==3){var t=g_videos[e[1]],a=parseInt(e[2]);if(t&&a>=1&&a<=t.length){VideoViewer.show({videos:e[1],pos:a-1})}}}}};this.show=function(e){Lightbox.show("videoviewer",{onShow:N,onHide:R,onResize:I},e);return false};$(document).ready(this.checkPound)};WH.WarcraftLogs=new function(){const e=WH.Gatherer;const t=WH.Types;this.displayTopSpells=function(e,t,a,i,n){var s=WH.ce("div",{className:a});WH.ae(s,WH.getImitationHeading(t,6));var r=WH.ce("table");var o=WH.ce("tr",{className:a+"-popularity"});var l=WH.ce("tr",{className:a+"-icon"});WH.ae(r,o);WH.ae(r,l);var c=0;if(i){for(var u=0,d;d=i[u];u++){var f=WH.Gatherer.get(WH.Types.SPELL,d.id);if(!f){continue}var h=WH.Entity.getUrl(WH.Types.SPELL,d.id,f.name);var p=WH.Icon.create(f.icon,WH.Icon.SMALL,h,{span:true});var m=Icon.getLink(p);m.setAttribute("data-whattach","true");if(n){m.target="_blank"}var H=WH.ce("td");WH.ae(H,p);WH.ae(o,WH.ce("td",{innerHTML:Math.round(d.pop)+"%"}));WH.ae(l,H);c++}}var g=0;if(!c){WH.de(l);var W=WH.ce("td",{innerHTML:WH.TERMS.notenoughdata});WH.ae(o,W);g++}WH.ae(s,r);if(e instanceof jQuery){e.append(s)}else{WH.ae(e,s)}return g};this.getCovenantTooltip=function(a){let i=WH.ce("div");WH.ae(i,WH.ce("b",{className:"q1"},WH.ct(e.getName(t.COVENANT,a.id))));let n=WH.ce("table",{style:{marginTop:"10px"}});WH.ae(i,n);a.soulbinds.forEach((function(a){let i=WH.ce("td",{className:"q",style:{paddingRight:"3px",textAlign:"right"}},WH.ct(WH.Strings.formatNumber(a.pop/100,true,0,1)));let s=a.id?e.getName(t.SOULBIND,a.id):null;if(!s){if(a.pop<.5){return}s=WH.TERMS.unknown+" / "+WH.TERMS.none}let r=WH.ce("td",{className:"q",style:{whiteSpace:"nowrap"}},WH.ct(s));let o=WH.ce("tr");WH.ae(o,i);WH.ae(o,r);WH.ae(n,o)}));return i.innerHTML}};WH.WAS=new function(){const e=this;const t=WH.DOM;const a=WH.DynamicFixedElement;const i=WH.Layout;const n=WH.LocalStorage;const s=WH.Responsive;const r=WH.Time;this.ANIMATION_DURATION_MS=333;this.EVENT_MOBILE_FOOTER_REMOVED="wh-mobile-footer-ad-removed";this.EVENT_MOBILE_FOOTER_CREATED="wh-mobile-footer-ad-created";this.EVENT_SIDEBAR_2_REMOVED="wh-sidebar-2-ad-removed";var o=1e3*60*10;const l=1360;var c="Other";var u="Other";const d=150;const f=20;const h=["https://securepubads.g.doubleclick.net/tag/js/gpt.js","https://cdn.dotaoutpost.com/stable/js/wowhead.js?type=ab","https://www.googletagmanager.com/gtm.js?id=GTM-KN7HXDF","https://zaf.api.fanbyte.com/stable/js/wowhead.js"+(()=>{let e=WH.parseQueryString(WH.getQueryString());return e.zafId?`?id=${e.zafId}`:""})()];const p="skinned";const m=[p,"skinned-3rd-party"];const H=["flex-leaderboard-active","flex-leaderboard-docked","flex-skin-active","flex-skin-docked"];const g="takeover-active";const W=Math.floor(Date.now()/1e3)%10===0;const E="responsive";const _="horizontal";const v="horizontalBTF";const T="mobileFooter";const b="mobileMedrec";const S="skin";const y="vertical";const I="verticalBTF";const R={};R[E]="responsive-block-bg is-atf";R[_]="horizontal-block-bg is-atf";R[v]="horizontal-block-bg is-btf";R[y]="vertical-block-bg is-atf";R[I]="vertical-block-bg is-btf";R[S]="skin-block-bg";R[T]="mobile-fixed-footer-block-bg";R[b]="block-block-bg is-btf";const N={elements:{skinLeft:undefined,skinRight:undefined,skinWrapper:undefined},hasVideo:false,isFlexSkinned:false,isSkinned:false,maxLayoutWidth:undefined,mobileFooterAdExists:false,postSkinSetupCallbacks:[],rejected:{},removeVideoCallbackRegistered:false,removed:false,skin:null,skinOffsetUpdateTimer:undefined,targetData:{}};this.init=function(t,a){if(!e.showAds()){return}s.initPrimis();F();N.targetData=t;if(a instanceof Array){P(a)}};this.addMobileMedrec=function(e){if(window.innerWidth>=768){return}if(WH.ge("ad-"+b)){return}let t=WH.qs(e);if(!(t instanceof Node)){WH.error("Failed to find mobile medrec target.",e);return}WH.ae(t,WH.ce("div",{className:"block-block-bg"},WH.ce("div",{id:"ad-"+b})));this.display(b)};this.addPostSkinSetupCallback=function(e){if(typeof e=="function"){N.postSkinSetupCallbacks.push(e)}};this.assign=function(e,t,a){let i=WH.qs(`.${R[e].replace(" ",".")} > div`,t);if(i){i.dataset.zafMaxDimensions=A(a);return}let n={className:"banner-ad",dataset:{zafMaxDimensions:A(a)},id:"ad-"+e};let s=WH.ce("div",n);WH.ae(t,WH.ce("div",{className:R[e]},s));t.parentNode.dataset.collapsed="false";this.display(e)};this.display=function(e){if(e===I){zamaf._defineAndDisplaySlot(`ad-${e}`)}else{zamaf.cmd.push((function(){zamaf.displaySync("ad-"+e)}))}};this.displaySkin=function(t){let a=window.innerWidth<l;let i=X();let n=!t.creatives||!t.creatives.left||!t.creatives.right;if(a||i||n){Q("Skin rejected by Wowhead",a?"Not enough space":i?"Suppressing ads for Blizzard":n?"Not a sides-only skin":"");e.removeSkin();return false}if(N.skin!==null){e.removeSkin(true)}N.skin=t;document.body.classList.add(p);J();let s=t.clickMacro?`${t.clickMacro}${t.link}`:t.link;N.elements.skinWrapper=WH.ce("div",{className:"skin-wrapper"});N.elements.skinLeft=WH.ce("a",{className:"skin-left",href:s,style:"background: url("+t.creatives.left+")",target:"_blank"});N.elements.skinRight=WH.ce("a",{className:"skin-right",href:s,style:"background: url("+t.creatives.right+")",target:"_blank"});WH.ae(N.elements.skinWrapper,N.elements.skinLeft);WH.ae(N.elements.skinWrapper,N.elements.skinRight);WH.aef(document.body,N.elements.skinWrapper);e.updateSkinMode();e.updateSkinPosition();WH.aE(window,"scroll",(function(){e.updateSkinPosition(true)}));B(t);WH.Track.nonInteractiveEvent("Skin","Skin Displayed",t.creative,t.lineItem);return true};this.fillDynamicUnits=function(){if(!e.showAds()){return}zamaf.cmd.push((function(){zamaf.displayAllDynamic()}))};this.getChannelGroup=function(){return N.targetData.channelGroup||c};this.getChannelName=function(){return N.targetData.channelName||u};this.getDfpLog=function(){let e=n.get(n.KEY_WAS_DFP_LOG);return Array.isArray(e)?e:[]};this.hasVideo=function(){return N.hasVideo};this.hideAll=function(){var e=L();e.attr("data-hidden-by-was","true")};this.initVideo=function(){if(!e.showAds()){e.removeVideo(false);return}N.hasVideo=true;WH.Responsive.test()};this.intersect=function(e,t){var a;var i;var n=L();for(var s=0,r=n.length;s<r;++s){var o=n[s];if(o){if(!x(o)){a=WH.ac(o);i=WH.createRect(a.x,a.y,o.offsetWidth,o.offsetHeight);if(WH.intersectRect(e,i)){if(t){k(o)}return o}}}}return false};this.isFlexSkinned=()=>N.isFlexSkinned;this.isSkinned=function(){return N.skin!==null||document.body.classList.contains("skinned")};this.logFallbackPosition=function(){Q("Video unit used fallback position")};this.onMobileFooterCreated=t=>{WH.aE(document.body,e.EVENT_MOBILE_FOOTER_CREATED,t);N.mobileFooterAdExists&&requestAnimationFrame(t)};this.remove=function(t,a){a=!!a;if(t!=="responsive"){K("ad-"+t,a)}else{let i=WH.qs(`.${R[t].replace(" ",".")} > div`);if(i){e.removeVideo(a);K(i.id,a)}}};this.removeAll=function(t){N.removed=true;t=t!==false;e.removeVideo(t);K("ad-"+E,t);K("ad-"+y,t);K("ad-"+_,t);K("ad-"+v,t);K("ad-"+T,t);K("ad-"+b,t);let a=WH.qsa(".dynamic-ad");if(a.length){if(t){$(a).slideUp({complete:function(){a.forEach(WH.de)},duration:e.ANIMATION_DURATION_MS})}else{a.forEach(WH.de)}}setTimeout((function(){WH.qsa("[data-contains-block]").forEach((function(e){delete e.dataset.containsBlock}));WH.qsa("[data-left-contains-block]").forEach((function(e){delete e.dataset.leftContainsBlock}))}),t?e.ANIMATION_DURATION_MS+1:1);e.removeSkin()};this.removeSkin=function(e){if(N.elements.skinWrapper){WH.de(N.elements.skinWrapper)}if(e!==true){$("#ad-skin, .skin--link").remove();document.body.classList.remove("body--skin","body--prelude");WH.de("div#pw-oop-flex_leaderboard_container");WH.de("div#bgdiv");document.body.style.background=""}document.documentElement.classList.remove(g);m.concat(H).forEach((e=>document.body.classList.remove(e)));J();N.skin=null;WH.Layout.Responsive.updateHeaderOffset();Y()};this.removeVideo=function(a){if(document.readyState==="loading"&&!N.removeVideoCallbackRegistered){N.removeVideoCallbackRegistered=true;WH.onLoad(e.removeVideo.bind(this,a))}N.hasVideo=false;WH.qsa("#video-pos-body, #video-pos-page, .blocks-video").forEach((e=>WH.de(e)));let i=WH.qs("#main > .blocks");if(i&&t.isEmpty(i)){V(_,i,a!==false)}};this.restoreHidden=function(){$('[data-hidden-by-was="true"]').attr("data-hidden-by-was","false")};this.showAds=function(){return g_user.ads&&!N.removed};this.updateSkinMode=function(){if(!e.isSkinned()){return}if(i.getFullscreenMode()){document.body.dataset.skinMode="standard";return}let t=i.getElement("layout");if(!N.maxLayoutWidth){N.maxLayoutWidth=t&&parseInt(getComputedStyle(t).getPropertyValue("max-width"))||undefined;if(N.maxLayoutWidth){N.maxLayoutWidth--}}document.body.dataset.skinMode=N.maxLayoutWidth&&t&&t.offsetWidth>=N.maxLayoutWidth?"large-screen":"standard"};this.updateSkinPosition=function(t){if(t){clearTimeout(N.skinOffsetUpdateTimer);N.skinOffsetUpdateTimer=setTimeout((()=>N.skinOffsetUpdateTimer=undefined),d+1)}if(N.skinOffsetUpdateTimer){requestAnimationFrame((()=>e.updateSkinPosition()))}if(!e.isSkinned()){return}let a=i.getHeaderBottom();if(!a||!N.elements.skinLeft||!N.elements.skinRight){return}N.elements.skinLeft.style.top=a+"px";N.elements.skinRight.style.top=a+"px"};this.validateUnit=function(t){if(!e.showAds()||N.rejected[t]){delete N.rejected[t];K(t)}};function w(e,t){var a="block-remove";if([S,T].indexOf(e)>-1||$("."+a,t).length){return}var i=WH.ce("a",{href:WH.Url.generatePath("/premium"),className:a},WH.ct(WH.TERMS.removeallads));WH.ae(t,i)}function A(e){return`${e.width}x${e.height}`}function M(t,a,i){var n=e.getChannelName().match(/\bTest\b/)||WH.isDev()||WH.User.hasRole(U_GROUP_ADMIN);var s=[0,0];var r=WH.ge(a);if(r.dataset.unitWidth&&r.dataset.unitHeight){s=[parseInt(r.dataset.unitWidth),parseInt(r.dataset.unitHeight)]}if(!U(s,i)){var o=WH.qs("iframe",a);if(o){s=[parseInt(o.getAttribute("width")),parseInt(o.getAttribute("height"))];if(n){WH.warn("IFRAME UNIT SIZES:",s[0],s[1],"FROM THIS IFRAME:",o)}}}return s}function C(e){if(e.id&&e.id.indexOf("skin")!==-1){return e}if(e.getAttribute("data-was-unit")==="true"){return e.parentNode}if(e.getAttribute("data-was-parent")==="true"){return e}if(e.parentNode.getAttribute("data-was-unit")==="true"){return e.parentNode.parentNode}if(e.parentNode.getAttribute("data-was-parent")==="true"){return e.parentNode}if(e.className){var t=O();var a=false;if(t.indexOf(e.className)>-1){a=true}if(!a){for(var i=0,n;n=t[i];i++){if(e.className.indexOf(n)>-1){a=true;break}}}if(!a){return e.parentNode}}else{return e.parentNode}return e}function O(){var e=[];for(var t in R){if(e.indexOf(R[t])===-1){e.push(R[t])}}O=function(e){return e}.bind(null,e);return e}function L(){return $("."+O().join(", ."))}function k(e){var t=C(e);t.setAttribute("data-hidden-by-was","true")}function D(){if(!e.showAds()){return}if(document.monetization){Q("Coil monetization detected");WH.ae(document.head,WH.ce("meta",{content:"$ilp.uphold.com/bq2m3aJwgwxZ",name:"monetization"}));let e=n.get(n.KEY_WAS_COIL_START_TIME);let t=!!(!isNaN(e)&&e+r.MS_DAY>=(new Date).getTime());try{document.monetization.addEventListener("monetizationstart",(function(){n.set(n.KEY_WAS_COIL_START_TIME,(new Date).getTime());Q("Coil monetization validated");if(!t){i.expandSite(false)}}))}catch(e){}if(t){i.expandSite(false);return}}t.onBodyAvailable((()=>{let e=new MutationObserver(J);e.observe(document.documentElement,{attributes:true,attributeFilter:["class"]});e.observe(document.body,{attributes:true,attributeFilter:["class"]});J()}));window.zamaf=window.zamaf||{};zamaf.cmd=zamaf.cmd||[];var a=WH.isBlizzardReferral();if(a){var s=Date.now?Date.now():(new Date).getTime();n.set(n.KEY_WAS_BLIZZARD_REFERRAL_TIME,s+o);if(a==="brl"){var l=(""+location.href).replace(/[\?&]brl=[^\?&#]*/,"").replace(/[\?&]brl\b/,"").replace(/^(https?:\/\/[^\/]+\/)home$/,"$1");if(window.history){window.history.replaceState({},"",l)}else{location.replace(l)}}}}function P(t){zamaf.setTargeting=function(){googletag.pubads().setTargeting("Channel",N.targetData.channelName);googletag.pubads().setTargeting("ChannelGroup",N.targetData.channelGroup);googletag.pubads().setTargeting("DataEnvironment",N.targetData.dataEnv);googletag.pubads().setTargeting("DataTree",N.targetData.dataTree);if(N.targetData.entityType){googletag.pubads().setTargeting("EntityType",N.targetData.entityType)}googletag.pubads().setTargeting("Game",N.targetData.game);googletag.pubads().setTargeting("Universe",N.targetData.universe)};zamaf.slotRenderCallback=Z.bind(e);zamaf.skinRenderCallback=e.displaySkin.bind(e);zamaf.cmd.push({event:"zaf:slot:rejected",handler:G})}function x(e,t){var a=C(e);if(a){if(t){return a.style.visibility=="hidden"}else{return a.getAttribute("data-hidden-by-was")=="true"}}return false}function U(e,t){if([S,T].indexOf(t)>=0){return true}return e&&e[0]&&e[1]&&e[0]!==1&&e[1]!==1}function F(){window.googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:"gtm.js","gtm.start":(new Date).getTime()});for(let e=0,t;t=h[e];e++){WH.ae(document.head,WH.ce("script",{async:true,src:t}))}}function q(t,a,i){var s={_time:(new Date).toUTCString(),_slot:a,_channelName:e.getChannelName(),_channelGroup:e.getChannelGroup()};if(i){s._error=i}for(var r in t){if(t.hasOwnProperty(r)&&(typeof t[r]!=="object"||!t[r]||r==="size")){s[r]=t[r]}}var o=e.getDfpLog().slice(0,f-1);o.unshift(s);n.set(n.KEY_WAS_DFP_LOG,o)}function Y(){WH.qsa(".element-highlight:not(#highlight-highlight-classic)").forEach((e=>WH.de(e)));s.test();a.checkAll()}function B(e){N.postSkinSetupCallbacks.forEach((t=>t(e)));Y()}function G(e,t){if(e&&typeof e.elementId==="string"){Q("Unit rejected by ZAF",e.elementId);WH.debug(e.elementId+" unit rejected by ZAF.",e);K(e.elementId)}else{WH.debug("Unknown unit rejected by ZAF.",e)}}function z(a,i,n){if(!a){return}let s=a.parentNode;if(!s){return}WH.de(a);switch(i){case _:e.removeVideo();case v:let r=s.closest(".block-pair");let o=r.closest(".blocks");WH.de(r);V(i,o,n);break;case b:let l=function(){WH.de(a);if(t.isEmpty(s)){WH.de(s)}};if(n){$(a).slideUp({complete:l,duration:e.ANIMATION_DURATION_MS})}else{l()}break;case y:WH.de(".sidebar-wrapper");document.body.dataset.sidebar="false";WH.Layout.updateContentHeight();break;case I:document.dispatchEvent(new Event(e.EVENT_SIDEBAR_2_REMOVED,{bubbles:true,cancelable:false}));break;case E:document.body.dataset.blocksCollapsed="true";break}if(zamaf._getGlobals){let e=zamaf._getGlobals().globalSlots["ad-"+i];if(e){zamaf.destroySlot(e.elementId,e.slot)}}}function V(a,i,n){if(i){let a=function(){if(t.isEmpty(i)){WH.de(i)}};if(n){i.style.height="250px";i.style.minHeight="0";$(i).slideUp({complete:a,duration:e.ANIMATION_DURATION_MS})}else{a()}}if(a===_){document.body.classList.add("no-horizontal");let t=WH.qs(".sidebar");if(t){if(n){$(t).animate({top:"0px"},e.ANIMATION_DURATION_MS,false)}else{t.style.top="0px"}}}}function K(t,a){WH.debug("Removing "+t+" unit.");if(typeof t!=="string"){return}var i=WH.ge(t);if(!i){N.rejected[t]=true;return}if(t.indexOf("video-pos-")===0){e.removeVideo(false)}else{z(C(i)||i,t.replace(/^ad-/,"").replace(/(-u)*$/,""),a===true)}}function j(t,a,i,n){var s=C(a);if(!s){Q("Impression shown but slot callback failed",t);return}i=parseInt(i);n=parseInt(n);s.className=s.className.replace(/ *\bis-[0-9]+x[0-9]+\b/g,"");s.className+=" is-"+i+"x"+n;w(t,s);if(t===T){N.mobileFooterAdExists=true;document.body.dispatchEvent(new CustomEvent(e.EVENT_MOBILE_FOOTER_CREATED));if(!s.querySelector(".mobile-footer-closer")){let t=WH.ce("a",{className:"mobile-footer-closer"});t.onclick=function(){WH.de(this.parentNode);N.mobileFooterAdExists=false;document.body.dispatchEvent(new CustomEvent(e.EVENT_MOBILE_FOOTER_REMOVED))};s.appendChild(t)}}var r=i+"x"+n;if(i===728||i===970){var o=s.parentNode.parentNode;o.setAttribute("data-contains-block",r);if(o.parentNode&&o.parentNode.parentNode&&o.parentNode.parentNode.parentNode&&o.parentNode.parentNode.parentNode.setAttribute){o.parentNode.parentNode.parentNode.setAttribute("data-contains-block",r)}}else if(typeof t==="string"&&t.match(/^vertical/)){let e=WH.closest(a,".sidebar");if(e){e.dataset.containsSidebarBlock=r}let t=WH.qs(".layout-wrapper");if(t){t.dataset.containsSidebarBlock=r}WH.Layout.updateContentHeight()}}function Z(e){var t=e.slot.getSlotElementId();var a=t.replace("ad-","");if(a===S){let e=WH.ge("ad-skin");if(e){WH.onMutate(e,WH.Layout.Responsive.check.bind(null,true),{attributes:true})}WH.Layout.Responsive.check(true);return}var i=WH.ge(t);if(i&&i.className.indexOf("zamaf-au")>-1){return}if(!i){var n='Div for DFP unit "'+a+'" not found!';WH.debug(n);q(e,a,n);return}if(e.isEmpty){WH.info("No slot rendered in DFP event!",e);q(e,null,"No slot rendered in DFP event.");return}q(e,a);var s=M(e,i,a);j(a,i,s[0],s[1]);if(WH.qs(".block-report",i.parentNode)){return}var r=WH.ce("a",{text:WH.TERMS.reportad,className:"block-report",onclick:function(e,t){WH.Layout.expandSite();ContactTool.show();$('select[name="reason"]').val(9);setTimeout((function(){$('input[name="email"]').focus()}),1)}.bind(null,i,a)});WH.ae(i.parentNode,r)}function X(){var e=WH.isBlizzardReferral();let t=n.get(n.KEY_WAS_BLIZZARD_REFERRAL_TIME);if(t){var a=Date.now?Date.now():(new Date).getTime();if(!isNaN(t)&&t>a&&t<a+o+1e3*20){e=true}else{n.remove(n.KEY_WAS_BLIZZARD_REFERRAL_TIME)}}X=function(e){return e}.bind(null,e);return e}function Q(e,t,a){if(W){WH.Track.nonInteractiveEvent("Ads",e,t,a)}}function J(){let t=N.isSkinned;N.isFlexSkinned=document.documentElement.classList.contains(g)||H.some((e=>document.body.classList.contains(e)));N.isSkinned=N.isFlexSkinned||m.some((e=>document.body.classList.contains(e)));document.body.dataset.bgActive=`${N.isSkinned}`;if(N.isSkinned!==t){window.dispatchEvent(new Event("resize"));if(N.isFlexSkinned){e.remove(y)}}WH.WAS.updateSkinPosition()}D()};var WAS={displaySkin:WH.WAS.displaySkin};WH.Weights=new function(){this.allowWeights=function(){return!WH.isRetailTree()};this.getCategoryNames=function(){return WH.getPageData("items.weightPresets.categoryNames")||{}};this.getPresets=function(){return WH.getPageData("items.weightPresets")||{}}};function wt_getScaleFacetOptions(e,t){var a=[];if(e){if(e.weights){for(var i in e.weights){if(e.weights.hasOwnProperty(i)){a.push([i,e.weights[i]])}}}else{for(var i=0,n;n=items_filterConfig.filters[i];i++){if(n.stat&&WH.Wow.Item.Stat.jsonToName(n.stat)&&e[n.stat]){a.push([n.id,e[n.stat]])}}}}a.sort((function(e,t){return-WH.stringCompare(e[1],t[1])}));var s=[],r=[];for(var o=0,l;l=a[o];o++){s.push(l[0]);r.push(l[1])}if(s.length&&r.length){var c={weights:s.join(":"),"weight-values":r.join(":")};if(t){c["gem-quality"]=3}return c}return{}}function wt_getScaleFilter(e,t){if(!WH.Weights.allowWeights()){return""}var a=wt_getScaleFacetOptions(e,t);if(a.weights&&a["weight-values"]){var i=";";if(t){i="&"}else if(typeof a["gem-quality"]!="undefined"){i+="gm="+a["gem-quality"]+";"}i+="weights="+a.weights+(t?"&":";")+"weight-values="+a["weight-values"];return i}return""}function wt_getScaleUrlSegment(e,t){var a=wt_getScaleFacetOptions(e,t);if(a.weights&&a["weight-values"]){var i="";if(!t&&typeof a["gem-quality"]!="undefined"){i+="/gem-quality:"+a["gem-quality"]}i+="/weights:"+a.weights+"/weight-values:"+a["weight-values"];return i}return""}function wt_showClassPresetMenu(e,t,a,i,n,s){const r=WH.Url;if(!(t&&i&&n)){return}var o=[[,WH.TERMS.chooseclassspec]];let l=r.generatePath("/items");for(var c=0,u;u=items_filterConfig.categories[c];c++){if(u.id==i){l+="/"+u.url;break}}if(i==4&&n){l+="/slot:"+n}var d="";var f="/live-only:on/group-by:"+(i==2?"slot":"source")+"?filter=161;1;0";if(i==2){if(Locale.getName()=="enus"){let e=WH.Wow.Item.getInvTypeName(n);if(e){f+="#"+WH.Strings.slug(e)}}else{f+="#slot-"+n}}if(g_user.weightscales&&g_user.weightscales.length){var h=[0,WH.TERMS.custom,undefined,[]];o.push(h);for(var p=0,m;m=g_user.weightscales[p];p++){d=wt_getScaleUrlSegment(m)+"/upgrade-for:"+t;if(a&&a.length){d+="/upgrade-bonuses:"+a.join(":")}h[3].push([m.id,m.name,l+d+f])}}var H=WH.isSet("g_items")&&g_items[t]?g_items[t].specs:null;let g=WH.Weights.getPresets();let W=WH.Weights.getCategoryNames();for(var E in g){if(!g.hasOwnProperty(E)){continue}var _=[E,WH.Wow.PlayerClass.getName(E),undefined,[],{className:"c"+E,tinyIcon:WH.Wow.PlayerClass.getIconName(E)}];if(H!=null&&H.length>0&&g_chr_specs_by_class[E]){var v=g_chr_specs_by_class[E];var T=false;for(var b in v){if(v.hasOwnProperty(b)&&WH.inArray(H,v[b])!=-1){T=true;break}}if(!T){continue}}o.push(_);var S=0;var y=0;for(let e in g[E]){if(!g[E].hasOwnProperty(e)){continue}_[Menu.ITEM_SUBMENU].push([undefined,W[e]||WH.term("itemlevel_format",e)]);y++;for(let i in g[E][e]){if(!g[E][e].hasOwnProperty(i)){continue}T=H==null||H.length==0;if(!T){for(let e in H){if(H.hasOwnProperty(e)&&i===H[e]){T=true;break}}}if(T){d="/class:"+E+wt_getScaleUrlSegment(g[E][e][i])+"/upgrade-for:"+t;if(a&&a.length){d+="/upgrade-bonuses:"+a.join(":")}_[Menu.ITEM_SUBMENU].push([S,g[E][e][i].meta.label,l+d+f,,{tinyIcon:g[E][e][i].meta.__icon}]);S++}}}if(y===1){_[Menu.ITEM_SUBMENU].shift()}}Menu.sort(o);Menu.show(o,e)}WH.Wow=new function(){const e=this;this.INVENTORY_SLOT_AMMO=0;this.INVENTORY_SLOT_HEAD=1;this.INVENTORY_SLOT_NECK=2;this.INVENTORY_SLOT_SHOULDERS=3;this.INVENTORY_SLOT_SHIRT=4;this.INVENTORY_SLOT_CHEST=5;this.INVENTORY_SLOT_WAIST=6;this.INVENTORY_SLOT_LEGS=7;this.INVENTORY_SLOT_FEET=8;this.INVENTORY_SLOT_WRISTS=9;this.INVENTORY_SLOT_HANDS=10;this.INVENTORY_SLOT_FINGER_1=11;this.INVENTORY_SLOT_FINGER_2=12;this.INVENTORY_SLOT_TRINKET_1=13;this.INVENTORY_SLOT_TRINKET_2=14;this.INVENTORY_SLOT_BACK=15;this.INVENTORY_SLOT_MAIN_HAND=16;this.INVENTORY_SLOT_OFF_HAND=17;this.INVENTORY_SLOT_RANGED=18;this.INVENTORY_SLOT_TABARD=19;this.INVENTORY_SLOTS_WITH_MODELS=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_TABARD];if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()){this.INVENTORY_SLOTS_WITH_MODELS.push(this.INVENTORY_SLOT_RANGED)}this.PAPERDOLL_SLOT_ORDER=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_NECK,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_BACK,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_SHIRT,this.INVENTORY_SLOT_TABARD,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_FINGER_1,this.INVENTORY_SLOT_FINGER_2,this.INVENTORY_SLOT_TRINKET_1,this.INVENTORY_SLOT_TRINKET_2,this.INVENTORY_SLOT_MAIN_HAND,this.INVENTORY_SLOT_OFF_HAND,this.INVENTORY_SLOT_RANGED,this.INVENTORY_SLOT_AMMO];this.SIDE_ANY=0;this.SIDE_ALLIANCE=1;this.SIDE_HORDE=2;this.SIDE_BOTH=3;const t=[this.INVENTORY_SLOT_HEAD,this.INVENTORY_SLOT_SHOULDERS,this.INVENTORY_SLOT_CHEST,this.INVENTORY_SLOT_WAIST,this.INVENTORY_SLOT_LEGS,this.INVENTORY_SLOT_FEET,this.INVENTORY_SLOT_WRISTS,this.INVENTORY_SLOT_HANDS];const a={[e.SIDE_ALLIANCE]:"alliance",[e.SIDE_HORDE]:"horde"};const i={};i[e.SIDE_ANY]="any";i[e.SIDE_ALLIANCE]="alliance";i[e.SIDE_HORDE]="horde";i[e.SIDE_BOTH]="both";const n=1e4;const s=100;const r=1;const o=WH.getPageData("wow.versions")||[];const l={invSlotNames:undefined};this.buildMoney=function(e){var t={};if(e.copper){t.unnamed=e.copper.toString()}if(e.items&&e.items.length){t.items="";for(var a,i=0;a=e.items[i];i++){t.items+=(t.items?",":"")+a[0]+","+a[1]}}if(e.currencies&&e.currencies.length){t.currency="";for(var n,i=0;n=e.currencies[i];i++){t.currency+=(t.currency?",":"")+n[0]+","+n[1]}}if(e.achievementPoints){t.achievement=e.achievementPoints.toString()}return WH.markup.tags.money.toNode(t)};this.getApiSlot=t=>e[`INVENTORY_SLOT_${t}`]??e[`INVENTORY_SLOT_${t}S`];this.getInventorySlotName=function(e){l.invSlotNames=l.invSlotNames||WH.getPageData("wow.invSlotNames")||{};return l.invSlotNames[e]};this.getPatchVersionObject=function(e,t){var a=t||WH.Wow.getVersionList();var i=false;if(!e){e=Date.now();i=true}var n="?????";var s={build:999999,timestamp:9999999999999,version:n,versionNum:999999};for(var r=0,o;o=a[r];r++){if(o.timestamp<=e&&(s.version=="?????"||s.build<o.build)){s=o}}if(WH.isDev()&&s.version===n){if(i){WH.error("Could not find a build for the current time!",e,"Versions:",a)}else{WH.error("Could not find a build for timestamp "+e+"!","Versions:",a)}}return s};this.getSideIcon=function(e){return a[e]};this.getSideName=e=>WH.TERMS[i[e]];this.getSideTerm=function(e){return i[e]};this.getTextureAtlasMemberUrl=function(e,t){return WH.Strings.sprintf("%s/images/wow/TextureAtlas/%s/%s%s",WH.STATIC_URL,WH.getDataEnvKey(t),e.replace(/\//g,"").toLowerCase(),WH.WebP.getImageExtension())};this.getVersionList=function(){return o};this.getVersionNumFromStr=function(e){let t=e.split(".");while(t.length<3){t.push(0)}let a=parseInt(t[0])*n||0;if(t[1]){a+=parseInt(t[1])*s||0}if(t[2]){a+=parseInt(t[2])*r||0}return a};this.getVersionStrFromNum=function(e){e=parseInt(e);if(isNaN(e)){return""}return Math.floor(e/1e4)+"."+Math.floor(e%1e4/100)+"."+e%100};this.getVersionString=function(e){return WH.PageMeta.dataEnv.versions[e||WH.getDataEnv()]};this.getVersionStringFromTimestamp=function(e,t){return WH.Wow.getPatchVersionObject(e,t).version};this.hasVersion=function(t,a){return e.getVersionNumFromStr(e.getVersionString(a))>=t};this.isBodyArmorSlot=function(e){return t.includes(e)};this.showContentPhasePrompt=function(e,t,a,i){if((g_user.roles&U_GROUP_STAFF)==0||WH.isRetailTree()){WH.error("Asked to show content phase prompt when we are not allowed.");return}if(!t.length){WH.error("Should call the content phase prompt with at least one type ID");return}if(isNaN(a)){a=""}var n=t.length===1?"this entity":"these "+t.length+" entities";var s=prompt("What should the content phase be for "+n+"?",a);if(s===null){return}var r=undefined;if(s===""){r=0}else{r=parseFloat(s);if(isNaN(r)||r<0){alert("Invalid response ("+s+"): must be a positive number");return}}$.ajax({url:WH.Url.generatePath("/admin/content-phase/set"),data:{type:e,typeIdCsv:t.join(","),phase:r.toFixed(2)},method:"POST",error:function(e,t,a){alert("Could not update content phase: "+t+"\n"+a)},success:function(e){if(i){i(e.phase)}else{alert("Updated "+e.typeIds.length+" "+(e.typeIds.length==1?"entity":"entities")+" to content phase "+(e.phase||"(None)")+".")}}})}};window.ZUL=new function(){const e=WH.Tooltips;this.HEIGHT=40;var t=false;var a={};var i={bodyAvailableListenerAttached:false,enabled:false,mobileScrollSetUp:false,mouseOver:false,iScroll:null,submenuCount:0,submenuTier:0,submenuTiers:[],timers:{menuExpand:null,menuExpandComplete:null,menuOut:null,menuOutPost:null,menuOverPost:null,mobileMenuToggle:null}};this.setOptions=function(e){if(typeof e!="object"){return}if(typeof t!="object"){t={}}for(var a in e){if(!e.hasOwnProperty(a))continue;t[a]=e[a]}};this.closeMobileMenu=function(){C()};this.addToMenu=function(e){if(!t.states){t.states={}}if(!t.states.universal){t.states.universal={}}if(!t.states.universal.content){t.states.universal.content=[]}if(e instanceof Array){t.states.universal.content=t.states.universal.content.concat(e)}else if(typeof e=="object"){t.states.universal.content.push(e)}ZUL.regenerateMenu()};this.getEnabled=()=>i.enabled;this.regenerateMenu=function(){C();if(a.mobileMenu){u(a.barMobile)}};this.setEnabled=e=>{if(i.enabled!==Boolean(e)){v(e);return true}return false};this.init=function(e){ZUL.setOptions(e?{state:"loggedIn",user:e}:{state:"loggedOut"});n()};function n(){if(!document.body){if(!i.bodyAvailableListenerAttached){i.bodyAvailableListenerAttached=true;WH.aE(document,"bodyAvailable",n)}return}if(a.bar){a.barMobile=null;a.bar.parentElement.removeChild(a.bar)}a.bar=document.createElement("div");a.bar.id=a.bar.className="zul-bar";var e=false;if(typeof t.mobileLoadCheck=="function"){if(t.mobileLoadCheck()){e=true}}else if(t.mobileLoadCheck){e=true}v(e);document.body.insertBefore(a.bar,document.body.firstChild);s();I();if(typeof t.onCreateBar=="function"){t.onCreateBar()}}function s(){if(typeof t.mobileWidthCheck==="function"){v(t.mobileWidthCheck())}else if(typeof t.mobileWidthCheck==="number"){v(document.documentElement.offsetWidth<t.mobileWidthCheck)}}function r(){if(a.barMobile||!a.bar){return}a.barMobile=document.createElement("div");a.barMobile.id=a.barMobile.className="zul-bar-mobile";a.barMobile.className+=" zul-bar-mobile-top-menu";a.barMobile.setAttribute("data-tier","0");c(a.barMobile);o(a.barMobile);u(a.barMobile);a.bar.appendChild(a.barMobile);if(typeof t.onCreateMobileBar=="function"){t.onCreateMobileBar()}}function o(e){if(a.mobileBarContent){a.mobileBarContent.parentNode.removeChild(a.mobileBarContent);a.mobileBarContent=null}var t=function(){if(a.mobileBarContent){return}a.mobileBarContent=document.createElement("div");a.mobileBarContent.id=a.mobileBarContent.className="zul-bar-mobile-content"};var i=D();var n=P();if(n.mobileBarPre){t();W(a.mobileBarContent,n.mobileBarPre,false)}if(i.mobileBarPre){t();W(a.mobileBarContent,i.mobileBarPre,false)}if(n.mobileBarContent){t();W(a.mobileBarContent,n.mobileBarContent,false)}if(i.mobileBarPost){t();W(a.mobileBarContent,i.mobileBarPost,false)}if(n.mobileBarPost){t();W(a.mobileBarContent,n.mobileBarPost,false)}if(a.mobileBarContent){e.appendChild(a.mobileBarContent)}}const l=(e,t)=>{const a=WH.ce("button",{ariaLabel:t.ariaLabel,className:`zul-bar-mobile-item-${t.name}`});WH.ae(e,a);WH.Tooltips.attachNonTouch(a,t.ariaLabel);WH.aE(a,"click",t.onClick)};function c(t){const i="zul-bar-mobile";if(a.mobileMenuButton){a.mobileMenuButton.parentNode.removeChild(a.mobileMenuButton)}a.mobileMenuButton=WH.ce("button",{ariaLabel:WH.TERMS.menu,className:`${i}-menu-button`,id:`${i}-menu-button`});e.attachNonTouch(a.mobileMenuButton,WH.TERMS.menu);Y(a.mobileMenuButton,"click",A);WH.ae(t,a.mobileMenuButton)}function u(e){if(a.mobileMenu){a.mobileMenu.parentNode.removeChild(a.mobileMenu)}a.mobileMenu=document.createElement("div");a.mobileMenu.id=a.mobileMenu.className="zul-bar-mobile-menu";a.mobileMenuList=d();p(a.mobileMenuList.firstChild);a.mobileMenu.appendChild(a.mobileMenuList);e.appendChild(a.mobileMenu);_()}function d(e,t){var a=document.createElement("div");a.className="zul-bar-mobile-menu-list-wrapper";a.id=a.className+(e?"-"+e:"");a.setAttribute("data-tier",t||0);a.style.left=U(t?1:0);var i=document.createElement("ul");i.className="zul-bar-mobile-menu-list";i.id=i.className+(e?"-"+e:"");a.appendChild(i);return a}function f(){var e=document.createElement("li");e.className="zul-bar-mobile-row";return e}function h(e){i.submenuCount++;var t=d(i.submenuCount,1);W(t.firstChild,e,true);a.mobileMenu.appendChild(t);b(true)}function p(e){var t=D();var a=P();W(e,a.pre,true);W(e,t.pre,true);W(e,a.content,true);W(e,t.post,true);W(e,a.post,true)}function m(e,a){var i=document.createElement("form");i.id="zul-bar-form-"+a.name;i.className="zul-bar-form "+i.className;if(typeof a.action=="function"){i.action=a.action(e,t,a)}else{i.action=a.action||"/"}if(typeof i.method=="function"){i.method=a.method(e,t,a)}else{i.method=a.method||"post"}for(var n=0,s;s=a.fields[n];n++){H(i,s,a)}e.appendChild(i)}function H(e,a,i){var n=false;var s=false;var r="input";var o={};switch(a.type){case"text":o.type="text";if(typeof a.label=="function"){o.placeholder=a.label(e,t,a)}else if(a.label){o.placeholder=a.label}else if(typeof a.placeholder=="function"){o.placeholder=a.placeholder(e,t,a)}else if(a.placeholder){o.placeholder=a.placeholder}if(typeof a.value=="function"){o.value=a.value(e,t,a)}else if(a.value){o.value=a.value}break;case"password":o.type="password";if(typeof a.label=="function"){o.placeholder=a.label(e,t,a)}else if(a.label){o.placeholder=a.label}else if(typeof a.placeholder=="function"){o.placeholder=a.placeholder(e,t,a)}else if(a.placeholder){o.placeholder=a.placeholder}if(typeof a.value=="function"){o.value=a.value(e,t,a)}else if(a.value){o.value=a.value}break;case"checkbox":o.type="checkbox";if(typeof a.label=="function"){s=a.label(e,t,a)}else{s=a.label}if(typeof a.checked=="function"){o.checked=a.value(e,t,a)}else if(a.checked){o.checked="checked"}break;case"hidden":r="hidden";if(typeof a.value=="function"){o.value=a.value(e,t,a)}else{o.value=a.value}break;case"button":r="button";if(typeof a.typeHTML=="function"){o.type=a.typeHTML(e,t,a)}else if(a.typeHTML){o.type=a.typeHTML}else{o.type="button"}if(typeof a.label=="function"){o.innerHTML=a.label(e,t,a)}else{o.innerHTML=a.label}break;case"link":return E(e,a,true,false);break;default:alert("Invalid element type passed to ZUL bar: "+a.type);return false}var l=["click","mouseover","mouseout","change","keyup","keydown","focus","blur"];var c=["name","innerHTML"].concat(l);for(var u=0,d;d=c[u];u++){if(a.hasOwnProperty(d)){if(["name","innerHTML"].indexOf(d)>-1&&typeof a[d]=="function"){o[d]=a[d](e,t,a)}else{o[d]=a[d]}}}o.id="zul-bar-form-"+i.name+"-"+a.name;o.className="zul-bar-form-"+a.type;if(typeof a.className=="function"){o.className+=" "+a.className(e,t,a)}else if(a.className){o.className+=" "+a.className}var f=document.createElement(r);for(var h in o){if(!o.hasOwnProperty(h)){continue}if(l.indexOf(h)>-1&&typeof o[h]=="function"){Y(f,h,o[h])}else{f[h]=o[h]}}if(n){var p=document.createElement("label");p.id=p.className=o.id+"-prelabel";p.className="zul-bar-form-prelabel zul-bar-form-"+a.type+"-prelabel "+p.className;p.htmlFor=f.id;p.innerHTML=n;Y(p,"mousedown",(function(){return false}));e.appendChild(p)}e.appendChild(f);if(s){var m=document.createElement("label");m.id=m.className=o.id+"-postlabel";m.className="zul-bar-form-postlabel zul-bar-form-"+a.type+"-postlabel "+m.className;m.htmlFor=f.id;m.innerHTML=s;Y(m,"mousedown",(function(){return false}));e.appendChild(m)}return true}function g(e,a){var i=[];for(var n=0,s;s=a[n];n++){if(s.type=="concatenation"){var r=s.content(e,t);if(r){i=i.concat(r)}}else{i.push(s)}}return i}function W(e,a,i){if(!(a instanceof Array)||!a.length){return}a=g(e,a);for(var n=0,s;s=a[n];n++){if(typeof s.condition=="function"){if(!s.condition(e,t)){continue}}var r=e;if(i){var o=f();e.appendChild(o);r=o}switch(s.type){case"button":l(r,s);break;case"link":E(r,s,false,i);break;case"form":m(r,s);break;case"custom":if(typeof s.custom=="function"){s.custom(r,t)}break;default:}}}function E(e,i,n,s){let r=WH.ce("a",{className:"zul-bar-mobile-item-"+(n?"form-":"")+i.name,dataset:{disableWowheadTooltip:"true"}});if(i.ariaLabel){r.ariaLabel=i.ariaLabel}if(typeof i.id=="function"){var o=i.id(e,t,i);if(o){r.id=o}}else if(i.id){r.id=F(i.id)}if(typeof i.innerHTML=="function"){r.innerHTML=i.innerHTML(e,t,i)}else if(i.innerHTML){r.innerHTML=F(i.innerHTML)}else if(typeof i.text=="function"){r.appendChild(document.createTextNode(i.text(e,t,i)))}else if(i.text){r.appendChild(document.createTextNode(F(i.text)))}if(typeof i.href=="function"){var l=i.href(e,t,i);if(l){r.href=l}}else if(i.href){r.href=F(i.href)}if(typeof i.heading=="function"){if(i.heading(e,t,i)){r.className+=" zul-bar-mobile-heading"}}else if(i.heading){r.className+=" zul-bar-mobile-heading"}if(typeof t.mobileIconSpacing=="function"){if(t.mobileIconSpacing(e,t,i)){r.className+=" zul-bar-icon-spacing"}}else if(t.mobileIconSpacing){r.className+=" zul-bar-icon-spacing"}var c=false;if(i.checked){switch(typeof i.checked){case"function":if(i.checked(e,t,i)){r.className+=" zul-bar-checked";c=true}break;case"string":if(location.href.match(i.checked)){r.className+=" zul-bar-checked";c=true}break;default:r.className+=" zul-bar-checked";c=true}}if(!c){if(i.imageIcon){if(typeof i.imageIcon=="function"){i.imageIcon=i.imageIcon(e,t,i)}var u;if(typeof i.imageIcon!="object"){u=i.imageIcon}else if(i.imageIcon.url){u=i.imageIcon.url}if(u){r.style.backgroundImage="url("+u+")";r.className+=" zul-bar-has-image-icon"}if(i.imageIcon.enlargeIcon){r.className+=" zul-bar-enlarge-image-icon"}}var d=false;if(typeof i.fontIcon=="function"){var f=i.fontIcon(e,t,i);if(f){d=f}}else if(i.fontIcon){d=i.fontIcon}if(d){r.className+=" zul-bar-has-fa";var h=document.createElement("i");h.className="fa fa-fw fa-"+d;r.insertBefore(h,r.firstChild)}}if(typeof i.className=="function"){var p=i.className(e,t,i);if(p){r.className+=" "+p}}else if(i.className){r.className+=" "+i.className}var m=false;var H=!i.hasOwnProperty("tap")||typeof i.tap==="boolean"&&i.tap;for(var g=0,W;W=["click","mouseover","mouseout"][g];g++){if(i[W]){if(W==="tap"||s&&W==="click"&&H){Y(r,"tap",function(e,t){O(this);setTimeout((function(){e.call(this,t)}),1)}.bind(r,i[W]));m=true}else if(s&&W==="click"){Y(r,W,function(e,t){O(this);setTimeout((function(){e.call(this,t)}),1)}.bind(r,i[W]))}else{Y(r,W,i[W])}}}if(s&&!m&&H){if(typeof r.href=="string"&&r.href&&r.href.charAt(0)!=="#"&&r.href.substring(0,11)!=="javascript:"){Y(r,"tap",(function(e){var t=e.target;O(t);setTimeout((function(){window.location=t.href}),1)}));m=true}}if(m){r.className+=" has-tap-event"}e.appendChild(r);if(i.menu&&i.menu.mobile){if(typeof i.menu.mobile=="function"){i.menu.mobile=i.menu.mobile()}var E;if(typeof i.mobileMenuText=="function"){E=i.mobileMenuText(a.mobileMenuBackTitleText,t,i)}else if(i.mobileMenuText){E=F(i.mobileMenuText)}else if(typeof i.innerHTML=="function"){E=i.innerHTML(a.mobileMenuBackTitleText,t,i)}else if(i.innerHTML){E=i.innerHTML}else if(typeof i.text=="function"){E=$(i.text(a.mobileMenuBackTitleText,t,i))}else if(i.text){E=$(i.text)}if(m){e.className+=" zul-mobile-menu-action-with-submenu";var _=document.createElement("a");_.className="zul-mobile-menu-submenu-arrow has-tap-event";Y(_,"tap",L.bind(_,E,i.menu.mobile));e.appendChild(_)}else{e.className+=" zul-mobile-menu-has-submenu";r.className+=" has-tap-event";Y(r,"tap",L.bind(r,E,i.menu.mobile))}}}function _(){if(a.mobileMenuBackRow){a.mobileMenuBackRow.parentNode.removeChild(a.mobileMenuBackRow)}a.mobileMenuBackRow=document.createElement("div");a.mobileMenuBackRow.id=a.mobileMenuBackRow.className="zul-bar-mobile-menu-back-row";a.mobileMenuBackButton=document.createElement("a");a.mobileMenuBackButton.innerHTML=t.mobileBackText||"Back";a.mobileMenuBackButton.id=a.mobileMenuBackButton.className="zul-bar-mobile-menu-back-button";a.mobileMenuBackButton.onclick=k;a.mobileMenuBackRow.appendChild(a.mobileMenuBackButton);a.mobileMenuBackTitle=document.createElement("div");a.mobileMenuBackTitle.id=a.mobileMenuBackTitle.className="zul-bar-mobile-menu-back-title";a.mobileMenuBackTitleText=document.createElement("span");a.mobileMenuBackTitleText.id=a.mobileMenuBackTitleText.className="zul-bar-mobile-menu-back-title-text";a.mobileMenuBackTitle.appendChild(a.mobileMenuBackTitleText);a.mobileMenuBackRow.appendChild(a.mobileMenuBackTitle);if(t.mobileHeader){a.mobileMenuBackHeader=document.createElement("ul");a.mobileMenuBackHeader.id="zul-bar-mobile-menu-back-header";a.mobileMenuBackHeader.className=a.mobileMenuBackHeader.id+" zul-bar-mobile-menu-list";W(a.mobileMenuBackHeader,t.mobileHeader,true);a.mobileMenuBackRow.appendChild(a.mobileMenuBackHeader);a.barMobile.className+=" zul-bar-mobile-menu-has-mobile-header"}a.barMobile.appendChild(a.mobileMenuBackRow)}function v(e){if(e){r();i.enabled=true;document.documentElement.dataset.header="mobile";document.body.dataset.zulBar="true"}else{i.enabled=false;document.documentElement.dataset.header="standard";document.body.dataset.zulBar="false"}}function T(e,t){var i;if(document.querySelectorAll){i=document.querySelectorAll((t||"#zul-bar-mobile-menu-list")+" .zul-bar-mobile-menu-active");if(i){for(var n=0,s;s=i[n];n++){s.className=s.className.replace(/ *zul-bar-mobile-menu-active\b/g,"")}}}else{i=(e||a.mobileMenuList).getElementsByTagName("a");if(i){for(var n=0,s;s=i[n];n++){if(s.className&&s.className.indexOf("zul-bar-mobile-menu-active")){s.className=s.className.replace(/ *zul-bar-mobile-menu-active\b/g,"")}}}}}function b(e){var t=e?-1:1;if(i.submenuTier+t>0){return false}N();i.submenuTier=i.submenuTier+t;if(!e){i.submenuTiers.pop()}y();a.barMobile.setAttribute("data-tier",i.submenuTier);if(i.submenuTier==0){a.barMobile.className+=" zul-bar-mobile-top-menu"}else{a.barMobile.className=a.barMobile.className.replace(/ *zul-bar-mobile-top-menu\b/g,"")}var n=a.mobileMenu.childNodes;var s=[];for(var r=0,o;o=n[r];r++){var l=parseInt(o.getAttribute("data-tier"))+t;if(l>0){o.setAttribute("data-tier","1");o.style.left=U(i.submenuTier);setTimeout(function(e){e.parentNode.removeChild(e)}.bind(null,o),251)}else{if(l==0){o.style.height="100%"}s.push(o);setTimeout(function(e,t){e.setAttribute("data-tier",t);e.style.left=U(i.submenuTier)}.bind(null,o,l),51)}}if(!e){T(n[n.length-2],"#"+n[n.length-2].id)}B(a.mobileMenu,250);setTimeout(function(e){for(var t=0,a;a=e[t];t++){if(t!=e.length-1){a.style.height="10px"}}w(e[e.length-1])}.bind(null,s),251);return true}function S(){if(!a.mobileMenu){return}var e=a.mobileMenu.childNodes;for(var t=0,n;n=e[t];t++){if(t>0){n.parentNode.removeChild(n)}else{n.setAttribute("data-tier","0");n.style.left=U(0)}}i.submenuTiers=[];i.submenuTier=0;a.barMobile.setAttribute("data-tier","0");a.barMobile.className+=" zul-bar-mobile-top-menu"}function y(){var e=i.submenuTiers[i.submenuTier*-1-1];if(e){a.mobileMenuBackTitleText.innerHTML=e}}function I(){Y(window,"resize",s);I=function(){}}function R(){if(!i.mobileScrollSetUp){var e=function(e){if(i.mobileMenuShown){if(!document.getElementById("zul-bar-mobile").contains(e.target)){e.preventDefault()}}};Y(document.body,"touchmove",e);Y(document.body,"mousewheel",e);i.mobileScrollSetUp=true}}function N(){if(i.iScroll){i.iScroll.destroy();i.iScroll=null}}function w(e){N();i.iScroll=new IScroll(e,{mouseWheel:true,tap:true})}function A(){Menu.hide(true);WH.Tooltip.hide();if(i.mobileMenuShown){C()}else{M()}}function M(){z("mobileMenuToggle");z("mobileMenuToggleCallback");var e=document.getElementById("zul-bar-mobile-menu-list-wrapper");e.style.height="100%";if(!a.fade){a.fade=document.createElement("div");a.fade.id=a.fade.className="zul-bar-fade";Y(a.fade,"click",A);a.bar.appendChild(a.fade)}document.body.className+=" zul-mobile-show-menu";i.timers.mobileMenuToggle=setTimeout((function(){document.body.className+=" zul-mobile-animate-menu"}),1);if(typeof t.onShowMobileBarEnd=="function"){i.timers.mobileMenuToggleCallback=setTimeout((function(){t.onShowMobileBarEnd()}),152)}R();w(e);i.mobileMenuShown=true}function C(){z("mobileMenuToggle");z("mobileMenuToggleCallback");if(typeof t.onHideMobileBarStart=="function"){t.onHideMobileBarStart()}N();if(a.fade){a.fade.parentNode.removeChild(a.fade);a.fade=null}var e=document.body;e.className=e.className.replace(/ *zul-mobile-animate-menu\b/g,"");i.timers.mobileMenuToggle=setTimeout((function(){e.className=e.className.replace(/ *zul-mobile-animate-menu\b/g,"").replace(/ *zul-mobile-show-menu\b/g,"");T();S();if(typeof t.onHideMobileBarEnd=="function"){t.onHideMobileBarEnd()}}),251);i.mobileMenuShown=false;S()}function O(e){var t=G(e,"ul");T(t,"#"+t.id);e.className+=" zul-bar-mobile-menu-active"}function L(e,t){i.submenuTiers.push(e);O(this);setTimeout((function(){h(t)}),1)}function k(){b(false)}function D(){if(!t.state){return{}}var e={name:t.state};return x(t.states,e)}function P(){if(t.states&&t.states&&t.states.universal){return t.states.universal}return{}}function x(e,t){if(e&&typeof e[t.name]=="object"){for(var a in e[t.name]){if(e[t.name].hasOwnProperty(a)){t[a]=e[t.name][a]}}}return t}function U(e){return parseInt(e)*100+"%"}function F(e){return e.indexOf("%")>-1?q(e,t.user):e}function q(e,t){if(!t){return e}for(var a in t){if(!t.hasOwnProperty(a))continue;e=e.replace("%"+a.toUpperCase()+"%",t[a])}return e}function Y(e,t,a,i){if(e.addEventListener){e.addEventListener(t,a,i)}else if(e.attachEvent){e.attachEvent("on"+t,a)}}function B(e,t){var a=e.scrollTop/(t/15);var i=e.scrollLeft/(t/15);var n=setInterval((function(){if(e.scrollTop!=0||e.scrollLeft!=0){e.scrollTop=Math.max(0,e.scrollTop-a);e.scrollLeft=Math.max(0,e.scrollLeft-i)}else clearInterval(n)}),15)}function G(e,t){while(e.parentNode){if(e.parentNode.tagName==t.toUpperCase()){return e.parentNode}e=e.parentNode}return null}function $(e){if(!a.htmlEscaper){a.htmlEscaper=document.createElement("div")}a.htmlEscaper.innerHTML="";a.htmlEscaper.appendChild(document.createTextNode(e));return a.htmlEscaper.innerHTML}function z(e){clearTimeout(i.timers[e]);i.timers[e]=null}};ZUL.setOptions({site:"wowhead",mobileLoadCheck:function(){return WH.Layout.Responsive.check()},mobileWidthCheck:function(){return WH.Layout.Responsive.check()},mobileBackText:WH.TERMS.back_verb,mobileIconSpacing:true,states:{loggedOut:{pre:[{type:"custom",custom:function(e,t){e.style.paddingLeft="32px";var a=WH.ce("span");a.id=a.className="zul-bar-mobile-loginwithcolon";a.innerHTML=WH.TERMS.loginwith_colon;WH.ae(e,a);a=WH.ce("span");a.id=a.className="zul-bar-mobile-logincolon";a.innerHTML=WH.TERMS.login+WH.TERMS.colon_punct;WH.ae(e,a);var i=WH.ce("a",{id:"zul-bar-mobile-battlenet",className:"zul-bar-mobile-item-battlenet btn btn-blizzard",innerHTML:"Battle.net",href:WH.getRelativeHostPrefix()+WH.Url.generatePath("/account=battlenet")});WH.aE(i,"tap",(function(){WH.visitUrlWithPostData(WH.getRelativeHostPrefix()+WH.Url.generatePath("/account=battlenet"),{r:1});return false}));WH.ae(e,i);let n=WH.ce("a",{id:"zul-bar-mobile-email",className:"zul-bar-mobile-item-email btn btn-site",innerHTML:"<span>"+WH.TERMS.email+"</span>",href:WH.Url.getLoginPath()});WH.aE(n,"tap",(function(){WH.goToLoginPage();return false}));WH.ae(e,n)}},{type:"link",name:"register",innerHTML:WH.TERMS.register,href:WH.Url.getRegistrationPath()},{type:"link",name:"get-premium",innerHTML:WH.TERMS.getpremium,href:WH.Url.generatePath("/premium"),fontIcon:"star"}]},loggedIn:{pre:[{type:"link",name:"staff",innerHTML:WH.TERMS.staffemployees,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(WH.Staff.getMenu())}},condition:function(e,t){return!!WH.Staff}},{type:"link",name:"favorites",innerHTML:WH.TERMS.favorites,href:"javascript:",className:"hassubmenu",menu:{mobile:function(){return Menu.prepareForZul(WH.Favorites.getMenu())}},condition:WH.Favorites.hasFavorites},{type:"link",name:"user",innerHTML:function(e,t){return t.user.name+" <small>("+WH.numberFormat(t.user.reputation)+" "+WH.TERMS.reputation+")</small>"},mobileMenuText:"%NAME%",menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getUserMenu())}}},{type:"link",name:"characters",innerHTML:WH.TERMS.myprofiles,menu:{mobile:function(){return Menu.prepareForZul(WH.Layout.User.getProfilerMenu())}}},{type:"link",name:"upgrade",innerHTML:WH.TERMS.upgradeavailable,href:WH.Url.generatePath("/premium"),fontIcon:"arrow-up",condition:function(e,t){return!t.user.premium}}]},universal:{pre:[{type:"link",name:"mobileheader",href:WH.Url.generatePath("/"),heading:true},{name:"data-env-switcher-header",type:"link",text:WH.TERMS.selectGame,heading:true},{type:"concatenation",content:function(e,t){const a=WH.Wow.Expansion;const i=WH.Game;const n=WH.Layout;const s=WH.WebP;let r=[];let o=e=>WH.STATIC_URL+"/images/header/data-tree-switcher/"+i.getKey(e)+"-icon-2x"+s.getImageExtension();let l=(e,t,a)=>{r.push({name:"data-env-switcher-game",type:"link",text:e,href:n.getEnvSwitcherUrl.bind(n,a),imageIcon:{url:o(t)},checked:WH.getDataEnv()===a})};let c={};Object.entries(WH.dataEnvToTree).forEach((e=>{if(!c[e[1]]){c[e[1]]=[]}c[e[1]].push(parseInt(e[0]))}));l(a.getName(a.WRATH),i.WOW,WH.dataEnv.WRATH);i.getAllSorted().forEach((e=>{if(!i.hasAccess(e)){return}let t=i.getDataTrees(e);if(t.length===1&&c[t[0]].length===1){let a=c[t[0]][0];l(i.getName(e),e,a);return}r.push({name:"data-env-switcher-game",type:"link",text:i.getName(e),imageIcon:{url:o(e)},checked:()=>i.get()===e,menu:{mobile:()=>{let e=[];t.forEach((t=>{c[t].forEach((a=>{if(!WH.isDataEnvActive(a)){return}e.push({name:"data-env-switcher-game",type:"link",text:WH.term(WH.getDataEnvTerm(a)),href:n.getEnvSwitcherUrl.bind(n,a),imageIcon:{url:n.getFaviconUrl(WH.getDataTreeKey(t))},checked:WH.getDataEnv()===a})}))}));return e}}})}));return r}},{type:"link",text:WH.TERMS.featuredGuides,heading:true},{type:"concatenation",content:function(e,t){return Menu.prepareForZul(Menu.getFeaturedNavigationMenu())}},{type:"link",text:WH.TERMS.navigation,heading:true},{type:"concatenation",content:function(e,t){return Menu.prepareForZul(Menu.getMenu())}},{type:"link",text:"",heading:true}],content:(()=>{const e=WH.Layout;return[{type:"link",name:"feedback",innerHTML:WH.TERMS.feedback,href:"javascript:",fontIcon:"envelope",click:function(){ZUL.closeMobileMenu();ContactTool.show()}},{type:"link",name:"locale",innerHTML:function(e,t){return Locale.getDescription()||WH.TERMS.language},href:"javascript:",mobileMenuText:WH.TERMS.language,menu:{mobile:function(){return Menu.prepareForZul(e.User.getLocaleMenu())}}},{type:"link",name:"theme",innerHTML:function(e,t){let a=WH.TERMS.unknown;switch(WH.Theme.getTheme()){case"classic":a=WH.TERMS.classic;break;case"standard":a=WH.TERMS.standard;break;case"thottbot":a=WH.TERMS.thottbot;break;default:WH.error("Unknown theme in ZUL configuration!",WH.Theme.getTheme())}return WH.TERMS.theme_format.replace("%s","<b>"+a+"</b>")},condition:function(e,t){return WH.Theme.getThemes().length>1},mobileMenuText:WH.TERMS.changeTheme,menu:{mobile:function(){let e=WH.Theme.getThemes();let t=[];for(let a=0,i=e.length;a<i;a++){let i=e[a];(function(e){t.push({name:"theme-"+e,type:"link",innerHTML:WH.TERMS.theme_format.replace("%s",WH.TERMS[e]),href:"javascript:",click:function(){let t=WH.qs(".zul-bar-mobile-item-theme-"+e);if(t){if(t.classList.contains("zul-bar-checked")){ZUL.closeMobileMenu();return}t.classList.add("zul-bar-has-fa");WH.aef(t,WH.ce("i",{className:"fa fa-refresh fa-spin"}))}if(!WH.User.isLoggedIn()){window.location=WH.Url.generatePath(WH.Url.getLoginPath(WH.Url.getPathCommand()));return}WH.Theme.set(e)},checked:function(t,a){return WH.Theme.getTheme()===e}})})(i)}return t}()}}]})(),mobileBarContent:[{type:"form",name:"search",action:WH.Url.generatePath("/search"),method:"get",fields:[{type:"text",name:"q",label:WH.TERMS.searchGuidesNewsDatabase_stc_ellipsis,value:function(){var e=function(){var t=$(".header-search form input");if(!t.length){setTimeout(e,5);return}$("#zul-bar-form-q").val(t.val()||"")};e();setTimeout((function(){WH.Search.Live.attach(WH.ge("zul-bar-form-search-q"))}),0);return""},focus:function(){document.body.scrollTop=0;document.body.scrollLeft=0;setTimeout((function(){document.body.scrollTop=0;document.body.scrollLeft=0;let e=WH.ce("div",{className:"zul-bar-fade zul-bar-fade-body-only"});WH.aE(e,"click",(()=>WH.de(e)));WH.ae(document.body,e)}),5)},blur:function(){WH.de(".zul-bar-fade.zul-bar-fade-body-only")}}]},{ariaLabel:WH.TERMS.share,name:"share",onClick:e=>{const t=WH.ShareServices.getSubredditByGame(WH.Game.get());const a=location.href;const i=[[,WH.TERMS.shareon_colon],[1,WH.TERMS.twitter,WH.ShareServices.getShareUrl("twitter",a),undefined,{fontIcon:"twitter",newWindow:true}],[2,WH.TERMS.facebook,WH.ShareServices.getShareUrl("facebook",a),undefined,{fontIcon:"facebook-official",newWindow:true}],[3,WH.TERMS.reddit,WH.ShareServices.getShareUrl("reddit",a,t),undefined,{fontIcon:"reddit-alien",newWindow:true}]];Menu.show(i,e.target)},type:"button"}]}}});WH.Admin.Debug=new function(){const e=this;this.TYPE_CODE="code";this.TYPE_MESSAGE="message";this.TYPE_QUERY="query";this.TYPE_SEO="seo";const t=0;const a=1;const i=2;const n="log";const s="warn";const r="error";const o="critical";const l={announcementId:1e5,footerInitialized:false,queue:[],queueElement:undefined};this.critical=function(e,t,a){d({level:o,markup:a||false,message:t,type:e})};this.error=function(e,t,a){d({level:r,markup:a||false,message:t,type:e})};this.initFooter=function(){let e=WH.qs(".footer-utility-site-links");if(!e){return}let t=WH.ce("a",{className:"debug-footer-toggle fa"});WH.preventSelectStart(t);let a=WH.ce("li",{className:"footer-list-item-debug"});WH.ae(e,a);WH.ae(a,t);WH.aE(t,"click",(function(){let e=WH.qs(".debug-footer");if(e.dataset.state==="hidden"){WH.st(this,"Hide debug");this.classList.add("fa-minus-circle");this.classList.remove("fa-plus-circle");e.dataset.state="visible";if(l.footerInitialized){WH.scrollTo(t)}}else{WH.st(this,"Show debug");this.classList.add("fa-plus-circle");this.classList.remove("fa-minus-circle");e.dataset.state="hidden"}}));if(WH.User.hasRole(U_GROUP_DEV)){WH.qs(".debug-footer").dataset.state="hidden"}WH.DOM.dispatchEvent(t,"click");l.footerInitialized=true};this.initFooterTabs=function(){let e=WH.qs(".debug-footer-inner");if(!e){return}WH.qsa(".debug-footer .tabs a").forEach((function(t){WH.aE(t,"click",(function(){let t;if(!this.tabSettings||!(t=WH.ge("tab-"+this.tabSettings.id))){return}let a=t.offsetHeight-2;if(e.style.minHeight){if(parseInt(e.style.minHeight)>=a){return}}else{let e;if(this.tabSettings.id!=="info"&&(e=WH.ge("tab-info"))){e.style.display="";let t=e.offsetHeight-2;e.style.display="none";if(t>a){a=t}}}a=Math.min(a,window.innerHeight);e.style.minHeight=a+"px"}))}))};this.log=function(e,t,a){d({level:n,markup:a||false,message:t,type:e})};this.warn=function(e,t,a){d({level:s,markup:a||false,message:t,type:e})};function c(){return WH.PageMeta.debug||false}function u(t){switch(t.type){case e.TYPE_CODE:case e.TYPE_QUERY:if(t.level!==r&&!WH.User.hasRole(U_GROUP_DEV)){return a}return i;case e.TYPE_SEO:if(t.level!==r&&!WH.User.hasRole(U_GROUP_BLOGGER|U_GROUP_EDITOR)){return a}return i;case e.TYPE_MESSAGE:return i;default:WH.error("Unknown debug message type.",t.type);return i}}function d(e){if(!c()){l.queue.push(e);return}switch(u(e)){case i:f(e);break;case t:break;case a:l.queue.push(e);g();break;default:WH.error("Debug message action could not be determined.",e.type,e);f(e)}}function f(e){if(!e.message){var t="Tried to display an empty debug message.";WH.error(t,e);alert(t);return}var a={allowMarkup:e.markup,class:"debug debug-type-"+(e.type||"unknown")+" debug-level-"+e.level,id:l.announcementId.toString(),nocookie:1,parent:"debug-message-wrapper-"+l.announcementId,text:e.message};var i=WH.ce("div",{id:a.parent});var n=WH.ge("announcement-0");if(n){n.parentNode.insertBefore(i,n)}else{if(document.readyState!=="complete"){WH.aE(document,"readystatechange",f.bind(this,e));return}else{var s=WH.qs(".main-contents");if(s){WH.aef(s,i)}else{WH.aef(document.body,i)}}}l.announcementId++;new WH.Announcement(a);$("#"+a.parent+"-markup .error-reveal-button").click((function(){$("#"+a.parent+"-markup > div").show();WH.de(this)}))}function h(){while(l.queue.length){f(l.queue.shift())}}function p(){var e={};for(var t=0,a=l.queue.length;t<a;t++){var i=l.queue[t];if(!e[i.level]){e[i.level]=0}e[i.level]++}return e}function m(){if(!l.queueElement){l.queueElement=WH.Layout.User.createDebugQueueElement();if(!l.queueElement){return undefined}WH.aef(l.queueElement,WH.ce("span",{className:"header-user-debug-messages-count"}));WH.aE(l.queueElement,"click",(function(){h();g()}));WH.Tooltip.simple(l.queueElement,H)}return l.queueElement}function H(){var e=p();var t="debug";var a=l.queue.length!==1?"s":"";var i=[];for(var n in e){if(!e.hasOwnProperty(n)){continue}if(e[n]===l.queue.length){t=n}else{i.push(e[n]+" "+n+(e[n]!==1?"s":""))}}var s=l.queue.length+" "+t+" message"+a+" queued.";if(i.length){s+="<br>Click to show "+Locale.formatList(i)+"."}else{s+="<br>Click to show."}return'<div class="no-wrap q2">'+s+"</div>"}function g(){if(!c()){return}if(!l.queue.length&&!l.queueElement){return}var e=m();if(!e){if(document.readyState!=="complete"){WH.aE(document,"readystatechange",g.bind(this))}else{h()}return}if(!l.queue.length){if(e.style.display!=="none"){e.style.display="none";WH.Layout.updateSearchWidth()}return}var t=p();if(t.hasOwnProperty(r)){e.dataset.level=r}else if(t.hasOwnProperty(o)){e.dataset.level=o}else if(t.hasOwnProperty(s)){e.dataset.level=s}else{e.dataset.level=n}e.dataset.count=l.queue.length;var a=WH.qs(".header-user-debug-messages-count",e);if(a){a.innerHTML=e.dataset.level===n?"":l.queue.length}if(e.style.display==="none"){delete e.style.display;WH.Layout.updateSearchWidth();if(WH.Theme.isClassic()){WH.Layout.Responsive.updateNavOverflow()}}}};WH.Admin.Localization=new function(){var e=0;var t=1;var a={0:{class:"q10",name:"Error"},1:{class:"r1",name:"Warning"}};var i={default:":",2:" :",4:"："};var n={default:": ",2:" : ",4:"："};var s={default:"…"};var r={default:"!",4:"！"};var o={default:".",4:"。"};var l={default:"?",4:"？"};this.initValidation=function(e,t,a,i,n){let s;let r=$(t);if(e===LOCALE_ENUS){r.bind("keydown keyup change",function(e,t){clearTimeout(s);s=setTimeout(h.bind(null,e,t),300)}.bind(null,r,i))}else{r.bind("keydown keyup change",function(e,t,a,i,n){clearTimeout(s);s=setTimeout(g.bind(null,e,t,a,i,n),300)}.bind(null,e,r,$(a),i,n))}if(g_user.roles&U_GROUP_DEV){r.change()}};function c(e){var t=e.match(/%(?:\d+\$)?[sd]/g);return t?t.length:0}function u(e,t){var i=e.siblings(".localization-message");if(!i.length){i=$("<div/>",{class:"localization-message"}).appendTo(e.parent())}i.empty();if(t.length){for(var n=0,s=t.length;n<s;n++){var r=t[n];var o="localization-message-"+a[r.type].name.toLowerCase();$("<div/>",{class:o+" "+a[r.type]["class"],text:a[r.type].name+": "+r.message}).appendTo(i)}}}function d(t,a){var i=[];if(!a.match(/[<>]/)&&t.match(/[<>]/)){i.push({type:e,message:"This translation appears to have HTML in it, but the original does not."})}return i}function f(e,a){var i=[];var n=a.match(/\n/g);var s=e.match(/\n/g);n=n?n.length:0;s=s?s.length:0;if(n>=3){return i}if(s>0&&n===0){i.push({type:t,message:"This translation has line breaks, but the original does not."})}else if(n!==s){i.push({type:t,message:"The number of line breaks in this translation ("+s+") does not "+"match the original ("+n+")."})}return i}function h(e,a){let c=a||(e.is("input, textarea")?e.val():e.text());var d=[];if(c!==""){if(c.match(/[<>]/)){d.push({type:t,message:"Avoid using HTML in term text."})}if(c.indexOf("\t")>-1){d.push({type:t,message:"Avoid tabs in term text."})}if(c.indexOf(" ")===0){d.push({type:t,message:"Avoid starting with a space in term text."})}var f=false;var h=[o,r,l,s,n,i];for(var p=0,m=h.length;p<m;p++){var H=h[p]["default"];if(c.substr(-1*H.length)===H){f=true;break}}if(!f&&c.substr(-1)===" "){d.push({type:t,message:"Avoid ending with a space in term text, if it's not related to punctuation (such as "+"after a colon)."})}if(c.indexOf("  ")>-1){d.push({type:t,message:"Avoid using multiple sequential spaces in term text."})}if(c.match(/(\r\n|\r|\n)/)){d.push({type:t,message:"Avoid using line breaks in term text, if possible."})}}u(e,d)}function p(e,a,c){var u=[];var d=false;var f=function(i,n){var s=i["default"];var r=i[c]||s;if(a.substr(-1*s.length)===s){d=true;if(e.substr(-1*r.length)!==r){return[{type:t,message:"This translation doesn't end in matching "+n+" punctuation for this locale ("+r+")."}]}}else{if(e.substr(-1*r.length)===r||e.substr(-1*s.length)===s){if(r==="："&&s===":"&&a.substr(-2)===": "||r==="："&&s===": "&&a.substr(-1)===":"){return[]}return[{type:t,message:"This translation ends in "+n+" punctuation, but the original "+"does not."}]}}return[]};u=u.concat(f(o,"full stop"));u=u.concat(f(r,"exclamation"));u=u.concat(f(l,"question mark"));u=u.concat(f(s,"ellipsis"));u=u.concat(f(n,"colon"+(Locale.hasWordSpaces(c)?" (with a space)":"")));u=u.concat(f(i,"colon"+(Locale.hasWordSpaces(c)?" (without a space)":"")));if(!d){if(a.substr(-1)===" "){if(Locale.hasWordSpaces(c)||Locale.hasSentenceSpaces(c)){if(e.substr(-1)!==" "){u.push({type:t,message:"This translation doesn't end in a space, but the original does."})}}}else{if(e.substr(-1)===" "){u.push({type:t,message:"This translation ends in a space, but the original does not."})}}}return u}function m(e,a,i){var n=[];if(Locale.hasWordSpaces(i)||Locale.hasSentenceSpaces(i)){var s=e.substr(0,1);var r=a.substr(0,1);if(s===" "&&r!==" "){n.push({type:t,message:"This translation starts with a space, but the original does not."})}else if(s!==" "&&r===" "){n.push({type:t,message:"This translation does not start with a space, but the original does."})}}if(e.indexOf("\t")>-1&&a.indexOf("\t")){n.push({type:t,message:"This translation has a tab character, but the original does not."})}if(e.indexOf("  ")>-1&&a.indexOf("  ")===-1){n.push({type:t,message:"This translation has multiple spaces, but the original does not."})}return n}function H(e,a){var i=[];var n=c(e);var s=c(a);if(n!==s){i.push({type:t,message:"This translation has "+n+" string replacement placeholders, "+"but the original has "+s+"."})}return i}function g(e,t,a,i,n){i=i||(t.is("input, textarea")?t.val():t.text());n=n||(a.is("input, textarea")?a.val():a.text());let s=[];if(i!==""){s=s.concat(d(i,n));s=s.concat(H(i,n));s=s.concat(p(i,n,e));s=s.concat(m(i,n,e));s=s.concat(f(i,n))}u(t,s)}};WH.D4.Affix=new function(){this.MAGIC_TYPE_LEGENDARY=1};WH.D4.Gender=new function(){const e=this;this.FEMALE=1;this.MALE=0;const t=[e.FEMALE,e.MALE];const a={[this.FEMALE]:WH.TERMS.female,[this.MALE]:WH.TERMS.male};const i={[this.FEMALE]:"female",[this.MALE]:"male"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getBySlug=function(e){for(let t in i){if(i[t]===e){return t}}return null};this.getName=function(e){return a[e]||null};this.getSlug=function(e){return i[e]||null}};WH.D4.Item=new function(){const e=WH.D4.Affix;this.getModifiedName=(t,a)=>{const i=WH.D4.Item.Quality;switch(t.quality){case i.COMMON:case i.MAGIC:case i.MAGIC2:case i.LEGENDARY:let n;a.forEach((a=>{if(t.quality===i.LEGENDARY&&a.magicType!==e.MAGIC_TYPE_LEGENDARY){return}if(a.modifier){n=WH.Strings.sprintf(WH.Strings.escapeHtml(a.modifier),n||t["nameHtml_"+Locale.getName()]||WH.Strings.escapeHtml(t["name_"+Locale.getName()]||t.name))}}));if(n!==undefined){return n}break}}};WH.D4.ItemLabel=new function(){const e=Object.freeze([15,16,17,30,26,0,28,19,29]);this.getInGameSlots=()=>e};WH.D4.ItemType=new function(){const e=this;this.AMULET=446837;this.STAFF=446803;const t=WH.getPageData("d4.itemType")||{};this.getAll=()=>Object.keys(t).map((e=>parseInt(e))).sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))));this.getClassMask=e=>t[e]?.classMask;this.getSlots=e=>t[e]?.slots||[];this.getName=e=>t[e]?.name;this.getIdString=e=>t[e]?.idString;this.isTwoHand=e=>t[e]?.isTwoHand||false;this.isWeapon=e=>t[e]?.isWeapon||false};WH.stub("D4");WH.D4.ModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.DOM;const a=WH.Types;const i=WH.Url;const n=20;const s=76;const r={elements:{animationSelect:undefined,classSelect:undefined,lightboxContent:undefined,screen:undefined},playerGender:undefined,playerClass:undefined,dataEnv:undefined,entityType:undefined,entityId:undefined,extendedHash:false,fromMarkup:false,ignoreHash:false,library:{},libraryLoadedCallbacks:{},message:undefined,oldHash:"",onHide:undefined,ratio:16/9,resizeEventBound:false,shown:false,variant:0,viewer:undefined};this.getBaseUrl=function(){return WH.isDev()?"https://static-staging.wowhead.com":WH.STATIC_URL};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return r.library[e]};this.getModelviewerBaseUrl=function(){return e.getBaseUrl()+e.getModelviewerPath()+"/"};this.getModelviewerPath=function(){return"/d4/modelviewer"};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}let i=!!r.libraryLoadedCallbacks[a];if(!i){r.libraryLoadedCallbacks[a]=[]}if(t){if(r.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{r.libraryLoadedCallbacks[a].push(t)}}if(i){return}let n=WH.ce("script");n.src=e.getModelviewerBaseUrl()+"viewer.js";WH.aE(n,"load",(function(){if(window.Viewer&&window.Viewer.default){r.library[a]=window.Viewer.default;delete window.Viewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but Viewer is still undefined!");return}while(r.libraryLoadedCallbacks[a].length){r.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load Viewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){e=e||{};r.dataEnv=e.dataEnv||WH.getDataEnv();r.entityId=e.typeId;r.entityType=e.type;r.extendedHash=!!e.extendedHash;r.fromMarkup=!!e.fromTag;r.ignoreHash=!!e.noPound;r.message=e.message;r.onHide=e.onHide;Lightbox.show("modelviewer",{onShow:m,onHide:p})};function o(){if(r.entityType===a.D4_ITEM){if(r.elements.classSelect){return}let e=WH.getPageData("modelData");if(!e||e.length===0){return}r.elements.classSelect=t.createImitationSelect({native:true});let a=r.elements.classSelect;a.classList.add("d4-model-select");WH.ae(WH.qs(".modelviewer-model"),a);e.forEach((e=>{WH.D4.Gender.getAll().forEach((t=>{let i=WH.D4.PlayerClass.getName(e)+WH.TERMS.comma_punct+WH.D4.Gender.getName(t);WH.ae(a,WH.ce("option",{dataset:{classId:e,genderId:t},label:i}))}))}));WH.aE(a,"change",(()=>{switch(r.entityType){case WH.Types.D4_ITEM:u();break}}));a.selectedIndex=0}}function l(){let e=r.elements.classSelect;let t=e.options[e.selectedIndex];return{playerClass:e?t.dataset.classId:169776,playerGender:t.dataset.genderId}}function c(){WH.onLoad(d)}function u(){h();let e=WH.D4.PlayerClass.getIndex(parseInt(r.playerClass));r.viewer.loadItem(r.entityId,e.value,r.playerGender,null)}function d(){if(!location.hash||location.hash.indexOf("#modelviewer")!==0){return}let t=location.hash.split(":");if(t.length<3){let e=WH.ge("wh-mv-view-in-3d-button");if(e){e.click()}return}t.shift();let a=parseInt(t.shift());let i={type:a,extendedHash:true};switch(a){case WH.Types.D4_ITEM:i.typeId=parseInt(t.shift());break}if(i.typeId){e.showLightbox(i)}}function f(){let t=r.dataEnv;if(!e.isLibraryLoaded(t)){e.loadLibrary(f.bind(this),t);return}if(!r.viewer){WH.ee(r.elements.screen);let a=WH.ce("canvas",{id:WH.Strings.guid(),style:{width:"100%",height:"100%"}});WH.ae(r.elements.screen,a);r.viewer=new(e.getLibrary(t))({rootGameDataPath:e.getBaseUrl(),basePath:e.getModelviewerBaseUrl(),canvasQuerySelector:"#"+a.id})}switch(r.entityType){case WH.Types.D4_ITEM:o();u();break;default:WH.error("Unsupported entity type",r.entityType)}if(!r.resizeEventBound){WH.aE(window,"resize",H);r.resizeEventBound=true}H();if(!r.ignoreHash){let e="#modelviewer";if(r.extendedHash){switch(r.entityType){case a.D4_ITEM:e+=":"+r.entityType+":"+r.entityId;break}}location.replace(WH.rtrim(e,":"))}}function h(){let e=l();r.playerClass=e.playerClass;r.playerGender=e.playerGender}function p(){r.shown=false;if(!r.ignoreHash){if(!r.fromMarkup&&r.oldHash&&r.oldHash.indexOf("modelviewer")===-1){WH.setHash(r.oldHash)}else{WH.clearHash()}}WH.ee(r.elements.screen);if(r.viewer){r.viewer=undefined}if(r.onHide){r.onHide()}}function m(e,t){r.shown=true;if(t){e.classList.add("has-lightbox-caption","modelviewer");r.elements.screen=WH.ce("div",{className:"modelviewer-screen"});r.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(r.elements.lightboxContent,r.elements.screen);e.append(r.elements.lightboxContent);H();let t=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(t,"click",Lightbox.hide);WH.ae(e,t);WH.ae(e,WH.ce("a",{className:"dialog-option fa fa-question",href:i.generatePath("/help=modelviewer"),target:"_blank"},WH.ct(WH.TERMS.help)));WH.ae(e,WH.ce("div",{className:"modelviewer-model"}));WH.ae(e,WH.ce("div",{className:"modelviewer-instructions"},WH.ct(WH.TERMS.modelviewercontrols_tip)));WH.ae(e,WH.ce("div",{id:"modelviewer-msg",className:"sub",style:{marginTop:"-6px",color:"#ccc",fontSize:"13px"}}));if(WH.User.isLoggedIn()){WH.fetch(i.generatePath("/website-achievement-explored"),{form:{trigger:"modelviewer"},success:AchievementCheck})}}requestAnimationFrame(f);let n=WH.qs("#modelviewer-msg",e);if(r.message){n.innerHTML=r.message;WH.displayDefault(n)}else{WH.displayNone(n)}let s="";switch(r.entityType){case a.D4_ITEM:s+="D4 Item "+r.entityId;break}WH.Track.interactiveEvent("Model Viewer","Show",WH.Strings.slug(s));r.oldHash=location.hash}function H(){if(!r.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=r.elements.lightboxContent.offsetWidth;t=r.elements.lightboxContent.offsetHeight;r.elements.screen.style.width="100%";r.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-n;t=window.innerHeight-Lightbox.BLEED_SIZE-s;let a=Math.round(t*(16/9));let i=Math.round(e*(9/16));if(e>a){e=a}else if(t>i){t=i}r.elements.screen.style.width=e+"px";r.elements.screen.style.height=t+"px"}}c()}));WH.D4.PlayerClass=new function(){"use strict";const e=this;const t=WH.getPageData("d4.playerClass.idStrings");const a=WH.getPageData("d4.playerClass.index");const i=WH.getPageData("d4.playerClass.names");const n=WH.getPageData("d4.playerClass.slugs");this.fromIndex=e=>a[e.value];this.fromSlug=e=>WH.findKey(n,e,true);this.getIdString=e=>t[e];this.getIndex=e=>WH.D4.PlayerClass.Index.tryFrom(WH.findKey(a,e,true));this.getName=e=>i[e];this.getSlug=e=>n[e]};WH.D4.Slot=new function(){const e=this;this.BACKPACK=0;this.HEAD=4;this.TORSO=5;this.OFF_HAND=6;this.MAIN_HAND=7;this.TWO_HAND_BLUNT=8;this.TWO_HAND_SLASH=9;this.TWO_HAND_RANGED=10;this.ONE_HAND_MAIN=11;this.ONE_HAND_OFF=12;this.HANDS=13;this.LEGS=14;this.FEET=15;this.RIGHT_FINGER=16;this.LEFT_FINGER=17;this.NECK=18;this.COSMETIC_BACK=19;this.BODY=20;this.TROPHY=21;const t=WH.getPageData("d4.slot.names")||{};const a={[this.BACKPACK]:"backpack",[this.HEAD]:"head",[this.TORSO]:"torso",[this.OFF_HAND]:"off-hand",[this.MAIN_HAND]:"main-hand",[this.TWO_HAND_BLUNT]:"two-hand-blunt",[this.TWO_HAND_SLASH]:"two-hand-slash",[this.TWO_HAND_RANGED]:"two-hand-ranged",[this.ONE_HAND_MAIN]:"one-hand-main",[this.ONE_HAND_OFF]:"one-hand-off",[this.HANDS]:"hands",[this.LEGS]:"legs",[this.FEET]:"feet",[this.RIGHT_FINGER]:"right-finger",[this.LEFT_FINGER]:"left-finger",[this.NECK]:"neck",[this.COSMETIC_BACK]:"cosmetic-back",[this.BODY]:"body",[this.TROPHY]:"trophy"};this.getAll=()=>Object.keys(a).map((e=>parseInt(e))).sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))));this.getDisplaySort=()=>[this.HEAD,this.TORSO,this.HANDS,this.LEGS,this.FEET,this.NECK,this.RIGHT_FINGER,this.LEFT_FINGER,this.TWO_HAND_RANGED,this.TWO_HAND_BLUNT,this.TWO_HAND_SLASH,this.MAIN_HAND,this.ONE_HAND_MAIN,this.OFF_HAND,this.ONE_HAND_OFF,this.COSMETIC_BACK,this.BACKPACK,this.BODY,this.TROPHY];this.getName=e=>t[e];this.getIdString=e=>a[e];this.isWeaponSlot=e=>[this.TWO_HAND_RANGED,this.TWO_HAND_BLUNT,this.TWO_HAND_SLASH,this.MAIN_HAND,this.ONE_HAND_MAIN,this.OFF_HAND,this.ONE_HAND_OFF].includes(e)};WH.D4.Item.Quality=new function(){const e=this;this.COMMON=0;this.MAGIC=1;this.MAGIC2=2;this.RARE=3;this.RARE2=4;this.LEGENDARY=5;this.UNIQUE=6;this.SET=7;const t={[this.COMMON]:"normal",[this.MAGIC]:"magic",[this.MAGIC2]:"magic",[this.RARE]:"rare",[this.RARE2]:"rare",[this.LEGENDARY]:"legendary",[this.UNIQUE]:"unique",[this.SET]:"set,"};this.getSlug=e=>t[e]};WH.D4.PlayerClass.Index=WH.defineEnum({Sorcerer:0,Druid:1,Barbarian:2,Rogue:3,Necromancer:4},(function(e){"use strict";const t=this;const a=WH.D4.PlayerClass;this.getIdString=()=>a.getIdString(t.getSno());this.getFlag=()=>1<<t.value;this.getName=()=>a.getName(t.getSno());this.getSlug=()=>a.getSlug(t.getSno());this.getSno=()=>a.fromIndex(t)}));WH.DI.EquipItem=new function(){};WH.DI.Gender=new function(){const e=this;this.FEMALE="f";this.MALE="m";const t=[e.FEMALE,e.MALE];const a={[this.FEMALE]:WH.TERMS.female,[this.MALE]:WH.TERMS.male};const i={[this.FEMALE]:1,[this.MALE]:0};const n={[this.FEMALE]:"female",[this.MALE]:"male"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getBySlug=function(e){for(let t in n){if(n[t]===e){return t}}return null};this.getName=function(e){return a[e]||null};this.getNumericId=function(e){return i[e]};this.getSlug=function(e){return n[e]||null}};WH.DI.InventoryColor=new function(){this.GRAY=0;this.INFERIOR_BLUE=1;this.LIGHT_BLUE=2;this.WHITE=3;this.BLUE=4;this.GOLD=5;this.ORANGE=6;this.GREEN=7;this.DUBO=8;this.VIOLET=9};WH.stub("DI");WH.DI.ModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.DOM;const a=WH.Types;const i=WH.Url;const n=[-1,0,1,2];const s=20;const r=76;const o={elements:{animationSelect:undefined,classSelect:undefined,lightboxContent:undefined,resonanceSelect:undefined,screen:undefined},playerGender:undefined,playerClass:undefined,dataEnv:undefined,entityResonance:undefined,entityType:undefined,entityId:undefined,extendedHash:false,fromMarkup:false,ignoreHash:false,library:{},libraryLoadedCallbacks:{},message:undefined,oldHash:"",onHide:undefined,ratio:16/9,resizeEventBound:false,selectedResonance:n[0],shown:false,variant:0,viewer:undefined};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return o.library[e]};this.getStaticBase=function(e){return"/di/modelviewer"};this.getContentPath=function(t){return(WH.isDev()?"https://static-staging.wowhead.com":WH.STATIC_URL)+e.getStaticBase(t)+"/"};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}let i=!!o.libraryLoadedCallbacks[a];if(!i){o.libraryLoadedCallbacks[a]=[]}if(t){if(o.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{o.libraryLoadedCallbacks[a].push(t)}}if(i){return}let n=WH.ce("script");n.src=e.getContentPath(a)+"viewer.js";WH.aE(n,"load",(function(){if(window.Viewer&&window.Viewer.default){o.library[a]=window.Viewer.default;delete window.Viewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but Viewer is still undefined!");return}while(o.libraryLoadedCallbacks[a].length){o.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load Viewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){e=e||{};o.dataEnv=e.dataEnv||WH.getDataEnv();o.entityId=e.typeId;o.entityResonance=e.hasResonance;o.entityType=e.type;o.extendedHash=!!e.extendedHash;o.fromMarkup=!!e.fromTag;o.ignoreHash=!!e.noPound;o.message=e.message;o.onHide=e.onHide;Lightbox.show("modelviewer",{onShow:H,onHide:m})};function l(){if(!o.elements.animationSelect){o.elements.animationSelect=t.createImitationSelect({native:true});let e=o.elements.animationSelect;e.classList.add("di-animation-select");WH.ae(WH.qs(".modelviewer-model"),e)}let e=o.elements.animationSelect;if(e.dataset.modelId!==o.entityId.toString()){WH.ee(e);let t=o.viewer.npc.animator.animations;if(t.length===0){e.dataset.hidden=true;return}t.forEach((t=>{WH.ae(e,WH.ce("option",{label:t.name,value:t.name}))}));e.dataset.modelId=o.entityId;WH.aE(e,"change",(()=>{o.viewer.npc.animator.setAnimationByName(e.options[e.selectedIndex].value)}))}e.selectedIndex=0}function c(){if(o.entityType===a.DI_EQUIP_ITEM){if(o.elements.classSelect){return}let e=WH.getPageData("modelData");if(!e||e.length===0){return}o.elements.classSelect=t.createImitationSelect({native:true});let a=o.elements.classSelect;a.classList.add("di-model-select");WH.ae(WH.qs(".modelviewer-model"),a);e.forEach((e=>{let t=WH.DI.PlayerClass.getByIdString(e.classString);let i=e.required?"di-class-equip":"di-class-restricted";let n=WH.DI.PlayerClass.getName(t)+WH.TERMS.comma_punct+WH.DI.Gender.getName(e.gender);let s=`${t}-${WH.DI.Gender.getNumericId(e.gender)}`;WH.ae(a,WH.ce("option",{className:i,label:n,value:s}))}));WH.aE(a,"change",(()=>{p();o.viewer.loadItem(o.entityId,o.playerClass,o.playerGender,o.variant,o.selectedResonance)}));a.selectedIndex=0}}function u(){let e=o.elements.classSelect;let t=e?e.options[e.selectedIndex].value.split("-"):[WH.DI.PlayerClass.WIZARD,WH.DI.Gender.getNumericId(WH.DI.Gender.MALE)];return{playerClass:parseInt(t[0]),playerGender:parseInt(t[1])}}function d(){WH.onLoad(f)}function f(){if(!location.hash||location.hash.indexOf("#modelviewer")!==0){return}let t=location.hash.split(":");if(t.length<3){let e=WH.ge("wh-mv-view-in-3d-button");if(e){e.click()}return}t.shift();let a=parseInt(t.shift());let i={type:a,extendedHash:true};switch(a){case WH.Types.DI_EQUIP_ITEM:i.typeId=parseInt(t.shift());break}if(i.typeId){e.showLightbox(i)}}function h(){let t=o.dataEnv;if(!e.isLibraryLoaded(t)){e.loadLibrary(h.bind(this),t);return}if(!o.viewer){WH.ee(o.elements.screen);let a=WH.ce("canvas",{id:WH.Strings.guid(),style:{width:"100%",height:"100%"}});WH.ae(o.elements.screen,a);o.viewer=new(e.getLibrary(t))({basePath:e.getContentPath().replace(/\/$/,""),canvasQuerySelector:"#"+a.id,databasePath:i.generatePath("/data-modelviewer/"),rootGameDataPath:e.getContentPath()+"data/"})}switch(o.entityType){case WH.Types.DI_EQUIP_ITEM:c();p();W();o.viewer.loadItem(o.entityId,o.playerClass,o.playerGender,o.variant,o.selectedResonance);break;case WH.Types.DI_NPC:o.viewer.loadMonster(o.entityId,-1,(function(){o.viewer.npc=this;o.viewer.npc.animator.setAnimationByIndex(0);l()}));break;default:WH.error("Unsupported entity type",o.entityType)}if(!o.resizeEventBound){WH.aE(window,"resize",g);o.resizeEventBound=true}g();if(!o.ignoreHash){let e="#modelviewer";if(o.extendedHash){switch(o.entityType){case a.DI_EQUIP_ITEM:e+=":"+o.entityType+":"+o.entityId;break}}location.replace(WH.rtrim(e,":"))}}function p(){let e=u();o.playerClass=e.playerClass;o.playerGender=e.playerGender}function m(){o.shown=false;if(!o.ignoreHash){if(!o.fromMarkup&&o.oldHash&&o.oldHash.indexOf("modelviewer")===-1){WH.setHash(o.oldHash)}else{WH.clearHash()}}WH.ee(o.elements.screen);if(o.viewer){o.viewer=undefined}if(o.onHide){o.onHide()}}function H(e,t){o.shown=true;if(t){e.classList.add("has-lightbox-caption","modelviewer");o.elements.screen=WH.ce("div",{className:"modelviewer-screen"});o.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(o.elements.lightboxContent,o.elements.screen);e.append(o.elements.lightboxContent);g();let t=WH.ce("a",{className:"dialog-option fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.close));WH.aE(t,"click",Lightbox.hide);WH.ae(e,t);WH.ae(e,WH.ce("a",{className:"dialog-option fa fa-question",href:i.generatePath("/help=modelviewer"),target:"_blank"},WH.ct(WH.TERMS.help)));WH.ae(e,WH.ce("div",{className:"modelviewer-model"}));WH.ae(e,WH.ce("div",{className:"modelviewer-instructions"},WH.ct(WH.TERMS.modelviewercontrols_tip)));WH.ae(e,WH.ce("div",{id:"modelviewer-msg",className:"sub",style:{marginTop:"-6px",color:"#ccc",fontSize:"13px"}}));if(WH.User.isLoggedIn()){WH.fetch(i.generatePath("/website-achievement-explored"),{form:{trigger:"modelviewer"},success:AchievementCheck})}}requestAnimationFrame(h);let n=WH.qs("#modelviewer-msg",e);if(o.message){n.innerHTML=o.message;WH.displayDefault(n)}else{WH.displayNone(n)}let s="";switch(o.entityType){case a.DI_EQUIP_ITEM:s+="DI Item "+o.entityId;break}WH.Track.interactiveEvent("Model Viewer","Show",WH.Strings.slug(s));o.oldHash=location.hash}function g(){if(!o.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=o.elements.lightboxContent.offsetWidth;t=o.elements.lightboxContent.offsetHeight;o.elements.screen.style.width="100%";o.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-s;t=window.innerHeight-Lightbox.BLEED_SIZE-r;let a=Math.round(t*(16/9));let i=Math.round(e*(9/16));if(e>a){e=a}else if(t>i){t=i}o.elements.screen.style.width=e+"px";o.elements.screen.style.height=t+"px"}}function W(){if(o.entityResonance){if(!o.elements.resonanceSelect){o.elements.resonanceSelect=t.createImitationSelect({native:true});let e=o.elements.resonanceSelect;e.classList.add("di-resonance-select");WH.ae(WH.qs(".modelviewer-model"),e)}let e=o.elements.resonanceSelect;if(e.dataset.modelId!==o.entityId.toString()){WH.ee(e);n.forEach(((t,a)=>{WH.ae(e,WH.ce("option",{label:WH.TERMS.gemResonance+WH.TERMS.colon_punct+a,value:t}))}));e.dataset.modelId=o.entityId;WH.aE(e,"change",(()=>{o.viewer.loadItem(o.entityId,o.playerClass,o.playerGender,o.variant,e.options[e.selectedIndex].value)}))}e.selectedIndex=0}}d()}));WH.DI.PlayerClass=new function(){const e=this;this.BARBARIAN=2;this.BLOOD_KNIGHT=7;this.CRUSADER=5;this.DEMON_HUNTER=4;this.MONK=3;this.NECROMANCER=6;this.WIZARD=1;const t=[e.BARBARIAN,e.BLOOD_KNIGHT,e.CRUSADER,e.DEMON_HUNTER,e.MONK,e.NECROMANCER,e.WIZARD];const a={[this.BARBARIAN]:"barbarian",[this.BLOOD_KNIGHT]:"bloodknight",[this.CRUSADER]:"crusader",[this.DEMON_HUNTER]:"demonhunter",[this.MONK]:"monk",[this.NECROMANCER]:"necromancer",[this.WIZARD]:"sorceress"};const i=WH.getPageData("di.playerClass.names")||{};const n={[this.BARBARIAN]:"barbarian",[this.BLOOD_KNIGHT]:"blood-knight",[this.CRUSADER]:"crusader",[this.DEMON_HUNTER]:"demon-hunter",[this.MONK]:"monk",[this.NECROMANCER]:"necromancer",[this.WIZARD]:"wizard"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getByIdString=function(e){for(let t in a){if(a[t]===e){return parseInt(t)}}return undefined};this.getBySlug=function(e){for(let t in n){if(n[t]===e){return parseInt(t)}}return undefined};this.getIdString=function(e){return a[e]};this.getName=function(e){return i[e]||null};this.getSlug=function(e){return n[e]}};WH.DI.EquipItem.DropRank=new function(){const e=this;this.NORMAL=1;this.MAGIC=2;this.RARE=3;this.LEGENDARY=4;this.SET=5;const t=[this.NORMAL,this.MAGIC,this.RARE,this.LEGENDARY,this.SET];const a=WH.getPageData("di.equipItem.dropRank.names")||{};const i={[this.NORMAL]:"normal",[this.MAGIC]:"magic",[this.RARE]:"rare",[this.LEGENDARY]:"legendary",[this.SET]:"set"};this.getAll=function(){return t.slice()};this.getName=function(e){return a[e]||null};this.getSlug=function(e){return i[e]}};WH.DI.EquipItem.Position=new function(){const e=this;this.AMULET=6;this.CHEST=5;this.FEET=11;this.HANDS=4;this.HEAD=1;this.LEGS=13;this.MAIN_HAND=10;this.NECK=3;this.OFF_HAND=12;this.RING=7;this.RING2=9;this.SHOULDER=2;this.TALISMAN=14;this.WAIST=8;const t=[this.AMULET,this.CHEST,this.FEET,this.HANDS,this.HEAD,this.LEGS,this.MAIN_HAND,this.NECK,this.OFF_HAND,this.RING,this.RING2,this.SHOULDER,this.TALISMAN,this.WAIST];const a=WH.getPageData("di.equipItem.position.names")||{};const i={[this.AMULET]:"amulet",[this.CHEST]:"chest",[this.FEET]:"feet",[this.HANDS]:"hands",[this.HEAD]:"head",[this.LEGS]:"legs",[this.MAIN_HAND]:"main-hand",[this.NECK]:"neck",[this.OFF_HAND]:"off-hand",[this.RING]:"ring",[this.RING2]:"ring2",[this.SHOULDER]:"shoulder",[this.TALISMAN]:"talisman",[this.WAIST]:"waist"};this.getAll=function(){return t.slice().sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getName=function(e){return a[e]};this.getSlug=function(e){return i[e]}};WH.stub("DI.Skill");WH.DI.Skill.Type=new function(){this.NORMAL=1;this.ACTIVE=2;this.POTION=3;this.TORCH=4;this.ON_BORN=5};WH.Layout.DataTreeSwitcher=new function(){const e=WH.Game;const t=WH.Layout;const a=WH.Responsive;const i=WH.Tooltips;const n=WH.Url;const s=[e.D2,e.DI];const r=[WH.dataTree.TBC];const o={elements:{container:undefined}};this.checkEnvDimensions=()=>{WH.qsa(".data-env-links-group .data-env-link").forEach((e=>{let t=getComputedStyle(e);let a=parseFloat(t.height);let i=parseFloat(t.width);e.dataset.equalDimensions=JSON.stringify(i/a<1.06)}))};this.init=()=>{let t=e.get();o.elements.container=WH.ge("data-tree-switcher");let i=location.pathname==="/";let n=WH.ce("a",{ariaLabel:WH.TERMS.homepage_short,className:"fa fa-home",dataset:{current:`${i}`}});if(!i){n.href="/"}WH.ae(o.elements.container,WH.ce("div",{dataset:{current:`${i}`,game:"wow"}},n));let r=[];e.getAll().forEach((a=>{if(s.includes(a)&&a!==t){e.getDataTrees(a).forEach((e=>r.push(e)))}else{u(a)}}));if(r.length){WH.ae(o.elements.container,WH.ce("div",{dataset:{game:"none"}},c(r,WH.TERMS.moreGames)))}a.adjustByScrollSize(o.elements.container,(()=>o.elements.container.dataset.text="short"),(()=>o.elements.container.dataset.text="long"))};function l(e){let a=e===WH.getDataTree()&&!t.useAlternateSwitcherPathCommand(WH.dataTreeToRoot[e],n.removePathPrefixes(location.pathname));let i=WH.ce("a",{dataset:{current:JSON.stringify(a),tree:WH.getDataTreeKey(e)}},[WH.ce("img",{alt:WH.TERMS[WH.getDataTreeTerm(e)]}),WH.ct(WH.TERMS[WH.getDataTreeShortTerm(e)])]);if(a){WH.preventSelectStart(i)}else{d(i,e)}return i}function c(e,a){let n=[Menu.createHeading({label:a})];e.forEach((e=>{n.push(Menu.createItem({label:WH.TERMS[WH.getDataTreeTerm(e)],options:{regenerateMenuItem:a=>{Menu.setItemUrl(a,t.getEnvSwitcherUrl(WH.dataTreeToRoot[e]));return a}}}))}));let s=WH.ce("a",{ariaLabel:a,className:"data-tree-switcher-ellipsis",href:"javascript:",innerHTML:"&middot;&middot;&middot;"});i.attach(s,a);Menu.add(s,n,{onShow:()=>i.hide(),showAtElement:true});return s}function u(t){if(!e.hasAccess(t)){return}let a=WH.getDataTree();let i=e.getDataTrees(t);let n=e.getAbbrev(t);let s=e.getName(t);let u={dataset:{text:"long"}};if(i.length>1){u.dataset.disabled="true"}let f=WH.ce("div",{dataset:{game:e.getKey(t)}});if(i.length===1&&e.get()===t){u.dataset.disabled="true";f.dataset.current="true"}let h=WH.ce("a",u,[WH.ce("img",{alt:s}),WH.ct(t===e.WOW?n:s)]);d(h,i[0]);WH.ae(f,h);u.dataset.text="short";let p=WH.ce("a",u,[WH.ce("img",{alt:s}),WH.ct(n)]);d(p,i[0]);WH.ae(f,p);if(i.length>1){let e=WH.ce("div",{className:"data-trees"});let t=[];i.forEach((i=>{if(r.includes(i)&&i!==a){t.push(i)}else{WH.ae(e,l(i))}}));if(t.length){let a=c(t,WH.TERMS.moreWowVersions);a.dataset.tree="none";WH.ae(e,a)}WH.ae(f,e)}WH.ae(o.elements.container,f)}function d(e,a){let i=WH.dataTreeToRoot[a];WH.aE(e,"click",t.updateDataEnvLink.bind(e,e,i));WH.aE(e,"mouseover",t.updateDataEnvLink.bind(e,e,i));t.updateDataEnvLink(e,i)}};WH.Layout.FilledPageMode=new function(){const e=WH.Layout;const t={enabled:false,headerBottomListenerAdded:false};this.disable=()=>{t.enabled=false;e.setForcedFullscreenMode(false);document.body.dataset.filledPageMode="false";WH.qs(".main-contents").style.top=null};this.enable=()=>{t.enabled=true;e.setForcedFullscreenMode(true);scrollTo(0,0);document.body.dataset.filledPageMode="true";if(!t.headerBottomListenerAdded){e.onHeaderBottomMove((e=>{if(t.enabled){WH.qs(".main-contents").style.top=`${e}px`}}));t.headerBottomListenerAdded=true}}};WH.Layout.Footer=new function(){const e=[{url:"https://discord.gg/wowhead",className:"discord-icon"},{url:"https://twitter.com/Wowhead",className:"fa fa-twitter"},{url:"https://www.facebook.com/Wowhead",className:"fa fa-facebook"},{url:"https://www.youtube.com/user/Wowhead",className:"fa fa-youtube-play"},{url:"/news/rss/all",className:"fa fa-rss hassubmenu"},{crumb:"vk",url:"https://vk.com/wowheadrussia",className:"fa fa-vk"}];this.init=function(e){WH.Page.init();o();r();l();c();WH.setupFooterMenus();Menu.add(WH.qs(".footer-utility-social-links .fa-rss"),e)};function t(e,t){if(Menu.hasSubmenuContent(e)){Menu.add(t,Menu.getSubmenu(e))}}function a(e,a){let i=WH.ce("li");let n=WH.ce("a",{href:Menu.getItemUrl(e)||"javascript:",dataset:{disableWowheadTooltip:"true"}},WH.ct(Menu.getLabel(e)));t(e,n);WH.ae(i,n);WH.ae(a,i)}function i(e){Menu.getMenu("footer").forEach((a=>{if((Menu.getItemUrl(a)||"").match(/\/random$/)&&!WH.Game.supportsRandomPages(WH.Game.get())){return}let i;if(Menu.getItemCrumb(a)==="advertise"){i="mailto:advertising@fanbyte.com"}else{i=Menu.getItemUrl(a)||"javascript:"}let n=WH.ce("a",{href:i},WH.ct(Menu.getLabel(a)));n.dataset.disableWowheadTooltip="true";t(a,n);let s=WH.ce("li",{className:"footer-list-item"});WH.ae(s,n);WH.ae(e,s)}))}function n(){let t=WH.ce("ul",{className:"footer-utility-social-links"});e.forEach((e=>{if(e.crumb==="vk"&&Locale.getId()!==LOCALE_RURU){return}let a=WH.ce("li");let i=WH.ce("a",{className:e.className,href:e.url});WH.ae(a,i);WH.ae(t,a)}));return t}function s(){let e=WH.ce("img",{src:"/images/logos/wh-logo-thumbnail.png"});let t=WH.ce("a",{href:WH.Url.generatePath("/")},e);let a=WH.ce("li",{className:"footer-utility-logo"},t);let n=WH.ce("ul",{className:"footer-utility-site-links"},a);i(n);return n}function r(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-content-links"});let a=WH.ce("section",{className:"footer-content"});Menu.getMenu("footerLinks").forEach((e=>{let a=WH.ae(t,WH.ce("ul",{className:"footer-list"}));let i=WH.ce("li",{className:"footer-list-item-heading"});let n=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));n.dataset.disableWowheadTooltip="true";WH.ae(i,n);WH.ae(a,i);if(Menu.hasSubmenuContent(e)){Menu.getSubmenu(e).forEach((e=>{let t=WH.ce("li",{className:"footer-list-item"});let i=WH.ce("a",{href:Menu.getItemUrl(e)},WH.ct(Menu.getLabel(e)));i.dataset.disableWowheadTooltip="true";WH.ae(t,i);WH.ae(a,t)}))}}));WH.ae(a,t);WH.ae(e,a)}function o(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-navigation"});let i=WH.ce("section",{className:"footer-navigation-bar"});let n=WH.ce("ul",{className:"footer-navigation-bar-links"});let s=WH.ce("ul",{className:"footer-navigation-bar-links"});let r=Menu.getMenu().filter((e=>{let t=Menu.getItemOptions(e);return!t.breadcrumbOnly}));r.slice(0,r.length/2).forEach((e=>{a(e,n)}));r.slice(r.length/2,r.length).forEach((e=>{a(e,s)}));let o=WH.ce("section",{className:"footer-navigation-bar-logo"});let l=WH.ce("section",{className:"footer-navigation-bar-logo-link"});let c=WH.ce("a",{href:WH.Url.generatePath("/")});WH.ae(c,l);WH.ae(o,c);WH.ae(i,n);WH.ae(i,o);WH.ae(i,s);WH.ae(t,i);WH.ae(e,t);let u=()=>{let e=[0,1,2,4];let t=window.innerWidth;let a=t>=1366?e[3]:t>=768?e[2]:t>=426?e[1]:e[0];i.dataset.columns=a.toString();let n=17;let s=WH.qs(".footer-navigation-bar-links li a");if(s){n=Math.ceil(parseFloat(getComputedStyle(s).lineHeight))}let r=a===4?"ul":"li";for(let t of WH.qsa(r,i)){if(t.clientHeight>n){i.dataset.columns=(e.indexOf(a)-1).toString();break}}};u();WH.aE(window,"resize",u)}function l(){let e=WH.qs(".footer-content");let t=WH.ce("span",{className:"footer-button-top-label"},WH.ct(WH.TERMS.topOfPage_short));WH.preventSelectStart(t);let a=WH.ce("div",{className:"footer-button-outer"},t);let i=WH.ce("button",{className:"footer-button-top-icon fa fa-angle-double-up"});WH.ae(a,i);WH.ae(e,a);WH.aE(i,"click",(()=>{scroll({top:0,behavior:"smooth"})}));WH.aE(t,"click",(()=>{scroll({top:0,behavior:"smooth"})}))}function c(){let e=WH.qs(".footer");let t=WH.ce("section",{className:"footer-utility-bar"});let a=WH.ce("section",{className:"footer-utility"});let i=s();let r=n();WH.ae(t,i);WH.ae(t,r);WH.ae(a,t);WH.ae(e,a)}};WH.Layout.Responsive=new function(){const e=this;const t=WH.DOM;const a=WH.DynamicFixedElement;const i=WH.Layout;this.HEADER_RESIZE_MS=150;const n=135;const s=84;const r="header-nav-collapsed";const o="compact";const l="standard";const c=2;const u=280;const d=2;const f={CLASSIC:WH.Theme.isClassic(),CLASSIC_TYPE:WH.Theme.isClassicType(),STANDARD_TYPE:WH.Theme.isStandardType(),THOTTBOT:WH.Theme.isThottbot()};const h={elements:{collapsibleNavLinks:undefined,firstMenuItem:undefined,fullscreenModeIcon:undefined,header:undefined,headerNav:undefined,headerNavEllipsis:undefined,headerNavFeatures:undefined,headerNavFeaturesEllipsis:undefined,headerNavFeaturesLinks:undefined,headerNavLinks:undefined,headerNavWrapper:undefined,headerUser:undefined,headerWrapper:undefined,layoutWrapper:undefined,logo:undefined,search:undefined,themeSwitcher:undefined},featuredNavCompact:undefined,featuredNavCompactHiddenViewportWidths:[0,0],featuredNavOverflowMenu:[],hiddenHeader:undefined,initialized:false,logoShrinkViewportWidth:0,collapsibleNavLinkCount:undefined,maxMobileNavigationWidth:767,mobileMode:false,navOverflowLastNavState:undefined,navOverflowLastResponsiveStep:{compact:0,standard:0},navOverflowLastViewportWidth:{compact:0,standard:0},navOverflowMenu:[],navScrollLimitEnabled:false,resizeCallbacks:[],responsiveNavStep:{compact:0,standard:0},responsiveNavStepWidths:{compact:[0,0],standard:[0,0]},shrinkHeader:false,updateSearchWidth:false};this.check=function(e){if(!h.initialized){return h.mobileMode}let t=h.mobileMode;if(w()){i.disableLayoutAnimation();x(!h.mobileMode);ZUL.setEnabled(h.mobileMode);if(!h.mobileMode&&w()){x(!h.mobileMode);ZUL.setEnabled(h.mobileMode)}setTimeout((function(){requestAnimationFrame(i.enableLayoutAnimation)}),10)}if(!h.mobileMode){if(f.STANDARD_TYPE){k()}else if(f.CLASSIC_TYPE){WH.WAS.updateSkinPosition()}}if(e===true||e!==false&&t&&!h.mobileMode){h.updateSearchWidth=true;N();R()}if(h.updateSearchWidth){requestAnimationFrame(i.updateSearchWidth.bind(i,false));h.updateSearchWidth=false}return h.mobileMode};this.disableNavScrollLimit=function(){h.elements.headerWrapper.style.position="";h.elements.headerWrapper.style.top="";requestAnimationFrame((function(){requestAnimationFrame((function(){h.elements.headerWrapper.style.transition=""}))}));h.navScrollLimitEnabled=false};this.init=function(t){h.initialized=true;if(!t){return}h.elements.collapsibleNavLinks=t.collapsibleNavLinks;h.elements.header=t.header;h.elements.headerNav=t.nav;h.elements.headerNavEllipsis=t.navEllipsis;h.elements.headerNavFeatures=t.featuredNav;h.elements.headerNavFeaturesEllipsis=t.featuredEllipsis;h.elements.headerNavFeaturesLinks=t.featuredLinks;h.elements.headerNavLinks=t.navLinks;h.elements.headerNavWrapper=t.navWrapper;h.elements.headerUser=WH.qs(".header-user");h.elements.headerWrapper=t.headerWrapper;h.elements.layoutWrapper=WH.qs(".layout-wrapper");h.elements.search=WH.qs(".header-search form");h.collapsibleNavLinkCount=h.elements.collapsibleNavLinks.length;WH.onMutate(document.body,(function(){if(h.navScrollLimitEnabled){U(window.scrollY)}}));WH.onMutate(document.body,N,{characterData:false,subtree:false});WH.onMutate(h.elements.headerUser,P.bind(e,true));WH.aE(window,"scroll",N);WH.aE(window,"resize",R);if(document.fonts){document.fonts.load("14px Open Sans").then(R)}N();R()};this.onHeaderResize=function(e){h.resizeCallbacks.push(e)};this.updateHeaderOffset=function(){let e;if(h.elements.header){if(f.CLASSIC_TYPE){e=t.getInnerHeight(h.elements.header)+(i.getFullscreenMode()?s:n)}if(!ZUL.getEnabled()){let a=10;if(!i.getFullscreenMode()){if(f.STANDARD_TYPE){a+=h.elements.headerWrapper.getBoundingClientRect().height;if(t.isVisible(h.elements.headerNavFeatures)){a-=h.elements.headerNavFeatures.getBoundingClientRect().height}}else if(f.CLASSIC_TYPE){a+=e;a-=51}}document.documentElement.style.scrollPaddingTop=a+"px"}else{document.documentElement.style.scrollPaddingTop=null}}if(f.STANDARD_TYPE){return}if(!e){return}let a=i.getElement("page-content");if(!a){return}i.disableLayoutAnimation();requestAnimationFrame(i.enableLayoutAnimation);a.style.borderTopWidth=e+"px";h.elements.headerWrapper.style.marginBottom="-"+e+"px";WH.WAS.updateSkinPosition()};this.updateNavOverflow=function(){P(true)};function p(e,t,a,i){for(let n=e;n<h.collapsibleNavLinkCount;n++){let s=h.elements.collapsibleNavLinks[n];if(b(t,a,i)){s.classList.add(r);e++;h.navOverflowMenu.push(s.menuItem);if(a===s){break}}else{s.classList.remove(r)}}return e}function m(e){h.mobileMode=true;let t=e+d;if(t>h.maxMobileNavigationWidth){h.maxMobileNavigationWidth=t}}function H(){if(h.elements.headerNavEllipsis&&!h.elements.headerNavEllipsis.classList.contains(r)){return h.elements.headerNavEllipsis}let e=h.elements.headerNavLinks||WH.qsa(".header-nav a");for(let t=e.length-1;t>=0;t--){if(!e[t].classList.contains(r)){return e[t]}}return undefined}function g(){if(h.elements.fullscreenModeIcon===undefined){h.elements.fullscreenModeIcon=WH.qs(".header-user-fullscreen")}return h.elements.fullscreenModeIcon}function W(e,t){let a=e.getBoundingClientRect();let i=getComputedStyle(e).getPropertyValue("padding-right");let n=a.right-parseInt(i||0)-2;let s=n-(t.originalWidth||56);return{rect:a,right:n,rightWithEllipsis:s}}function E(){return h.featuredNavCompact?o:l}function _(){T(h.elements.headerNavFeaturesLinks,h.elements.headerNavFeaturesEllipsis,h.featuredNavOverflowMenu);_=function(){}}function v(){T(h.elements.headerNavLinks,h.elements.headerNavEllipsis,h.navOverflowMenu);v=function(){}}function T(e,t,a){for(let t=0,a=e.length;t<a;t++){e[t].originalWidth=e[t].getBoundingClientRect().width}t.originalWidth=t.getBoundingClientRect().width;Menu.add(t,a)}function b(e,t,a){let i=t.getBoundingClientRect();if(i.top!==e.rect.top){return true}return i.left+t.originalWidth>(a?e.right:e.rightWithEllipsis)}function S(e){if(!f.STANDARD_TYPE){return false}if(h.elements.headerNavFeaturesLinks&&!h.featuredNavCompact){let e=h.elements.headerNavFeaturesLinks[0];let t=h.elements.headerNavFeaturesLinks[h.elements.headerNavFeaturesLinks.length-1];if(e&&t&&e.getBoundingClientRect().top!==t.getBoundingClientRect().top){return true}}return false}function y(e){let t=E();P();let a=0;for(let i=1;i<=c;i++){if(e<=(h.responsiveNavStepWidths[t][i-1]||0)){a=i}}if(a!==h.responsiveNavStep[t]){A(t,a);h.updateSearchWidth=true}let i=H();if(f.CLASSIC_TYPE){let e=i?i.getBoundingClientRect():null;if(f.CLASSIC){if(h.responsiveNavStep[t]<1&&e&&e.right>h.elements.headerUser.getBoundingClientRect().left){A(t,1)}}else if(f.THOTTBOT){if(typeof h.elements.logo==="undefined"){h.elements.logo=WH.qs(".header-logo")}if(typeof h.elements.themeSwitcher==="undefined"){h.elements.themeSwitcher=WH.qs(".header-theme-switcher")}if(h.elements.logo&&h.elements.themeSwitcher){let e=h.elements.logo.getBoundingClientRect();let t=h.elements.themeSwitcher.getBoundingClientRect();if(e.right>t.left){return true}}}if(typeof h.elements.firstMenuItem==="undefined"){h.elements.firstMenuItem=WH.qs(".header-nav a:first-child")}if(h.elements.firstMenuItem&&e){return e.top>h.elements.firstMenuItem.getBoundingClientRect().top}return false}if(i&&!(h.featuredNavCompact&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true")){let a=h.responsiveNavStep[t];let n=h.elements.headerNav.getBoundingClientRect().top;let s=C(t,n,i,a);if(typeof s==="number"){if(e>h.responsiveNavStepWidths[t][s-1]){h.responsiveNavStepWidths[t][s-1]=e}if(s!==a){h.updateSearchWidth=true}}else{return true}}return false}function I(e){if(!f.STANDARD_TYPE){return false}let t=h.elements.header.dataset.logo==="small";let a=h.elements.search.offsetWidth;if(e<h.logoShrinkViewportWidth||!t&&a<u){if(!t&&h.logoShrinkViewportWidth<e){h.logoShrinkViewportWidth=e}h.elements.header.dataset.logo="small";if(t&&a&&a<u){return true}}else if(e>h.logoShrinkViewportWidth&&t){delete h.elements.header.dataset.logo;if(h.elements.search.offsetWidth<u){h.logoShrinkViewportWidth=e;h.elements.header.dataset.logo="small";if(h.elements.search.offsetWidth<u){return true}}}return false}function R(){if(h.mobileMode){return}e.updateHeaderOffset();WH.WAS.updateSkinMode()}function N(){if(h.mobileMode){return}let e=h.elements.layoutWrapper?.offsetTop;let t=window.scrollY;if(WH.WAS&&WH.WAS.isFlexSkinned()){t+=100}D(t,e);F(t,e);U(t)}function w(){let e=h.mobileMode;let t=window.innerWidth;h.mobileMode=t<=h.maxMobileNavigationWidth;if(!h.mobileMode){if(y(t)){m(t)}}if(!h.mobileMode&&h.elements.search&&I(t)){m(t)}if(!h.mobileMode&&S(t)){m(t)}return h.mobileMode!==e}function A(e,t){if(h.responsiveNavStep[e]===t){return}h.responsiveNavStep[e]=t;document.body.dataset.responsiveNavStep=""+t}function M(e,t,a){let i=e.getBoundingClientRect();if(t.left!==i.left||t.top!==i.top||a&&e.classList.contains(r)){Menu.hide(true)}}function C(e,t,a,i){if(a.getBoundingClientRect().top!==t){let n=i+1;if(n>c){return null}A(e,n);return C(e,t,a,n)}return i}function O(){if(h.navOverflowMenu.length===0){h.elements.headerNavEllipsis.classList.add(r)}else{h.elements.headerNavEllipsis.classList.remove(r);h.navOverflowMenu.reverse()}if(h.featuredNavOverflowMenu.length===0){h.elements.headerNavFeaturesEllipsis.classList.add(r)}else{h.elements.headerNavFeaturesEllipsis.classList.remove(r)}}function L(e,t){if(h.mobileMode||!h.featuredNavCompact||h.featuredNavOverflowMenu.length!==h.elements.headerNavFeaturesLinks.length&&document.body.dataset.hideFeaturedNavWhileScrolling!=="true"){return}let a=h.responsiveNavStep[E()]-1;let i=e<=h.featuredNavCompactHiddenViewportWidths[a];if(!i){let t=h.elements.headerNavFeaturesEllipsis.getBoundingClientRect();let n=h.elements.headerNavFeatures.getBoundingClientRect();if(t.width>n.width||t.top!==n.top){h.featuredNavCompactHiddenViewportWidths[a]=e;i=true}}if(t!==true||t===true&&i){document.body.dataset.hideFeaturedNavWhileScrolling=JSON.stringify(i)}if(t!==true&&!i){L(e,true)}}function k(){if(h.mobileMode||!h.elements.headerNavFeaturesLinks||h.featuredNavCompact){return}h.elements.headerNavFeaturesLinks.forEach((e=>{if(!e.origTextWidth){let t=WH.qs("span",e);t.style.display="table-cell";e.origTextWidth=t.scrollWidth;t.style.display=null}e.dataset.restrictTextWidth=JSON.stringify(e.offsetWidth+10<e.origTextWidth)}))}function D(e,t){if(t!=null){document.body.dataset.fixedHeader=JSON.stringify(e>=t)}let a=i.getFullscreenMode()&&e>=(t||0)+70;if(h.hiddenHeader!==a){h.hiddenHeader=a;document.body.dataset.hideHeader=JSON.stringify(h.hiddenHeader)}}function P(e){if(h.mobileMode||!h.elements.headerNav){return}let t=window.innerWidth;let a=E();if(h.navOverflowLastNavState===a&&h.navOverflowLastResponsiveStep[a]===h.responsiveNavStep[a]&&h.navOverflowLastViewportWidth[a]===t&&e!==true){return}h.navOverflowLastNavState=a;h.navOverflowLastResponsiveStep[a]=h.responsiveNavStep[a];h.navOverflowLastViewportWidth[a]=t;if(f.CLASSIC){v();h.navOverflowMenu.length=0;for(let e=0,t=h.elements.collapsibleNavLinks.length;e<t;e++){h.elements.collapsibleNavLinks[e].classList.remove(r)}let e=h.elements.headerUser.getBoundingClientRect();for(let t=0;t<h.collapsibleNavLinkCount;t++){let a=h.elements.collapsibleNavLinks[t];if(H().getBoundingClientRect().right>e.left){a.classList.add(r);h.navOverflowMenu.push(a.menuItem)}else{a.classList.remove(r)}}O();return}let i=0;if(h.featuredNavCompact){_();for(let e=0,t=h.elements.collapsibleNavLinks.length;e<t;e++){h.elements.collapsibleNavLinks[e].classList.remove(r)}h.navOverflowMenu.length=0;h.featuredNavOverflowMenu.length=0;let e=W(h.elements.headerNavFeatures,h.elements.headerNavFeaturesEllipsis);let a=false;for(let t=0,n=h.elements.headerNavFeaturesLinks.length;t<n;t++){let s=h.elements.headerNavFeaturesLinks[t];if(!a){let r=t===n-1;i=p(i,e,s,r);a=b(e,s,r)}if(a){s.classList.add(r);h.featuredNavOverflowMenu.push(s.menuItem)}else{s.classList.remove(r)}}O();L(t)}else{v();h.navOverflowMenu.length=0;let e=W(h.elements.headerNav,h.elements.headerNavEllipsis);for(let t=0,a=h.elements.headerNavLinks.length;t<a;t++){let n=h.elements.headerNavLinks[t];if(i<h.collapsibleNavLinkCount&&!n.classList.contains(r)){i=p(i,e,n,t===a-1)}}O()}}function x(e){if(!e){document.body.classList.add("no-header")}else{document.body.classList.remove("no-header")}}function U(t){if(h.hiddenHeader){return}let a=i.getElement("main-contents");if(!a||!h.elements.headerWrapper){if(document.readyState==="complete"){U=function(){}}return}let n=t+a.getBoundingClientRect().bottom-h.elements.headerWrapper.getBoundingClientRect().height;if(t>=n){if(!h.navScrollLimitEnabled){h.elements.headerWrapper.style.position="absolute";h.elements.headerWrapper.style.top=n+"px";h.elements.headerWrapper.style.transition="none";h.navScrollLimitEnabled=true}}else{if(h.navScrollLimitEnabled){e.disableNavScrollLimit()}}}function F(t,n){n=n||0;let s=i.getFullscreenMode();if(!s&&WH.WAS){s=WH.WAS.isFlexSkinned()}let r=s||(f.CLASSIC_TYPE?h.shrinkHeader&&t>n+15||!h.shrinkHeader&&t>=n+70:t>=n+70);let o=h.shrinkHeader!==r;if(!o){return}let l=Menu.getOpener();let c;if(l&&WH.closest(l,".header-wrapper")){c=l.getBoundingClientRect()}h.shrinkHeader=r;h.featuredNavCompact=r&&f.STANDARD_TYPE;document.body.dataset.shrinkHeader=s?"default":r?"scrolling":"false";document.body.dataset.navLayout=E();q();P();if(h.featuredNavCompact){requestAnimationFrame(P.bind(e,true))}if(c){let e=M.bind(this,l,c,r);if(f.CLASSIC_TYPE){requestAnimationFrame((function(){requestAnimationFrame(e)}))}else{e()}}a.checkAll();if(WH.Theme.isClassicType()){setTimeout(a.checkAll,150)}e.check(f.CLASSIC_TYPE);if(o&&h.resizeCallbacks.length){h.resizeCallbacks.forEach((e=>e()))}}function q(){if(!f.STANDARD_TYPE||h.mobileMode){return}let e=g();let t=h.elements.headerNavWrapper.getBoundingClientRect();let a=t.right-e.getBoundingClientRect().left+10;if(h.featuredNavCompact){a+=17;h.elements.headerNavWrapper.style.paddingRight=a+"px";h.elements.headerNav.style.paddingRight=""}else{h.elements.headerNav.style.paddingRight=a+"px";h.elements.headerNavWrapper.style.paddingRight=""}}};WH.Layout.User=new function(){const e=this;const t=WH.Url;const a={userMenu:undefined};this.createDebugQueueElement=function(){var e=WH.qs(".header-user");if(!e){WH.error("Cannot create debug queue element, .header-user not found.");return undefined}var t=i(e,"debug-messages","Debug Messages");WH.aef(e,t);return t};this.getLocaleMenu=function(){let e=location.pathname+location.search+location.hash;e=WH.Url.removePathPrefixes(e);let t=Locale.getId();let a=[Menu.createHeading({label:WH.TERMS.language})];let i=WH.getPageData("layout.user.preferredLanguageTips")||{};let n=function(e,a,n){if(!i.hasOwnProperty(e)){return}let s=Locale.getName(a);let r="";if(n){r=WH.TERMS[WH.getDataEnvTerm()]}else{r=WH.GlobalStrings["LFG_LIST_LANGUAGE_"+s.toUpperCase()]||Locale.getDescription(a)}let o=[WH.Strings.sprintf(i[e][t],r)];if(a!==t){o.push(WH.Strings.sprintf(i[e][a],n?i[WH.getDataEnvTerm()][a]:Locale.getDescription(a)))}return o.map(WH.Strings.escapeHtml).join("<br>")};let s=function(e){let t=e[Menu.ITEM_CRUMB];if(Locale.getPreferred()===t){return n("preferredLanguageRemove_format",t,false)}if(e[Menu.ITEM_URL]){return n("preferredLanguageUse_format",t,false)}return n("preferredLanguageSet_format",t,false)};let r=function(e){let t=e[Menu.ITEM_CRUMB];let a=Menu.getItemOptions(e).extraActions[0];a.fontIcon=Locale.getPreferred()===t?"star":"star-o"};$.each(Locale.getAllByName(),(function(i,o){let l=WH.Url.generate(e,{locale:o.id});if(l===location.href){l=undefined}let c=Menu.createItem({crumb:o.id,label:o.description,url:l,options:{checkedFunc:function(){return o.id===t},extraActions:[{fontIcon:"star-o","data-preferred-locale":o.id,callback:function(e){if(Locale.getPreferred()===o.id){Locale.setPreferred(null)}else{Locale.setPreferred(o.id);if(l&&o.id!==t){location.href=l}}WH.qsa(".menu-item [data-preferred-locale]").forEach((function(e){let t=parseInt(e.dataset.preferredLocale);let i=Menu.findItem(a,[t]);r(i);let n=Menu.getItemOptions(i).extraActions[0];e.classList.remove("fa-star","fa-star-o");e.classList.add("fa-"+n.fontIcon)}));let i=Menu.findItem(a,[o.id]);let n=s(i);if(n){WH.Tooltip.show(e.target,n,"q2")}}}],onBeforeShow:r}});let u=Menu.getItemOptions(c);u.extraActions[0].tooltipText=s.bind(null,c);if(!l&&t!==o.id){u.className="q10";let e=n("languageNotAvailable_format",o.id,true);if(e){u.attributes={"data-simple-tooltip":WH.ce("span",{className:"q10",innerHTML:e}).outerHTML}}}a.push(c)}));return a};this.getProfilerMenu=function(){if(!g_user.lists){return null}var e=[];var t=[["refresh",WH.TERMS.refreshcharacterlist,"/account=battlenet",null,{icon:WH.staticUrl+"/images/icons/battlenet.png"}]];var a=[],i=[],n=[],s=[];g_user.lists.sort((function(e,t){return WH.stringCompare(e.realm,t.realm)||WH.stringCompare(e.name,t.name)}));var r=false;$.each(g_user.lists,(function(e,t){if(t.mode==1){if(t.pinned>0){a.push(WH.Profiler.getMenuItem(t,true))}if(r&&r!=t.realm){if(i.length){i.unshift([undefined,r])}i.push([undefined,t.realm])}r=t.realm;i.push(WH.Profiler.getMenuItem(t))}else{s.push(WH.Profiler.getMenuItem(t))}}));var o=0,l,c,u;var d=function(e,t){var a=0+t;return function(t){if(t){return}for(var i=0;i<e.length;i++){if(e[i][0]==a){e.splice(i--,1)}}}};if(g_user.battlenetChars&&g_user.battlenetChars.length){g_user.battlenetChars.sort((function(e,t){return WH.stringCompare(e.region,t.region)||WH.stringCompare(e.realm,t.realm)||WH.stringCompare(e.name,t.name)}));r=false;for(var f=0;f<g_user.battlenetChars.length;f++){c=g_user.battlenetChars[f];if(c.level<10){continue}l=WH.Strings.slug(c.region+" "+c.realm+" "+c.name,true);u=false;for(var h=0;h<g_user.lists.length;h++){if(g_user.lists[h].url==l){u=true;break}}if(u){continue}if(r&&r!=c.realm){if(n.length){n.unshift([undefined,r])}n.push([undefined,c.realm])}r=c.realm;o--;n.push([o,c.name,"/list/"+l+"?private",null,{className:"listmanager-mode1"}]);WH.BlizzardApi.characterExists(c.region,c.realm,c.name,d(n,o))}}var p=0;if(i.length)p++;if(n.length)p++;if(s.length)p++;if(i.length+n.length+s.length<=12||p<=1){if(i.length){e.push([undefined,WH.TERMS.profiles]);e.push.apply(e,i)}if(n.length){e.push([undefined,WH.TERMS["import"]]);e.push.apply(e,t.concat(n))}if(s.length){e.push([undefined,WH.TERMS.customlists]);e.push.apply(e,s)}}else{if(a.length){Menu.sort(a);e.push([undefined,WH.TERMS.pinnedprofiles]);e.push.apply(e,a);e.push([undefined,WH.TERMS.other])}if(i.length){e.push([1,WH.TERMS.profiles,null,i])}if(n.length){e.push([1,WH.TERMS["import"],null,t.concat(n)])}if(s.length){e.push([1,WH.TERMS.customlists,null,s])}}return e};this.getUserMenu=function(){if(a.userMenu){return a.userMenu}let e=[];let t=WH.Url.generatePath("/user="+g_user.name);let i=["user-page",WH.TERMS.userpage,t,null,{checkedUrl:new RegExp(WH.Strings.escapeRegExp(t)+"$","i"),fontIcon:"user"}];e.push(i);let o=WH.Url.generatePath("/account");let l=["settings",WH.TERMS.settings,o,null,{fontIcon:"cog",checkedUrl:new RegExp(WH.Strings.escapeRegExp(o)+"(?!=premium|/guides)")}];e.push(l);if(WH.Notifications.browserSupportsNotifications()){let t=WH.Url.generatePath("/notifications/settings");e.push(["notifications",WH.TERMS.notificationSettings,t,null,{fontIcon:"bell",checkedUrl:new RegExp(WH.Strings.escapeRegExp(t))}])}if(WH.User.isPremium()){let t=WH.Url.generatePath("/account=premium");e.push(["premium",WH.TERMS.premiumsettings,t,null,{checkedUrl:new RegExp(WH.Strings.escapeRegExp(t)),fontIcon:"star"}])}else{let t=WH.Url.generatePath("/premium");e.push(["premium-upgrade",WH.TERMS.premiumsettings,t,null,{className:"premium-upgrade",checkedFunc:()=>location.pathname===t,fontIcon:"star"}])}let c=WH.TERMS.reputation;if(g_user.reputation){c=WH.Strings.sprintf(WH.TERMS.parens_format,WH.TERMS.reputation,WH.Strings.formatNumber(g_user.reputation))}let u=["reputation",c,WH.Url.generatePath("/reputation"),null,{fontIcon:"trophy"}];e.push(u);let d=s();if(d){e.push(d)}let f=n();if(f){e.push(f)}let h=r();if(h){e.push(h)}e.push(["sign-out",WH.TERMS.signout,WH.Url.generatePath("/account=signout")]);e.push(["sign-out-global",WH.TERMS.logOutEverywhere,WH.Url.generatePath("/account=signout?global")]);a.userMenu=e;return e};this.init=function(){var t=WH.qs(".header");if(!t){return}var a=WH.ce("div",{className:"header-user"});WH.ae(t,a);if(WH.User.isLoggedIn()){o(a)}else{l(a)}let n=i(a,"fullscreen",WH.Layout.getFullscreenMode()?WH.TERMS.exitFullscreen:WH.TERMS.fullscreen);WH.aE(n,"click",WH.Layout.toggleFullscreenMode);if(!WH.Theme.isClassicType()){WH.Tooltip.simpleNonTouch(n,(function(){let e=WH.Layout.getFullscreenMode()?WH.TERMS.exitFullscreenMode:WH.TERMS.enterFullscreenMode;return WH.ce("div",{className:"no-wrap"},WH.ct(e)).outerHTML}),"q2",{byCursor:true})}if((!WH.Theme.isClassicType()||!WH.User.isLoggedIn())&&WH.Notifications.browserSupportsNotifications()){let e=i(a,"notifications",WH.TERMS.notifications,WH.Url.generatePath("/notifications/settings"));let t=WH.qs("span",e);if(!t||window.getComputedStyle(t).display==="none"){WH.Tooltip.simpleNonTouch(e,WH.TERMS.notificationSettings,"q2",{byCursor:true})}}var s=i(a,"feedback",WH.TERMS.feedback);WH.aE(s,"click",ContactTool.show.bind(ContactTool,undefined));var r=WH.qs("span",s);if(!r||window.getComputedStyle(r).display==="none"){WH.Tooltip.simpleNonTouch(s,WH.TERMS.feedback,"q2",{byCursor:true})}var c=i(a,"lang",Locale.getDescription());Menu.add(c,e.getLocaleMenu(),{padded:true})};function i(e,t,a,i){var n=WH.ce("a",{className:"header-user-"+t});if(a){WH.ae(n,WH.ce("span",undefined,WH.ct(a)))}n.href=i||"javascript:";WH.ae(e,n);return n}function n(){let e=WH.getPageData("d4.build.myRecent");if(!e||!e.count){return}let t=[];e.list.forEach((e=>{t.push(Menu.createItem({crumb:e.id,label:e.name,url:WH.Entity.getUrl(WH.Types.D4_BUILD,e.id,e.name,undefined,WH.dataEnv.D4)}))}));let a=WH.Url.generatePath("/account/builds",WH.dataEnv.D4);return Menu.createItem({crumb:"builds",label:WH.TERMS.myBuilds,url:a,submenu:t,options:{fontIcon:"book",checkedUrl:new RegExp(a)}})}function s(){let e=WH.getPageData("guide.myRecent");if(!e||!e.count){return}let t=[];e.list.forEach((function(e){let a={extraActions:[{fontIcon:"pencil",url:WH.Url.generate("guide=edit&id="+e.id,{dataEnv:e.dataEnv}),tooltipText:WH.TERMS.edit}]};if(!e["public"]){a.rel="np"}if(e.classId){a.className="c"+e.classId;if(e.specId){a.tinyIcon=WH.Wow.PlayerClass.Specialization.getIconName(e.specId)}else{a.tinyIcon=WH.Wow.PlayerClass.getIconName(e.classId)}}t.push(Menu.createItem({crumb:e.id,label:e.name,url:e.url,options:a}))}));let a=WH.Url.generatePath("/account/guides");return Menu.createItem({crumb:"guides",label:WH.TERMS.myguides,url:a,submenu:t,options:{fontIcon:"book",checkedUrl:new RegExp(a)}})}function r(){if(!g_user.lists||!g_user.lists.length){return null}var t={onBeforeShow:function(t){Menu.setSubmenu(t,e.getProfilerMenu())},zulGetMobileMenu:function(){return Menu.prepareForZul(e.getProfilerMenu())},zulHref:function(e,t,a,i){return a?false:"/user="+g_user.name},fontIcon:"users"};for(var a=0;a<g_user.lists.length;a++){if(g_user.lists[a].thumbnail){delete t.icon;t.armory=WH.BlizzardApi.getCharacterThumbnailUrl(g_user.lists[a].region,g_user.lists[a].thumbnail)}}return["lists",WH.TERMS.myprofiles,"/user="+g_user.name+"#lists",null,t]}function o(t){if(WH.User.hasRole(U_GROUP_STAFF)){i(t,"staff",WH.TERMS.staffemployees)}i(t,"favorites",WH.TERMS.favorites);WH.Favorites.refreshMenu();var a=WH.Profiler.getFavorite();if(a){var n=WH.Profiler.getAvatarUrl(a);if(n){var s=i(t,"profile",undefined,WH.Profiler.getPath(a));s.style.background="url("+n+")";var r=e.getProfilerMenu();if(r&&r.length){Menu.add(s,r,{padded:true})}}}let o=WH.User.getUsername();let l=WH.User.getReputation();let c=i(t,"user",o,WH.User.getPath());if(l){WH.ae(c,WH.ce("span",{classList:"header-user-user-reputation"},WH.ct(WH.term("parens_format","",WH.Strings.formatNumber(l)))))}Menu.add(c,e.getUserMenu(),{padded:true})}function l(e){let a=WH.Url.getLoginPath();var n=WH.ce("a",{className:"header-user-text",href:a},WH.ce("span",undefined,WH.ct(WH.TERMS.loginwith_colon)));WH.ae(e,n);var s=WH.Url.generatePath("/account=battlenet?r=1");var r=i(e,"bnet btn btn-blizzard",WH.TERMS.battlenet,s);WH.aE(r,"click",(function(){WH.visitUrlWithPostData(WH.Url.generatePath("/account=battlenet"),{r:1});return false}));i(e,"email btn btn-site fa fa-envelope",WH.TERMS.email,a);var o="btn btn-site fa fa-user-plus fa-fw";i(e,"register "+o,WH.TERMS.register,t.getRegistrationPath())}};Listview.Filters=function(e){const t=this;const a=WH.Device;const i=WH.DOM;const n="all";const s="any";const r=n;const o=[n,s];const l=1;const c=2;const u=3;const d=4;const f=5;const h=6;const p=7;const m={">":l,"=":c,"<":u,">=":d,"<=":f};const H={};H[l]=">";H[c]="=";H[u]="<";H[d]=">=";H[f]="<=";H[h]=WH.TERMS.min+"-"+WH.TERMS.max;H[p]=WH.TERMS.text;const g={};g["default"]=[{type:l,text:H[l]},{type:d,text:H[d]},{type:c,text:H[c]},{type:f,text:H[f]},{type:u,text:H[u]},{type:h,text:H[h]}];g[Listview.COLUMN_TYPE_TEXT]=[{type:p,text:H[p]},{type:l,text:H[l]},{type:d,text:H[d]},{type:c,text:H[c]},{type:f,text:H[f]},{type:u,text:H[u]},{type:h,text:H[h]}];const W={NUMBER:/(>|=|<|>=|<=)\s*(-?[0-9.]+)/,RANGE:/(-?[0-9.]+)\s*-\s*(-?[0-9.]+)/};const E=[Listview.COLUMN_ID_COMPLETION,Listview.COLUMN_ID_DEBUG_ID,Listview.COLUMN_ID_POPULARITY];const _={};_[l]=function(e,t){return t>e};_[c]=function(e,t){return t==e};_[u]=function(e,t){return t<e};_[d]=function(e,t){return t>=e};_[f]=function(e,t){return t<=e};_[h]=function(e,t){return e.min<=t&&t<=e.max};const v={};v[l]=function(e,t){return t.max>e};v[c]=function(e,t){return t.min<=e&&e<=t.max};v[u]=function(e,t){return t.min<e};v[d]=function(e,t){return t.max>=e};v[f]=function(e,t){return t.min<=e};v[h]=function(e,t){return e.min<=t.max&&t.min<=e.max};const T={elements:{columnFilters:undefined,container:undefined,match:{all:undefined,any:undefined,container:undefined},reset:undefined,tableFilter:undefined,tableFilterIcon:undefined,tableFilterClear:undefined},filters:[],hasFilterableColumns:false,listview:undefined,matchType:r};this.apply=function(){WH.Tooltip.hide();pe();t.applyDataOnly();he();T.listview.validatePage();T.listview.updateNav();T.listview.refreshRows();T.listview.updateBrowseSession();T.listview.writeHash()};this.focus=function(){re();if(T.listview.searchable&&T.elements.tableFilter){WH.safeFocus(T.elements.tableFilter)}};this.reset=function(){while(T.filters.length){let e=T.filters.pop();if(e.column){I(e.column)}}if(T.elements.columnFilters){WH.ee(T.elements.columnFilters)}if(T.elements.tableFilter){T.elements.tableFilter.value=""}T.matchType=r;if(T.elements.match[r]){T.elements.match[r].checked=true}T.listview.resetRowVisibility();t.apply()};this.resetAndFocus=function(){requestAnimationFrame(J)};this.applyDataOnly=function(){T.listview.resetRowVisibility(true);if(!T.filters.length&&!T.listview.customFilter&&!T.listview.classFilter){return}let e=[];let t=L();for(let a=0,i;i=t[T.listview.visibility[a]];a++){if(!E.includes(i.id)&&q(i)){e.push(i)}}let a=0;let i=T.matchType===s?ue:ce;for(let t=0,n=T.listview.data.length;t<n;t++){let n=T.listview.data[t];n.__hidden=true;if(T.listview.customFilter&&!T.listview.customFilter(n,t)){continue}if(T.listview.customFilter2&&!T.listview.customFilter2(n,t)){continue}if(T.listview.classFilter&&!T.listview.classFilter(n,t)){continue}if(n.__alwaysvisible||!T.filters.length||i(n,e)){n.__hidden=false;a++}}T.listview.filtered=a<T.listview.data.length;T.listview.nRowsVisible=a};this.getColumnTooltipAdditions=function(e){let t=T.filters.filter((function(t){return(t.column||{}).id===e.id}));if(!t.length){return null}t.sort((function(e,t){WH.stringCompare(e.invert,t.invert)}));let a=WH.ce("div","no-wrap");for(let e=0,i;i=t[e];e++){WH.ae(a,WH.ce("div",undefined,WH.ct((i.invert?WH.TERMS.invertedFilter_stc:WH.TERMS.filter)+WH.TERMS.colon_punct+U(i,true))))}return a};this.getHashParts=function(){let e=[];let t=[];let a=[];for(let e=0,i;i=T.filters[e];e++){if(!i.enabled){continue}let e=encodeURIComponent(U(i));if(i.column){a.push(i.column.id+"="+e)}else{t.push("q="+e)}}let i=t.length+a.length>1;if(t=t.join(Listview.HASH_DELIMITER)){e.push(t)}if(a=a.join(Listview.HASH_DELIMITER)){e.push(a)}if(i&&T.matchType!==r){e.push("match"+WH.ucfirst(T.matchType))}return e};this.getOptionsToggle=function(){if(T.listview.searchable||T.hasFilterableColumns){let e=WH.ce("a",{className:"listview-option-button listview-option-button-filters fa fa-filter",href:"javascript:"});WH.aE(e,"click",V);WH.Tooltip.simpleNonTouch(e,x,"q2");return e}else{return null}};this.isColumnFiltered=function(e){for(let t=0,a;a=T.filters[t];t++){if(a.column.id===e.id&&a.enabled){return true}}return false};this.readHashPart=function(e){let t=e.match(/^q=(.*)$/);if(t){if(T.listview.searchable){ae(decodeURIComponent(t[1]),{skipApply:true})}return}e.split(",").forEach((function(e){let t=e.match(/^([A-Za-z0-9_]+)=(.+)$/);if(t){let e=decodeURIComponent(t[1]);let a=decodeURIComponent(t[2]);let i=L();for(let t=0,n;n=i[t];t++){if(n.id===e&&T.listview.isColumnVisible(n)&&q(n)){ae(a,{column:n,skipApply:true,allowDuplicateColumns:true});break}}return}let a=e.match(/^match([A-Za-z]+)$/);if(a){ne(a[1].toLowerCase(),true)}}))};function b(){return!!T.listview.container.dataset.filters}function S(){let e=WH.ce("div",{className:"listview-filters"});if(T.listview.searchable){let t=T.listview._truncated?WH.TERMS.searchwithindisplayedresults_ellipsis:WH.TERMS.searchAllColumns_ellipsis;let a=WH.ce("div",{className:"listview-filters-table"});if(T.listview.tabClick){WH.aE(a,"click",T.listview.tabClick)}T.elements.tableFilterIcon=WH.ce("span",{className:a.className+"-search-icon fa fa-search"});WH.ae(a,T.elements.tableFilterIcon);let i=WH.ce("input",{placeholder:t,style:{width:T.listview._truncated?"20em":"16em"},type:"text"});T.elements.tableFilter=i;for(let e=0,t;t=T.filters[e];e++){if(!t.column){i.value=t.invert+U(t);break}}WH.aE(i,"keyup",pe);WH.onAfterTyping(i,Z.bind(i),T.listview.searchDelay);WH.aE(i,"blur",(function(){if(this.value&&this.value.trim()===""){this.value=""}}));WH.aE(i,"keypress",T.listview.submitSearch.bind(this));WH.ae(a,i);T.elements.tableFilterClear=WH.ce("a",{className:a.className+"-clear fa fa-times-circle",href:"javascript:",style:{display:"none"}});WH.aE(T.elements.tableFilterClear,"click",(function(){i.value="";i.placeholder=t;Z.call(i)}));WH.ae(a,T.elements.tableFilterClear);WH.ae(e,a)}T.elements.columnFilters=WH.ce("div",{className:"listview-filters-columns"});WH.ae(e,T.elements.columnFilters);let t=WH.ce("div",{className:"listview-filters-actions"});WH.ae(e,t);let a=WH.ce("a",{className:"fa fa-plus",href:"javascript:"},WH.ct(WH.TERMS.addColumnFilter_ellipsis));Menu.add(a,A,{showAtElement:true});WH.ae(t,a);T.elements.match.container=WH.ce("div",undefined,WH.ct(WH.TERMS.match+WH.TERMS.colon_punct));WH.ae(t,T.elements.match.container);let i="listview-match-"+WH.Strings.guid();let r=WH.ce("label",undefined,WH.ct(WH.TERMS.all));T.elements.match.all=WH.ce("input",{name:i,type:"radio"});WH.aef(r,T.elements.match.all);WH.ae(T.elements.match.container,r);let o=WH.ce("label",undefined,WH.ct(WH.TERMS.any));T.elements.match.any=WH.ce("input",{name:i,type:"radio"});WH.aef(o,T.elements.match.any);WH.ae(T.elements.match.container,o);T.elements.match[T.matchType].checked=true;WH.aE(T.elements.match.all,"change",(function(){ne(n)}));WH.aE(T.elements.match.any,"change",(function(){ne(s)}));T.elements.reset=WH.ce("a",{className:"fa fa-times",href:"javascript:"},WH.ct(WH.TERMS.reset));WH.aE(T.elements.reset,"click",J);WH.ae(t,T.elements.reset);return e}function y(e,a){e.enabled=false;if(!t.isColumnFiltered(e.column)){I(e.column)}if(a){e.elements.wrapper.dataset.showError="true";WH.st(e.elements.error,a)}else{delete e.elements.wrapper.dataset.showError}t.apply()}function I(e){if(e.__th){e.__th.firstChild.firstChild.classList.remove("q5")}}function R(e){if(e.__th){e.__th.firstChild.firstChild.classList.add("q5")}}function N(e){re();e.elements.text.focus()}function w(e,a){const n="listview-filters-columns-filter";let s=WH.ce("div",{className:n});let r=WH.ce("a",{className:n+"-remove",href:"javascript:"});WH.aE(r,"click",K.bind(r,s));WH.Tooltip.simpleNonTouch(r,WH.TERMS.removefilter_stc,"q10");WH.ae(s,r);let o=i.createImitationSelect({text:M(e)});o.classList.add(n+"-name");Menu.add(o,A.bind(undefined,s,o),{showAtElement:true});WH.ae(s,o);let l=i.createImitationSelect({text:WH.TERMS.error});l.classList.add(n+"-operator");Menu.add(l,C.bind(undefined,s,l),{showAtElement:true});WH.ae(s,l);let c=WH.ce("div",{className:n+"-text-wrapper"});WH.ae(s,c);let u=WH.ce("input",{className:n+"-text",type:"text"});WH.onAfterTyping(u,B.bind(u,s,u),T.listview.searchDelay);WH.ae(c,u);let d=WH.ce("div",{className:n+"-range"},WH.ct("-"));WH.ae(c,d);let f=WH.ce("input",{className:n+"-text2",type:"text"});WH.onAfterTyping(f,B.bind(f,s,f),T.listview.searchDelay);WH.ae(c,f);let h=WH.ce("input",{className:n+"-invert",type:"checkbox"});let m=WH.ce("label",{className:n+"-invert-label",href:"javascript:"},h);WH.ae(m,WH.ct(WH.TERMS.invert));WH.aE(h,"change",Y.bind(h,s,h));WH.ae(s,m);let H=WH.ce("span",{className:n+"-error"});WH.ae(s,H);if(a){WH.st(o,M(a.column));se(l,s,a.operator);u.value=a.text;f.value=a.text2;h.checked=!!a.invert}else{if(e.type===Listview.COLUMN_TYPE_TEXT){a={column:e,elements:undefined,enabled:false,invert:"",operator:p,test:undefined,text:"",text2:""};se(l,s,a.operator);T.filters.push(a);he()}else{let i=false;try{a=P(">0",e)}catch(e){WH.error(e.message||e);i=true}if(!a||i){let t="Could not create empty numeric filter.";WH.error(t,e.id,e);alert(t);throw new Error(t)}T.filters.push(a);R(a.column);se(l,s,a.operator);u.value=a.text;f.value=a.text2;t.apply()}}s.__listviewFilter=a;a.elements={error:H,operator:l,text:u,text2:f,wrapper:s};return s}function A(e,t){let a=[];let i;let n;if(e){a.push(Menu.createHeading({label:WH.TERMS.changeColumn_ellipsis}));let s=O(e);i=G.bind(undefined,s,t);n=s.column.id}else{i=$.bind(undefined)}let s=L();for(let e=0,t;t=s[T.listview.visibility[e]];e++){if(!q(t)){continue}if(t.id===Listview.COLUMN_ID_DEBUG_ID){let e=Menu.createItem({label:WH.Strings.sprintf(WH.TERMS.parens_format,M(t),WH.TERMS.staffonly_stc),url:i.bind(undefined,t)});e.checked=t.id===n;a.push(e);continue}let e=Menu.createItem({label:M(t),url:i.bind(undefined,t)});e.checked=t.id===n;a.push(e)}return a}function M(e){return e.tooltip||e.name||e.id}function C(e,t){let a=[];let i=O(e);let n=g[i.column.type]||g["default"];for(let e=0,s;s=n[e];e++){let e=Menu.createItem({label:s.text,url:z.bind(undefined,i,t,s)});e.checked=s.type===i.operator;a.push(e)}return a}function O(e){return e.__listviewFilter}function L(){return T.listview.sortOptions||T.listview.columns||[]}function k(e,t){let a=T.listview.template.getVisibleText?(""+T.listview.template.getVisibleText(e)).trim():"";if(t.getVisibleText){return a+t.getVisibleText(e)}if(t.getValue){return a+t.getValue.call(T.listview,e)}if(t.value){return a+e[t.value]}if(t.compute){return a+t.compute.call(T.listview,e,WH.ce("td"),WH.ce("tr"),t.__index)}return""}function D(e){return e?e.type||Listview.COLUMN_TYPE_NUMBER:Listview.COLUMN_TYPE_TEXT}function P(e,t){e=e.replace(/\s+/g," ").trim();let a={elements:undefined,enabled:true,invert:"",test:undefined,text:"",text2:""};if(t){a.column=t}let i=D(t);if(e){if(e.charAt(0)==="!"||i===Listview.COLUMN_TYPE_TEXT&&e.charAt(0)==="-"){a.invert="!";e=e.substr(1)}let t;if(e.match(W.NUMBER)){t=te(RegExp.$2);if(!ee(t)){a.operator=m[RegExp.$1];a.value=t;a.text=""+t}}else if(e.match(W.RANGE)){t={min:te(RegExp.$1),max:te(RegExp.$2)};if(!ee(t.min)&&!ee(t.max)){if(t.min===t.max){a.operator=c;a.value=t.min;a.text=""+t.min}else{if(t.min>t.max){let e=t.min;t.min=t.max;t.max=e}a.operator=h;a.value=t;a.text=""+t.min;a.text2=""+t.max}}}else{let n=e.toLowerCase().split(" ");if(i===Listview.COLUMN_TYPE_TEXT){a.operator=p;a.text=e;if(a.invert){a.regExp=WH.createOrRegex(e)}else{a.words=n}}else if(n.length===1&&!ee(t=te(n[0]))&&""+t===n[0]){a.operator=c;a.value=t;a.text=""+t}}}if(e&&!a.operator){throw new Error(WH.TERMS.invalidfilter_stc)}if(!a.text){return null}ie(a);return a}function x(){return WH.ce("div",{className:"no-wrap"},WH.ct(b()?WH.TERMS.hidefilteroptions_stc:WH.TERMS.filterTheseResults_stc)).outerHTML}function U(e,t){let a=t?"":e.invert;switch(e.operator){case h:return a+e.text+"-"+e.text2;case p:return a+e.text;default:if(!H[e.operator]){let t="Could not generate simple filter text for unsupported filter operator.";WH.error(t,e.operator);alert(t);throw new Error(t)}return a+H[e.operator]+e.text}}function F(e){T.listview=e;if(T.listview.filtrable){let e=L();for(let t=0,a;a=e[t];++t){if(!q(a)){continue}if(!T.hasFilterableColumns&&T.listview.isColumnVisible(a)){T.hasFilterableColumns=true}if(a.actions){a.actions.unshift({action:j.bind(undefined,a),name:WH.TERMS.filter,tooltipText:WH.TERMS.rightClickToFilter_stc})}}}}function q(e){return e.id&&(e.filtrable==null||e.filtrable)}function Y(e,t){let a=O(e);a.invert=this.checked?"!":"";let i=X(a);if(!i.success){y(a,i.error)}}function B(e,t){let a=O(e);let i=t.value.trim();let n=t.className.indexOf("text2")===-1?"text":"text2";if(a[n]===i){return}if(a.enabled){if(i){if(a[n]!==i){a[n]=i;let e=X(a);if(!e.success){y(a,e.error)}}}else{a[n]=i;y(a)}}else{if(i){a[n]=i;let e=X(a);if(!e.success){y(a,e.error)}}else{delete a.elements.wrapper.dataset.showError}}}function G(e,a,i){if(e.column.id===i.id){t.apply();return}let n=e.column;e.column=i;WH.st(a,M(i));let s=X(e);if(!s.success){y(e,s.error)}if(!t.isColumnFiltered(n)){I(n)}N(e)}function $(e){let t=w(e);WH.ae(T.elements.columnFilters,t);N(O(t))}function z(e,a,i){if(e.operator===i.type){t.apply();return}let n=e.operator;e.operator=i.type;se(a,e.elements.wrapper,e.operator);if(i.type===h){if(n===p){let t=te(e.text);if(!ee(t)){e.text=""+t;e.value=t;e.elements.text.value=e.text}else{e.text="0";e.value=0;e.elements.text.value=e.text}}if(!e.text2||e.text2===e.text){e.text2=(e.value||0)+1;e.elements.text2.value=e.text2}}let s=X(e);if(!s.success){y(e,s.error)}N(e)}function V(e){if(!T.listview.container.dataset.filters){re();if(T.listview.searchable&&T.elements.tableFilter){T.elements.tableFilter.focus()}}else{delete T.listview.container.dataset.filters}if(!a.isTouch()){WH.Tooltip.showAtCursor(e,x(),"q2")}}function K(e){let a=O(e);WH.de(e);let i=T.filters.indexOf(a);if(i!==-1){T.filters.splice(i,1);if(!t.isColumnFiltered(a.column)){I(a.column)}t.apply()}Menu.hide(true);WH.Tooltip.hide()}function j(e){for(let t=0,a;a=T.filters[t];t++){if(a.column&&a.column.id===e.id){N(a);return}}let t=e.type===Listview.COLUMN_TYPE_TEXT?WH.TERMS.examplefilter_tip:WH.TERMS.examplefilter2_tip;let a=prompt(WH.sprintf(WH.TERMS.columnfilter_format+"\n\n"+t,M(e)));if(a!==null){let t=ae(a,{column:e});if(t){N(t)}}}function Z(){ae(this.value)}function X(e){let t={success:false};try{let a=P(U(e),e.column);if(a){Q(e,a);se(a.elements.operator,a.elements.wrapper,a.operator);let i=a.elements.text;let n=a.elements.text2;if(a.operator===h){if(a.text===e.text2||a.text2===e.text){i.value=a.text;n.value=a.text2;if(document.activeElement===i){n.focus()}else if(document.activeElement===n){i.focus()}}if(document.activeElement!==i&&document.activeElement!==n){i.focus()}}else{i.focus()}delete a.elements.wrapper.dataset.showError;t.success=true}}catch(e){t.error=e.message||e}return t}function Q(e,a){let i=T.filters.indexOf(e);if(i!==-1){T.filters.splice(i,1,a)}else{T.filters.push(a)}a.elements=e.elements;a.elements.wrapper.__listviewFilter=a;R(a.column);t.apply()}function J(){t.reset();t.focus()}function ee(e){return typeof e==="number"&&isNaN(e)}function te(e){let t=parseFloat(e);if(Number.isInteger(t)&&!Number.isSafeInteger(t)){t=BigInt(e)}return t}function ae(e,a){a=a||{};let i;try{i=P(e,a.column)}catch(e){alert(e.message||e);return null}let n=false;let s=false;if(!a.allowDuplicateColumns){for(let e=T.filters.length-1;e>=0;e--){if(a.column&&T.filters[e].column&&T.filters[e].column.id===a.column.id||!a.column&&!T.filters[e].column){if(T.filters[e].elements){WH.de(T.filters[e].elements.wrapper)}if(i){T.filters.splice(e,1,i);n=true}else{T.filters.splice(e,1)}s=true}}}if(i){if(!n){T.filters.push(i);n=true}re();if(a.column){WH.ae(T.elements.columnFilters,w(a.column,i))}else if(T.listview.searchable&&T.elements.tableFilter){let e=U(i);if(e!==T.elements.tableFilter.value.trim()){T.elements.tableFilter.value=e}}}if(a.column){if(n&&!s){R(a.column)}else if(s&&!n&&!t.isColumnFiltered(a.column)){I(a.column)}}if((n||s)&&!a.skipApply){t.apply()}return i}function ie(e){if(!e.enabled){delete e.test;return}let t=D(e.column);if(t===Listview.COLUMN_TYPE_TEXT&&e.operator!==p){t=Listview.COLUMN_TYPE_NUMBER}switch(t){case Listview.COLUMN_TYPE_TEXT:e.test=e.invert?fe.bind(null,e):de.bind(null,e);break;case Listview.COLUMN_TYPE_RANGE:let a=v[e.operator].bind(null,e.value);e.test=le.bind(null,e,a);break;case Listview.COLUMN_TYPE_NUMBER:let i=_[e.operator].bind(null,e.value);e.test=oe.bind(null,e,i);break;default:let n="Unknown column type cannot be filtered.";WH.error(n,t,e.column.id);throw new Error(n)}}function ne(e,a){if(!o.includes(e)){return}T.matchType=e;re();T.elements.match[e].checked=true;if(!a){t.apply()}}function se(e,t,a){WH.st(e,H[a]);t.dataset.type=a===p?"string":"number";if(a===h){t.dataset.useRange="true"}else{delete t.dataset.useRange}}function re(){if(!T.listview.searchable&&!T.hasFilterableColumns){return}if(!T.elements.container){T.elements.container=S();let e=T.listview.noteTop||T.listview.noteIndicators||T.listview.navTop;T.listview.bandTop.insertBefore(T.elements.container,e.nextSibling)}T.listview.container.dataset.filters="visible"}function oe(e,t,a,i){let n=te(a.getValue?a.getValue(i):i[a.value]);if(ee(n)){return false}return e.invert?!t(n):t(n)}function le(e,t,a,i){return e.invert?!t({min:a.getMinValue(i),max:a.getMaxValue(i)},e.value):t({min:a.getMinValue(i),max:a.getMaxValue(i)},e.value)}function ce(e,t){let a=0;for(let i=0,n;n=T.filters[i];i++){if(!n.enabled){a++;continue}if(n.column){if(n.test(n.column,e)){a++}else{break}}else{let i=false;for(let a=0,s;s=t[a];a++){if(n.test(s,e)){i=true;break}}if(i){a++}else{break}}}return a===T.filters.length}function ue(e,t){for(let a=0,i;i=T.filters[a];a++){if(!i.enabled){continue}if(i.column){if(i.test(i.column,e)){return true}}else{for(let a=0,n;n=t[a];a++){if(i.test(n,e)){return true}}}}return false}function de(e,t,a,i){let n=false;let s=k(a,t);if(s){s=s.toString().toLowerCase();n=true;for(let t=0,a=e.words.length;t<a;t++){if(s.indexOf(e.words[t])===-1){n=false;break}}}return n}function fe(e,t,a,i){let n=false;let s=k(a,t);if(s){s=s.toString().toLowerCase();n=s.match(e.regExp)!=null}return!n}function he(){if(!T.elements.reset){return}let e=0;for(let t=0,a;a=T.filters[t];t++){if(a.enabled||a.column){e++}}switch(e){case 0:WH.displayNone(T.elements.match.container);WH.displayNone(T.elements.reset);break;case 1:WH.displayNone(T.elements.match.container);WH.displayBlock(T.elements.reset);break;default:WH.displayBlock(T.elements.match.container);WH.displayBlock(T.elements.reset)}}function pe(){if(T.listview.searchable&&T.elements.tableFilter){if(T.elements.tableFilter.value.trim()){T.elements.tableFilterIcon.style.display="none";T.elements.tableFilterClear.style.display=""}else{T.elements.tableFilterIcon.style.display="";T.elements.tableFilterClear.style.display="none"}}}F(e)};Listview.Filters.resetAndFocus=function(){this.Filters.resetAndFocus()};WH.markup.Tags=new function(){this.getByEntityType=e=>{if(!e){return undefined}let t;Object.entries(WH.markup.tags).some((([a,i])=>{if(i.entityType===e){t=a;return true}}));return t};this.getWhml=(e,t,a={})=>`[${e}=${t}`+(a.bonuses&&a.bonuses.length?` bonus=${a.bonuses.join(":")}`:"")+(a.spec?` spec=${a.spec}`:"")+"]"};WH.markup.tags.build=function(){return{empty:false,allowedChildren:{url:1},allowedParents:{builds:1},attr:{class:{req:false,valid:/^.+$/},consumables:{req:false,valid:WH.markup.regex.isItemList},set:{req:false,valid:WH.markup.regex.intCsv},"set-items":{req:false,valid:WH.markup.regex.isItemList},site:{req:false,valid:WH.markup.regex.domain},spec:{req:false,valid:/^.+$/},stats:{req:false,valid:/^([a-zA-Z]+(>+|=)?)+$/},tab:{req:false,valid:/^.+$/},talents:{req:false,valid:/^[\/a-zA-Z0-9_-]+$/},title:{req:false,valid:/^.+$/},trinkets:{req:false,valid:WH.markup.regex.isItemList},"trinkets-alt":{req:false,valid:WH.markup.regex.isItemList},weapons:{req:false,valid:WH.markup.regex.isItemList},"weapons-alt":{req:false,valid:WH.markup.regex.isItemList}},toNode:function(e){let t="build-summary";let a=WH.ce("section",{className:t});a.whMarkupInfo={type:"wow-build"};Object.entries(e).forEach((([e,t])=>{if(t===""){return}let i=e==="set-items"?"tier":e.replace("-alt","").replace("-items","");if(!a.whMarkupInfo[i]){a.whMarkupInfo[i]={}}let n=a.whMarkupInfo[i];if(!e.includes("-alt")){n.content=t}else{n.alternatives=t}}));return a}}}();WH.markup.tags.builds=function(){let e=[];return{empty:false,allowedChildren:{build:1,"d4-build":1,"d4-paragon-calc":1,"d4-skill-tree":1},attr:{domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);let i=WH.ce("section",{className:"build-summary-container"});let n=[];let s=[];let r=[];let o=[];let l;while(t._contents.hasChildNodes()){l=t._contents.removeChild(t._contents.firstChild);if(l.whMarkupInfo.type==="d4-skill-tree"){o.push(l.whMarkupInfo)}else if(l.whMarkupInfo.type==="d4-build"){s.push(l.whMarkupInfo)}else if(l.whMarkupInfo.type==="d4-paragon-calc"){r.push(l.whMarkupInfo)}else{n.push(l.whMarkupInfo)}}if(s.length>0){let t=()=>{try{WH.DOM.setData(i,"buildPlanner",new WH.D4.BuildPlanner(i,{editable:false,embedded:true,planners:s}))}catch(e){WH.error("Unable to create Build Planner",{calcs:s,error:e})}};if(!WH.D4.BuildPlanner?.isReady()){let a="d4-build";e[a]=e[a]||[];e[a].push(t);if(e[a].length===1){WH.loadAssets("d4-build",(()=>{let t;while(t=e[a].shift()){t()}}))}}else{t()}}if(r.length>0){let t=()=>{try{WH.DOM.setData(i,"paragonCalc",new WH.D4.ParagonCalc(i,{dataEnv:a.dataEnv,editable:false,markup:true,calcs:r}))}catch(e){WH.error("Unable to create Paragon Calc",{calcs:r,error:e})}};if(!WH.D4.ParagonCalc?.isReady()){let a="d4-paragon-calc";e[a]=e[a]||[];e[a].push(t);if(e[a].length===1){WH.loadAssets("d4-paragon-calc",(()=>{let t;while(t=e[a].shift()){t()}}))}}else{t()}}if(o.length>0){let t=function(){try{WH.DOM.setData(i,"skillTree",new WH.D4.SkillPlanner(i,{dataEnv:a.dataEnv,editable:false,embedded:true,markup:true,trees:o}))}catch(e){WH.error("Unable to create skill tree",{trees:o,error:e})}};if(!WH.D4.SkillPlanner?.isReady()){let a="d4-skill-tree";e[a]=e[a]||[];e[a].push(t);if(e[a].length===1){WH.loadAssets("d4-skill-tree",(()=>{let t;while(t=e[a].shift()){t()}}))}}else{t()}}if(n.length>0){let t=function(){new WH.Wow.BuildSummary(i,n,a.dataEnv)};if(!WH.Wow.BuildSummary){e.push(t);if(e.length===1){WH.loadAssets("build-summary",(()=>{let t;while(t=e.shift()){t()}}))}}else{t()}}return i}}}();WH.markup.tags.copy={empty:false,allowedClass:WH.markup.CLASS.STAFF,attr:{unnamed:{req:false},button:{req:false,valid:/^false$/},size:{req:false,valid:/^large$/}},allowedChildren:{"<text>":1},invisibleContent:true,rawText:true,toNode:function(e){let t=e.unnamed?WH.term("copy_format",e.unnamed):WH.TERMS.copy_clipboard;let a=e._contents.textContent;while(e._contents.hasChildNodes()){e._contents.removeChild(e._contents.firstChild)}if(e.button==="false"){let e=WH.ce("span",{className:"tip"},WH.ct(a));WH.clickToCopy(e,a);return e}let i=WH.ce("button",{className:"btn btn-site fa fa-clipboard",type:"button"},WH.ct(t));if(e.size!=="large"){i.classList.add("btn-small")}WH.aE(i,"click",(()=>{WH.copyToClipboard(a);i.classList.remove("fa-clipboard");i.classList.add("fa-check");setTimeout((()=>{i.classList.remove("fa-check");i.classList.add("fa-clipboard")}),3*WH.Time.MS_SEC)}));return i}};{let e=WH.markup.entityTag(WH.Types.D4_AFFIX,{icons:true});let t=e.toNode;let a=e.toText;e.attr.description={req:false,empty:true};e.toNode=(e,a,i)=>{if(e.description==null){return t(e,a,i)}let n=parseInt(e.unnamed);let s=WH.markup.getDatabaseDomainInfo(e);let r=WH.Gatherer.get(WH.Types.D4_AFFIX,n,s.dataEnv);let o=WH.ce("span");if(r){let e=(r.tooltipLines||[]).join(WH.TERMS.wordspace_punct);if(e){o.innerHTML=e}else{WH.st(o,r.displayName||r[s.nameKey]||r.name)}}else{WH.st(o,WH.Entity.getUnknownName(WH.Types.D4_AFFIX,n))}return o};e.toText=e=>{if(e.description==null){return a(e)}let t=parseInt(e.unnamed);let i=WH.markup.getDatabaseDomainInfo(e);let n=WH.Gatherer.get(WH.Types.D4_AFFIX,t,i.dataEnv);if(n){let e=(n.tooltipLines||[]).join(WH.TERMS.wordspace_punct);if(e){return WH.ce("div",{innerHTML:e}).textContent}else{return n.displayName||n[i.nameKey]||n.name}}else{return WH.Entity.getUnknownName(WH.Types.D4_AFFIX,t)}}}WH.markup.entityTag(WH.Types.D4_ASPECT,{icons:true});WH.markup.tags["d4-build"]=(()=>{const e=WH.Gatherer;const t=WH.Types;return{empty:true,allowedParents:{builds:1},attr:{header:{req:false,valid:/^(true|false)$/},tab:{req:false,valid:/^.+$/},unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/},sections:{req:false,valid:WH.markup.regex.anyChars}},toNode:a=>{let i={buildId:a.unnamed,tab:a.tab,type:"d4-build"};if(a.header){i.header=a.header!=="false"}if(a.sections){i.sections=a.sections}const n=e.get(t.D4_BUILD,a.unnamed);i.hash=n.hash;i.name=n[`name_${Locale.getName()}`];const s=WH.ce("section");s.whMarkupInfo=i;return s}}})();WH.markup.tags["d4-item"]={entityType:WH.Types.D4_ITEM,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},affixes:{req:false,valid:/^\d+(:\d+)*$/},"item-power":{req:false,valid:/^\d+$/},upgrades:{req:false,valid:/^\d+$/},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},tooltip:{req:false,empty:true}},validate:e=>!((e.domain||e.site)&&WH.markup.dbPage),toNode:(e,t)=>{const a=WH.Gatherer;const i=WH.Types;let n=[];if(e.affixes!=null){n.push(`affixes=${e.affixes}`)}if(e["item-power"]!=null){n.push(`itemPower=${e["item-power"]}`)}if(e.upgrades!=null){n.push(`upgrades=${e.upgrades}`)}let s=WH.markup.entityTagToNode(i.D4_ITEM,e,t,n);if(e.affixes!=null&&(e.icon??"false")==="false"){let t=a.get(i.D4_ITEM,e.unnamed);let n=e.affixes.split(":").map((e=>a.get(i.D4_AFFIX,parseInt(e)))).filter(Boolean);let r=t&&WH.D4.Item.getModifiedName(t,n);if(r){(WH.qs("span",s)||s).innerHTML=r}}if(s.dataset.markupTooltipContainer){return s}return s},toText:e=>WH.markup.entityTagToText(WH.Types.D4_ITEM,e)};WH.markup.tags["d4-paragon-calc"]=function(){return{empty:true,allowedParents:{builds:1},attr:{tab:{req:false,valid:/^.+$/},unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/},board:{req:false,valid:WH.markup.regex.isInt}},toNode:e=>{let t={hash:e.unnamed,tab:e.tab,type:"d4-paragon-calc"};if(e.board){t.board=e.board}const a=WH.ce("section");a.whMarkupInfo=t;return a}}}();WH.markup.entityTag(WH.Types.D4_PARAGON_GLYPH,{icons:true});WH.markup.entityTag(WH.Types.D4_PARAGON_NODE,{icons:true});WH.markup.tags["d4-skill-tree"]=function(){return{empty:true,allowedParents:{builds:1},attr:{summary:{req:false,empty:true},points:{req:false,empty:true},tab:{req:false,valid:/^.+$/},tree:{req:false,empty:true},unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/}},toNode:e=>{let t={hash:e.unnamed,shownSections:[],type:"d4-skill-tree",tab:e.tab,requiresOrder:false};if(e.points!=null){t.shownSections.push("points");t.requiresOrder=!!(e.points&&e.points==="order")}e.tree!=null&&t.shownSections.push("tree");e.summary!=null&&t.shownSections.push("summary");const a=WH.ce("section");a.whMarkupInfo=t;return a}}}();WH.markup.tags["d4-skill"]={entityType:WH.Types.D4_SKILL,empty:true,allowInReplies:true,attr:{unnamed:{req:true,valid:/^[0-9]+$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain},diff:{req:false,valid:/^[0-9]+$/},diffnew:{req:false,valid:/^[12]$/},tempname:{req:false},icon:{req:false,valid:WH.markup.regex.iconSizeOrFalse},mod:{req:false,valid:/^\d+$/},mods:{req:false,valid:/^\d+(:\d+)*$/},rank:{req:false,valid:/^\d+$/},tooltip:{req:false,empty:true}},validate:function(e){return!((e.domain||e.site)&&WH.markup.dbPage)},toNode:(e,t)=>{let a=[];if(e.mod!=null){a.push("mod="+e.mod)}else if(e.mods!=null){a.push("mods="+e.mods)}if(e.rank!=null){a.push("rank="+e.rank)}let i=WH.markup.entityTagToNode(WH.Types.D4_SKILL,e,t,a);if(i.dataset.markupTooltipContainer){return i}if(e.mod!=null){if(i.dataset.type==="d4-skill"){i.dataset.skillType="upgrade"}WH.qsa('[data-type="d4-skill"]',i).forEach((e=>e.dataset.skillType="upgrade"));if(i.textContent!==""){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.Gatherer.get(WH.Types.D4_SKILL,parseInt(e.unnamed),t.dataEnv);if(a){let n=t.localeId??Locale.getId();let s=((a.mods||{})[n]||{})[e.mod];if(s!=null){WH.st(WH.qs("span",i)||i,s)}}}}return i},toText:e=>{if(e.mod!=null){let t=WH.markup.getDatabaseDomainInfo(e);let a=WH.Gatherer.get(WH.Types.D4_SKILL,parseInt(e.unnamed),t.dataEnv);if(a){let i=t.localeId??Locale.getId();let n=((a.mods||{})[i]||{})[e.mod];if(n!=null){return WH.markup.getEscapedHtml(n)}}}return WH.markup.entityTagToText(WH.Types.D4_SKILL,e)}};WH.markup.entityTag(WH.Types.D4_VAMPIRIC_POWER);WH.markup.entityTag(WH.Types.DI_EQUIP_ITEM,{icons:true});WH.markup.entityTag(WH.Types.DI_MISC_ITEM,{icons:true});WH.markup.entityTag(WH.Types.DI_NPC);WH.markup.entityTag(WH.Types.DI_OBJECT);WH.markup.tags["di-paragon-skill-calculator"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/}},toNode:function(t){let a=WH.ce("div",{className:"di-paragoncalc-shell-markup"});let i={editable:t.editable==="true",embedded:true,hash:t.unnamed};let n=function(){new WH.DI.ParagonCalc.Shell(a,i)};if(!WH.DI.ParagonCalc||!WH.DI.ParagonCalc.Shell){e.push(n);if(e.length===1){WH.loadAssets("di-paragon-skill-calc",(()=>{let t;while(t=e.shift()){t()}}))}}else{n()}return a}}}();WH.markup.entityTag(WH.Types.DI_PARAGON_SKILL,{icons:true});WH.markup.entityTag(WH.Types.DI_QUEST);WH.markup.entityTag(WH.Types.DI_SET);WH.markup.entityTag(WH.Types.DI_SKILL,{icons:true});WH.markup.entityTag(WH.Types.DI_ZONE);WH.markup.tags["dragonflight-talent-calc"]=function(){let e={};return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_+-]+$/},editable:{req:false,valid:/^true|false$/},heading:{req:false,valid:/^true|false$/},"max-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},tree:{req:false,valid:/^class|spec$/},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);let i=t.dataEnv||a.dataEnv;let n=t["max-width"]||(t.tree?"600px":"1220px");if(/^\d+$/.test(n)){n=`${n}px`}let s=WH.ce("div",{className:"dragonflight-talent-markup dragonflight-talent-embed",style:{margin:"0 auto",maxWidth:n}});let r={dataEnv:i,editable:t.editable==="true",embedded:true,fixedSize:t.hasOwnProperty("max-width"),hash:t.unnamed,titleBar:t.heading!=="false",tree:t.tree};let o=t.unnamed.indexOf("/")<=0;let l="TalentCalcDragonflight"+(o?"Manual":"");let c=function(){try{WH.DOM.setData(s,"talentCalc",new WH.Wow[l](s,r))}catch(e){WH.error({message:"Unable to create talent calc",options:r,error:e})}};if(!WH.Wow[l]||!o&&!WH.Wow[l].isReady(i)){let t=l+"."+i;e[t]=e[t]||[];e[t].push(c);if(e[t].length===1){WH.loadAssets("dragonflight-talent-calc"+(o?"-manual":""),(()=>{let a;while(a=e[t].shift()){a()}}),i)}}else{c()}return s}}}();WH.markup.tags["pet-talent-calc"]=function(){let e=[];return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true$/},site:{req:false,valid:WH.markup.regex.dataEnv}},validate:function(e){if((e.domain||e.site)&&WH.markup.dbPage){return false}return true},toNode:function(t){let a=WH.markup.getDataEnvFromSiteAttr(t.site);let i=WH.ce("div",{className:"talentcalc-markup-parent"});let n={abilities:false,dataEnv:a,editable:t.editable==="true",embedded:true,hash:t.unnamed.replace(/^\/+/,""),pet:true};let s=()=>new WH.Wow.TalentCalcClassic(i,n);if(!WH.Wow.hasOwnProperty("TalentCalcClassic")||!WH.Wow.TalentCalcClassic.isReady(true,a)){e.push(s);if(e.length===1){WH.loadAssets("pet-talent-calc",(()=>e.forEach((e=>e()))),a)}}else{s()}return i}}}();WH.markup.entityTag(WH.Types.PROFESSION_TRAIT);WH.markup.tags["profession-tree-calc"]=function(){let e={};return{empty:true,attr:{unnamed:{req:true,valid:/^[\/a-zA-Z0-9_-]+$/},editable:{req:false,valid:/^true|false$/},"max-width":{req:false,valid:WH.markup.regex.cssUnitOrInt},domain:{req:false,valid:WH.markup.regex.domain},site:{req:false,valid:WH.markup.regex.domain}},toNode:function(t){let a=WH.markup.getDatabaseDomainInfo(t);let i=t["max-width"]||"700px";if(/^\d+$/.test(i)){i=`${i}px`}let n=WH.ce("div",{className:"profession-tree-calc-markup",style:{margin:"0 auto",maxWidth:i}});let s={dataEnv:a.dataEnv,editable:t.editable==="true",embedded:true,hash:t.unnamed};let r=function(){new WH.Wow.ProfessionTreeCalc(n,s)};if(!WH.Wow.ProfessionTreeCalc||!WH.Wow.ProfessionTreeCalc.isReady(a.dataEnv)){let t=a.dataEnv;e[t]=e[t]||[];e[t].push(r);if(e[t].length===1){WH.loadAssets("profession-tree-calc",(()=>{let a;while(a=e[t].shift()){a()}}),a.dataEnv)}}else{r()}return n}}}();WH.markup.tags.symbol=(()=>{const e={barbarian:"ClassIcon_Barb_Small",boss:"Marker_Boss",cellar:"Marker_DungeonCellar",challenge:"Marker_DungeonChallenge","completed-achievement":"Achievement_Completed","completed-quest":"QuestLog_CheckboxComplete02",currency:"CurrencyIcon",dungeon:"Marker_DungeonEntrance",druid:"ClassIcon_Druid_Small",fire:"DamageType_Fire",frost:"DamageType_Frost",gold:"gold","legendary-star":"legendarystar",lightning:"DamageType_Lightning",mastery:"Mastery_Icon",materials:"Bag_Tab_Materials",necromancer:"ClassIcon_Necro_Small",nightmare:"nightmare_dungeon",owned:"AlreadyOwnedDiamondFrame","pact-divinity":"Vampire_Pact_Purple_Icon","pact-eternity":"Vampire_Pact_Green_Icon","pact-ferocity":"Vampire_Pact_Red_Icon",paragon:"ParagonPoint_Icon",physical:"DamageType_Physical",poison:"DamageType_Poison",rogue:"ClassIcon_Rogue_Small",salvage:"ItemTransmogSalvage",season:"Marker_Season",shadow:"DamageType_Shadow",skill:"Skill_Icon",sorcerer:"ClassIcon_Sorc_Small",transmog:"transmog","unique-star":"uniquestar",upgrade:"Crafting_UpgradePip_Unlocked",wardrobe:"Marker_Wardrobe",warning:"Warning_Icon","world-event":"Marker_WorldEvent"};return{empty:true,attr:{unnamed:{req:true}},toNode:function(t){if(t.unnamed.startsWith("d4-")){let a=e[t.unnamed.substring(3)];if(a){return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url("${WH.D4.getImageUrlFromHash(WH.D4.getStringHash(a,false))}")`}})}}switch(t.unnamed){case"df-talent":return document.createTextNode("⭘");case"df-talent-line":return WH.ce("span",{style:{background:"linear-gradient(0deg, #000 0%, transparent 25%, transparent 75%, #000 100%),"+"linear-gradient(90deg, #000 -25%, var(--color, rgba(255, 209, 0, 0.8)) 50%, #000 125%)",display:"inline-block",height:"0.5em",margin:"0.25em 0",transform:"rotate(45deg)",width:"1em"}});case"professions-tier-1":case"professions-tier-2":case"professions-tier-3":case"professions-tier-4":case"professions-tier-5":return WH.ce("span",{className:"markup-symbol",style:{backgroundImage:`url(${WH.STATIC_URL}/images/wow/ui/${t.unnamed}.png)`}});default:return document.createTextNode("?")}}}})();WH.markup.entityTag(WH.Types.TRADING_POST_ACTIVITY);WH.stub("Search");WH.Search.Live=new function(){const e=this;const t=WH.Entity;const a=WH.Game;const i=WH.Icon;const n=WH.Strings;const s=WH.Theme;const r=WH.Tooltip;const o=WH.Types;const l=WH.Url;const c=WH.Wow;const u=10;const d=500;const f="live-search-mobile-closer";const h={elements:{container:undefined,currentTextBox:undefined,filters:undefined,headerSearch:undefined,loader:undefined,noResults:undefined,resultContainer:undefined,selectedResult:undefined,viewAllLink:undefined},lastSearch:{},resultsCache:{},timer:undefined,prepared:false,cancelNext:false,hasData:false};this.attach=function(e){if(e.getAttribute("autocomplete")==="off"){return}e.setAttribute("autocomplete","off");WH.aE(e,"focus",R);WH.aE(e,"keyup",A);WH.aE(e,"keydown",w)};this.hide=function(e){if(e&&!WH.isLeftClick(e)){return}if(e&&e.target&&e.target.id!==f&&(e.target.closest(".live-search")||e.target.closest(".header-search"))){return}r.hide();if(h.elements.container){h.elements.container.style.display="none"}if(h.elements.headerSearch){h.elements.headerSearch.dataset.hasLiveSearch="false"}};this.reset=function(t){h.lastSearch[t.id]=null;t.value="";h.hasData=false;e.hide()};function p(e){if(e&&!y()){return}if(h.elements.currentTextBox==null){return}let t={[s.THEME_CLASSIC]:3,[s.THEME_THOTTBOT]:1}[s.getTheme()]||0;let a=WH.ac(h.elements.currentTextBox);h.elements.container.style.left=a[0]-t+"px";h.elements.container.style.top=a[1]+h.elements.currentTextBox.offsetHeight+"px";let i=getComputedStyle(h.elements.currentTextBox);h.elements.container.style.width=h.elements.currentTextBox.clientWidth-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)+t*2+"px";k()}function m(){if(h.elements.selectedResult){h.elements.selectedResult.dataset.selected="false";h.elements.selectedResult=undefined}}function H(e,t){let a=t===1?WH.Types.getUpperSingular(e):WH.Types.getUpperPlural(e);let i=WH.ce("button",{className:"btn",dataset:{type:e,active:JSON.stringify(false)}},WH.ct(a));WH.ae(i,WH.ce("span",undefined,WH.ct(WH.term("parens_format","",t))));WH.aE(i,"click",I);WH.ae(h.elements.filters,i)}function g(e,t){let n=WH.ce("div",{className:"result-icon"});if(e.icon){let s=a.get();t.dataset.gameIcon=a.getKey(s);n.style.backgroundImage=`url('${i.getIconUrl(e.icon,i.LARGE,s)}')`}else if(e.type===o.NPC&&e.boss){n.dataset.icon="boss"}else if([o.QUEST,o.TITLE].includes(e.type)&&[c.SIDE_ALLIANCE,c.SIDE_HORDE].includes(e.side)){n.dataset.icon=c.getSideIcon(e.side)}else{n.dataset.icon=WH.Types.getReferenceName(e.type)}return n}function W(e){let a=WH.ce("a",{className:"live-search-result",dataset:{selected:JSON.stringify(false),type:e.type},href:t.getUrl(e.type,e.id,e.name)});if(s.isClassicType()){a.dataset.tooltipMode="icon"}WH.aE(a,"mouseover",M);if(e.quality!=null){a.classList.add("q"+e.quality)}if(e.type===o.PLAYER_CLASS){a.classList.add("c"+e.id)}return a}function E(e,t){let a=WH.ce("span",{className:"result-name"});let i=e.displayName??n.escapeHtml(e.name);i=i.replace(t,(function(e,t){return t?'<span class="exact-match">'+e+"</span>":e}));if(e.type===o.TITLE){i=i.replace("%s",'<span class="q0">&lt;'+WH.TERMS.name+"&gt;</span>")}else if(e.type===o.SPELL&&e.rank){i=WH.term("parens_format",i,e.rank)}a.innerHTML=i;return a}function _(e){return WH.ce("span",{className:"result-type"},WH.ct(o.getUpperSingular(e.type)))}function v(e){if(!y()){if(h.hasData){L()}return}let t=WH.qs('.search-filters > [data-active="true"]');let a=".live-search-result";if(t&&t.dataset.type!=="0"){a+='[data-filtered="true"]'}let i=WH.qsa(a);let n=e?i.item(i.length-1):i.item(0);if(!h.elements.selectedResult){S(n);return}let s=e?h.elements.selectedResult.previousSibling:h.elements.selectedResult.nextSibling;if(t){for(let t=0;t<i.length;t++){let a=i.item(t);if(h.elements.selectedResult.href===a.href){s=e?i.item(t-1):i.item(t+1);break}}}S(s||n)}function T(e,t,a){WH.displayNone(h.elements.loader);h.hasData=true;r.hide();WH.displayNone(h.elements.noResults);WH.ee(h.elements.resultContainer);while(h.elements.filters.lastChild!==h.elements.filters.firstChild){WH.de(h.elements.filters.lastChild)}t=t.replace(/\s+/g," ").trim();h.elements.viewAllLink.href=l.generatePath("/search?q="+encodeURIComponent(t));WH.displayDefault(h.elements.viewAllLink);t=n.escapeHtml(t).replace(/[^\u00C0-\u1FFF\u2C00-\uD7FF\w-]/gi," ");let i=WH.createOrRegex(t,t==="s"?"[%]":null);if(a.length===0){WH.displayDefault(h.elements.noResults);WH.displayNone(h.elements.viewAllLink);h.elements.filters.dataset.hidden="true";return}let s={};for(let e=0;e<a.length;e++){let t=a[e];if(s[t.type]){s[t.type].count++}else{s[t.type]={position:e,count:1}}let n=W(t);WH.ae(n,g(t,n));WH.ae(n,E(t,i));WH.ae(n,_(t));WH.ae(h.elements.resultContainer,n)}Object.entries(s).sort((function(e,t){return e[1].position-t[1].position})).forEach((function(e){H(parseInt(e[0]),e[1].count)}));h.elements.filters.dataset.hidden="false";k()}function b(e,t){if(h.resultsCache[t]){T(e,t,h.resultsCache[t])}else{if(h.resultsCache.hasOwnProperty(t)){return}h.resultsCache[t]=null}WH.fetch(l.generatePath("/search/suggestions-template"),{cookies:false,query:{q:t,v:WH.getDataCacheVersion()},success:function(t){h.resultsCache[t.search]=t.results;if(t.search===h.lastSearch[e.id]){T(e,t.search,t.results)}},error:function(){h.resultsCache[t]=[];if(t===h.lastSearch[e.id]){T(e,t,[])}}})}function S(e,t){m();h.elements.selectedResult=e;h.elements.selectedResult.dataset.selected="true";if(e.parentNode===h.elements.resultContainer){let t=e.offsetTop;let a=h.elements.resultContainer.scrollTop;if(t+e.clientHeight>a+h.elements.resultContainer.clientHeight){h.elements.resultContainer.scrollTop=t-(h.elements.resultContainer.clientHeight-e.offsetHeight)}else if(t<a){h.elements.resultContainer.scrollTop=t}}else{h.elements.resultContainer.scrollTop=0}if(!t){L();h.cancelNext=true}}function y(){if(!h.elements.container){return false}return h.elements.container.style.display!=="none"}function I(e){let t=WH.qs('.search-filters > [data-active="true"]');if(t){t.dataset.active="false"}m();e.target.dataset.active="true";let a=e.target.dataset.type==="0";WH.qsa(".live-search-result").forEach((t=>{t.dataset.filtered=JSON.stringify(a||t.dataset.type===e.target.dataset.type)}));k();h.elements.currentTextBox.focus()}function R(e){let t=e.target;if(t!==document){h.elements.currentTextBox=t}m();L()}function N(){if(!y()){return}let e=true;setTimeout((()=>{e=false}),WH.Layout.Responsive.HEADER_RESIZE_MS+1);let t=()=>{p();if(e){requestAnimationFrame(t)}};t()}function w(t){switch(t.key){case"Enter":if(h.elements.selectedResult){t.preventDefault();window.location.href=h.elements.selectedResult.href}break;case"Escape":e.hide();break;case"ArrowUp":t.preventDefault();v(true);break;case"ArrowDown":t.preventDefault();v();break}}function A(t){let a=t.target;let i=a.value.replace(/\s+/g," ").trim();if(i===h.lastSearch[a.id]){return}h.lastSearch[a.id]=i;if(a!==document){h.elements.currentTextBox=a}if(i.length){C(a,i)}else{e.hide()}}function M(){S(this,true)}function C(e,t){if(h.cancelNext){h.cancelNext=false;return}h.hasData=false;O();clearTimeout(h.timer);if(h.resultsCache[t]){L();T(e,t,h.resultsCache[t]);return}WH.displayDefault(h.elements.loader);L();h.timer=setTimeout(b.bind(0,e,t),d)}function O(){if(h.prepared){return}h.prepared=true;if(h.elements.headerSearch){h.elements.headerSearch=WH.Layout.getElement("header-search")}h.elements.container=WH.ce("div",{className:"live-search",style:{display:"none"}});h.elements.filters=WH.ce("div",{className:"search-filters",dataset:{hidden:JSON.stringify(true)}});let t=WH.ce("button",{className:"btn",dataset:{type:"0",active:JSON.stringify(true)}},WH.ct(WH.TERMS.all));WH.aE(t,"click",I);WH.ae(h.elements.filters,t);WH.ae(h.elements.container,h.elements.filters);h.elements.loader=WH.ce("div",{className:"live-search-loading"},WH.ce("span",{className:"live-search-loading-indicator"}));WH.ae(h.elements.loader,WH.ce("div",undefined,WH.ct(WH.TERMS.loading_ellipsis)));WH.ae(h.elements.container,h.elements.loader);h.elements.resultContainer=WH.ce("div",{className:"live-search-results"});WH.ae(h.elements.container,h.elements.resultContainer);h.elements.noResults=WH.ce("span",{className:"live-search-result empty",style:{display:"none"}},WH.ct(WH.TERMS.noresults));WH.ae(h.elements.container,h.elements.noResults);h.elements.viewAllLink=WH.ce("a",{className:"live-search-button",style:{display:"none"}},WH.ct(WH.TERMS.viewAllSearchResults));WH.ae(h.elements.container,h.elements.viewAllLink);let a=WH.ce("a",{className:"live-search-button fa fa-times q10",id:f},WH.ct(WH.TERMS.closesearch));WH.aE(a,"click",e.hide);WH.ae(h.elements.container,a);WH.ae(document.body,h.elements.container);WH.aE(window,"resize",p.bind(e,true));WH.aE(document,"click",(function(t){if(!ZUL.getEnabled()){e.hide(t)}}));if(s.isClassicType()){WH.Layout.Responsive.onHeaderResize(N)}}function L(){if(h.elements.container&&!y()){p();if(h.elements.headerSearch){h.elements.headerSearch.dataset.hasLiveSearch="true"}h.elements.container.style.opacity="0";WH.displayDefault(h.elements.container);$(h.elements.container).animate({opacity:"1"},"fast")}}function k(){let e=h.elements.container.getBoundingClientRect().top+h.elements.container.offsetHeight-h.elements.resultContainer.offsetHeight+h.elements.resultContainer.scrollHeight+u;h.elements.container.style.bottom=e>window.innerHeight?u+"px":null}};WH.Tools.Bloodmallet=new function(){var e=false;this.loadCharts=function(){if(typeof window.Highcharts!=="object"){WH.error("Can't load Bloodmallet charts because the Highcharts library isn't available.");return}if(typeof window.bloodmallet_charts!=="object"){if(!e){e=true;$.ajax({url:WH.STATIC_URL+"/js/3rd-party/bloodmallet_chart_import.js?2023-03-21",dataType:"script",success:t,cache:true})}}else{t()}};this.updateChartsSizes=function(e){var t=[];$(e).find(".bloodmallet_chart[data-highcharts-chart]").each((function(){t.push(this.getAttribute("data-highcharts-chart"))}));if(t.length>0){WH.Tools.Highcharts.updateSizes(t)}};function t(){$(".bloodmallet_chart").each((function(){if(typeof $(this).attr("data-highcharts-chart")==="undefined"){bloodmallet_chart_import();return false}}));setTimeout(a,9);$(window).resize(WH.Tools.Highcharts.updateSizes)}function a(){var e=0;var t=[];$(".bloodmallet_chart").each((function(){var a=this.getAttribute("data-highcharts-chart");if(a!==""){t.push(a)}else{e++}}));if(t.length>0){WH.Tools.Highcharts.updateSizes(t)}if(e>0){setTimeout(a,9*e)}}};WH.Tools.Highcharts=new function(){var e=[];var t=false;var a={};var i=50;this.loadScript=function(a){if(a){e.push(a)}if(typeof window.Highcharts!=="object"){if(!t){t=true;n(WH.STATIC_URL+"/js/3rd-party/highcharts.js",s)}}else{s()}};this.updateSizes=function(e){if(typeof Highcharts==="undefined"||!Array.isArray(Highcharts.charts)){return 0}var t=0;if(Array.isArray(e)){for(var a=0,i;i=e[a];a++){if(Highcharts.charts[i]){r(Highcharts.charts[i]);t++}}}else{for(var n=0,s;s=Highcharts.charts[n];n++){r(s);t++}}return t};function n(e,t){let a=WH.ce("script",{type:"text/javascript"});if(WH.PageMeta.scriptVersionQueryString){if(e.indexOf("?")<0){e+="?"+WH.PageMeta.scriptVersionQueryString}else{e=e.replace(/\?/,"?"+WH.PageMeta.scriptVersionQueryString+"&")}}a.src=e;WH.aE(a,"load",t);WH.ae(document.getElementsByTagName("head")[0],a)}function s(){while(e.length){e.pop()()}}function r(e){clearTimeout(a[e.index]);a[e.index]=setTimeout((function(){e.setSize(null,null)}),i)}};WH.stub("User");WH.User.Completion=new function(){const e=this;const t={pageData:{byType:{},wardrobe:undefined}};this.getByType=function(e){return t.pageData.byType[e]=t.pageData.byType[e]||WH.getPageData("user.completion.type."+e)||{}};this.getWardrobe=function(){return t.pageData.wardrobe=t.pageData.wardrobe||WH.getPageData("user.completion.wardrobe")||{}}};WH.Wow.Achievement=new function(){const e=WH.getPageData("wow.achievement.categoryNames")||{};this.getCategoryName=function(t){return e[t]}};WH.Wow.Area=new function(){const e=this;const t={categoryNames:undefined,names:undefined};this.getCategoryName=function(e){t.categoryNames=t.categoryNames||WH.getPageData("wow.area.categoryNames")||{};return t.categoryNames[e]||null};this.getName=function(t){return e.getNameList()[t]||null};this.getNameList=function(){if(!t.names){t.names=WH.getPageData("wow.area.names")||{}}return t.names}};WH.Wow.BattlePet=new function(){const e={families:undefined};this.getFamilyName=function(t){e.families=e.families||WH.getPageData("wow.battlePet.families")||{};return e.families[t]}};WH.Wow.BattlePetAbility=new function(){const e={types:undefined};this.getTypeName=function(t){e.types=e.types||WH.getPageData("wow.battlePetAbility.types")||{};return e.types[t]}};WH.Wow.Building=new function(){const e=WH.getPageData("wow.building.shortNames")||{};this.getShortName=function(t){return e[t]||WH.TERMS.unknown};this.hasShortName=function(t){return e.hasOwnProperty(t)}};var g_artifact_knowledge_max_level=55;var g_file_factions={1:"alliance",2:"horde"};var g_file_racefactions={10:2,11:1,3:1,7:1,1:1,4:1,2:2,6:2,8:2,5:2,9:2,22:1,24:3,25:1,26:2,27:2,28:2,29:1,30:1,31:2,32:1,34:1,35:2,36:2,37:1};var g_class_forums={6:18,12:29,11:3,3:4,8:6,10:28,2:7,5:8,4:5,7:9,9:10,1:11};var g_file_gems={1:"meta",2:"red",4:"yellow",6:"orange",8:"blue",10:"purple",12:"green",14:"prismatic",16:"hydraulic",32:"cogwheel"};var g_chr_specs_by_class={12:["577","581"],6:["250","251","252"],11:["102","103","104","105"],13:["1467","1468","1473"],3:["253","254","255"],8:["62","63","64"],10:["268","270","269"],2:["65","66","70"],5:["256","257","258"],4:["259","260","261"],7:["262","263","264"],9:["265","266","267"],1:["71","72","73"]};if(WH.isClassicTree()||WH.isTbcTree()){g_chr_specs_by_class={11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}if(WH.isWrathTree()){g_chr_specs_by_class={6:["398","399","400"],11:["283","281","282"],3:["361","363","362"],8:["81","41","61"],2:["382","383","381"],5:["201","202","203"],4:["182","181","183"],7:["261","263","262"],9:["302","303","301"],1:["161","164","163"]}}var g_battlepet_types={1:"humanoid",2:"dragonkin",3:"flying",4:"undead",5:"critter",6:"magic",7:"elemental",8:"beast",9:"aquatic",10:"mechanical"};var g_battlepet_passives={1:238,2:245,3:239,4:242,5:236,6:243,7:241,8:237,9:240,10:244};var g_skill_recipe_subclass={171:6,164:4,185:5,333:8,202:3,356:9,773:11,755:10,165:1,186:12,197:2};if(WH.isClassicTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773];delete g_skill_recipe_subclass[755]}if(WH.isTbcTree()){g_skill_recipe_subclass[129]=7;delete g_skill_recipe_subclass[773]}if(WH.isWrathTree()){g_skill_recipe_subclass[129]=7}var g_skill_recipe_subclass_url={171:"alchemy",164:"blacksmithing",185:"cooking",333:"enchanting",202:"engineering",356:"fishing",773:"inscription",755:"jewelcrafting",165:"leatherworking",186:"mining",197:"tailoring"};if(WH.isClassicTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773];delete g_skill_recipe_subclass_url[755]}if(WH.isTbcTree()){g_skill_recipe_subclass_url[129]="first-aid";delete g_skill_recipe_subclass_url[773]}if(WH.isWrathTree()){g_skill_recipe_subclass_url[129]="first-aid"}var g_grayedOutStats={3:[250,251,252,102,105,1467,1468,1473,62,63,64,270,65,66,70,256,257,258,262,264,265,266,267,71,72,73],4:[102,103,104,105,1467,1468,253,254,255,62,63,64,268,270,269,65,256,257,258,259,260,261,262,263,264,265,266,267],5:[71,72,73,259,260,261,253,254,255,103,104,250,251,252,66,70,263,268,269],6:[250,251,252,102,103,104,1467,1473,253,254,255,62,63,64,268,269,66,70,258,259,260,261,262,263,265,266,267,71,72,73],50:[251,252,102,103,105,1467,1468,1473,253,254,255,62,63,64,270,269,65,70,256,257,258,259,260,261,262,263,264,265,266,267,71,72]};if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()){g_grayedOutStats={}}var g_specPrimaryStatOrders={62:[5,3,4],63:[5,3,4],64:[5,3,4],65:[5,4,3],66:[4,3,5],70:[4,3,5],71:[4,3,5],72:[4,3,5],73:[4,3,5],102:[5,3,4],103:[3,4,5],104:[3,4,5],105:[5,3,4],1467:[5,3,4],1468:[5,3,4],1473:[5,3,4],250:[4,3,5],251:[4,3,5],252:[4,3,5],253:[3,5,4],254:[3,5,4],255:[3,5,4],256:[5,3,4],257:[5,3,4],258:[5,3,4],259:[3,4,5],260:[3,4,5],261:[3,4,5],262:[5,3,4],263:[3,5,4],264:[5,3,4],265:[5,3,4],266:[5,3,4],267:[5,3,4],268:[3,5,4],269:[3,5,4],270:[5,3,4],577:[3,5,4],581:[3,5,4]};var g_spec_to_role={62:2,63:2,64:2,65:1,66:0,70:2,71:2,72:2,73:0,74:2,79:2,81:0,102:2,103:2,104:0,105:1,1467:2,1468:1,1473:2,250:0,251:2,252:2,253:2,254:2,255:2,256:1,257:1,258:2,259:2,260:2,261:2,262:2,263:2,264:1,265:2,266:2,267:2,268:0,269:2,270:1,535:2,536:2,537:0,577:2,581:0};var g_character_slots_data=[{id:1,name:"head",itemSlots:[1]},{id:2,name:"neck",itemSlots:[2],noModel:1},{id:3,name:"shoulder",itemSlots:[3]},{id:15,name:"back",itemSlots:[16],iconName:"chest"},{id:5,name:"chest",itemSlots:[5,20]},{id:4,name:"shirt",itemSlots:[4]},{id:19,name:"tabard",itemSlots:[19]},{id:9,name:"wrists",itemSlots:[9]},{id:10,name:"hands",itemSlots:[10]},{id:6,name:"waist",itemSlots:[6]},{id:7,name:"legs",itemSlots:[7]},{id:8,name:"feet",itemSlots:[8]},{id:11,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger1"},{id:12,name:"finger",itemSlots:[11],noModel:1,simCraftName:"finger2"},{id:13,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket1"},{id:14,name:"trinket",itemSlots:[12],noModel:1,simCraftName:"trinket2"},{id:16,name:"mainhand",itemSlots:[21,13,17,15,25,26],simCraftName:"main_hand"},{id:17,name:"offhand",itemSlots:[22,13,17,23,14],simCraftName:"off_hand"}];var g_classes_allowed_armor={6:[1,2,3,4,5],12:[1,2,5],11:[1,2,5],3:[1,2,3,5],8:[1,5],10:[1,2,5],2:[1,2,3,4,5,6],5:[1,5],4:[1,2,5],7:[1,2,3,5,6],9:[1,5],1:[1,2,3,4,5,6]};var g_classes_allowed_weapon={6:[0,1,4,5,6,7,8,20],12:[0,7,9,13,15,20],11:[4,5,6,10,13,15,20],13:[0,1,4,5,6,7,8,10,13,15,20],3:[2,3,6,10,18,20],8:[7,10,15,19,20],10:[0,4,6,7,10,13,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[0,2,3,4,7,13,15,18,20],7:[0,1,4,5,6,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,18,20]};if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()){g_character_slots_data[g_character_slots_data.length-2].itemSlots=[21,13,17];if([WH.dataEnv.CLASSIC,WH.dataEnv.TBC].includes(WH.getDataEnv())){g_character_slots_data[g_character_slots_data.length-1].itemSlots=[22,13,23,14]}g_character_slots_data.push({id:18,name:"ranged",itemSlots:[15,25,26,28]});g_classes_allowed_armor[2].push(7);g_classes_allowed_armor[7].push(9);g_classes_allowed_armor[11].push(8);g_classes_allowed_armor[6].push(10);g_classes_allowed_weapon={11:[4,5,10,13,15,20],3:[0,1,2,3,6,7,8,10,13,15,16,18,20],8:[7,10,15,19,20],2:[0,1,4,5,6,7,8,20],5:[4,10,15,19,20],4:[2,3,4,7,13,15,16,18,20],7:[0,1,4,5,10,13,15,20],9:[7,10,15,19,20],1:[0,1,2,3,4,5,6,7,8,10,13,15,16,18,20]};if(WH.isWrathTree()){g_classes_allowed_weapon[6]=[0,1,4,5,6,7,8,20];g_classes_allowed_weapon[4].push(0);g_classes_allowed_weapon[11].push(6)}}WH.getRaceSideSortString=function(e){var t=parseInt(e.side||g_file_racefactions[e.id]);if(t===1){return"alliance"}else if(t===2){return"horde"}else if(t===3){return"both"}return"npc"};WH.Wow.Covenant=new function(){this.KYRIAN=1;this.NECROLORD=4;this.NIGHT_FAE=3;this.VENTHYR=2;const e={};e[this.KYRIAN]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_kyrian.jpg";e[this.NECROLORD]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_necrolord.jpg";e[this.NIGHT_FAE]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_night_fae.jpg";e[this.VENTHYR]="https://render-us.worldofwarcraft.com/profile-backgrounds/v2/armory_bg_covenant_venthyr.jpg";const t={};t[this.KYRIAN]="ui_sigil_kyrian";t[this.NECROLORD]="ui_sigil_necrolord";t[this.NIGHT_FAE]="ui_sigil_nightfae";t[this.VENTHYR]="ui_sigil_venthyr";const a={[this.KYRIAN]:"kyrian",[this.NECROLORD]:"necrolord",[this.NIGHT_FAE]:"night-fae",[this.VENTHYR]:"venthyr"};this.getArmoryBackgroundImageUrl=function(t){return e[t]};this.getIcon=function(e){return t[e]};this.getIdBySlug=function(e){return parseInt(Object.keys(a).find((t=>a[t]===e)))||undefined};this.getSlug=function(e){return a[e]}};WH.Wow.Currency=new function(){this.ID_CONQUEST=390;this.ID_HONOR=392;this.ID_JUSTICE=395;this.ID_VALOR=396;const e=WH.getPageData("wow.currency.categories")||{};const t=WH.getPageData("wow.currency.namesAndIcons")||{};this.getCategoryName=function(t){return e[t]||null};this.getIcon=function(e){return t[e]&&t[e].icon||null};this.getName=function(e){return t[e]&&t[e].name||null}};var g_achievements={};var g_affixes={};var g_azeriteEssences={};var g_azeriteEssencePowers={};var g_bfa_champions={};var g_buildings={};var g_champions={};var g_classes={};var g_factions={};var g_followers={};var g_gatheredcurrencies={};var g_gatheredzones={};var g_gearsets={};var g_guides={};var g_holidays={};var g_icons={};var g_items={};var g_itemsets={};var g_mission_abilities={};var g_missions={};var g_npcs={};var g_objects={};var g_orderadvancements={};var g_outfits={};var g_petabilities={};var g_pets={};var g_quests={};var g_races={};var g_resources={};var g_ships={};var g_skills={};var g_sounds={};var g_spells={};var g_storylines={};var g_threats={};var g_titles={};var g_transmogsets={};var g_charts={};window.g_gathered_types={};g_gathered_types[WH.Types.ACHIEVEMENT]=g_achievements;g_gathered_types[WH.Types.ADVENTURE_COMBATANT_ABILITY]={};g_gathered_types[WH.Types.AFFIX]=g_affixes;g_gathered_types[WH.Types.AZERITE_ESSENCE]=g_azeriteEssences;g_gathered_types[WH.Types.AZERITE_ESSENCE_POWER]=g_azeriteEssencePowers;g_gathered_types[WH.Types.BATTLE_PET_ABILITY]=g_petabilities;g_gathered_types[WH.Types.BFA_CHAMPION]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_ALLIANCE]=g_bfa_champions;g_gathered_types[WH.Types.BFA_CHAMPION_HORDE]=g_bfa_champions;g_gathered_types[WH.Types.BUILDING]=g_buildings;g_gathered_types[WH.Types.CHAMPION]=g_champions;g_gathered_types[WH.Types.CHAMPION_ALLIANCE]=g_champions;g_gathered_types[WH.Types.CHAMPION_HORDE]=g_champions;g_gathered_types[WH.Types.COVENANT]={};g_gathered_types[WH.Types.CURRENCY]=g_gatheredcurrencies;g_gathered_types[WH.Types.D4_AFFIX]={};g_gathered_types[WH.Types.D4_ASPECT]={};g_gathered_types[WH.Types.D4_ITEM]={};g_gathered_types[WH.Types.D4_PARAGON_GLYPH]={};g_gathered_types[WH.Types.D4_PARAGON_NODE]={};g_gathered_types[WH.Types.D4_SKILL]={};g_gathered_types[WH.Types.DI_EQUIP_ITEM]={};g_gathered_types[WH.Types.DI_MISC_ITEM]={};g_gathered_types[WH.Types.DI_NPC]={};g_gathered_types[WH.Types.DI_OBJECT]={};g_gathered_types[WH.Types.DI_PARAGON_SKILL]={};g_gathered_types[WH.Types.DI_QUEST]={};g_gathered_types[WH.Types.DI_SET]={};g_gathered_types[WH.Types.DI_SKILL]={};g_gathered_types[WH.Types.DI_ZONE]={};g_gathered_types[WH.Types.ENCOUNTER]={};g_gathered_types[WH.Types.EVENT]=g_holidays;g_gathered_types[WH.Types.FACTION]=g_factions;g_gathered_types[WH.Types.FOLLOWER]=g_followers;g_gathered_types[WH.Types.FOLLOWER_ALLIANCE]=g_followers;g_gathered_types[WH.Types.FOLLOWER_HORDE]=g_followers;g_gathered_types[WH.Types.HUNTER_PET]=g_pets;g_gathered_types[WH.Types.ICON]=g_icons;g_gathered_types[WH.Types.ITEM]=g_items;g_gathered_types[WH.Types.ITEM_SET]=g_itemsets;g_gathered_types[WH.Types.MISSION]=g_missions;g_gathered_types[WH.Types.MISSION_ABILITY]=g_mission_abilities;g_gathered_types[WH.Types.NPC]=g_npcs;g_gathered_types[WH.Types.OBJECT]=g_objects;g_gathered_types[WH.Types.ORDER_ADVANCEMENT]=g_orderadvancements;g_gathered_types[WH.Types.PLAYER_CLASS]=g_classes;g_gathered_types[WH.Types.PROFESSION_TRAIT]={};g_gathered_types[WH.Types.QUEST]=g_quests;g_gathered_types[WH.Types.RACE]=g_races;g_gathered_types[WH.Types.RESOURCE]=g_resources;g_gathered_types[WH.Types.SHIP]=g_ships;g_gathered_types[WH.Types.SHIP_ALLIANCE]=g_ships;g_gathered_types[WH.Types.SHIP_HORDE]=g_ships;g_gathered_types[WH.Types.SKILL]=g_skills;g_gathered_types[WH.Types.SOULBIND]={};g_gathered_types[WH.Types.SOUND]=g_sounds;g_gathered_types[WH.Types.SPELL]=g_spells;g_gathered_types[WH.Types.STORYLINE]=g_storylines;g_gathered_types[WH.Types.THREAT]=g_threats;g_gathered_types[WH.Types.TITLE]=g_titles;g_gathered_types[WH.Types.TRADING_POST_ACTIVITY]={};g_gathered_types[WH.Types.ZONE]=g_gatheredzones;g_gathered_types[WH.Types.GEAR_SET]=g_gearsets;g_gathered_types[WH.Types.GUIDE]=g_guides;g_gathered_types[WH.Types.OUTFIT]=g_outfits;g_gathered_types[WH.Types.TRANSMOG_SET]=g_transmogsets;g_gathered_types[WH.Types.GATHERER_GUIDE_IMAGE]={};g_gathered_types[WH.Types.GATHERER_LISTVIEW]={};g_gathered_types[WH.Types.GATHERER_SCREENSHOT]={};g_gathered_types[WH.Types.GATHERER_SURVEY_COVENANTS]={};var g_completion_categories={1:[12],3:[2,4,9,"15-2","15-5"],6:[-5,-6,9,11]};WH.cO(g_items,{add:function(e,t){var a={};a[e]=t;WH.Gatherer.addData(WH.Types.ITEM,WH.getDataEnv(),a)},getIcon:function(e,t,a,i){var n=WH.Gatherer.get(WH.Types.ITEM,e,i);var s=Icon.questionMarkIcon;if(n!=null&&n.icon){s=n.icon}var r=g_items.getAppearance(e,t,a,i);if(r!=null&&r[1]){s=r[1]}return s},getAppearance:function(e,t,a,i){var n=null;var s=WH.Gatherer.get(WH.Types.ITEM,e,i);var r=-1;var o=s&&s.appearances?s.appearances:s&&s.jsonequip&&s.jsonequip.appearances?s.jsonequip.appearances:null;if(a&&o&&o[a]){n=o[a]}else{if(WH.isSet("g_itembonuses")&&t&&t.length>0){for(var l in t){var c=t[l];if(c>0&&g_itembonuses[c]){WH.arrayWalk(g_itembonuses[c],(function(e){if(e[0]==7){r=e[1]}}))}if(r!=-1&&o&&o[r]){n=o[r];break}}}}return n},createIcon:function(e,t,a,i,n){var s={};if(n&&n.length>0){s.bonus=n.join(":")}return Icon.create(g_items.getIcon(e,n),t,null,WH.Entity.getUrl(WH.Types.ITEM,e,null,s),a,i)}});WH.cO(g_spells,{WH_IDS:1e6,add:function(e,t){if(g_spells[e]!=null){WH.cO(g_spells[e],t)}else{g_spells[e]=t}},getIcon:function(e){if(g_spells[e]!=null&&g_spells[e].icon){return g_spells[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_spells.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.SPELL,e),a,i)}});WH.cO(g_petabilities,{add:function(e,t){if(g_petabilities[e]!=null){WH.cO(g_petabilities[e],t)}else{g_petabilities[e]=t}},getIcon:function(e){if(g_petabilities[e]!=null&&g_petabilities[e].icon){return g_petabilities[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_petabilities.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.BATTLE_PET_ABILITY,e),a,i)}});WH.cO(g_achievements,{getIcon:function(e){if(g_achievements[e]!=null&&g_achievements[e].icon){return g_achievements[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_achievements.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.ACHIEVEMENT,e),a,i)}});WH.cO(g_classes,{getIcon:e=>WH.Wow.PlayerClass.getIconName(e)||WH.Icon.UNKNOWN,createIcon:function(e,t,a,i){return Icon.create(g_classes.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.PLAYER_CLASS,e),a,i)}});WH.cO(g_races,{getIcon:function(e,t){if(t===undefined){t=WH.Wow.Gender.Male.value}return WH.Wow.Race.getIcon(e,WH.Wow.Gender.tryFrom(t))||WH.Icon.UNKNOWN},createIcon:function(e,t,a,i){return Icon.create(g_races.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.RACE,e),a,i)}});WH.cO(g_skills,{getIcon:function(e){if(g_skills[e]!=null&&g_skills[e].icon){return g_skills[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_skills.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.SKILL,e),a,i)}});WH.cO(g_gatheredcurrencies,{getIcon:function(e){if(g_gatheredcurrencies[e]!=null&&g_gatheredcurrencies[e].icon){return g_gatheredcurrencies[e].icon}return WH.Icon.UNKNOWN},createIcon:function(e,t,a,i){return Icon.create(g_gatheredcurrencies.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.CURRENCY,e),Math.abs(a),i)}});WH.cO(g_holidays,{getIcon:function(e){if(g_holidays[e]!=null&&g_holidays[e].icon){return g_holidays[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){return Icon.create(g_holidays.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.EVENT,e),a,i)}});WH.cO(g_mission_abilities,{getIcon:function(e){if(g_mission_abilities[e]!=null&&g_mission_abilities[e].icon){return g_mission_abilities[e].icon}else{return Icon.questionMarkIcon}},createIcon:function(e,t,a,i){var n=Icon.create(g_mission_abilities.getIcon(e),t,null,WH.Entity.getUrl(WH.Types.MISSION_ABILITY,e),a,i);n.className+=" garrison-ability";return n}});WH.Wow.Difficulty=new function(){const e=this;this.ID_NONE=0;this.ID_DUNGEON_NORMAL=1;this.ID_DUNGEON_HEROIC=2;this.ID_LEGACY_10_PLAYER=3;this.ID_LEGACY_25_PLAYER=4;this.ID_LEGACY_10_PLAYER_HEROIC=5;this.ID_LEGACY_25_PLAYER_HEROIC=6;this.ID_LEGACY_RAID_FINDER=7;this.ID_DUNGEON_CHALLENGE=8;this.ID_RAID_40_PLAYER=9;this.ID_SCENARIO=11;this.ID_SCENARIO_HEROIC=12;this.ID_RAID_NORMAL=14;this.ID_RAID_HEROIC=15;this.ID_RAID_MYTHIC=16;this.ID_RAID_FINDER=17;this.ID_RAID_EVENT=18;this.ID_DUNGEON_EVENT=19;this.ID_SCENARIO_EVENT=20;this.ID_DUNGEON_MYTHIC=23;this.ID_DUNGEON_TIMEWALKING=24;this.ID_CLASSIC_RAID_20_PLAYER=148;this.ID_TBC_DUNGEON_NORMAL=173;this.ID_TBC_DUNGEON_HEROIC=174;this.ID_TBC_10_PLAYER=175;this.ID_TBC_25_PLAYER=176;this.ID_SEASON_OF_MASTERY_DUNGEON=184;this.ID_SEASON_OF_MASTERY_20_PLAYER=185;this.ID_SEASON_OF_MASTERY_40_PLAYER=186;this.ID_WOTLK_10_PLAYER_HEROIC=193;this.ID_WOTLK_25_PLAYER_HEROIC=194;this.GROUP_NONE=1;this.GROUP_DUNGEON=2;this.GROUP_LEGACY_RAID=3;this.GROUP_RAID=4;this.GROUPS={};this.GROUPS[this.GROUP_RAID]=[this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_FINDER];this.GROUPS[this.GROUP_LEGACY_RAID]=[this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_LEGACY_RAID_FINDER,this.ID_SEASON_OF_MASTERY_40_PLAYER,this.ID_SEASON_OF_MASTERY_20_PLAYER,this.ID_RAID_40_PLAYER,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_TBC_10_PLAYER,this.ID_TBC_25_PLAYER,this.ID_WOTLK_10_PLAYER_HEROIC,this.ID_WOTLK_25_PLAYER_HEROIC,this.ID_RAID_NORMAL];this.GROUPS[this.GROUP_DUNGEON]=[this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_CHALLENGE,this.ID_DUNGEON_TIMEWALKING,this.ID_TBC_DUNGEON_NORMAL,this.ID_TBC_DUNGEON_HEROIC,this.ID_SEASON_OF_MASTERY_DUNGEON];this.GROUPS[this.GROUP_NONE]=[this.ID_NONE];this.SORT_ORDER=[this.ID_NONE,this.ID_DUNGEON_NORMAL,this.ID_DUNGEON_HEROIC,this.ID_DUNGEON_MYTHIC,this.ID_DUNGEON_CHALLENGE,this.ID_DUNGEON_EVENT,this.ID_DUNGEON_TIMEWALKING,this.ID_TBC_DUNGEON_NORMAL,this.ID_TBC_DUNGEON_HEROIC,this.ID_SEASON_OF_MASTERY_DUNGEON,this.ID_LEGACY_RAID_FINDER,this.ID_LEGACY_10_PLAYER,this.ID_LEGACY_10_PLAYER_HEROIC,this.ID_LEGACY_25_PLAYER,this.ID_LEGACY_25_PLAYER_HEROIC,this.ID_CLASSIC_RAID_20_PLAYER,this.ID_SEASON_OF_MASTERY_20_PLAYER,this.ID_RAID_40_PLAYER,this.ID_SEASON_OF_MASTERY_40_PLAYER,this.ID_TBC_10_PLAYER,this.ID_TBC_25_PLAYER,this.ID_WOTLK_10_PLAYER_HEROIC,this.ID_WOTLK_25_PLAYER_HEROIC,this.ID_RAID_FINDER,this.ID_RAID_NORMAL,this.ID_RAID_HEROIC,this.ID_RAID_MYTHIC,this.ID_RAID_EVENT,this.ID_SCENARIO,this.ID_SCENARIO_HEROIC,this.ID_SCENARIO_EVENT];const t=-2;const a=-1;const i=1;const n=2;const s=3;const r=4;const o=5;const l={};l[a]=this.ID_DUNGEON_NORMAL;l[t]=this.ID_DUNGEON_HEROIC;l[o]=this.ID_LEGACY_RAID_FINDER;l[i]=this.ID_LEGACY_10_PLAYER;l[n]=this.ID_LEGACY_25_PLAYER;l[s]=this.ID_LEGACY_10_PLAYER_HEROIC;l[r]=this.ID_LEGACY_25_PLAYER_HEROIC;this.comparator=function(t,a){var i=e.SORT_ORDER.indexOf(parseInt(t));var n=e.SORT_ORDER.indexOf(parseInt(a));if(i<0){if(n<0){return 0}return 1}if(n<0){return-1}return Math.sign(i-n)};this.convertLegacyDropDifficulty=function(e){return l[e]||e};this.getIds=function(){var e=[];for(var t in this){if(!this.hasOwnProperty(t)||typeof this[t]!="number"){continue}if(t.substr(0,3)==="ID_"){e.push(this[t])}}return e};this.getIconClass=function(e){let t=undefined;switch(e){case this.ID_DUNGEON_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t="icon-heroic";break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t="icon-mythic";break}return t};this.getName=function(e){var t="";switch(e){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_TBC_DUNGEON_NORMAL:t=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t=WH.TERMS.mythic;break;case this.ID_DUNGEON_CHALLENGE:t=WH.TERMS.mythicplus;break;case this.ID_DUNGEON_TIMEWALKING:t=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:t=WH.TERMS.raidfinder;break;case this.ID_LEGACY_10_PLAYER:case this.ID_TBC_10_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,10);break;case this.ID_LEGACY_25_PLAYER:case this.ID_TBC_25_PLAYER:t=WH.sprintf(WH.TERMS.normal_format,25);break;case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_WOTLK_10_PLAYER_HEROIC:t=WH.sprintf(WH.TERMS.heroic_format,10);break;case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_WOTLK_25_PLAYER_HEROIC:t=WH.sprintf(WH.TERMS.heroic_format,25);break;case this.ID_RAID_40_PLAYER:t=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:t=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break;case this.ID_SEASON_OF_MASTERY_DUNGEON:t=WH.TERMS.seasonOfMastery;break;case this.ID_SEASON_OF_MASTERY_20_PLAYER:t=WH.TERMS.player20SeasonOfMastery;break;case this.ID_SEASON_OF_MASTERY_40_PLAYER:t=WH.TERMS.player40SeasonOfMastery;break}return t||"["+e+"]"};this.getNameAbbrev=function(e){var t="";switch(e){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_TBC_DUNGEON_NORMAL:t=WH.TERMS.normal_abbrev;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:t=WH.TERMS.heroic_abbrev;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:t=WH.TERMS.mythic_abbrev;break;case this.ID_DUNGEON_TIMEWALKING:t=WH.TERMS.timewalking_abbrev;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:t=WH.TERMS.lookingforraid_abbrev;break;case this.ID_LEGACY_10_PLAYER:t="10"+WH.TERMS.normal_abbrev;break;case this.ID_TBC_10_PLAYER:t="10"+WH.TERMS.player.substr(0,1);break;case this.ID_LEGACY_25_PLAYER:t="25"+WH.TERMS.normal_abbrev;break;case this.ID_TBC_25_PLAYER:t="25"+WH.TERMS.player.substr(0,1);break;case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_WOTLK_10_PLAYER_HEROIC:t="10"+WH.TERMS.heroic_abbrev;break;case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_WOTLK_25_PLAYER_HEROIC:t="25"+WH.TERMS.heroic_abbrev;break;case this.ID_RAID_40_PLAYER:t="40";break;case this.ID_CLASSIC_RAID_20_PLAYER:t="20";break;case this.ID_SEASON_OF_MASTERY_DUNGEON:case this.ID_SEASON_OF_MASTERY_20_PLAYER:case this.ID_SEASON_OF_MASTERY_40_PLAYER:t=WH.TERMS.seasonOfMastery_abbrev;break}return t||"["+e+"]"};this.getNameShorthand=function(t){let a="";switch(t){case this.ID_NONE:case this.ID_DUNGEON_NORMAL:case this.ID_RAID_NORMAL:case this.ID_LEGACY_10_PLAYER:case this.ID_LEGACY_25_PLAYER:case this.ID_TBC_DUNGEON_NORMAL:a=WH.TERMS.normal;break;case this.ID_DUNGEON_HEROIC:case this.ID_RAID_HEROIC:case this.ID_LEGACY_10_PLAYER_HEROIC:case this.ID_LEGACY_25_PLAYER_HEROIC:case this.ID_TBC_DUNGEON_HEROIC:case this.ID_WOTLK_10_PLAYER_HEROIC:case this.ID_WOTLK_25_PLAYER_HEROIC:a=WH.TERMS.heroic;break;case this.ID_DUNGEON_MYTHIC:case this.ID_RAID_MYTHIC:a=WH.TERMS.mythic;break;case this.ID_DUNGEON_TIMEWALKING:a=WH.TERMS.timewalking;break;case this.ID_RAID_FINDER:case this.ID_LEGACY_RAID_FINDER:a=WH.TERMS.lookingforraid_abbrev;break;case this.ID_RAID_40_PLAYER:a=WH.GlobalStrings.RAID_DIFFICULTY_40PLAYER;break;case this.ID_CLASSIC_RAID_20_PLAYER:a=WH.GlobalStrings.RAID_DIFFICULTY_20PLAYER;break;case this.ID_TBC_10_PLAYER:case this.ID_TBC_25_PLAYER:a=e.getNameAbbrev(t);break;case this.ID_SEASON_OF_MASTERY_DUNGEON:a=WH.TERMS.seasonOfMastery_abbrev;break;case this.ID_SEASON_OF_MASTERY_20_PLAYER:a=WH.TERMS.seasonOfMastery_abbrev+WH.TERMS.wordspace_punct+"20";break;case this.ID_SEASON_OF_MASTERY_40_PLAYER:a=WH.TERMS.seasonOfMastery_abbrev+WH.TERMS.wordspace_punct+"40";break}return a||"["+t+"]"}};WH.Wow.Event=new function(){this.getNextEvent=function(e,t){t=t||new Date;for(let a in e){let i=e[a];if(new Date(i.end)>=t){return i}}return null}};WH.Wow.Expansion=new function(){const e=this;const t=WH.Wow;this.CLASSIC=0;this.TBC=1;this.WRATH=2;this.CATA=3;this.MOP=4;this.WOD=5;this.LEGION=6;this.BFA=7;this.SL=8;this.DF=9;this.LEVEL_CAP_RETAIL_CLASSIC=30;this.LEVEL_CAP_RETAIL_TBC=30;this.LEVEL_CAP_RETAIL_WRATH=30;this.LEVEL_CAP_RETAIL_CATA=35;this.LEVEL_CAP_RETAIL_MOP=35;this.LEVEL_CAP_RETAIL_WOD=40;this.LEVEL_CAP_RETAIL_LEGION=45;this.LEVEL_CAP_RETAIL_BFA=50;this.LEVEL_CAP_RETAIL_SL=60;this.LEVEL_CAP_RETAIL_DF=70;this.LEVEL_START_RETAIL_CATA=30;this.LEVEL_START_RETAIL_EXPANSION=10;const a={[this.CLASSIC]:"",[this.TBC]:"tbc",[this.WRATH]:"wotlk",[this.CATA]:"cata",[this.MOP]:"mop",[this.WOD]:"wod",[this.LEGION]:"legion",[this.BFA]:"bfa",[this.SL]:"sl",[this.DF]:"df"};const i={[this.CLASSIC]:[WH.TERMS.classic],[this.TBC]:[WH.TERMS.theburningcrusade_short,WH.TERMS.burningcrusade_abbrev],[this.WRATH]:[WH.TERMS.wrathofthelichking_short,WH.TERMS.wrathofthelichking_abbrev],[this.CATA]:[WH.TERMS.cataclysm_short,WH.TERMS.cataclysm_abbrev],[this.MOP]:[WH.TERMS.mistsofpandaria_short,WH.TERMS.mistsofpandaria_abbrev],[this.WOD]:[WH.TERMS.warlordsofdraenor_short,WH.TERMS.warlordsofdraenor_abbrev],[this.LEGION]:[WH.TERMS.legion_abbrev],[this.BFA]:[WH.TERMS.battleforazeroth_short,WH.TERMS.battleforazeroth_abbrev],[this.SL]:[WH.TERMS.shadowlands_expansion,WH.TERMS.shadowlands_abbrev],[this.DF]:[WH.TERMS.dragonflight_expansion,WH.TERMS.dragonflight_abbrev]};const n={[this.CLASSIC]:"classic",[this.TBC]:"theburningcrusade",[this.WRATH]:"wrathofthelichking",[this.CATA]:"cataclysm",[this.MOP]:"mistsofpandaria",[this.WOD]:"warlordsofdraenor",[this.LEGION]:"legion_expansion",[this.BFA]:"battleforazeroth",[this.SL]:"shadowlands_expansion",[this.DF]:"dragonflight_expansion"};const s={[this.CLASSIC]:"classic_abbrev",[this.TBC]:"theburningcrusade_short",[this.WRATH]:"wrathofthelichking_abbrev",[this.CATA]:"cataclysm_abbrev",[this.MOP]:"mistsofpandaria_abbrev",[this.WOD]:"warlordsofdraenor_abbrev",[this.LEGION]:"legion_abbrev",[this.BFA]:"battleforazeroth_abbrev",[this.SL]:"shadowlands_abbrev",[this.DF]:"dragonflight_abbrev"};const r={[this.CLASSIC]:"classic",[this.TBC]:"theburningcrusade_short",[this.WRATH]:"wrathofthelichking_short",[this.CATA]:"cataclysm_short",[this.MOP]:"mistsofpandaria_short",[this.WOD]:"warlordsofdraenor_short",[this.LEGION]:"legion_expansion",[this.BFA]:"battleforazeroth_short",[this.SL]:"shadowlands_short",[this.DF]:"dragonflight_short"};const o={availableExpansionsCache:{},currentExpansionsCache:{}};this.available=function(t,a){return e.get(a)>=t};this.get=function(e){e=e||WH.getDataEnv();if(o.availableExpansionsCache[e]){return o.availableExpansionsCache[e]}let t=l(WH.Wow.getVersionString(e));if(t===undefined){let t="Could not get expansion for data env. ["+e+"]";WH.error(t);throw t}o.availableExpansionsCache[e]=t;return t};this.getAbbreviation=function(e){return WH.TERMS[s[e]]||WH.TERMS.unknown};this.getAllAvailable=function(t){let a=e.get(t);let i=[];for(let e=0;e<=a;e++){i.push(e)}return i};this.getCurrent=t=>{t=t||WH.getDataEnv();if(o.currentExpansionsCache[t]){return o.currentExpansionsCache[t]}let a=e.getAllAvailable(t);a.sort(((e,t)=>t-e));let i=a.find((a=>e.isLaunched(a,t)));if(i==null){throw new Error(`No launched WoW expansions found in ${WH.getDataEnvKey(t)}.`)}o.currentExpansionsCache[t]=i;return i};this.getIconClass=function(e){if(!a[e]){return null}return"icon-"+a[e]};this.getName=function(e){return WH.TERMS[n[e]]||WH.TERMS.unknown};this.getRightIconClass=function(t){let a=e.getIconClass(t);return a?a+"-right":null};this.getSearchText=function(e){var t=i[e]||[];for(var a=1;a<t.length;a++){if(t[a-1]===t[a]){t.splice(a--,1)}}return t};this.getShortName=function(e){return WH.TERMS[r[e]]||WH.TERMS.unknown};this.isLaunched=(a,i)=>{i=i||WH.getDataEnv();if(a<e.get(i)){return true}let n=t.getVersionString(i).split(".").map((e=>parseInt(e)));return n[0]>=c(a)&&(n[1]>0||n[2]>1)};function l(e){let t=parseInt(e.substr(0,e.indexOf(".")));if(isNaN(t)){return undefined}return t-1}function c(e){return e+1}};WH.Wow.Faction=new function(){this.REP_LEVEL_REVERED=63e3;this.REP_RANK_HATED=0;this.REP_RANK_HOSTILE=1;this.REP_RANK_UNFRIENDLY=2;this.REP_RANK_NEUTRAL=3;this.REP_RANK_FRIENDLY=4;this.REP_RANK_HONORED=5;this.REP_RANK_REVERED=6;this.REP_RANK_EXALTED=7;this.getCategoryName=function(e){return g_faction_categories[e]};this.getRankName=function(e){return WH.getPageData("wow.faction.ranks")[e].name}};WH.Wow.Follower=new function(){this.FOLLOWER_TYPE_FOLLOWER=1;this.FOLLOWER_TYPE_SHIP=2;this.FOLLOWER_TYPE_LEGION_CHAMPION=4;this.FOLLOWER_TYPE_BFA_CHAMPION=22;this.FOLLOWER_TYPE_ADVENTURE_COMBATANT=123};WH.Wow.Gender=WH.defineEnum({Both:3,Female:1,Male:0,Neutral:4,None:2},(function(e){const t=this;const a=WH.Wow.Expansion;const i=WH.WebP;this.getIcon=function(){switch(t){case e.Female:return n()?"ui-charactercreate-body-2":"ui-charactercreate-gender-female";case e.Male:return n()?"ui-charactercreate-body-1":"ui-charactercreate-gender-male"}};this.getName=function(){if(t===e.Male&&n()){return WH.TERMS.body1}if(t===e.Female&&n()){return WH.TERMS.body2}return WH.TERMS[t.name.toLowerCase()]};this.getFilename=()=>t.name.toLowerCase();function n(){return!WH.isClassicTree()&&!WH.isTbcTree()}}));WH.Wow.Glyph=new function(){const e=1;const t=2;this.getTypeName=function(a){switch(a){case e:return WH.TERMS.major;case t:return WH.TERMS.minor;default:return WH.TERMS.unknown}}};WH.Wow.Item=new function(){const e=this;const t=WH.Wow.Difficulty;const a=WH.Wow.Expansion;this.CLASS_WEAPON=2;this.CLASS_GEM=3;this.CLASS_ARMOR=4;this.CLASS_QUEST=12;this.ARMOR_SUBCLASS_MISC=0;this.ARMOR_SUBCLASS_CLOTH=1;this.ARMOR_SUBCLASS_LEATHER=2;this.ARMOR_SUBCLASS_MAIL=3;this.ARMOR_SUBCLASS_PLATE=4;this.ARMOR_SUBCLASS_COSMETIC=5;this.ARMOR_SUBCLASS_SHIELDS=6;this.ARMOR_SUBCLASS_RINGS=-2;this.ARMOR_SUBCLASS_AMULETS=-3;this.ARMOR_SUBCLASS_TRINKETS=-4;this.ARMOR_SUBCLASS_OFF_HAND_FRILLS=-5;this.ARMOR_SUBCLASS_CLOAKS=-6;this.ARMOR_SUBCLASS_TABARDS=-7;this.ARMOR_SUBCLASS_SHIRTS=-8;this.WEAPON_SUBCLASS_ONE_HANDED_AXE=0;this.WEAPON_SUBCLASS_TWO_HANDED_AXE=1;this.WEAPON_SUBCLASS_BOW=2;this.WEAPON_SUBCLASS_GUN=3;this.WEAPON_SUBCLASS_ONE_HANDED_MACE=4;this.WEAPON_SUBCLASS_TWO_HANDED_MACE=5;this.WEAPON_SUBCLASS_POLEARM=6;this.WEAPON_SUBCLASS_ONE_HANDED_SWORD=7;this.WEAPON_SUBCLASS_TWO_HANDED_SWORD=8;this.WEAPON_SUBCLASS_WARGLAIVE=9;this.WEAPON_SUBCLASS_STAFF=10;this.WEAPON_SUBCLASS_FIST_WEAPON=13;this.WEAPON_SUBCLASS_MISCELLANEOUS=14;this.WEAPON_SUBCLASS_DAGGER=15;this.WEAPON_SUBCLASS_THROWN=16;this.WEAPON_SUBCLASS_CROSSBOW=18;this.WEAPON_SUBCLASS_WAND=19;this.WEAPON_SUBCLASS_FISHING_POLE=20;this.FLAGS2_APPEARANCE_UNCOLLECTIBLE=4194304;this.INVENTORY_TYPE_HEAD=1;this.INVENTORY_TYPE_NECK=2;this.INVENTORY_TYPE_SHOULDERS=3;this.INVENTORY_TYPE_SHIRT=4;this.INVENTORY_TYPE_CHEST=5;this.INVENTORY_TYPE_WAIST=6;this.INVENTORY_TYPE_LEGS=7;this.INVENTORY_TYPE_FEET=8;this.INVENTORY_TYPE_WRISTS=9;this.INVENTORY_TYPE_HANDS=10;this.INVENTORY_TYPE_FINGER=11;this.INVENTORY_TYPE_TRINKET=12;this.INVENTORY_TYPE_ONE_HAND=13;this.INVENTORY_TYPE_SHIELD=14;this.INVENTORY_TYPE_RANGED=15;this.INVENTORY_TYPE_BACK=16;this.INVENTORY_TYPE_TWO_HAND=17;this.INVENTORY_TYPE_BAG=18;this.INVENTORY_TYPE_TABARD=19;this.INVENTORY_TYPE_ROBE=20;this.INVENTORY_TYPE_MAIN_HAND=21;this.INVENTORY_TYPE_OFF_HAND=22;this.INVENTORY_TYPE_HELD_IN_OFF_HAND=23;this.INVENTORY_TYPE_PROJECTILE=24;this.INVENTORY_TYPE_THROWN=25;this.INVENTORY_TYPE_RANGED_RIGHT=26;this.INVENTORY_TYPE_QUIVER=27;this.INVENTORY_TYPE_RELIC=28;this.INVENTORY_TYPE_PROFESSION_TOOL=29;this.INVENTORY_TYPE_PROFESSION_ACCESSORY=30;this.INV_TYPES=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_NECK,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_FINGER,this.INVENTORY_TYPE_TRINKET,this.INVENTORY_TYPE_ONE_HAND,this.INVENTORY_TYPE_SHIELD,this.INVENTORY_TYPE_RANGED,this.INVENTORY_TYPE_BACK,this.INVENTORY_TYPE_TWO_HAND,this.INVENTORY_TYPE_BAG,this.INVENTORY_TYPE_TABARD,this.INVENTORY_TYPE_ROBE,this.INVENTORY_TYPE_MAIN_HAND,this.INVENTORY_TYPE_OFF_HAND,this.INVENTORY_TYPE_HELD_IN_OFF_HAND,this.INVENTORY_TYPE_PROJECTILE,this.INVENTORY_TYPE_THROWN,this.INVENTORY_TYPE_RANGED_RIGHT,this.INVENTORY_TYPE_QUIVER,this.INVENTORY_TYPE_RELIC,this.INVENTORY_TYPE_PROFESSION_TOOL,this.INVENTORY_TYPE_PROFESSION_ACCESSORY];this.QUALITY_DEFAULT="";this.QUALITY_POOR=0;this.QUALITY_COMMON=1;this.QUALITY_UNCOMMON=2;this.QUALITY_RARE=3;this.QUALITY_EPIC=4;this.QUALITY_LEGENDARY=5;this.QUALITY_ARTIFACT=6;this.QUALITY_HEIRLOOM=7;this.QUALITY_WOW_TOKEN=8;this.QUALITY_GLYPH=9;this.QUALITY_FAIL=10;this.QUALITY_SET_BONUSES=13;this.WRATH_ARMOR_SCALING_INDEXES={[e.ARMOR_SUBCLASS_CLOTH]:{[e.INVENTORY_TYPE_SHOULDERS]:12,[e.INVENTORY_TYPE_CHEST]:16,[e.INVENTORY_TYPE_HEAD]:20,[e.INVENTORY_TYPE_LEGS]:24},[e.ARMOR_SUBCLASS_LEATHER]:{[e.INVENTORY_TYPE_SHOULDERS]:13,[e.INVENTORY_TYPE_CHEST]:17,[e.INVENTORY_TYPE_HEAD]:21,[e.INVENTORY_TYPE_LEGS]:25},[e.ARMOR_SUBCLASS_MAIL]:{[e.INVENTORY_TYPE_SHOULDERS]:14,[e.INVENTORY_TYPE_CHEST]:18,[e.INVENTORY_TYPE_HEAD]:22,[e.INVENTORY_TYPE_LEGS]:26},[e.ARMOR_SUBCLASS_PLATE]:{[e.INVENTORY_TYPE_SHOULDERS]:15,[e.INVENTORY_TYPE_CHEST]:19,[e.INVENTORY_TYPE_HEAD]:23,[e.INVENTORY_TYPE_LEGS]:27},[e.ARMOR_SUBCLASS_CLOAKS]:{[e.INVENTORY_TYPE_BACK]:28},[e.ARMOR_SUBCLASS_SHIELDS]:{[e.INVENTORY_TYPE_SHIELD]:29}};this.SCALING_STATS_DISTRIBUTION_STAT_MAX=10;this.ITEM_SCALING_VALUE_SPELL_POWER_INDEX=6;this.DBCITEM_FLAGS_SCALING_SPELL_POWER=32768;const i=[this.INVENTORY_TYPE_HEAD,this.INVENTORY_TYPE_SHOULDERS,this.INVENTORY_TYPE_SHIRT,this.INVENTORY_TYPE_CHEST,this.INVENTORY_TYPE_WAIST,this.INVENTORY_TYPE_LEGS,this.INVENTORY_TYPE_FEET,this.INVENTORY_TYPE_WRISTS,this.INVENTORY_TYPE_HANDS,this.INVENTORY_TYPE_ROBE];const n=[e.ARMOR_SUBCLASS_CLOTH,e.ARMOR_SUBCLASS_LEATHER,e.ARMOR_SUBCLASS_MAIL,e.ARMOR_SUBCLASS_PLATE];const s={};const r=WH.getPageData("wow.item.slotToInvTypes");var o={default:{"":"ffd100",0:"9d9d9d",1:"ffffff",2:"1eff00",3:"0070dd",4:"a335ee",5:"ff8000",6:"e5cc80",7:"00ccff",8:"00ccff",9:"71d5ff",10:"ff4040",13:"ffff98"},thottbot:{"":"e5c017",0:"777777",1:"000000",2:"00bb00",3:"0070dd",4:"a335ee",5:"ff8000",6:"998856",7:"00ccff",8:"00ccff",9:"4f95b3",10:"ff4040",13:"99995c"}};var l={"":"default",0:"poor",1:"common",2:"uncommon",3:"rare",4:"epic",5:"legendary",6:"artifact",7:"heirloom",8:"wowtoken",9:"glyph",10:"error",13:"setbonuses"};const c={1:WH.TERMS.arena,2:WH.TERMS.battleground,4:WH.TERMS.world};const u=[e.WEAPON_SUBCLASS_BOW,e.WEAPON_SUBCLASS_GUN,e.WEAPON_SUBCLASS_THROWN,e.WEAPON_SUBCLASS_CROSSBOW,e.WEAPON_SUBCLASS_WAND];const d={invTypeNames:undefined,nameDescriptions:undefined};this.getArmorSubclasses=function(){let t=n.slice();if(a.available(a.MOP)){t.push(e.ARMOR_SUBCLASS_COSMETIC)}return t};this.getBondTypeName=function(e){return{1:WH.GlobalStrings.ITEM_BIND_ON_PICKUP,2:WH.GlobalStrings.ITEM_BIND_ON_EQUIP,3:WH.GlobalStrings.ITEM_BIND_ON_USE,4:WH.GlobalStrings.ITEM_BIND_QUEST,5:WH.GlobalStrings.ITEM_BIND_QUEST}[e]||WH.TERMS.unknownBindType_stc};this.getClassName=function(e,t){if(t!=null){return(g_item_subclasses[e]||{})[t]}else{return g_item_classes[e]}};this.getSlotsToInvTypes=function(){return r[WH.getDataEnv()]||r[WH.getRootEnv()]};this.getInvTypeName=function(e){d.invTypeNames=d.invTypeNames||WH.getPageData("wow.item.invTypeNames")||{};return d.invTypeNames[e]};this.getInvTypeSlots=function(e){let t=WH.getDataEnv();if(!s[t]){s[t]={};let e=r[t]||r[WH.getRootEnv()];for(let a in e){if(!e.hasOwnProperty(a)){continue}for(let i=0,n;n=e[a][i];i++){if(!s[t][n]){s[t][n]=[]}s[t][n].push(parseInt(a))}}}return s[t][e]||[]};this.getNameDescription=function(e){return(f()[e]||{}).name||null};this.getNameDescriptionColor=function(e){return(f()[e]||{}).color||null};this.getQualityClass=function(e){let t=o[WH.Theme.getTheme()]||o["default"];return t[e]?`q${e}`:""};this.getQualityColor=function(t,a){var i=a?o["default"]:o[WH.Theme.getTheme()]||o["default"];var n=i[t]||i[e.QUALITY_DEFAULT];return"#"+n};this.getQualityName=function(e){return WH.TERMS[l[e]]||WH.TERMS.unknown};this.getSourceCategory=function(e,t){switch(e){case 2:if(t.bd){return WH.TERMS.bossdrop}if(t.z){return WH.TERMS.zonedrop}break;case 4:return WH.TERMS.quests;case 5:return WH.TERMS.vendors}return g_sources[e]||""};this.getSourceDescription=function(e,a){switch(e){case 3:if(a.p&&c[a.p]){return{text:c[a.p]}}break}switch(a.t||0){case 0:case 1:case 2:if(a.z){var i={url:WH.Entity.getUrl(WH.Types.ZONE,a.z,WH.Wow.Area.getName(a.z)),text:WH.Wow.Area.getName(a.z)};if(a.t&&e==5){i.pretext=WH.TERMS.vendorin}if(a.dd){let e=t.getNameAbbrev(t.convertLegacyDropDifficulty(a.dd));i.posttext=WH.Strings.sprintf(WH.TERMS.parens_format,"",e)}return i}break;case 5:return{url:WH.Url.generate("/quests="+a.c2+"."+a.c),text:WH.Wow.Quest.getCategoryName(a.c)};break;case 6:if(a.c&&a.s){return{url:WH.Url.generate("/spells="+a.c+"."+a.s),text:WH.Wow.Skill.getName(a.s)}}else{return{url:WH.Url.generate("/spells=0"),text:"??"}}break}};this.getThumbUrl=function(e,t,a){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(a)+"/webthumbs/item/"+(e&255)+"/"+e+(t?"-"+t:"")+WH.WebP.getImageExtension()};this.getTypeNameAndUrl=function(e,t,a){if(g_item_subsubclasses.hasOwnProperty(e)&&g_item_subsubclasses[e].hasOwnProperty(t)&&g_item_subsubclasses[e][t].hasOwnProperty(a)){return{url:WH.Url.generatePath("/items="+e+"."+t+"."+a),text:g_item_subsubclasses[e][t][a]}}if(g_item_subclasses.hasOwnProperty(e)&&g_item_subclasses[e].hasOwnProperty(t)){return{url:WH.Url.generatePath("/items="+e+"."+t),text:g_item_subclasses[e][t]}}if(g_item_classes.hasOwnProperty(e)){return{url:WH.Url.generatePath("/items="+e),text:g_item_classes[e]}}WH.error("Could not find item class name for: "+JSON.stringify({itemClass:e,itemSubClass:t,itemSubSubClass:a}));return{url:WH.Url.generatePath("/items"),text:WH.TERMS.unknown}};this.getWeaponSubclasses=function(){let t=WH.cOr({},g_item_subclasses[WH.Wow.Item.CLASS_WEAPON]);if(!a.available(a.LEGION)){delete t[e.WEAPON_SUBCLASS_WARGLAIVE]}if(a.available(a.MOP)){delete t[e.WEAPON_SUBCLASS_THROWN]}let i=Object.keys(t).map(Number);i.sort((function(e,t){return e-t}));e.getWeaponSubclasses=function(e){return e}.bind(this,i);return i};this.isArmorInvType=function(e){return i.includes(e)};this.isBodyArmor=function(t,a){return t===e.CLASS_ARMOR&&n.includes(a)};this.isRangedWeaponSubclass=function(e){return u.includes(e)};this.tooltipHasSpecStats=function(e){const t=WH.Wow.Item.Stat;let a=/<span[^>]*?><!--stat(\d+)-->([-+][\d\.,]+(?:-[\d\.,]+)?\D*?)<\/span>/gi;let i=a.exec(e);while(i!=null){if(g_grayedOutStats.hasOwnProperty(i[1])||[t.ID_AGI_STR_INT,t.ID_AGI_STR,t.ID_AGI_INT,t.ID_STR_INT].includes(parseInt(i[1]))){return true}i=a.exec(e)}return e.indexOf("\x3c!--traitspec")>0};function f(){return d.nameDescriptions=d.nameDescriptions||WH.getPageData("wow.item.bonusNameDescriptions")||{}}};WH.Links=new function(){const e=WH.Game;const t=WH.Gatherer;const a=WH.Wow.Item;const i=WH.ShareServices;const n=WH.Theme;this.show=function(u,d,f){u.blur();if(u.addedLinksMenu&&!d.alwaysRefresh){return}let h=[];h.push(Menu.createHeading({label:WH.TERMS.clickToCopy}));h.push([0,WH.TERMS.link,WH.copyToClipboard.bind(null,location.href),null,{fontIcon:"link"}]);let p=d.type&&d.typeId&&WH.markup.Tags.getByEntityType(d.type);if(p){h.push([0,WH.TERMS.wowheadMarkupTag,WH.copyToClipboard.bind(null,WH.markup.Tags.getWhml(p,d.typeId,d)),null,{icon:n.getFaviconUrl()}])}let m=r(d);if(m){h.push([0,WH.TERMS.inGameLink,WH.copyToClipboard.bind(null,m),null,{icon:"/images/icons/wow.png"}])}let H=s(d);if(H){h.push([0,WH.TERMS.inGameDressingRoomCommand,WH.copyToClipboard.bind(null,H),null,{icon:"/images/icons/wow.png"}])}let g=o(d);if(g){h.push([0,WH.TERMS.inGameSoundCommand,WH.copyToClipboard.bind(null,g),null,{icon:"/images/icons/wow.png"}])}let W=l(d);if(W){h.push([0,WH.TERMS.mogItImportString,WH.copyToClipboard.bind(null,W),null,{fontIcon:"code"}])}let E=c(d);if(E){h.push([0,WH.TERMS.simulationCraftImportString,WH.copyToClipboard.bind(null,E),null,{fontIcon:"code"}])}if(d.typeId){h.push(Menu.createItem({label:WH.term("id_format",WH.Types.getUpperSingular(d.type))+WH.TERMS.colon_punct+d.typeId,url:WH.copyToClipboard.bind(null,d.typeId),options:{fontIcon:"hashtag"}}))}if(u.dataset.displayId){h.push(Menu.createItem({label:WH.TERMS.displayId+WH.TERMS.colon_punct+u.dataset.displayId,url:function(e){let t=WH.ge("wh-mv-view-in-3d-button");let a=t&&t.dataset.mvDisplayId||u.dataset.displayId;WH.copyToClipboard(a,e)},options:{fontIcon:"hashtag"}}))}if(WH.User.hasRole(U_GROUP_STAFF)){let e=[Menu.createHeading({label:WH.term("parens_format",WH.TERMS.clickToCopy,WH.TERMS.staffemployees)})];if(u.dataset.modelMarkup){e.push(Menu.createItem({label:"Model Markup",url:WH.copyToClipboard.bind(null,u.dataset.modelMarkup)}))}if(u.dataset.displayId){let i=parseInt(u.dataset.displayId);if(u.dataset.modelEntityType==WH.Types.NPC){let t=WH.STATIC_URL+WH.Wow.ModelViewer.getStaticBase()+"/webthumbs/npc-row/"+(i&255)+"/"+i+".jpg";e.push(Menu.createItem({label:"NPC Row Image",url:WH.copyToClipboard.bind(null,t),options:{tooltip:t}}))}if(u.dataset.modelEntityType==WH.Types.ITEM){let n=t.get(WH.Types.ITEM,parseInt(u.dataset.modelEntityId));if(n&&n.classs===a.CLASS_WEAPON){let t=WH.STATIC_URL+WH.Wow.ModelViewer.getStaticBase()+"/webthumbs/item-large/"+(i&255)+"/"+i+".jpg";e.push(Menu.createItem({label:"Item Large Image",url:WH.copyToClipboard.bind(null,t),options:{tooltip:t}}))}}}let i=WH.Wow.ModelViewer.getModelScreenshotUrl();if(i){e.push(Menu.createItem({label:"Model Image URL",url:function(e){WH.copyToClipboard(i.replace(/\.webp$/,".png"),e)},options:{fontIcon:"picture-o"}}))}if(e.length>1){h=h.concat(e)}}h.push(Menu.createHeading({label:WH.TERMS.share}));i.getShareServices(location.href,i.getSubredditByGame(e.get())).forEach((e=>{h.push(Menu.createItem({label:e.name,url:e.url,options:{fontIcon:e.fontIcon,newWindow:true}}))}));u.addedLinksMenu=true;if(Menu.hasMenu(u)){Menu.replace(u,h)}else{Menu.add(u,h,{showAtElement:true,showImmediately:true},f)}};function s(e){if(!e.dressup||!e.dressup.length){return null}var t='/run local function f(i,b)DressUpItemLink("item:"..i.."::::::::::::9:"..b);end;';for(var a=0,i=e.dressup.length;a<i;a++){var n=e.dressup[a].slice(0);while(n.length<2){n.push(0)}t+="f("+n.shift()+","+(n.length>1?'"'+n.join(":")+'"':n.shift())+");"}return t}function r(e){if(!(e.linkColor&&e.linkId&&e.linkName)){return null}var t=e.linkName.replace(/:+$/,"").replace(/"/g,'\\"');return"/script DEFAULT_CHAT_FRAME:AddMessage("+'"\\124c'+e.linkColor+"\\124H"+e.linkId+"\\124h["+t+']\\124h\\124r");'}function o(e){return e.sound?"/script PlaySound("+e.sound+")":null}function l(e){if(!e.dressup||!e.dressup.length){return null}var t="";for(var a=0,i=e.dressup.length;a<i;a++){var n=e.dressup[a];if(n[0]){t+=(t?":":"compare?items=")+n[0];if(n[1]){t+=".0.0.0.0.0.0.0.0.0."+n[1]}}}return t||null}function c(e){if(e.type!==WH.Types.ITEM||!e.slot){return null}var t=u(parseInt(e.slot));if(!t){return null}var a=t+"="+e.linkName.toLowerCase().replace(/ /g,"_").replace(/[^+.%\w]/g,"")+",id="+e.typeId;if(e.bonuses&&e.bonuses.length&&e.bonuses[0]!=0){a+=",bonus_id="+e.bonuses.join("/")}if(e.dropLevel){a+=",drop_level="+e.dropLevel}return a}function u(e){for(var t in g_character_slots_data){if(g_character_slots_data.hasOwnProperty(t)&&g_character_slots_data[t].itemSlots.indexOf(e)!==-1){return g_character_slots_data[t].simCraftName||g_character_slots_data[t].name}}return null}};WH.Wow.ItemSet=new function(){this.getThumbUrl=function(e,t,a,i){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(i)+"/webthumbs/item-set/"+t+"/"+a+"/"+(Math.abs(e)&255)+"/"+e+WH.WebP.getImageExtension()}};WH.Wow.MissionAbility=new function(){const e={types:undefined};this.getTypeName=function(t,a){e.types=e.types||WH.getPageData("wow.missionAbility.types")||{};return e.types[t]&&e.types[t][a]||undefined};this.getTypeNames=function(t){e.types=e.types||WH.getPageData("wow.missionAbility.types")||{};return e.types[t]}};WH.Wow.Models=new function(){this.getRaceIdFromMask=function(e){if(e){let t=WH.Wow.Race.getIdsFromMask(e);if(t.length){t.sort(((e,t)=>e-t));return t[0]}}return null};this.isPepeEnabled=function(){return WH.isRetailTree()}};WH.Wow.Npc=new function(){const e=this;const t=[71953,72057,71952,71954,71955];this.getThumbUrl=function(e,t){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(t)+"/webthumbs/npc/"+(e&255)+"/"+e+WH.WebP.getImageExtension()};this.getTypeName=function(t){return e.getTypeNames()[t]};this.getTypeNames=function(){return WH.getPageData("wow.npc.types")};this.usesPersonalLootOutdoors=e=>t.includes(e);this.typeExists=function(t){return e.getTypeNames()[t]!==undefined}};WH.Wow.Pet=new function(){const e=WH.getPageData("wow.pet.names")||{};this.getName=function(t){return e[t]||null}};WH.Wow.PlayerClass=new function(){const e=this;const t=WH.Game;const a=WH.Wow.Item;this.DEATH_KNIGHT=6;this.DEMON_HUNTER=12;this.DRUID=11;this.EVOKER=13;this.HUNTER=3;this.MAGE=8;this.MONK=10;this.PALADIN=2;this.PRIEST=5;this.ROGUE=4;this.SHAMAN=7;this.WARLOCK=9;this.WARRIOR=1;const i=WH.getPageData("wow.playerClass.raceIds")||{};const n={[WH.dataEnv.CLASSIC]:[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.TBC]:[this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.WRATH]:[this.DEATH_KNIGHT,this.DRUID,this.HUNTER,this.MAGE,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR],[WH.dataEnv.MAIN]:[this.DEATH_KNIGHT,this.DEMON_HUNTER,this.DRUID,this.EVOKER,this.HUNTER,this.MAGE,this.MONK,this.PALADIN,this.PRIEST,this.ROGUE,this.SHAMAN,this.WARLOCK,this.WARRIOR]};const s={[this.DEATH_KNIGHT]:"deathknight",[this.DEMON_HUNTER]:"demonhunter",[this.DRUID]:"druid",[this.EVOKER]:"evoker",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.MONK]:"monk",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"};const r=WH.getPageData("wow.playerClass.names")||{};const o={};o[a.ARMOR_SUBCLASS_CLOTH]=[this.MAGE,this.PRIEST,this.WARLOCK];o[a.ARMOR_SUBCLASS_LEATHER]=[this.DEMON_HUNTER,this.DRUID,this.MONK,this.ROGUE];o[a.ARMOR_SUBCLASS_MAIL]=[this.EVOKER,this.HUNTER,this.SHAMAN];o[a.ARMOR_SUBCLASS_PLATE]=[this.DEATH_KNIGHT,this.PALADIN,this.WARRIOR];const l={[WH.dataEnv.CLASSIC]:{[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.TBC]:{[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.WRATH]:{[this.DEATH_KNIGHT]:"death-knight",[this.DRUID]:"druid",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"},[WH.dataEnv.MAIN]:{[this.DEATH_KNIGHT]:"death-knight",[this.DEMON_HUNTER]:"demon-hunter",[this.DRUID]:"druid",[this.EVOKER]:"evoker",[this.HUNTER]:"hunter",[this.MAGE]:"mage",[this.MONK]:"monk",[this.PALADIN]:"paladin",[this.PRIEST]:"priest",[this.ROGUE]:"rogue",[this.SHAMAN]:"shaman",[this.WARLOCK]:"warlock",[this.WARRIOR]:"warrior"}};const c={colorCache:undefined};this.canBeRace=function(t,a){if(!i[t]){WH.error("Class not available in current data env.",e.getName(t)||t,WH.getDataEnvKey());return false}return i[t].indexOf(a)>-1};this.exists=function(e,t){return this.getAll(t).includes(e)};this.getAll=function(e){e=e||t.getEnv(t.WOW);let a=n[e]||n[WH.getRootEnv(e)]||n[t.getEnv(t.WOW)];if(!a){WH.error("No classes defined for "+WH.getDataEnvKey()+".");return[]}return a.slice()};this.getBySlug=function(e,t){let a=u(t);for(let t in a){if(a[t]===e){return parseInt(t)}}return undefined};this.getBySpec=function(t,a){return e.Specialization.getClassId(t,a)};this.getColor=function(t){if(!c.colorCache){let t=e=>"#"+e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.?\d*))?\)$/).slice(1).map(((e,t)=>(t===3?Math.round(parseFloat(e)*255):parseFloat(e)).toString(16).padStart(2,"0").replace("NaN",""))).join("");let a=WH.dataEnv.BETA;WH.Tooltip.prepare(a);let i=WH.Tooltips.getTd();c.colorCache={};e.getAll(a).forEach((e=>{let a=WH.ce("span",{className:"c"+e},WH.ct("text"));WH.ae(i,a);c.colorCache[e]=t(getComputedStyle(a).getPropertyValue("color"))}));WH.Tooltip.hide()}if(!c.colorCache[t]){throw new Error("Invalid WoW class ID: "+t)}return c.colorCache[t]};this.getIconName=function(e){return"class_"+s[e]};this.getIdString=function(e){return s[e]};this.getName=function(e){return r[e]||null};this.getPreferredArmorSubclass=function(e){for(let t in o){if(o[t].includes(e)){return parseInt(t)}}return undefined};this.getSlug=function(e,t){return u(t)[e]};this.removeClasses=function(e){let t=/^c1?\d$/;e.classList.forEach((function(e,a,i){if(t.test(e)){i.remove(e)}}))};function u(e){return l[e]||l[WH.getRootEnv(e)]||l[t.getEnv(t.WOW)]}function d(){for(let t in n){n.hasOwnProperty(t)&&n[t].sort((function(t,a){return(e.getName(t)||"").localeCompare(e.getName(a)||"")}))}}d()};WH.Wow.Quest=new function(){const e=WH.getPageData("wow.quest.categoryNames")||{};const t=WH.getPageData("wow.quest.types")||{};this.getCategoryName=function(t){return e[t]};this.getTypeName=function(e){return t[e]||null};this.roundQuestXp=function(e){if(e==undefined){return e}let t=e<1e3?10:50;return Math.round(e/t)*t}};WH.Wow.Race=new function(){const e=this;const t=WH.Game;const a=WH.Wow.Gender;const i=WH.Wow;this.ID_BLOOD_ELF=10;this.ID_BROKEN=14;this.ID_DARK_IRON_DWARF=34;this.ID_DRACTHYR_ALLIANCE=52;this.ID_DRACTHYR_HORDE=70;this.ID_DRACTHYR_VISAGE_ALLIANCE=75;this.ID_DRACTHYR_VISAGE_HORDE=76;this.ID_DRAENEI=11;this.ID_DWARF=3;this.ID_FEL_ORC=12;this.ID_FOREST_TROLL=18;this.ID_GNOME=7;this.ID_GOBLIN=9;this.ID_HIGHMOUNTAIN_TAUREN=28;this.ID_HUMAN=1;this.ID_ICE_TROLL=21;this.ID_KUL_TIRAN=32;this.ID_LIGHTFORGED_DRAENEI=30;this.ID_MAGHAR_ORC=36;this.ID_MECHAGNOME=37;this.ID_NIGHT_ELF=4;this.ID_NIGHTBORNE=27;this.ID_NORTHREND_SKELETON=20;this.ID_ORC=2;this.ID_PANDAREN_ALLIANCE=25;this.ID_PANDAREN_HORDE=26;this.ID_PANDAREN_NEUTRAL=24;this.ID_SKELETON=15;this.ID_TAUNKA=19;this.ID_TAUREN=6;this.ID_THIN_HUMAN=33;this.ID_TROLL=8;this.ID_TUSKARR=17;this.ID_UNDEAD=5;this.ID_VOID_ELF=29;this.ID_VRYKUL=16;this.ID_VULPERA=35;this.ID_WORGEN=22;this.ID_ZANDALARI_TROLL=31;const n=WH.getPageData("wow.race.files")||{};const s=WH.getPageData("wow.race.masks")||{};const r={[this.ID_BROKEN]:a.Male,[this.ID_FEL_ORC]:a.Male,[this.ID_FOREST_TROLL]:a.Male,[this.ID_ICE_TROLL]:a.Male,[this.ID_NORTHREND_SKELETON]:a.Male,[this.ID_SKELETON]:a.Male,[this.ID_TAUNKA]:a.Male,[this.ID_THIN_HUMAN]:a.Male,[this.ID_TUSKARR]:a.Male,[this.ID_VRYKUL]:a.Male};const o=1101;const l=690;const c=o|l;const u=WH.getPageData("wow.race.names");const d=WH.getPageData("wow.race.ids");const f=[e.ID_DRAENEI,e.ID_DARK_IRON_DWARF,e.ID_DWARF,e.ID_DRACTHYR_ALLIANCE,e.ID_DRACTHYR_VISAGE_ALLIANCE,e.ID_GNOME,e.ID_HUMAN,e.ID_KUL_TIRAN,e.ID_LIGHTFORGED_DRAENEI,e.ID_MECHAGNOME,e.ID_NIGHT_ELF,e.ID_PANDAREN_ALLIANCE,e.ID_VOID_ELF,e.ID_WORGEN];const h=[e.ID_BLOOD_ELF,e.ID_DRACTHYR_HORDE,e.ID_DRACTHYR_VISAGE_HORDE,e.ID_GOBLIN,e.ID_HIGHMOUNTAIN_TAUREN,e.ID_MAGHAR_ORC,e.ID_NIGHTBORNE,e.ID_ORC,e.ID_PANDAREN_HORDE,e.ID_TAUREN,e.ID_TROLL,e.ID_UNDEAD,e.ID_VULPERA,e.ID_ZANDALARI_TROLL];var p={};p[WH.dataEnv.MAIN]={11:"draenei",34:"dark-iron-dwarf",[this.ID_DRACTHYR_ALLIANCE]:"alliance-dracthyr",3:"dwarf",7:"gnome",1:"human",32:"kul-tiran",30:"lightforged-draenei",37:"mechagnome",4:"night-elf",25:"alliance-pandaren",29:"void-elf",22:"worgen",10:"blood-elf",[this.ID_DRACTHYR_HORDE]:"horde-dracthyr",9:"goblin",28:"highmountain-tauren",36:"maghar-orc",27:"nightborne",2:"orc",26:"horde-pandaren",6:"tauren",8:"troll",5:"undead",35:"vulpera",31:"zandalari-troll",24:"pandaren"};p[WH.dataEnv.CLASSIC]={3:"dwarf",7:"gnome",1:"human",4:"night-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};p[WH.dataEnv.TBC]={11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"night-elf",10:"blood-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};p[WH.dataEnv.WRATH]={11:"draenei",3:"dwarf",7:"gnome",1:"human",4:"night-elf",10:"blood-elf",2:"orc",6:"tauren",8:"troll",5:"undead"};const m={localeSortedIds:undefined,localeSortedIdsAll:undefined};this.exists=function(e,a){a=a||t.getEnv(t.WOW);if(!d){return H(a)[e]!==undefined}return d[a].includes(e)};this.getAll=function(){let e=[];let t=H();for(let a in t){if(t.hasOwnProperty(a)){e.push(parseInt(a))}}return e};this.getFileName=function(e){return n[e]};this.getGenders=function(e){return r.hasOwnProperty(e)?[r[e]]:[a.Male,a.Female]};this.getIcon=function(t,i){if(!e.isPlayableRace(t)){return undefined}let n=e.getFileName(t);if(!n){return undefined}i=i||a.Male;i=e.validateGender(t,i);return"race_"+n+"_"+i.getFilename()};this.getIdFromSlug=function(e){let t=H();for(var a in t){if(!t.hasOwnProperty(a)){continue}if(t[a]===e){return parseInt(a)}}return undefined};this.getIdsFromMask=function(t){let a=[];if(t<0){WH.error("Race mask expected to be non-negative.",t);return a}let i=4294967295;if(t>i){if(window.BigInt){a=a.concat(Object.keys(s).filter((e=>s[e]>i&&BigInt(s[e])&BigInt(t))).map((e=>parseInt(e))))}else{WH.warn("Unable to check bits above 32 on large mask.",t)}t=t&i}a=a.concat(Object.keys(s).filter((e=>s[e]&t)).map((e=>parseInt(e))));return a.sort(((t,a)=>e.getName(t).localeCompare(e.getName(a))))};this.getName=function(t){return e.getNames()[t]};this.getNames=()=>u;this.getPlayableRaceIds=function(t){var a=t?"localeSortedIdsAll":"localeSortedIds";if(m[a]){return m[a]}var i=[];let n=H();for(var s in n){if(n.hasOwnProperty(s)&&(t===true||s!=e.ID_PANDAREN_ALLIANCE&&s!=e.ID_PANDAREN_HORDE)){i.push(parseInt(s))}}i.sort((function(t,a){return WH.stringCompare(e.getName(t),e.getName(a))}));m[a]=i;return i};this.getRequiredGender=function(e){return r[e]};this.getSide=function(e){if((e&c)===o){return i.SIDE_ALLIANCE}else if((e&c)===l){return i.SIDE_HORDE}return undefined};this.getSideByRaceId=function(e){if(f.includes(e)){return i.SIDE_ALLIANCE}if(h.includes(e)){return i.SIDE_HORDE}};this.getSlug=function(e){return H()[e]};this.getUnique=function(){return e.getAll().filter((function(t){return![e.ID_PANDAREN_ALLIANCE,e.ID_PANDAREN_HORDE].includes(t)}))};this.isPlayableRace=function(t){return e.getSlug(t)!==undefined};this.validateGender=function(t,a){let i=e.getGenders(t);if(i.includes(a)){return a}return i[Math.floor(Math.random()*i.length)]};function H(e){e=e||t.getEnv(t.WOW);return p[e]||p[WH.getRootEnv(e)]||p[t.getEnv(t.WOW)]}};WH.Wow.Realm=new function(){const e={callbacks:[],dataRequested:false};this.fetchData=function(a){if(window["g_bnet_realms"]){window.requestAnimationFrame(a);return}if(e.dataRequested){e.callbacks.push(a);return}let i=WH.ajaxIshRequest(WH.Url.getDataPageUrl("realms"));if(i){WH.aE(i,"load",t);if(a){e.callbacks.push(a)}}e.dataRequested=true};this.getAll=function(){return window["g_bnet_realms"]||null};this.getSlugByName=function(e,t){var a=this.getAll();if(!a){return null}a=a[e.toUpperCase()];if(!a){return null}var i="name_"+Locale.getName();t=t.toLocaleLowerCase();for(var n in a){if(!a.hasOwnProperty(n)){continue}var s=a[n];if(s.name.toLocaleLowerCase()===t){return s.slug}if(s[i]&&s[i].toLocaleLowerCase()===t){return s.slug}}return null};function t(){if(!window["g_bnet_realms"]){WH.error("The realm data failed to load.");return}while(e.callbacks.length){var t=e.callbacks.shift();try{t()}catch(e){WH.error("Realm data loading callback error:",e)}}}};WH.Wow.Skill=new function(){this.CATEGORY_TALENTS=-2;this.CATEGORY_PROFICIENCIES=-11;this.CATEGORY_SPECIALIZATION=-12;this.CATEGORY_GLYPHS=-13;this.ID_DEFENSE=95;this.ID_RIDING=762;this.ID_AXES=44;this.ID_BOWS=45;this.ID_CROSSBOWS=226;this.ID_DAGGERS=173;this.ID_FIST_WEAPONS=473;this.ID_GUNS=46;this.ID_MACES=54;this.ID_POLEARMS=229;this.ID_STAVES=136;this.ID_SWORDS=43;this.ID_THROWN=176;this.ID_TWO_HANDED_AXES=172;this.ID_TWO_HANDED_MACES=160;this.ID_TWO_HANDED_SWORDS=55;this.ID_UNARMED=162;this.ID_WANDS=228;const e=WH.getPageData("wow.skill.categoryNames")||{};const t=WH.getPageData("wow.skill.names")||{};this.getCategoryName=function(t){return e[t]||null};this.getName=function(e){return t[e]||null}};WH.Wow.Spell=new function(){const e=this;this.AURA_EFFECT_MOD_DAMAGE_DONE=13;this.AURA_EFFECT_MOD_RESISTANCE=22;this.AURA_EFFECT_MOD_STAT=29;this.AURA_EFFECT_MOD_SKILL_TEMPORARY=30;this.AURA_EFFECT_INCREASE_MAX_HEALTH_FLAT=34;this.AURA_EFFECT_MOD_PARRY_PCT=47;this.AURA_EFFECT_MOD_DODGE_PCT=49;this.AURA_EFFECT_MOD_BLOCK_PCT=51;this.AURA_EFFECT_MOD_MELEE_RANGED_CRIT_PCT=52;this.AURA_EFFECT_MOD_MELEE_RANGED_HIT_CHANCE_PCT=54;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT=55;this.AURA_EFFECT_MOD_SPELL_CRIT_PCT=57;this.AURA_EFFECT_MOD_SPELL_HASTE_PCT=65;this.AURA_EFFECT_MOD_SPELL_CRIT_PCT2=71;this.AURA_EFFECT_MOD_DAMAGE_DONE_PCT=79;this.AURA_EFFECT_POWER_REGEN=85;this.AURA_EFFECT_MOD_SKILL=98;this.AURA_EFFECT_MOD_MELEE_ATTACK_POWER=99;this.AURA_EFFECT_ADD_MODIFIER_FLAT=107;this.AURA_EFFECT_REDUCE_TARGET_RESISTANCES_FLAT=123;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER=124;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_POWER_PCT=132;this.AURA_EFFECT_MOD_INCREASE_MAXIMUM_HEALTH_PCT=133;this.AURA_EFFECT_ALLOW_PCT_OF_MANA_REGENERATION_TO_CONTINUE_IN_COMBAT=134;this.AURA_EFFECT_MOD_HEALING_POWER=135;this.AURA_EFFECT_MOD_STAT_PCT2=137;this.AURA_EFFECT_MOD_MELEE_ATTACK_SPEED_PCT=138;this.AURA_EFFECT_MOD_BASE_RESISTANCE_PCT=142;this.AURA_EFFECT_MOD_RESISTACE_FLAT_DOES_NOT_STACK=143;this.AURA_EFFECT_MOD_BLOCK_VALUE_PCT=150;this.AURA_EFFECT_REGEN_HEALTH_WORKS_IN_COMBAT=161;this.AURA_EFFECT_MOD_MELEE_ATTACK_POWER_PCT=166;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER_PCT=167;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_STAT=174;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_STAT=175;this.AURA_EFFECT_MOD_RESISTANCE_BY_PCT_OF_STAT=182;this.AURA_EFFECT_MOD_ATTACKER_MELEE_HIT_CHANCE_PCT=184;this.AURA_EFFECT_MOD_ATTACKER_RANGED_HIT_CHANCE_PCT=185;this.AURA_EFFECT_MOD_ATTACKER_MELEE_CRIT_CHANCE_PCT=187;this.AURA_EFFECT_MOD_ATTACKER_RANGED_CRIT_CHANCE_PCT=188;this.AURA_EFFECT_MOD_RATING=189;this.AURA_EFFECT_MOD_SPELL_HIT_CHANCE_PCT2=199;this.AURA_EFFECT_MOD_RANGED_ATTACK_POWER_BY_PCT_OF_STAT=212;this.AURA_EFFECT_ADD_MODIFIER_FLAT_LABEL=219;this.AURA_EFFECT_MOD_MAX_HEALTH=230;this.AURA_EFFECT_MOD_SPELL_POWER_BY_PCT_OF_ATTACK_POWER=237;this.AURA_EFFECT_MOD_HEALING_POWER_BY_PCT_OF_ATTACK_POWER=238;this.AURA_EFFECT_MOD_EXPERTISE=240;this.AURA_EFFECT_MOD_ATTACK_POWER_FOR_EVERY_SCHOOL_RESISTANCE_POINT=285;this.AURA_EFFECT_MOD_CRIT_CHANCE_PCT_ALL=290;this.FLAGS4_REQUIRES_OFFHAND_WEAPON=16777216;this.ID_EXOTIC_BEASTS=53270;this.OPTIONAL_REAGENT_ICON_PATH="/images/wow/interface/GuildFrame/communities-icon-addgroupplus.png";const t=6;const a=2;const i=4;const n=1;const s=3;const r=0;const o=5;const l={[t]:WH.TERMS.arcane,[a]:WH.TERMS.fire,[i]:WH.TERMS.frost,[n]:WH.TERMS.holy,[s]:WH.TERMS.nature,[r]:WH.TERMS.physical,[o]:WH.TERMS.shadow};const c=1;const u=2;const d=4;const f=[15,25,30,35,40,45,50];this.get=function(e){return WH.Gatherer.get(WH.Types.SPELL,e)||null};this.getName=function(e){return WH.Gatherer.getName(WH.Types.SPELL,e)};this.getProficiencyFilterSelectFromFlags=function(e){if(e&c){return 1}if(e&u){return 2}if(e&d){return 5}};this.getProficiencyNameFromFlags=function(e){if(e&c){return WH.TERMS.weapons}if(e&u){return WH.TERMS.armor}if(e&d){return WH.TERMS.languages}};this.getProjectBranchName=function(e){return this.getProjectBranchNames()[e]||WH.TERMS.unknown};this.getProjectBranchNames=function(){return WH.getPageData("wow.spell.projectBranches")};this.getSchoolName=function(e){return l[e]};this.getTalentLevels=function(){return f}};WH.Wow.TransmogSet=new function(){const e=WH.User.Completion;this.getCompletionAmount=function(t,a){if(!t||!(a in e.getWardrobe())){return null}let i=e.getWardrobe()[a]||[];let n=Object.keys(t);if(n.length===0){return 0}let s=0;n.forEach((function(e){let a=t[e];for(let t=0;t<a.length;t++){if(i.includes(e+"|"+a[t])){s++;return}}}));return s/n.length};this.getThumbUrl=function(e,t,a,i){return WH.staticUrl+WH.Wow.ModelViewer.getStaticBase(i)+"/webthumbs/transmog/"+t+"/"+a+"/"+(e&255)+"/"+e+WH.WebP.getImageExtension()}};WH.Wow.UiMap=new function(){const e=this;this.clickToCopyCoordinates=function(e,t,i){i=i||{};let n=typeof t==="function"?t:function(){return t};e.style.cursor="pointer";WH.Tooltips.attach(e,(()=>{let e=WH.ce("div",undefined,WH.ct(n().join(WH.TERMS.comma_punct)));WH.ae(e,WH.ce("div",{className:"q2",style:{marginTop:"10px"}},WH.ct(WH.TERMS.clickToCopy)));return e.innerHTML}),"q",{noWrap:true,stopPropagation:true});WH.aE(e,"click",a.bind(e,n,i))};this.generateInGamePinLinkCommand=function(e,t,a,i){let n;if(i){n="\\124A:Waypoint-MapPin-ChatIcon:13:13:0:0\\124a "+WH.term("mapPin_format",i).replace(/:+$/,"").replace(/"/g,'\\"')}else{n=WH.GlobalStrings.MAP_PIN_HYPERLINK.replace(/\|/g,"\\124")}return'/script DEFAULT_CHAT_FRAME:AddMessage("'+"\\124cffffff00\\124Hworldmap:"+e+":"+t+":"+a+"\\124h["+n+"]\\124h\\124r"+'");'};this.generateTomTomCommand=function(e,t){let a=t.uiMapId?" #"+t.uiMapId:t.uiMapName?" "+t.uiMapName:"";let i="/way"+a+" "+e[0]+" "+e[1];if(t.name&&t.name!==t.uiMapName){i+=" "+t.name}return i};function t(e,t){return{x:parseFloat(e[0])*100,y:parseFloat(e[1])*100,name:t.name&&t.uiMapName?WH.term("parens_format",t.name,t.uiMapName):t.name||t.uiMapName}}function a(a,i){let n=a();let s=i.getAllCoords?i.getAllCoords():null;if(s&&s.length<=1){s=null}let r=i.getAllInGameMapPins?i.getAllInGameMapPins():null;if(r&&r.length<=1){r=null}let o=i.getAllTomTomCommands?i.getAllTomTomCommands():null;if(o&&o.length<=1){o=null}let l=[Menu.createHeading({label:WH.TERMS.copy_clipboard})];let c=s||o?[Menu.createHeading({label:WH.TERMS.copyAll})]:null;l.push(Menu.createItem({label:WH.TERMS.coordinates,url:function(e){WH.copyToClipboard(n.join(" "),e)}}));if(s){c.push(Menu.createItem({label:WH.TERMS.coordinates,url:function(e){let t=[];s.forEach((function(e){t.push(e.join(" "))}));WH.copyToClipboard(t.join("\n"),e)}}))}if(i.uiMapId){l.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(a){let s=t(n,i);let r=e.generateInGamePinLinkCommand(i.uiMapId,s.x,s.y,s.name);WH.copyToClipboard(r,a)}}));if(r){c.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(e){WH.copyToClipboard(r.join("\n"),e)}}))}else if(s){c.push(Menu.createItem({label:WH.TERMS.inGameMapPin,url:function(a){let n=[];s.forEach((function(a){let s=t(a,i);n.push(e.generateInGamePinLinkCommand(i.uiMapId,s.x,s.y,s.name))}));WH.copyToClipboard(n.join("\n"),a)}}))}}if(i.includeTomTom||i.uiMapId||i.uiMapName){l.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(t){WH.copyToClipboard(e.generateTomTomCommand(n,i),t)}}));if(o){c.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(e){WH.copyToClipboard(o.join("\n"),e)}}))}else if(s){c.push(Menu.createItem({label:WH.TERMS.tomTomCommand,url:function(t){let a=[];s.forEach((function(t){a.push(e.generateTomTomCommand(t,i))}));WH.copyToClipboard(a.join("\n"),t)}}))}}let u=c?l.concat(c):l;if(u.length===2){u[1][Menu.ITEM_URL]();return}Menu.show(u,this)}};WH.Wow.Item.Gems=new function(){const e=this;this.MASK_META=1;this.MASK_RED=2;this.MASK_YELLOW=4;this.MASK_BLUE=8;this.MASK_ORANGE=this.MASK_RED|this.MASK_YELLOW;this.MASK_PURPLE=this.MASK_RED|this.MASK_BLUE;this.MASK_GREEN=this.MASK_YELLOW|this.MASK_BLUE;this.MASK_PRISMATIC=this.MASK_RED|this.MASK_YELLOW|this.MASK_BLUE;this.SOCKET_META=1;this.SOCKET_RED=2;this.SOCKET_YELLOW=3;this.SOCKET_BLUE=4;this.SOCKET_SHA_TOUCHED=5;this.SOCKET_COGWHEEL=6;this.SOCKET_PRISMATIC=7;this.SOCKET_RELIC_IRON=8;this.SOCKET_RELIC_BLOOD=9;this.SOCKET_RELIC_SHADOW=10;this.SOCKET_RELIC_FEL=11;this.SOCKET_RELIC_ARCANE=12;this.SOCKET_RELIC_FROST=13;this.SOCKET_RELIC_FIRE=14;this.SOCKET_RELIC_WATER=15;this.SOCKET_RELIC_LIFE=16;this.SOCKET_RELIC_STORM=17;this.SOCKET_RELIC_HOLY=18;this.SOCKET_PUNCHCARD_RED=19;this.SOCKET_PUNCHCARD_YELLOW=20;this.SOCKET_PUNCHCARD_BLUE=21;this.SOCKET_DOMINATION=22;this.SOCKET_CRYSTALLIC=23;this.SOCKET_TINKER=24;this.SOCKET_PRIMORDIAL=25;const t=[];const a={};a[this.MASK_META]="meta";a[this.MASK_RED]="red";a[this.MASK_YELLOW]="yellow";a[this.MASK_ORANGE]="orange";a[this.MASK_BLUE]="blue";a[this.MASK_PURPLE]="purple";a[this.MASK_GREEN]="green";a[this.MASK_PRISMATIC]="prismatic";const i={};i[this.SOCKET_META]=this.MASK_META;i[this.SOCKET_RED]=this.MASK_RED;i[this.SOCKET_YELLOW]=this.MASK_YELLOW;i[this.SOCKET_BLUE]=this.MASK_BLUE;i[this.SOCKET_PRISMATIC]=this.MASK_PRISMATIC;this.getGemMaskFromType=function(e){return i[e]};this.getGemMaskString=function(e){return a[e]};this.getGemColorName=function(e){return n()[e]};this.getGemColors=function(){if(WH.isClassicTree()){return[]}if(!t.length){let a=[e.MASK_META,e.MASK_RED,e.MASK_ORANGE,e.MASK_YELLOW,e.MASK_GREEN,e.MASK_BLUE,e.MASK_PURPLE,e.MASK_PRISMATIC];let i=Object.keys(n());i.sort((function(t,i){t=parseInt(t);i=parseInt(i);let n=a.indexOf(t);let s=a.indexOf(i);if(n<0){if(s<0){return e.getGemColorName(t).localeCompare(e.getGemColorName(i))}return 1}else{if(s<0){return-1}return n-s}}));i.forEach((function(a){let i=parseInt(a);t.push({id:i,name:e.getGemColorName(i)})}))}return JSON.parse(JSON.stringify(t))};this.getSocketName=e=>WH.getPageData("wow.item.gems.socketNames")[e];this.getSocketTypeName=function(e){return g_gem_types[e]};function n(){return WH.getPageData("wow.item.gems.colorNames")}};WH.Wow.Item.Stat=new function(){const e=this;this.ID_MANA=0;this.ID_HEALTH=1;this.ID_ENDURANCE=2;this.ID_AGILITY=3;this.ID_STRENGTH=4;this.ID_INTELLECT=5;this.ID_SPIRIT=6;this.ID_STAMINA=7;this.ID_ENERGY=8;this.ID_RAGE=9;this.ID_FOCUS=10;this.ID_WEAPON_SKILL_RATING=11;this.ID_DEFENSE_SKILL_RATING=12;this.ID_DODGE_RATING=13;this.ID_PARRY_RATING=14;this.ID_BLOCK_RATING=15;this.ID_HIT_MELEE_RATING=16;this.ID_HIT_RANGED_RATING=17;this.ID_HIT_SPELL_RATING=18;this.ID_CRIT_MELEE_RATING=19;this.ID_CRIT_RANGED_RATING=20;this.ID_CRIT_SPELL_RATING=21;this.ID_CORRUPTION_RESISTANCE=23;this.ID_CRAFTING_STAT_1=24;this.ID_CRAFTING_STAT_2=25;this.ID_HASTE_MELEE_RATING=28;this.ID_HASTE_RANGED_RATING=29;this.ID_HASTE_SPELL_RATING=30;this.ID_HIT_RATING=31;this.ID_CRIT_RATING=32;this.ID_RESILIENCE_RATING=35;this.ID_HASTE_RATING=36;this.ID_EXPERTISE_RATING=37;this.ID_ATTACK_POWER=38;this.ID_RANGED_ATTACK_POWER=39;this.ID_VERSATILITY_RATING=40;this.ID_SPELL_HEALING_DONE=41;this.ID_SPELL_DAMAGE_DONE=42;this.ID_MANA_REGENERATION=43;this.ID_ARMOR_PENETRATION_RATING=44;this.ID_SPELL_POWER=45;this.ID_HEALTH_REGENERATION=46;this.ID_SPELL_PENETRATION=47;this.ID_BLOCK_VALUE=48;this.ID_MASTERY_RATING=49;this.ID_ARMOR=50;this.ID_FIRE_RESISTANCE=51;this.ID_FROST_RESISTANCE=52;this.ID_HOLY_RESISTANCE=53;this.ID_SHADOW_RESISTANCE=54;this.ID_NATURE_RESISTANCE=55;this.ID_ARCANE_RESISTANCE=56;this.ID_SPEED_RATING=61;this.ID_LEECH_RATING=62;this.ID_AVOIDANCE_RATING=63;this.ID_AGI_STR_INT=71;this.ID_AGI_STR=72;this.ID_AGI_INT=73;this.ID_STR_INT=74;this.CRAFTING_STAT_FROM=[this.ID_CRAFTING_STAT_1,this.ID_CRAFTING_STAT_2];this.CRAFTING_STAT_TO=[this.ID_CRIT_RATING,this.ID_HASTE_RATING,this.ID_VERSATILITY_RATING,this.ID_MASTERY_RATING,this.ID_SPEED_RATING,this.ID_LEECH_RATING,this.ID_AVOIDANCE_RATING];const t={agi:WH.TERMS.agility_abbrev,amplify:WH.TERMS.amplify_abbrev,arcres:WH.TERMS.arcaneresist_abbrev,arcsplpwr:WH.TERMS.arcanepower_abbrev,armor:WH.TERMS.armor,armorbonus:WH.TERMS.additionalarmor_abbrev,armorpenrtng:WH.TERMS.penetration_abbrev,atkpwr:WH.TERMS.attackpower_abbrev,avoidance:WH.TERMS.avoidance_abbrev,block:WH.TERMS.blockvalue_abbrev,blockrtng:WH.TERMS.block,cleave:WH.TERMS.cleave_abbrev,corruption:WH.TERMS.corruption_abbrev,corruptionres:WH.TERMS.corruptionResistance_abbrev,critstrkrtng:WH.TERMS.crit,defrtng:WH.TERMS.defense_abbrev,dmg:WH.TERMS.damage_abbrev,dmgmax1:WH.TERMS.maximum_abbrev,dmgmin1:WH.TERMS.minimum_abbrev,dodgertng:WH.TERMS.dodge,dps:WH.TERMS.dps,exprtng:WH.TERMS.expertise_abbrev,firres:WH.TERMS.fireresist_abbrev,firsplpwr:WH.TERMS.firepower_abbrev,frores:WH.TERMS.frostresist_abbrev,frosplpwr:WH.TERMS.frostpower_abbrev,hastertng:WH.TERMS.haste,health:WH.TERMS.health_abbrev,healthrgn:WH.TERMS.healthregen_abbrev,hitrtng:WH.TERMS.hit,holres:WH.TERMS.holyresist_abbrev,holsplpwr:WH.TERMS.holypower_abbrev,int:WH.TERMS.intellect_abbrev,level:WH.TERMS.level_abbrev,lifesteal:WH.TERMS.leech_abbrev,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregen_abbrev,mastrtng:WH.TERMS.mastery_abbrev,mleatkpwr:WH.TERMS.attackpower_abbrev,mlecritstrkrtng:WH.TERMS.crit,mledmgmax:WH.TERMS.maximum_abbrev,mledmgmin:WH.TERMS.minimum_abbrev,mledps:WH.TERMS.dps,mlehastertng:WH.TERMS.haste,mlehitrtng:WH.TERMS.hit,mlespeed:WH.TERMS.speed,multistrike:WH.TERMS.multistrike_abbrev,natres:WH.TERMS.natureresist_abbrev,natsplpwr:WH.TERMS.naturepower_abbrev,nsockets:WH.TERMS.socket_abbrev,parryrtng:WH.TERMS.parry,pvppower:WH.TERMS.pvppower_abbrev,readiness:WH.TERMS.readiness_abbrev,reqarenartng:WH.TERMS.rating,reqlevel:WH.TERMS.level,resirtng:WH.TERMS.resilience_abbrev,rgdatkpwr:WH.TERMS.rangedap_abbrev,rgdcritstrkrtng:WH.TERMS.crit,rgddmgmax:WH.TERMS.maximum_abbrev,rgddmgmin:WH.TERMS.minimum_abbrev,rgddps:WH.TERMS.dps,rgdhastertng:WH.TERMS.haste,rgdhitrtng:WH.TERMS.hit,rgdspeed:WH.TERMS.speed,shares:WH.TERMS.shadowresist_abbrev,shasplpwr:WH.TERMS.shadowpower_abbrev,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus_abbrev,spi:WH.TERMS.spirit_abbrev,splcritstrkrtng:WH.TERMS.crit,spldmg:WH.TERMS.damage_abbrev,splhastertng:WH.TERMS.haste,splheal:WH.TERMS.heal,splhitrtng:WH.TERMS.hit,splpen:WH.TERMS.penetration_abbrev,splpwr:WH.TERMS.spellpower_abbrev,sta:WH.TERMS.stamina_abbrev,str:WH.TERMS.strength_abbrev,sturdiness:WH.TERMS.indestructible_abbrev,versatility:WH.TERMS.versatility_abbrev};const a=0;const i=1;const n=2;const s=3;const r=4;const o={};o[a]=e.ID_STRENGTH;o[i]=e.ID_AGILITY;o[n]=e.ID_STAMINA;o[s]=e.ID_INTELLECT;o[r]=e.ID_SPIRIT;const l={agi:WH.TERMS.agility,amplify:WH.TERMS.amplifyrating_stc,arcres:WH.TERMS.arcaneresistance_stc,arcsplpwr:WH.TERMS.arcanespellpower_stc,armor:WH.TERMS.armor,armorbonus:WH.TERMS.additionalarmor_stc,armorpenrtng:WH.TERMS.armorpenetrationrating_stc,atkpwr:WH.TERMS.attackpower_stc,avoidance:WH.TERMS.avoidancerating_stc,block:WH.TERMS.blockvalue_stc,blockrtng:WH.TERMS.blockrating_stc,cleave:WH.TERMS.cleaverating_stc,corruption:WH.TERMS.corruption,corruptionres:WH.TERMS.corruptionResistance_stc,critstrkrtng:WH.TERMS.criticalstrikerating_stc,defrtng:WH.TERMS.defenserating_stc,dmg:WH.TERMS.weapondamage_stc,dmgmax1:WH.TERMS.maximumdamage_stc,dmgmin1:WH.TERMS.minimumdamage_stc,dodgertng:WH.TERMS.dodgerating_stc,dps:WH.TERMS.damagepersecond_stc,exprtng:WH.TERMS.expertiserating_stc,firres:WH.TERMS.fireresistance_stc,firsplpwr:WH.TERMS.firespellpower_stc,frores:WH.TERMS.frostresistance_stc,frosplpwr:WH.TERMS.frostspellpower_stc,hastertng:WH.TERMS.hasterating_stc,health:WH.TERMS.health,healthrgn:WH.TERMS.healthregeneration_stc,hitrtng:WH.TERMS.hitrating_stc,holres:WH.TERMS.holyresistance_stc,holsplpwr:WH.TERMS.holyspellpower_stc,int:WH.TERMS.intellect,level:WH.TERMS.level,lifesteal:WH.TERMS.leechrating_stc,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregeneration_stc,mastrtng:WH.TERMS.masteryrating_stc,mleatkpwr:WH.TERMS.meleeattackpower_stc,mlecritstrkrtng:WH.TERMS.meleecriticalstrikerating_stc,mledmgmax:WH.TERMS.meleemaximumdamage_stc,mledmgmin:WH.TERMS.meleeminimumdamage_stc,mledps:WH.TERMS.meleedps,mlehastertng:WH.TERMS.meleehasterating_stc,mlehitrtng:WH.TERMS.meleehitrating_stc,mlespeed:WH.TERMS.meleespeed_stc,multistrike:WH.TERMS.multistrikerating_stc,natres:WH.TERMS.natureresistance_stc,natsplpwr:WH.TERMS.naturespellpower_stc,nsockets:WH.TERMS.numberofsockets_stc,parryrtng:WH.TERMS.parryrating_stc,pvppower:WH.TERMS.pvppower,readiness:WH.TERMS.readinessrating_stc,reqarenartng:WH.TERMS.requiredpersonalandteamarenarating_stc,reqlevel:WH.TERMS.requiredlevel_stc,resirtng:WH.TERMS.resiliencerating_stc,rgdatkpwr:WH.TERMS.rangedattackpower_stc,rgdcritstrkrtng:WH.TERMS.rangedcriticalstrikerating_stc,rgddmgmax:WH.TERMS.rangedmaximumdamage_stc,rgddmgmin:WH.TERMS.rangedminimumdamage_stc,rgddps:WH.TERMS.rangeddps,rgdhastertng:WH.TERMS.rangedhasterating_stc,rgdhitrtng:WH.TERMS.rangedhitrating_stc,rgdspeed:WH.TERMS.rangedspeed_stc,shares:WH.TERMS.shadowresistance_stc,shasplpwr:WH.TERMS.shadowspellpower_stc,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus,spi:WH.TERMS.spirit,splcritstrkrtng:WH.TERMS.spellcriticalstrikerating_stc,spldmg:WH.TERMS.damagedonebyspells_stc,splhastertng:WH.TERMS.spellhasterating_stc,splheal:WH.TERMS.healingdonebyspells_stc,splhitrtng:WH.TERMS.spellhitrating_stc,splpen:WH.TERMS.spellpenetration_stc,splpwr:WH.TERMS.spellpower_stc,sta:WH.TERMS.stamina,str:WH.TERMS.strength,sturdiness:WH.TERMS.indestructiblerating_stc,versatility:WH.TERMS.versatilityrating_stc};const c={agi:WH.TERMS.agility,amplify:WH.TERMS.amplify,arcres:WH.TERMS.arcaneresist,arcsplpwr:WH.TERMS.arcanepower,armor:WH.TERMS.armor,armorbonus:WH.TERMS.bonusarmor,armorpenrtng:WH.TERMS.armorpen,atkpwr:WH.TERMS.attackpower_abbrev,avoidance:WH.TERMS.avoidance,block:WH.TERMS.blockvalue,blockrtng:WH.TERMS.block,cleave:WH.TERMS.cleave,corruption:WH.TERMS.corruption,corruptionres:WH.TERMS.corruptionResist,critstrkrtng:WH.TERMS.crit,defrtng:WH.TERMS.defense,dmg:WH.TERMS.damage,dmgmax1:WH.TERMS.maxdamage,dmgmin1:WH.TERMS.mindamage,dodgertng:WH.TERMS.dodge,dps:WH.TERMS.dps,exprtng:WH.TERMS.expertise,firres:WH.TERMS.fireresist,firsplpwr:WH.TERMS.firepower,frores:WH.TERMS.frostresist,frosplpwr:WH.TERMS.frostpower,hastertng:WH.TERMS.haste,health:WH.TERMS.health,healthrgn:WH.TERMS.healthregen_abbrev,hitrtng:WH.TERMS.hit,holres:WH.TERMS.holyresist,holsplpwr:WH.TERMS.holypower,int:WH.TERMS.intellect,level:WH.TERMS.level,lifesteal:WH.TERMS.leech,mana:WH.TERMS.mana,manargn:WH.TERMS.manaregen_abbrev,mastrtng:WH.TERMS.mastery,mleatkpwr:WH.TERMS.meleeap,mlecritstrkrtng:WH.TERMS.meleecrit,mledmgmax:WH.TERMS.meleemaxdamage,mledmgmin:WH.TERMS.meleemindamage,mledps:WH.TERMS.meleedps,mlehastertng:WH.TERMS.meleehaste,mlehitrtng:WH.TERMS.meleehit,mlespeed:WH.TERMS.meleespeed,multistrike:WH.TERMS.multistrike,natres:WH.TERMS.natureresist,natsplpwr:WH.TERMS.naturepower,nsockets:WH.TERMS.sockets,parryrtng:WH.TERMS.parry,pvppower:WH.TERMS.pvppower_abbrev,readiness:WH.TERMS.readiness,reqarenartng:WH.TERMS.reqrating,reqlevel:WH.TERMS.reqlevel,resirtng:WH.TERMS.resilience,rgdatkpwr:WH.TERMS.rangedap,rgdcritstrkrtng:WH.TERMS.rangedcrit,rgddmgmax:WH.TERMS.rangedmaxdamage,rgddmgmin:WH.TERMS.rangedmindamage,rgddps:WH.TERMS.rangeddps,rgdhastertng:WH.TERMS.rangedhaste,rgdhitrtng:WH.TERMS.rangedhit,rgdspeed:WH.TERMS.rangedspeed,shares:WH.TERMS.shadowresist,shasplpwr:WH.TERMS.shadowpower,speed:WH.TERMS.speed,speedbonus:WH.TERMS.speedbonus,spi:WH.TERMS.spirit,splcritstrkrtng:WH.TERMS.spellcrit,spldmg:WH.TERMS.spelldamage,splhastertng:WH.TERMS.spellhaste,splheal:WH.TERMS.healing,splhitrtng:WH.TERMS.spellhit,splpen:WH.TERMS.spellpen,splpwr:WH.TERMS.spellpower,sta:WH.TERMS.stamina,str:WH.TERMS.strength,sturdiness:WH.TERMS.indestructible,versatility:WH.TERMS.versatility};const u=[this.ID_SPEED_RATING,this.ID_LEECH_RATING,this.ID_AVOIDANCE_RATING];this.convertBaseIndex=function(e){return o[e]};this.getTertiaryStats=function(){return u.slice()};this.jsonToAbbr=function(e){return t[e]};this.jsonToDesc=function(e){return l[e]};this.jsonToName=function(e){return c[e]}};WH.Wow.Item.Bonuses=new function(){"use strict";const e=this;const t=WH.Wow.Item;const a=WH.Wow.Item.Stat;this.CONTEXT_CHALLENGE_MODE=16;this.CONTEXT_DUNGEON_MYTHIC=23;this.CONTEXT_CHALLENGE_MODE_2=33;this.CONTEXT_CHALLENGE_MODE_3=34;this.CONTEXT_CHALLENGE_MODE_JACKPOT=35;this.CONTEXT_CHALLENGE_MODE_4=87;this.EFFECT_TYPE_ADJUST_ITEM_LEVEL=1;this.EFFECT_TYPE_ADJUST_STAT=2;this.EFFECT_TYPE_QUALITY=3;this.EFFECT_TYPE_TAG_DESCRIPTION=4;this.EFFECT_TYPE_NAME_SUFFIX=5;this.EFFECT_TYPE_ADD_SOCKET=6;this.EFFECT_TYPE_DISPLAY_MOD=7;this.EFFECT_TYPE_ADJUST_REQUIRED_LEVEL=8;this.EFFECT_TYPE_SCALE_HEIRLOOM=11;this.EFFECT_TYPE_SCALE_DYNAMIC_REWARD=13;this.EFFECT_TYPE_PREVIEW_LEVEL=14;this.EFFECT_TYPE_BOND=16;this.EFFECT_TYPE_APPLY_ITEM_EFFECT=23;this.EFFECT_TYPE_CRAFTING_STAT=25;this.EFFECT_TYPE_ITEM_BONUS_LIST_GROUP=34;this.EFFECT_TYPE_SET_ITEM_LEVEL=42;const i=[e.CONTEXT_CHALLENGE_MODE,e.CONTEXT_CHALLENGE_MODE_2,e.CONTEXT_CHALLENGE_MODE_3,e.CONTEXT_CHALLENGE_MODE_4,e.CONTEXT_CHALLENGE_MODE_JACKPOT];this.getEffects=function(e){let t=n();let a=t[e]||[];let i=[];a.forEach((e=>{i.push({type:e[0],params:e.slice(1)})}));return i};this.getLevelAdjustmentBonus=function(e){if(e>=-400&&e<-100){return 3229+e}if(e>=-100&&e<=200){return 1472+e}if(e>200&&e<=400){return 2929+e}};this.getName=function(i,s){i=parseInt(i);if(i===0){return WH.TERMS.normal}let r=n();if(!r){return WH.TERMS.normal}let o=[];let l=s.level;let c=false;let u=e.getEffects(i);u.sort(((e,t)=>e.type-t.type));let d="";let f="";let h="";let p="";let m="";let H="";u.forEach((n=>{switch(n.type){case e.EFFECT_TYPE_ADJUST_ITEM_LEVEL:d=WH.TERMS.itemlevel+WH.TERMS.wordspace_punct+(n.params[0]>=0?"+":"")+n.params[0];break;case e.EFFECT_TYPE_ADJUST_STAT:case e.EFFECT_TYPE_CRAFTING_STAT:let r=WH.statToJson[n.params[0]]&&a.jsonToName(WH.statToJson[n.params[0]])||"Unknown stat";if(n.params[0]===a.ID_CORRUPTION_RESISTANCE){r+=" "+n.params[1];c=true}o.push(WH.TERMS.stat+WH.TERMS.colon_punct+r);break;case e.EFFECT_TYPE_QUALITY:f=n.params[0];break;case e.EFFECT_TYPE_TAG_DESCRIPTION:h=t.getNameDescription(n.params[0])||h;break;case e.EFFECT_TYPE_NAME_SUFFIX:p=t.getNameDescription(n.params[0])||p;break;case e.EFFECT_TYPE_ADD_SOCKET:let u=n.params[1];o.push(WH.TERMS.sockets+WH.TERMS.colon_punct+n.params[0]+WH.TERMS.wordspace_punct+(g_gem_types[u]||WH.TERMS.other));break;case e.EFFECT_TYPE_ADJUST_REQUIRED_LEVEL:o.push(WH.sprintf(WH.TERMS.requireslevel_format.replace("%s","$1"),s.reqlevel+n.params[0]));break;case e.EFFECT_TYPE_SCALE_HEIRLOOM:if(s.heirloombonuses){let e="?";for(let t=0,a;a=s.heirloombonuses[t];t++){if(i===a){e=t+1;break}}o.push(WH.sprintf(WH.TERMS.heirloomupgradejs_format,e))}break;case e.EFFECT_TYPE_SCALE_DYNAMIC_REWARD:d=WH.TERMS.scaleswithlevel_stc;break;case e.EFFECT_TYPE_PREVIEW_LEVEL:d=WH.TERMS.itemlevel+WH.TERMS.colon_punct+l+"+";break;case e.EFFECT_TYPE_BOND:H=t.getBondTypeName(n.params[0]);break;case e.EFFECT_TYPE_APPLY_ITEM_EFFECT:if(n.params[0]>0){let e=WH.Tooltips.getScalingData(WH.Types.ITEM,"bonusEffects")||{};m=(e.effectSpellName||{})[n.params[0]]||""}break;case e.EFFECT_TYPE_ITEM_BONUS_LIST_GROUP:let g=WH.getPageData("wow.item.bonuses.upgrades")||{};if(g[i]){m=g[i][2]?WH.Strings.sprintf(WH.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT_STRING,g[i][2],g[i][0],g[i][1]):WH.Strings.sprintf(WH.GlobalStrings.ITEM_UPGRADE_TOOLTIP_FORMAT,g[i][0],g[i][1])}break;case e.EFFECT_TYPE_SET_ITEM_LEVEL:d=WH.TERMS.itemlevel+WH.TERMS.colon_punct+n.params[0];break}}));if(c&&!d&&l){d=WH.TERMS.itemlevel+WH.TERMS.wordspace_punct+l}if(d){o.unshift(d)}if(h){o.push(WH.TERMS.description+WH.TERMS.colon_punct+h)}if(p){o.push(WH.TERMS.suffix+WH.TERMS.colon_punct+p)}if(m&&!c){o.unshift(WH.TERMS.effect+WH.TERMS.colon_punct+m)}if(f){o.push(WH.TERMS.quality_colon+t.getQualityName(f))}if(H){o.push(H)}o=o.join(" / ");return o||WH.TERMS.normal};this.getQuality=function(t){let a=n();let i;for(let n,s=0;n=t[s];s++){let t=a[n]||[];for(let a,n=0;a=t[n];n++){if(a[0]===e.EFFECT_TYPE_QUALITY){i=Math.max(i||0,a[1])}}}return i};this.isMythicPlusContext=function(e){return i.includes(e)};function n(){let e=window.g_itembonuses||{};if(!Object.keys(e).length){WH.error("Item bonus data not found.")}return e}};WH.Wow.PlayerClass.Specialization=new function(){const e=this;const t=WH.Game;const a=WH.Icon;const i=WH.Wow.PlayerClass;this.ID_DEATH_KNIGHT_BLOOD=250;this.ID_DEATH_KNIGHT_FROST=251;this.ID_DEATH_KNIGHT_UNHOLY=252;this.ID_DEMON_HUNTER_HAVOC=577;this.ID_DEMON_HUNTER_VENGEANCE=581;this.ID_DRUID_BALANCE=102;this.ID_DRUID_FERAL=103;this.ID_DRUID_GUARDIAN=104;this.ID_DRUID_RESTORATION=105;this.ID_EVOKER_AUGMENTATION=1473;this.ID_EVOKER_DEVASTATION=1467;this.ID_EVOKER_PRESERVATION=1468;this.ID_HUNTER_BEAST_MASTERY=253;this.ID_HUNTER_MARKSMANSHIP=254;this.ID_HUNTER_SURVIVAL=255;this.ID_MAGE_ARCANE=62;this.ID_MAGE_FIRE=63;this.ID_MAGE_FROST=64;this.ID_MONK_BREWMASTER=268;this.ID_MONK_MISTWEAVER=270;this.ID_MONK_WINDWALKER=269;this.ID_PALADIN_HOLY=65;this.ID_PALADIN_PROTECTION=66;this.ID_PALADIN_RETRIBUTION=70;this.ID_PRIEST_DISCIPLINE=256;this.ID_PRIEST_HOLY=257;this.ID_PRIEST_SHADOW=258;this.ID_ROGUE_ASSASSINATION=259;this.ID_ROGUE_OUTLAW=260;this.ID_ROGUE_SUBTLETY=261;this.ID_SHAMAN_ELEMENTAL=262;this.ID_SHAMAN_ENHANCEMENT=263;this.ID_SHAMAN_RESTORATION=264;this.ID_WARLOCK_AFFLICTION=265;this.ID_WARLOCK_DEMONOLOGY=266;this.ID_WARLOCK_DESTRUCTION=267;this.ID_WARRIOR_ARMS=71;this.ID_WARRIOR_FURY=72;this.ID_WARRIOR_PROTECTION=73;this.ID_CLASSIC_DEATH_KNIGHT_BLOOD=398;this.ID_CLASSIC_DEATH_KNIGHT_FROST=399;this.ID_CLASSIC_DEATH_KNIGHT_UNHOLY=400;this.ID_CLASSIC_DRUID_BALANCE=283;this.ID_CLASSIC_DRUID_FERAL_COMBAT=281;this.ID_CLASSIC_DRUID_RESTORATION=282;this.ID_CLASSIC_HUNTER_BEAST_MASTERY=361;this.ID_CLASSIC_HUNTER_MARKSMANSHIP=363;this.ID_CLASSIC_HUNTER_SURVIVAL=362;this.ID_CLASSIC_MAGE_ARCANE=81;this.ID_CLASSIC_MAGE_FIRE=41;this.ID_CLASSIC_MAGE_FROST=61;this.ID_CLASSIC_PALADIN_HOLY=382;this.ID_CLASSIC_PALADIN_PROTECTION=383;this.ID_CLASSIC_PALADIN_RETRIBUTION=381;this.ID_CLASSIC_PRIEST_DISCIPLINE=201;this.ID_CLASSIC_PRIEST_HOLY=202;this.ID_CLASSIC_PRIEST_SHADOW=203;this.ID_CLASSIC_ROGUE_ASSASSINATION=182;this.ID_CLASSIC_ROGUE_COMBAT=181;this.ID_CLASSIC_ROGUE_SUBTLETY=183;this.ID_CLASSIC_SHAMAN_ELEMENTAL=261;this.ID_CLASSIC_SHAMAN_ENHANCEMENT=263;this.ID_CLASSIC_SHAMAN_RESTORATION=262;this.ID_CLASSIC_WARLOCK_AFFLICTION=302;this.ID_CLASSIC_WARLOCK_DEMONOLOGY=303;this.ID_CLASSIC_WARLOCK_DESTRUCTION=301;this.ID_CLASSIC_WARRIOR_ARMS=161;this.ID_CLASSIC_WARRIOR_FURY=164;this.ID_CLASSIC_WARRIOR_PROTECTION=163;this.ROLE_TANK=0;this.ROLE_HEAL=1;this.ROLE_DPS=2;const n={};n[WH.dataEnv.CLASSIC]={};n[WH.dataEnv.CLASSIC][i.DRUID]=[this.ID_CLASSIC_DRUID_BALANCE,this.ID_CLASSIC_DRUID_FERAL_COMBAT,this.ID_CLASSIC_DRUID_RESTORATION];n[WH.dataEnv.CLASSIC][i.HUNTER]=[this.ID_CLASSIC_HUNTER_BEAST_MASTERY,this.ID_CLASSIC_HUNTER_MARKSMANSHIP,this.ID_CLASSIC_HUNTER_SURVIVAL];n[WH.dataEnv.CLASSIC][i.MAGE]=[this.ID_CLASSIC_MAGE_ARCANE,this.ID_CLASSIC_MAGE_FIRE,this.ID_CLASSIC_MAGE_FROST];n[WH.dataEnv.CLASSIC][i.PALADIN]=[this.ID_CLASSIC_PALADIN_HOLY,this.ID_CLASSIC_PALADIN_PROTECTION,this.ID_CLASSIC_PALADIN_RETRIBUTION];n[WH.dataEnv.CLASSIC][i.PRIEST]=[this.ID_CLASSIC_PRIEST_DISCIPLINE,this.ID_CLASSIC_PRIEST_HOLY,this.ID_CLASSIC_PRIEST_SHADOW];n[WH.dataEnv.CLASSIC][i.ROGUE]=[this.ID_CLASSIC_ROGUE_ASSASSINATION,this.ID_CLASSIC_ROGUE_COMBAT,this.ID_CLASSIC_ROGUE_SUBTLETY];n[WH.dataEnv.CLASSIC][i.SHAMAN]=[this.ID_CLASSIC_SHAMAN_ELEMENTAL,this.ID_CLASSIC_SHAMAN_ENHANCEMENT,this.ID_CLASSIC_SHAMAN_RESTORATION];n[WH.dataEnv.CLASSIC][i.WARLOCK]=[this.ID_CLASSIC_WARLOCK_AFFLICTION,this.ID_CLASSIC_WARLOCK_DEMONOLOGY,this.ID_CLASSIC_WARLOCK_DESTRUCTION];n[WH.dataEnv.CLASSIC][i.WARRIOR]=[this.ID_CLASSIC_WARRIOR_ARMS,this.ID_CLASSIC_WARRIOR_FURY,this.ID_CLASSIC_WARRIOR_PROTECTION];n[WH.dataEnv.TBC]=n[WH.dataEnv.CLASSIC];n[WH.dataEnv.WRATH]={...n[WH.dataEnv.CLASSIC]};n[WH.dataEnv.WRATH][i.DEATH_KNIGHT]=[this.ID_CLASSIC_DEATH_KNIGHT_BLOOD,this.ID_CLASSIC_DEATH_KNIGHT_FROST,this.ID_CLASSIC_DEATH_KNIGHT_UNHOLY];n[WH.dataEnv.MAIN]={};n[WH.dataEnv.MAIN][i.DEATH_KNIGHT]=[this.ID_DEATH_KNIGHT_BLOOD,this.ID_DEATH_KNIGHT_FROST,this.ID_DEATH_KNIGHT_UNHOLY];n[WH.dataEnv.MAIN][i.DEMON_HUNTER]=[this.ID_DEMON_HUNTER_HAVOC,this.ID_DEMON_HUNTER_VENGEANCE];n[WH.dataEnv.MAIN][i.DRUID]=[this.ID_DRUID_BALANCE,this.ID_DRUID_FERAL,this.ID_DRUID_GUARDIAN,this.ID_DRUID_RESTORATION];n[WH.dataEnv.MAIN][i.EVOKER]=[this.ID_EVOKER_DEVASTATION,this.ID_EVOKER_PRESERVATION,this.ID_EVOKER_AUGMENTATION];n[WH.dataEnv.MAIN][i.HUNTER]=[this.ID_HUNTER_BEAST_MASTERY,this.ID_HUNTER_MARKSMANSHIP,this.ID_HUNTER_SURVIVAL];n[WH.dataEnv.MAIN][i.MAGE]=[this.ID_MAGE_ARCANE,this.ID_MAGE_FIRE,this.ID_MAGE_FROST];n[WH.dataEnv.MAIN][i.MONK]=[this.ID_MONK_BREWMASTER,this.ID_MONK_MISTWEAVER,this.ID_MONK_WINDWALKER];n[WH.dataEnv.MAIN][i.PALADIN]=[this.ID_PALADIN_HOLY,this.ID_PALADIN_PROTECTION,this.ID_PALADIN_RETRIBUTION];n[WH.dataEnv.MAIN][i.PRIEST]=[this.ID_PRIEST_DISCIPLINE,this.ID_PRIEST_HOLY,this.ID_PRIEST_SHADOW];n[WH.dataEnv.MAIN][i.ROGUE]=[this.ID_ROGUE_ASSASSINATION,this.ID_ROGUE_OUTLAW,this.ID_ROGUE_SUBTLETY];n[WH.dataEnv.MAIN][i.SHAMAN]=[this.ID_SHAMAN_ELEMENTAL,this.ID_SHAMAN_ENHANCEMENT,this.ID_SHAMAN_RESTORATION];n[WH.dataEnv.MAIN][i.WARLOCK]=[this.ID_WARLOCK_AFFLICTION,this.ID_WARLOCK_DEMONOLOGY,this.ID_WARLOCK_DESTRUCTION];n[WH.dataEnv.MAIN][i.WARRIOR]=[this.ID_WARRIOR_ARMS,this.ID_WARRIOR_FURY,this.ID_WARRIOR_PROTECTION];const s={};s[WH.dataEnv.CLASSIC]={};s[WH.dataEnv.CLASSIC][i.DRUID]={};s[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_BALANCE]="balance";s[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_FERAL_COMBAT]="feral-combat";s[WH.dataEnv.CLASSIC][i.DRUID][this.ID_CLASSIC_DRUID_RESTORATION]="restoration";s[WH.dataEnv.CLASSIC][i.HUNTER]={};s[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_BEAST_MASTERY]="beast-mastery";s[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_MARKSMANSHIP]="marksmanship";s[WH.dataEnv.CLASSIC][i.HUNTER][this.ID_CLASSIC_HUNTER_SURVIVAL]="survival";s[WH.dataEnv.CLASSIC][i.MAGE]={};s[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_ARCANE]="arcane";s[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_FIRE]="fire";s[WH.dataEnv.CLASSIC][i.MAGE][this.ID_CLASSIC_MAGE_FROST]="frost";s[WH.dataEnv.CLASSIC][i.PALADIN]={};s[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_HOLY]="holy";s[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_PROTECTION]="protection";s[WH.dataEnv.CLASSIC][i.PALADIN][this.ID_CLASSIC_PALADIN_RETRIBUTION]="retribution";s[WH.dataEnv.CLASSIC][i.PRIEST]={};s[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_DISCIPLINE]="discipline";s[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_HOLY]="holy";s[WH.dataEnv.CLASSIC][i.PRIEST][this.ID_CLASSIC_PRIEST_SHADOW]="shadow";s[WH.dataEnv.CLASSIC][i.ROGUE]={};s[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_ASSASSINATION]="assassination";s[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_COMBAT]="combat";s[WH.dataEnv.CLASSIC][i.ROGUE][this.ID_CLASSIC_ROGUE_SUBTLETY]="subtlety";s[WH.dataEnv.CLASSIC][i.SHAMAN]={};s[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_ELEMENTAL]="elemental";s[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_ENHANCEMENT]="enhancement";s[WH.dataEnv.CLASSIC][i.SHAMAN][this.ID_CLASSIC_SHAMAN_RESTORATION]="restoration";s[WH.dataEnv.CLASSIC][i.WARLOCK]={};s[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_AFFLICTION]="affliction";s[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_DEMONOLOGY]="demonology";s[WH.dataEnv.CLASSIC][i.WARLOCK][this.ID_CLASSIC_WARLOCK_DESTRUCTION]="destruction";s[WH.dataEnv.CLASSIC][i.WARRIOR]={};s[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_ARMS]="arms";s[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_FURY]="fury";s[WH.dataEnv.CLASSIC][i.WARRIOR][this.ID_CLASSIC_WARRIOR_PROTECTION]="protection";s[WH.dataEnv.TBC]={...s[WH.dataEnv.CLASSIC]};s[WH.dataEnv.WRATH]={...s[WH.dataEnv.TBC]};s[WH.dataEnv.WRATH][i.DEATH_KNIGHT]={};s[WH.dataEnv.WRATH][i.DEATH_KNIGHT][this.ID_CLASSIC_DEATH_KNIGHT_BLOOD]="blood";s[WH.dataEnv.WRATH][i.DEATH_KNIGHT][this.ID_CLASSIC_DEATH_KNIGHT_FROST]="frost";s[WH.dataEnv.WRATH][i.DEATH_KNIGHT][this.ID_CLASSIC_DEATH_KNIGHT_UNHOLY]="unholy";s[WH.dataEnv.MAIN]={};s[WH.dataEnv.MAIN][i.DEATH_KNIGHT]={};s[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_BLOOD]="blood";s[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_FROST]="frost";s[WH.dataEnv.MAIN][i.DEATH_KNIGHT][this.ID_DEATH_KNIGHT_UNHOLY]="unholy";s[WH.dataEnv.MAIN][i.DEMON_HUNTER]={};s[WH.dataEnv.MAIN][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_HAVOC]="havoc";s[WH.dataEnv.MAIN][i.DEMON_HUNTER][this.ID_DEMON_HUNTER_VENGEANCE]="vengeance";s[WH.dataEnv.MAIN][i.DRUID]={};s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_BALANCE]="balance";s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_FERAL]="feral";s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_GUARDIAN]="guardian";s[WH.dataEnv.MAIN][i.DRUID][this.ID_DRUID_RESTORATION]="restoration";s[WH.dataEnv.MAIN][i.EVOKER]={[this.ID_EVOKER_AUGMENTATION]:"augmentation",[this.ID_EVOKER_DEVASTATION]:"devastation",[this.ID_EVOKER_PRESERVATION]:"preservation"};s[WH.dataEnv.MAIN][i.HUNTER]={};s[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_BEAST_MASTERY]="beast-mastery";s[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_MARKSMANSHIP]="marksmanship";s[WH.dataEnv.MAIN][i.HUNTER][this.ID_HUNTER_SURVIVAL]="survival";s[WH.dataEnv.MAIN][i.MAGE]={};s[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_ARCANE]="arcane";s[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_FIRE]="fire";s[WH.dataEnv.MAIN][i.MAGE][this.ID_MAGE_FROST]="frost";s[WH.dataEnv.MAIN][i.MONK]={};s[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_BREWMASTER]="brewmaster";s[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_MISTWEAVER]="mistweaver";s[WH.dataEnv.MAIN][i.MONK][this.ID_MONK_WINDWALKER]="windwalker";s[WH.dataEnv.MAIN][i.PALADIN]={};s[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_HOLY]="holy";s[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_PROTECTION]="protection";s[WH.dataEnv.MAIN][i.PALADIN][this.ID_PALADIN_RETRIBUTION]="retribution";s[WH.dataEnv.MAIN][i.PRIEST]={};s[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_DISCIPLINE]="discipline";s[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_HOLY]="holy";s[WH.dataEnv.MAIN][i.PRIEST][this.ID_PRIEST_SHADOW]="shadow";s[WH.dataEnv.MAIN][i.ROGUE]={};s[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_ASSASSINATION]="assassination";s[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_OUTLAW]="outlaw";s[WH.dataEnv.MAIN][i.ROGUE][this.ID_ROGUE_SUBTLETY]="subtlety";s[WH.dataEnv.MAIN][i.SHAMAN]={};s[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_ELEMENTAL]="elemental";s[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_ENHANCEMENT]="enhancement";s[WH.dataEnv.MAIN][i.SHAMAN][this.ID_SHAMAN_RESTORATION]="restoration";s[WH.dataEnv.MAIN][i.WARLOCK]={};s[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_AFFLICTION]="affliction";s[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_DEMONOLOGY]="demonology";s[WH.dataEnv.MAIN][i.WARLOCK][this.ID_WARLOCK_DESTRUCTION]="destruction";s[WH.dataEnv.MAIN][i.WARRIOR]={};s[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_ARMS]="arms";s[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_FURY]="fury";s[WH.dataEnv.MAIN][i.WARRIOR][this.ID_WARRIOR_PROTECTION]="protection";const r={[this.ID_DEATH_KNIGHT_FROST]:137006,[this.ID_DEATH_KNIGHT_UNHOLY]:137007,[this.ID_DEATH_KNIGHT_BLOOD]:137008,[this.ID_DRUID_GUARDIAN]:137010,[this.ID_DRUID_FERAL]:137011,[this.ID_DRUID_RESTORATION]:137012,[this.ID_DRUID_BALANCE]:137013,[this.ID_HUNTER_BEAST_MASTERY]:137015,[this.ID_HUNTER_MARKSMANSHIP]:137016,[this.ID_HUNTER_SURVIVAL]:137017,[this.ID_MAGE_FIRE]:137019,[this.ID_MAGE_FROST]:137020,[this.ID_MAGE_ARCANE]:137021,[this.ID_MONK_BREWMASTER]:137023,[this.ID_MONK_MISTWEAVER]:137024,[this.ID_MONK_WINDWALKER]:137025,[this.ID_PALADIN_RETRIBUTION]:137027,[this.ID_PALADIN_PROTECTION]:137028,[this.ID_PALADIN_HOLY]:137029,[this.ID_PRIEST_HOLY]:137031,[this.ID_PRIEST_DISCIPLINE]:137032,[this.ID_PRIEST_SHADOW]:137033,[this.ID_ROGUE_SUBTLETY]:137035,[this.ID_ROGUE_OUTLAW]:137036,[this.ID_ROGUE_ASSASSINATION]:137037,[this.ID_SHAMAN_RESTORATION]:137039,[this.ID_SHAMAN_ELEMENTAL]:137040,[this.ID_SHAMAN_ENHANCEMENT]:137041,[this.ID_WARLOCK_AFFLICTION]:137043,[this.ID_WARLOCK_DEMONOLOGY]:137044,[this.ID_WARLOCK_DESTRUCTION]:137046,[this.ID_WARRIOR_PROTECTION]:137048,[this.ID_WARRIOR_ARMS]:137049,[this.ID_WARRIOR_FURY]:137050,[this.ID_DEMON_HUNTER_HAVOC]:212612,[this.ID_DEMON_HUNTER_VENGEANCE]:212613,[this.ID_EVOKER_DEVASTATION]:356809,[this.ID_EVOKER_PRESERVATION]:356810,[this.ID_EVOKER_AUGMENTATION]:396186};const o={icons:WH.getPageData("wow.playerClass.specialization.icons"),names:WH.getPageData("wow.playerClass.specialization.names")};this.getAll=function(t){let a=[];i.getAll(t).forEach((function(t){a=a.concat(e.getByClass(t)||[])}));return a};this.getClassId=function(e,t){let a;if(typeof e==="string"){e=parseInt(e);WH.error("Spec ID was incorrect type.")}Object.entries(l(t)).some((([t,i])=>{if(i.includes(e)){a=parseInt(t);return true}}));return a};this.getByClass=function(t,a){let i=l(a);if(!i[t]){return undefined}let n=i[t].slice();n.sort((function(t,a){(e.getName(t)||t.toString()).localeCompare(e.getName(a)||a.toString())}));return n};this.getByIndex=function(e,t,a){let i=l(a);return i[e]&&i[e][t]||undefined};this.getBySlug=function(e,t,a){let n=c(a);let s=i.getBySlug(e,a);if(n[s]){for(let e in n[s]){if(n[s][e]===t){return parseInt(e)}}}return undefined};this.getIconName=function(e){return o.icons[e]};this.getIconUrl=function(t,i){return a.getIconUrl(e.getIconName(t),i)};this.getId=function(e,t){let a=l();if(a[e]){for(let i=0,n;n=a[e][i];i++){if(i+1===t){return n}}}else{WH.error("Tried to get a specialization ID from a non-existent class.",e,t)}WH.error("Could not get a specialization ID for this class and spec.",e,t);return undefined};this.getName=function(e){return o.names[e]};this.getNameWithClass=function(t){return WH.Strings.sprintf(WH.TERMS.specclass_format,e.getName(t),i.getName(i.getBySpec(t)))};this.getNumber=function(e,t,a){let i=l(a);if(i[e]){for(let a=0;a<i[e].length;a++){if(t===i[e][a]){return a+1}}}WH.error("Could not get a specialization number for this class and spec.",e,t);return undefined};this.getRoleName=function(t){switch(t){case e.ROLE_TANK:return WH.TERMS.tank;case e.ROLE_HEAL:return WH.TERMS.healing;case e.ROLE_DPS:return WH.TERMS.dps}};this.getSlug=function(e,t,a){return(c(a)[e]||{})[t]};this.getSpecSpellBySpec=e=>r[e];function l(e){return n[e]||n[WH.getRootEnv(e)]||n[t.getEnv(t.WOW)]}function c(e){return s[e]||s[WH.getRootEnv(e)]||s[t.getEnv(t.WOW)]}};WH.Wow.ModelViewer=WH.extendStatic(WH.ModelViewer,(function(){const e=this;const t=WH.Gatherer;const a=WH.Wow.Gender;const i=WH.Icon;const n=WH.Wow.Item;const s=WH.LocalStorage;const r=WH.Wow.Race;const o=WH.Wow.PlayerClass.Specialization;const l=WH.Tooltip;const c=WH.Types;const u=WH.Url;this.ANIMATION_CHARACTER_CREATE="DressingRoom";this.UNSHEATHED_DEFAULT=-1;const d=[181581];const f={[n.INVENTORY_TYPE_ONE_HAND]:n.INVENTORY_TYPE_MAIN_HAND,[n.INVENTORY_TYPE_TWO_HAND]:n.INVENTORY_TYPE_MAIN_HAND,[n.INVENTORY_TYPE_THROWN]:n.INVENTORY_TYPE_MAIN_HAND,[n.INVENTORY_TYPE_RANGED_RIGHT]:n.INVENTORY_TYPE_MAIN_HAND,[n.INVENTORY_TYPE_RANGED]:n.INVENTORY_TYPE_OFF_HAND,[n.INVENTORY_TYPE_HELD_IN_OFF_HAND]:n.INVENTORY_TYPE_OFF_HAND};const h=[n.INVENTORY_TYPE_HEAD,n.INVENTORY_TYPE_SHOULDERS,n.INVENTORY_TYPE_SHIRT,n.INVENTORY_TYPE_CHEST,n.INVENTORY_TYPE_WAIST,n.INVENTORY_TYPE_LEGS,n.INVENTORY_TYPE_FEET,n.INVENTORY_TYPE_WRISTS,n.INVENTORY_TYPE_HANDS,n.INVENTORY_TYPE_ONE_HAND,n.INVENTORY_TYPE_SHIELD,n.INVENTORY_TYPE_RANGED,n.INVENTORY_TYPE_BACK,n.INVENTORY_TYPE_TWO_HAND,n.INVENTORY_TYPE_TABARD,n.INVENTORY_TYPE_ROBE,n.INVENTORY_TYPE_MAIN_HAND,n.INVENTORY_TYPE_OFF_HAND,n.INVENTORY_TYPE_HELD_IN_OFF_HAND,n.INVENTORY_TYPE_THROWN,n.INVENTORY_TYPE_RANGED_RIGHT];const p=20;const m=76;const H=1;const g=2;const W=4;const E=8;const _=16;const v=32;const T=64;const b=128;const S=256;const y=512;const I=1024;const R={animationsLoaded:false,elements:{animationSelect:undefined,definition:undefined,gender:undefined,lightboxContent:undefined,race:undefined,screen:undefined},library:{},libraryLoadedCallbacks:{},ratio:16/9,resizeEventBound:false,shouldersOverride:undefined,shown:false};var N,w,A=[],M,C,O,L,k,D,P;this.applyDataEnv=function(e,t){e.env=e.dataEnv=e.gameDataEnv=WH.getDataEnvKey(t)};this.getBackgroundFilename=function(){if(WH.Theme.isThottbot()){return"background-classic-ddd.png"}if(WH.Theme.isClassic()){return"background-classic-181818.png"}return"background-181818.png"};this.getBackgroundUrl=function(t){return WH.staticUrl+e.getStaticBase(t)+"/"+e.getBackgroundFilename()};this.getContentPath=function(t){return""+(WH.isDev()?"https://wow.zamimg.com":WH.staticUrl)+e.getStaticBase(t)+"/"};this.getEffectiveInventoryType=function(e){return f[e]||e};this.getLibrary=function(e){if(e===undefined){e=WH.getDataEnv()}return R.library[e]};this.getModelId=function(e,t){return e+"_"+t};this.getModelScreenshotUrl=function(){let e=WH.ge("wh-mv-view-in-3d-button");if(!(e&&e.dataset.mvDisplayId)){return}let t;let a=parseInt(e.dataset.mvType);let i=parseInt(e.dataset.mvTypeId);let n=parseInt(e.dataset.mvDisplayId);if(a===WH.Types.NPC){return WH.Wow.Npc.getThumbUrl(n)}else if(a===WH.Types.ITEM){let e=WH.Gatherer.get(a,i);let t=e&&e.jsonequip&&e.jsonequip.races;let s=WH.Wow.Models.getRaceIdFromMask(t);if(e.classs!==WH.Wow.Item.CLASS_ARMOR){s=undefined}return WH.Wow.Item.getThumbUrl(n,s)}};this.getSheathTypes=function(a,i){let n={mainhand:e.UNSHEATHED_DEFAULT,offhand:e.UNSHEATHED_DEFAULT};if(a){let i=t.get(c.ITEM,a);if(i&&i.jsonequip){n.mainhand=i.jsonequip.sheathtype||e.UNSHEATHED_DEFAULT}}if(i){let a=t.get(c.ITEM,i);if(a&&a.jsonequip){n.offhand=a.jsonequip.sheathtype||e.UNSHEATHED_DEFAULT;if(a.jsonequip.sheathtype===4){n.offhand=9}else if(a.jsonequip.sheathtype===undefined){n.offhand=3}}}return n};this.getStaticBase=function(e){return"/modelviewer/"+WH.getDataEnvKey(e)};this.grabScreenshot=function(e,t){if(!t){t="screenshot";if(g_pageInfo){if(g_pageInfo.name){t=g_pageInfo.name}else{if(g_pageInfo.type&&WH.Types.getReferenceName(g_pageInfo.type)){t=WH.Types.getReferenceName(g_pageInfo.type);if(g_pageInfo.typeId){t+=" "+g_pageInfo.typeId}}}}}var a=$(e.renderer.canvas)[0];var i="fullscreenchange";var n;var s=function(a){if(a){document.removeEventListener(i,n,false)}window.requestAnimationFrame((function(){e.renderer.makeDataURL=["image/png",1];window.requestAnimationFrame((function(){var a=e.renderer.screenshotDataURL;var i=WH.ce("a");i.download=t+".png";i.href=a;i.style.display="none";WH.ae(document.body,i);i.click();if(document.exitFullscreen){document.exitFullscreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}}))}))};if(a.requestFullscreen){document.addEventListener(i,n=s.bind(this,true),false);a.requestFullscreen()}else if(a.webkitRequestFullscreen){i="webkit"+i;document.addEventListener(i,n=s.bind(this,true),false);a.webkitRequestFullscreen()}else if(a.mozRequestFullScreen){i="moz"+i;document.addEventListener(i,n=s.bind(this,true),false);a.mozRequestFullScreen()}else{s(false)}};this.isLibraryLoaded=function(t){return e.getLibrary(t)!==undefined};this.loadLibrary=function(t,a){if(a===undefined){a=WH.getDataEnv()}if(e.isLibraryLoaded(a)){if(t){window.requestAnimationFrame(t)}return}var i=!!R.libraryLoadedCallbacks[a];if(!i){R.libraryLoadedCallbacks[a]=[]}if(t){if(R.libraryLoadedCallbacks[a].length>100){WH.error("Too many callbacks waiting for ZamModelViewer!")}else{R.libraryLoadedCallbacks[a].push(t)}}if(i){return}var n=WH.ce("script");n.src=e.getContentPath(a)+"viewer/viewer.min.js";WH.aE(n,"load",(function(){if(window.ZamModelViewer){R.library[a]=window.ZamModelViewer;delete window.ZamModelViewer}if(!e.isLibraryLoaded(a)){WH.error("Model viewer script file was loaded, but ZamModelViewer is still undefined!");return}while(R.libraryLoadedCallbacks[a].length){R.libraryLoadedCallbacks[a].shift()()}}));WH.aE(n,"error",(function(){WH.error("Failed to load ZamModelViewer JS")}));WH.ae(WH.qs("head"),n)};this.showLightbox=function(e){O=e;Lightbox.show("modelviewer",{onShow:ee,onHide:X},e)};this.supportsEnchantVisual=function(t){switch(e.getEffectiveInventoryType(t)){case n.INVENTORY_TYPE_MAIN_HAND:case n.INVENTORY_TYPE_OFF_HAND:return true}return false};this.supportsInventoryType=function(e){return h.indexOf(parseInt(e))>=0};function x(){let t=Y();let i=t.race;let n=t.gender;if(!i){if(R.elements.gender.style.display==="none"){return}WH.displayNone(R.elements.gender);N=A[1];switch(O.slot){case 1:w=g;break;case 3:w=W;break;default:w=H}}else{if(R.elements.gender.style.display==="none"){WH.displayInline(R.elements.gender)}n=r.validateGender(i,a.tryFrom(n)).value;N=e.getModelId(i,n);w=_;s.set(s.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL,{race:parseInt(i),gender:n})}Z();J()}function U(){let t=false;let a=false;let i=function(){return t?WH.TERMS.sheathed:WH.TERMS.unsheathed};let r=WH.ce("a",{className:"fa fa-hand-"+(t?"paper":"rock")+"-o",href:"javascript:"});l.simple(r,i,"q2");WH.aE(r,"click",(function(){t=!t;let o;let c;if(t){(P.itemData||[]).forEach((function(e){let t=n.getInvTypeSlots(e[2]);if(t.includes(WH.Wow.INVENTORY_SLOT_MAIN_HAND)){o=e[0]}else if(t.includes(WH.Wow.INVENTORY_SLOT_OFF_HAND)){c=e[0]}}))}let u=e.getSheathTypes(o,c);P.characterData.sheathMain=u.mainhand;P.characterData.sheathOff=u.offhand;if(L){if(!WH.isClassicTree()){L.method("setSheath",[u.mainhand,u.offhand])}else{L.method("setAppearance",[P.characterData.hairstyle,P.characterData.haircolor,P.characterData.facetype,P.characterData.skincolor,P.characterData.features,P.characterData.haircolor,P.characterData.hornstyle,P.characterData.blindfolds,P.characterData.tattoos,u.mainhand,u.offhand])}}r.classList.toggle("fa-hand-rock-o");r.classList.toggle("fa-hand-paper-o");if(a){l.show(r,i(),"q2")}s.set(s.KEY_WOW_MODEL_VIEWER_SHEATHED,t)}));if(s.get(s.KEY_WOW_MODEL_VIEWER_SHEATHED)===true){r.click()}a=true;return r}function F(e,t){let a=WH.Gatherer.get(WH.Types.ITEM,e);let i=[];let n=e=>{A[1]=e;N=e;if(Y().race){x()}else{J()}};let s=(e,t)=>i.some((i=>[N,A[1]].includes(a.appearances[i.mod][0])&&i.si===parseInt(e)&&(t==null||i.ai===parseInt(t))));let r=[];for(let e in t){let o=t[e];if(Object.keys(o).length){let t=[];for(let r in o){let l=o[r];let c=l.mod;if(a.appearances&&a.appearances[c]&&a.appearances[c][0]){i.push(l);t.push(Menu.createItem({crumb:r,label:WH.ce("span",{className:"artifact-appearance",style:{backgroundColor:"rgba("+WH.Strings.sprintf("%d,%d,%d,1",l.swatchrgb>>16&255,l.swatchrgb>>8&255,l.swatchrgb&255)+")"}}),url:n.bind(null,a.appearances[c][0]),options:{checkedFunc:s.bind(null,e,r)}}))}}r.push(Menu.createItem({crumb:e,label:o["1"]?o["1"].setname:"",submenu:t,options:{checkedFunc:s.bind(null,e,null)}}))}}return r}function q(e,t,a){let i=[];for(let n in e){let s=e[n];let r=WH.ce("span",{className:"spec-variant"},WH.ct(s.specName));let l=Menu.createItem({label:r,url:(e=>{N=e.modelId;WH.st(t,e.specName);J()}).bind(null,s),options:{tinyIcon:WH.Icon.getIconUrl(o.getIconName(s.specId),WH.Icon.TINY),checkedFunc:(e=>e===N).bind(null,s.modelId)}});if(s.modelId===a){WH.st(t,s.specName)}i.push(l)}return i}function Y(){return{race:R.elements.race.selectedIndex>=0?R.elements.race.options[R.elements.race.selectedIndex].value:"",gender:R.elements.gender.selectedIndex>=0?R.elements.gender.options[R.elements.gender.selectedIndex].value:0}}function B(){WH.onLoad(j)}function G(t,i){let n;let o;if(i.race!=null&&i.gender!=null){n=i.race;o=i.gender;k.hide();t=false}else{k.show()}if(i.hasOwnProperty("characterData")&&i.characterData.hasOwnProperty("race")){n=i.characterData.race}if(i.hasOwnProperty("characterData")&&i.characterData.hasOwnProperty("gender")){o=i.characterData.gender}if(n==null&&o==null&&location.hash){let e=location.hash.match(/modelviewer:.*?([0-9]+)\+([0-9]+)/);if(e&&z(parseInt(e[1]),parseInt(e[2]))){n=parseInt(e[1]);o=parseInt(e[2]);WH.displayInline(R.elements.gender)}}R.elements.race.options[0].hidden=!t;R.elements.race.options[0].disabled=!t;if(t){R.elements.race.selectedIndex=0;if(o==null){WH.displayNone(R.elements.gender)}}else{if(n==null&&o==null){let e=r.ID_HUMAN;let t=a.Male.value;if(g_user&&g_user.settings&&g_user.settings.defaultModel){e=g_user.settings.defaultModel.race;t=g_user.settings.defaultModel.gender-1}else{let a=s.get(s.KEY_WOW_MODEL_VIEWER_DEFAULT_MODEL);if(a&&a.race){e=a.race;t=a.gender}}e=i.defaultRace||e;if(z(e,t)){n=e;o=t}else{n=r.ID_HUMAN;o=a.Male.value}}WH.displayInline(R.elements.gender)}if(o!=null){R.elements.gender.selectedIndex=o}if(n!=null&&o!=null){N=e.getModelId(n,o);w=_;for(let e,t=0;e=R.elements.race.options[t];t++){if(e.value==n){R.elements.race.selectedIndex=t}}for(let e,t=0;e=R.elements.gender.options[t];t++){if(e.value==o){R.elements.gender.selectedIndex=t}}}}function z(e,t){let i=a.tryFrom(t);if(!i){return false}return r.exists(e)&&r.validateGender(e,i)===i}function V(e,t){return WH.inArray([n.INVENTORY_TYPE_SHIRT,n.INVENTORY_TYPE_CHEST,n.INVENTORY_TYPE_WAIST,n.INVENTORY_TYPE_LEGS,n.INVENTORY_TYPE_FEET,n.INVENTORY_TYPE_WRISTS,n.INVENTORY_TYPE_HANDS,n.INVENTORY_TYPE_BACK,n.INVENTORY_TYPE_TABARD,n.INVENTORY_TYPE_ROBE],e)!==-1||d.indexOf(t)!==-1}function K(){if(R.animationsLoaded){return}if(!L||!L.method("isLoaded")){setTimeout(K,100);return}WH.ee(R.elements.animationSelect);let t=[];let a=L.method("getNumAnimations");for(let e=0;e<a;e++){let a=L.method("getAnimation",e);if(a&&!t.includes(a)){t.push(a)}}t.sort();t.forEach((function(e){WH.ae(R.elements.animationSelect,WH.ce("option",{value:e},WH.ct(e)))}));let i=t.indexOf(e.ANIMATION_CHARACTER_CREATE);if(i>=0){WH.debug("Setting model viewer animation to:",t[i]);L.method("setAnimation",t[i]);R.elements.animationSelect.selectedIndex=i}R.animationsLoaded=true}function j(){if(location.hash&&location.hash.indexOf("#modelviewer")==0){var t=location.hash.split(":");if(t.length>=3){t.shift();var a=parseInt(t.shift());var i={type:a,extendedHash:true};switch(a){case WH.Types.NPC:i.displayId=parseInt(t.shift());var n=parseInt(t.shift());if(n==1){i.humanoid=1}break;case WH.Types.OBJECT:i.displayId=parseInt(t.shift());break;case WH.Types.ITEM:i.displayId=parseInt(t.shift());i.slot=parseInt(t.shift());break;case WH.Types.ITEM_SET:var s=t.shift();i.equipList=s.split(";");break}if(i.displayId||i.equipList){e.showLightbox(i)}}else{var r=WH.ge("wh-mv-view-in-3d-button");if(r){r.click()}}}}function Z(){let e=[];let t=[WH.Types.ITEM_SET,WH.Types.TRANSMOG_SET,WH.Types.OUTFIT,WH.Types.GEAR_SET];if(t.includes(P.type)&&P.itemData){for(let t in P.itemData){e.push({itemId:P.itemData[t][0],itemBonus:P.itemData[t][1],slot:P.itemData[t][2]})}}if(e.length===0){return}if(P.characterData){let t=$.extend({},P.characterData);t.date=(new Date).getTime();if(!t["class"]&&t.charClass){t["class"]=t.charClass;delete t.charClass}if(Array.isArray(t.charCustomization)){t.charCustomization.forEach((function(e){if(e.optionSlug){t[e.optionSlug]=e.choiceId}}));delete t.charCustomization}e.push(t)}else{let t=Y();t.date=(new Date).getTime();e.push(t)}s.set(s.KEY_WOW_MODEL_VIEWER_LAST_MODEL,e)}function X(){R.shown=false;if(!O.noPound){if(!O.fromTag&&D&&D.indexOf("modelviewer")==-1){WH.setHash(D)}else{WH.clearHash()}}if(L){L.destroy()}if(O.onHide){O.onHide()}}function Q(){if(!R.shown){return}let e;let t;if(window.innerWidth<WH.Responsive.BREAKPOINTS.MOBILE_MODE){e=R.elements.lightboxContent.offsetWidth;t=R.elements.lightboxContent.offsetHeight;R.elements.screen.style.width="100%";R.elements.screen.style.height="100%"}else{e=window.innerWidth-Lightbox.BLEED_SIZE-p;t=window.innerHeight-Lightbox.BLEED_SIZE-m;let a=Math.round(t*(16/9));let i=Math.round(e*(9/16));if(e>a){e=a}else if(t>i){t=i}R.elements.screen.style.width=e+"px";R.elements.screen.style.height=t+"px"}if(e&&t){R.ratio=e/t;if(L&&L.renderer.onResize){L.renderer.onResize(e,t,R.ratio)}}}function J(){var t=O.dataEnv;if(!e.isLibraryLoaded(t)){e.loadLibrary(J.bind(this),t);return}var a=Y();var i=a.race;var n=a.gender;if(L)L.destroy();var r={type:e.getLibrary(t).WOW,contentPath:e.getContentPath(t),container:$(R.elements.screen),aspect:R.ratio,background:e.getBackgroundFilename(),models:{type:w,id:N}};if(P.hasOwnProperty("characterData")){if(P.characterData.race==i&&P.characterData.gender==n){if(!WH.isClassicTree()){r.charCustomization={race:P.characterData.race,gender:P.characterData.gender,options:P.characterData.charCustomization||[]}}else{r.sk=P.characterData.skincolor;r.ha=P.characterData.hairstyle;r.hc=P.characterData.haircolor;r.fa=P.characterData.facetype;r.fh=P.characterData.features;r.fc=P.characterData.haircolor;r.ep=P.characterData.blindfolds;r.ho=P.characterData.hornstyle;r.ta=P.characterData.tattoos}r.cls=P.characterData.charClass}if(s.get(s.KEY_WOW_MODEL_VIEWER_SHEATHED)===true){if(!WH.isClassicTree()){r.charCustomization=r.charCustomization||{};if(P.characterData.hasOwnProperty("sheathMain")){r.charCustomization.sheathMain=P.characterData.sheathMain}if(P.characterData.hasOwnProperty("sheathOff")){r.charCustomization.sheathOff=P.characterData.sheathOff}}else{if(P.characterData.hasOwnProperty("sheathMain")){r.sheathMain=P.characterData.sheathMain}if(P.characterData.hasOwnProperty("sheathOff")){r.sheathOff=P.characterData.sheathOff}}}}if((w==E||w==v||w==_)&&A.length){var o=[];A=[].concat.apply([],A);for(var l=0;l<A.length;l+=2){o.push([A[l],A[l+1]])}r.items=o}if(R.shouldersOverride){r.shouldersOverride=R.shouldersOverride}if(M)r.link=M;if(C)r.label=C;if(WH.isClassicTree()||WH.isTbcTree()||WH.isWrathTree()){r.hd=false}else{r.hd=true}if(e.canTakeScreenshots()&&WH.getGets().modelViewerTransparency!==undefined){r.transparent=true;delete r.background;R.elements.screen.style.backgroundImage='url("'+e.getBackgroundUrl(t)+'")'}e.applyDataEnv(r,t);WH.debug("Creating ZamModelViewer with these options:",JSON.stringify(r),r);e.viewer=L=new(e.getLibrary(t))(r);if(e.viewer.setAdaptiveMode){e.viewer.setAdaptiveMode(true);if(!R.resizeEventBound){WH.aE(window,"resize",Q);R.resizeEventBound=true}}Q();if(!O.noPound){var c="#modelviewer";if(O.extendedHash||!WH.ge("wh-mv-view-in-3d-button")){switch(O.type){case WH.Types.NPC:c+=":"+O.type+":"+O.displayId+":"+(O.humanoid|0);break;case WH.Types.OBJECT:c+=":"+O.type+":"+O.displayId;break;case WH.Types.ITEM:c+=":"+O.type+":"+O.displayId+":"+(O.slot|0);break;case WH.Types.ITEM_SET:c+=":"+O.type+":"+A.join(";");break;case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:c+=":"+O.type+":"+A.join(";");break}}if(i&&n){c+=":"+i+"+"+n}else{c+=":"}WH.ee(R.elements.animationSelect);WH.ae(R.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));R.animationsLoaded=false;K();location.replace(WH.rtrim(c,":"))}}function ee(t,s,o){P=o;R.shown=true;if(s){t=$(t);t.addClass("has-lightbox-caption modelviewer");R.elements.screen=WH.ce("div",{className:"modelviewer-screen"});R.elements.lightboxContent=WH.ce("div",{className:"lightbox-content modelviewer-modelbg"});WH.ae(R.elements.lightboxContent,R.elements.screen);t.append(R.elements.lightboxContent);let s=WH.ce("a",{className:"fa fa-arrows-alt",href:"javascript:"});WH.aE(s,"click",(function(){L.setFullscreen(true)}));l.simple(s,WH.TERMS.fullscreen,"q2");WH.ae(R.elements.screen,s);let h=WH.ce("a",{className:"fa fa-pause",href:"javascript:"});WH.aE(h,"click",(function(){L.method("setAnimPaused",this.classList.contains("fa-pause"));this.classList.toggle("fa-play");this.classList.toggle("fa-pause");let e=this.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play;l.show(this,e,"q2")}));l.simple(h,(function(){return this.classList.contains("fa-pause")?WH.TERMS.pause:WH.TERMS.play}),"q2");WH.ae(R.elements.screen,h);if(P.itemData&&P.itemData.length){for(let e=0,t;t=P.itemData[e];e++){let e=n.getInvTypeSlots(t[2]);if(e.includes(WH.Wow.INVENTORY_SLOT_MAIN_HAND)||e.includes(WH.Wow.INVENTORY_SLOT_OFF_HAND)){WH.ae(R.elements.screen,U());break}}}Q();let p=WH.ce("div",{className:"modelviewer-animation"});WH.ae(p,WH.ce("var",undefined,WH.ct(WH.TERMS.animation)));R.elements.animationSelect=WH.ce("select");WH.ae(R.elements.animationSelect,WH.ce("option",{value:0},WH.ct(WH.TERMS.loading_ellipsis)));WH.aE(R.elements.animationSelect,"change",(function(){let e=R.elements.animationSelect.value;if(e&&L&&L.method("isLoaded")){WH.debug("Setting model viewer animation to:",e);L.method("setAnimation",e)}}));WH.ae(p,R.elements.animationSelect);K();t.append(p);t.append($("<a/>",{class:"dialog-option fa fa-times",href:"javascript:",click:Lightbox.hide,text:WH.TERMS.close}));t.append($("<a/>",{class:"dialog-option fa fa-question",href:WH.Url.generatePath("/help=modelviewer"),target:"_blank",text:WH.TERMS.help}));if(e.canTakeScreenshots()){t.append($("<a/>",{class:"dialog-option fa fa-camera",href:"javascript:",click:function(){e.grabScreenshot(L)},text:WH.TERMS.screenshot}));let a=WH.ce("a",{className:"dialog-option fa"},WH.ct("Transparency"));t.append(a);if(WH.getGets().modelViewerTransparency===undefined){a.classList.add("fa-square");WH.aE(a,"click",(function(){location.href=u.getModifiedPageQuery((function(e){e.modelViewerTransparency=""}))}))}else{a.classList.add("fa-check-square","fa-color-white");WH.aE(a,"click",(function(){location.href=u.getModifiedPageQuery((function(e){delete e.modelViewerTransparency}))}))}}if(o.modelTileUrl){t.append($("<a/>",{class:"dialog-option fa fa-th-large",href:o.modelTileUrl,text:"Tile"}))}if(o.itemData){let e=WH.ce("div",{className:"modelviewer-slots"});let t=WH.ce("div",{className:"modelviewer-slots-left"});let a=WH.ce("div",{className:"modelviewer-slots-right"});let n=WH.ce("div",{className:"modelviewer-slots-bottom"});WH.ae(e,t);WH.ae(e,a);WH.ae(e,n);WH.ae(R.elements.screen,e);R.elements.screen.dataset.dressingRoomButton="true";WH.ae(e,WH.ce("a",{className:"btn btn-site btn-small modelviewer-dressing-room-link fa fa-male",href:WH.Url.generate("/dressing-room"),text:WH.TERMS.openindressingroom}));let s={};for(let e=0,r;r=g_character_slots_data[e];++e){let o=r.name==="back"?"chest":r.name;s[r.id]=i.create("inventoryslot_"+o,i.MEDIUM,"javascript:");s[r.id].classList.add("modelviewer-slots-noicon");if(r.noModel){s[r.id].style.visibility="hidden"}WH.ae(e<8?t:e<16?a:n,s[r.id])}let r;for(let e=0,t;t=o.itemData[e];e++){if(r=s[t[2]]){i.setName(r,i.MEDIUM,g_items.getIcon(t[0],t[1]).toLowerCase());r.classList.remove("modelviewer-slots-noicon");r.style.visibility=""}}}k=$("<div/>",{class:"modelviewer-model"});var c=r.getPlayableRaceIds();R.elements.race=WH.ce("select");k.append(R.elements.race);WH.aE(R.elements.race,"change",x);WH.ae(R.elements.race,WH.ce("option"));for(let e=0,t=c.length;e<t;++e){WH.ae(R.elements.race,WH.ce("option",{value:c[e],text:r.getName(c[e])}))}R.elements.gender=WH.ce("select");k.append(R.elements.gender);WH.aE(R.elements.gender,"change",x);WH.ae(R.elements.gender,WH.ce("option",{value:a.Male.value,text:a.Male.getName()}));WH.ae(R.elements.gender,WH.ce("option",{value:a.Female.value,text:a.Female.getName()}));WH.displayNone(R.elements.gender);let m=P.artifact&&Object.keys(P.artifact).length>0;let H=$("<a>"+WH.TERMS.artifactappearances+"</a>");H.get(0).style.marginLeft="5px";if(m){Menu.add(H,F(P.typeId,P.artifact))}let g=P.specVariants&&Object.keys(P.specVariants).length>0;let W=WH.ce("a",{style:{marginLeft:"5px"}},WH.ct(WH.TERMS.specializationvariants));if(g){Menu.add(W,q(P.specVariants,W,o.displayId))}if(m){k.append("<br>");k.append(H)}t.append(k);if(g){t.append("<br>");t.append(W)}var d=$("<div/>",{class:"modelviewer-instructions"});d.append(WH.TERMS.modelviewercontrols_tip);t.append(d);var f=$("<div/>",{id:"modelviewer-msg",class:"sub",css:{display:"none","margin-top":"-6px",color:"#ccc","font-size":"13px"}});t.append(f);if(WH.isSet("g_user")&&g_user.id)$.ajax({url:WH.Url.generatePath("/website-achievement-explored"),data:{trigger:"modelviewer"},success:function(){AchievementCheck()},type:"POST"})}R.shouldersOverride=undefined;switch(o.type){case WH.Types.NPC:k.hide();if(o.humanoid){w=v}else{w=E}if(o.equipList){A=o.equipList}N=o.displayId;break;case WH.Types.OBJECT:k.hide();w=T;N=o.displayId;break;case WH.Types.ITEM:case WH.Types.ITEM_SET:case WH.Types.TRANSMOG_SET:case WH.Types.OUTFIT:case WH.Types.GEAR_SET:if(o.type==WH.Types.ITEM){A=[o.slot,o.displayId]}else{A=o.equipList}if(o.shouldersOverride&&o.shouldersOverride.length===2){R.shouldersOverride=o.shouldersOverride}if(A.length>2||V(A[0],A[1])||WH.inArray([WH.Types.TRANSMOG_SET,WH.Types.OUTFIT,WH.Types.GEAR_SET],o.type)>=0&&A.length>1){G(false,o)}else{switch(A[0]){case 1:w=g;break;case 3:w=W;break;default:w=H}N=A[1];G(true,o)}break}if(o.fileId){k.hide();w=S;N=o.fileId}setTimeout(J,1);var h=$("#modelviewer-msg");if(o.message&&h.length>0){h.html(o.message);h.show()}else h.hide();if(o.link)M=o.link;if(o.label)C=o.label;var p="";if(o.fromTag){p+="Custom ";switch(o.type){case WH.Types.NPC:p+="NPC "+o.displayId+(o.humanoid?" humanoid":"");break;case WH.Types.OBJECT:p+="Object "+o.displayId;break;case WH.Types.ITEM:p+="Item "+o.displayId+" Slot "+(o.slot|0);break;case WH.Types.ITEM_SET:p+="Item set "+A.join(".");break;case WH.Types.TRANSMOG_SET:p+="Transmog set "+A.join(".");break;case WH.Types.OUTFIT:p+="Outfit "+A.join(".");break;case WH.Types.GEAR_SET:p+="Gear set "+A.join(".");break}}else{switch(o.type){case WH.Types.NPC:p+="NPC "+(o.typeId?o.typeId:" DisplayID "+o.displayId);break;case WH.Types.OBJECT:p+="Object "+o.typeId;break;case WH.Types.ITEM:p+="Item "+o.typeId;break;case WH.Types.ITEM_SET:p+="Item set "+A.join(".");break;case WH.Types.TRANSMOG_SET:p+="Transmog set "+A.join(".");break;case WH.Types.OUTFIT:p+="Outfit "+A.join(".");break;case WH.Types.GEAR_SET:p+="Gear set "+A.join(".");break}}WH.Track.interactiveEvent("Model Viewer","Show",WH.Strings.slug(p));D=location.hash;Z()}B()}));